<html><head></head><body>
		<div id="_idContainer010">
			<h1 id="_idParaDest-30"><em class="italic"><a id="_idTextAnchor029"/>Chapter 2</em>: Understanding systemd Directories and Files</h1>
			<p>In this chapter, we'll explore the various <strong class="source-inline">systemd</strong> unit files and configuration files and explain the purpose of several types. We'll briefly look at some of the executable files that are associated with <strong class="source-inline">systemd</strong>. Along the way, we'll also look at the directories where these files live.</p>
			<p>These are the topics we will cover in this chapter:</p>
			<ul>
				<li>Understanding the <strong class="source-inline">systemd</strong> configuration files</li>
				<li>Understanding the <strong class="source-inline">systemd</strong> unit files</li>
				<li>Understanding the <strong class="source-inline">systemd</strong> executables</li>
			</ul>
			<p>The topics in this chapter comprise basic foundational knowledge of <strong class="source-inline">systemd</strong>. We'll be building upon this foundation in the chapters to come.</p>
			<p>If you're ready, let's go.</p>
			<h1 id="_idParaDest-31"><a id="_idTextAnchor030"/>Technical requirements</h1>
			<p>If you'd like to follow along with what I'm doing, you'll need a couple of <strong class="bold">virtual machines</strong> (<strong class="bold">VMs</strong>). Here, I'm using Ubuntu Server 20.04 for the Ubuntu side of things, and AlmaLinux 8 for the Red Hat side of things. (You'll also see me using Fedora to point out a couple of things, but you won't need a Fedora VM yourself.)</p>
			<p>Check out the following link to see the Code in Action video: <a href="https://bit.ly/3xL4os5">https://bit.ly/3xL4os5</a></p>
			<h1 id="_idParaDest-32"><a id="_idTextAnchor031"/>Understanding the systemd configuration files</h1>
			<p>In this<a id="_idIndexMarker020"/> section, we'll look at the configuration files that control how the various components of <strong class="source-inline">systemd</strong> operate. If you want to follow along with your own VM, it won't much matter which distro you have because things will be mostly the same across all <strong class="source-inline">systemd</strong>-enabled distros. Okay—so now you're yelling at me, saying: </p>
			<p><em class="italic">Mostly the same? Why, Donnie, you told us before that systemd is implemented consistently across all distros! What gives?</em></p>
			<p>Well, it is consistent, in that the management and control commands are the same across all distros, but the <strong class="source-inline">systemd</strong> ecosystem includes several different components besides just the <strong class="source-inline">init</strong> system. These components are optional, and some Linux distros don't use all of them in a default configuration. Several of these components have <a id="_idIndexMarker021"/>configuration files in the <strong class="source-inline">/etc/systemd/</strong> directory, as you can see here:</p>
			<p class="source-code">[donnie@localhost systemd]$ pwd</p>
			<p class="source-code">/etc/systemd</p>
			<p class="source-code">[donnie@localhost systemd]$ ls -l *.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root  720 May 31  2016 bootchart.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root  615 Mar 26  2020 coredump.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root 1041 Mar 26  2020 journald.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root 1042 Mar 26  2020 logind.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root  584 Mar 26  2020 networkd.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root  529 Mar 26  2020 pstore.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root  764 Mar 26  2020 resolved.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root  790 Mar 26  2020 sleep.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root 1762 Mar 26  2020 system.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root  677 Mar 26  2020 timesyncd.conf</p>
			<p class="source-code">-rw-r--r--. 1 root root 1185 Mar 26  2020 user.conf</p>
			<p class="source-code">[donnie@localhost systemd]$</p>
			<p>The <strong class="source-inline">timesyncd.conf</strong> file, which you see second from the bottom in the preceding code snippet, is one of those components that you won't see everywhere. It's for the service that synchronizes the machine's time to a trusted external source. You see it here, but you won't see it<a id="_idIndexMarker022"/> on either <strong class="bold">Red Hat Enterprise Linux</strong> (<strong class="bold">RHEL</strong>) or any of RHEL's free-of-charge derivatives. That's because RHEL-type distros use an alternate time-synchronization service called <strong class="source-inline">chronyd</strong>, and just because you see a configuration file here for a particular <strong class="source-inline">systemd</strong> component doesn't necessarily mean that that component is being used. On the Fedora machine from which I took the preceding code snippet, the <strong class="source-inline">networkd</strong>, <strong class="source-inline">resolved</strong>, and <strong class="source-inline">timesyncd</strong> components are all disabled. (As with the RHEL distros, Fedora uses <strong class="source-inline">chronyd</strong> for time-keeping, but it still has the <strong class="source-inline">timesyncd</strong> component installed.) On the other hand, if you look at the newest versions of Ubuntu Server, you'll see that these optional components are enabled by default. (We'll see later how to tell if a service is either enabled or disabled.)</p>
			<p>Okay—let's talk about what's in these configuration files. We'll start by looking at the <strong class="source-inline">system.conf</strong> file, which sets the configuration for the <strong class="source-inline">systemd</strong> <strong class="source-inline">init</strong> process. (For space reasons, I can <a id="_idIndexMarker023"/>only show part of the file here. You can view the whole file on your VM by doing <strong class="source-inline">less /etc/systemd/system.conf</strong>.) Here's a snippet:</p>
			<p class="source-code">[Manager]</p>
			<p class="source-code">#LogLevel=info</p>
			<p class="source-code">#LogTarget=journal-or-kmsg</p>
			<p class="source-code">#LogColor=yes</p>
			<p class="source-code">#LogLocation=no</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p class="source-code">#DefaultLimitNICE=</p>
			<p class="source-code">#DefaultLimitRTPRIO=</p>
			<p class="source-code">#DefaultLimitRTTIME=</p>
			<p>Now, I'm not going to explain this file line by line because I don't want you to hate me for boring you to death. But seriously, in normal circumstances, you might not ever have to change any of these configuration files. If you think that you might need to do anything with them, your best bet is to read their associated man pages, which will have a breakdown of what each of these parameters is doing for you. The trick is that for most of these files, you'll have to add the <strong class="source-inline">systemd-</strong> text string to the front of the filename to find its man page. For example, to look at the man page for the <strong class="source-inline">system.conf</strong> file, type the following:</p>
			<p class="source-code">man systemd-system.conf</p>
			<p>Also, you might have noticed that in all of these configuration files, every line is commented out. That doesn't mean that those lines have no effect. Instead, it means that these are the default parameters that are compiled in. To change something, you would uncomment the line for the desired parameter and change its value.</p>
			<p class="callout-heading">Pro tip</p>
			<p class="callout">You can use the <strong class="source-inline">apropos</strong> command to find all man pages with a specific text string in either the man page name or man page description. For example, to find all pages that match the <strong class="source-inline">systemd</strong> string, just type the following: <strong class="source-inline">apropos systemd</strong>.</p>
			<p class="callout">You can also type <strong class="source-inline">man -k systemd</strong>, which is a synonym for <strong class="source-inline">apropos systemd</strong>. (I got into the habit early on of always typing <strong class="source-inline">apropos</strong>, and I've never broken this habit.) If nothing comes up when you try this, you might have to rebuild the man page database, which you'll do by typing <strong class="source-inline">sudo mandb</strong>.</p>
			<p>All right—I think<a id="_idIndexMarker024"/> we've talked enough about the configuration files. Next up, we'll talk about the <strong class="source-inline">systemd</strong> unit files.</p>
			<h1 id="_idParaDest-33"><a id="_idTextAnchor032"/>Understanding the systemd unit files</h1>
			<p>Instead of <a id="_idIndexMarker025"/>using a set of complex Bash shell scripts, the <strong class="source-inline">systemd</strong> <strong class="source-inline">init</strong> system controls system and service operations with various types of <em class="italic">unit</em> files. Each unit file has a filename with a filename extension that describes which type of unit it is. Before we look at these files, let's see where they live.</p>
			<p>The <strong class="source-inline">/lib/systemd/system/</strong> directory is the default location for unit files that either come with the operating system or come with any packages that you might install. There might be times when you'll either need to modify some of these unit files or even create your own, but you won't do that in this directory. Instead, you'll do that in the <strong class="source-inline">/etc/systemd/system/</strong> directory. Any unit files in this directory that have the same name as unit files in <strong class="source-inline">/lib/systemd/system/</strong> take precedence.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">You can read about unit files by typing the following: <strong class="source-inline">man systemd.unit</strong>.</p>
			<p class="callout">At the bottom of this man page, you'll see where it refers you to other man pages for each specific type of unit file. You'll soon see that the trickiest part about this is having to search through the various man pages whenever you need to look up something about a particular unit-configuration parameter. To make things easier, you can look up a specific directive in the <strong class="source-inline">systemd.directives</strong> man page, which will direct you to the man page that contains information about that directive.</p>
			<p>Now that you<a id="_idIndexMarker026"/> know where the unit files are, let's look at <em class="italic">what</em> they are.</p>
			<h2 id="_idParaDest-34"><a id="_idTextAnchor033"/>Types of unit files</h2>
			<p>In the <strong class="source-inline">/lib/systemd/system</strong> directory, you'll see various types of unit files that each perform <a id="_idIndexMarker027"/>a different function. Here's a list of the more common types:</p>
			<ul>
				<li><strong class="source-inline">service</strong>: These are the configuration files for services. They replace the old-fashioned init scripts that <a id="_idIndexMarker028"/>we had on the old <strong class="bold">System V</strong> (<strong class="bold">SysV</strong>) systems.</li>
				<li><strong class="source-inline">socket</strong>: Sockets can either enable communication between different system services or they can automatically wake up a sleeping service when it receives a connection request.</li>
				<li><strong class="source-inline">slice</strong>: Slice units are used when configuring <strong class="source-inline">cgroups</strong>. (We'll look at these in <em class="italic">Part 2</em>, <em class="italic">Understanding cgroups</em>.)</li>
				<li><strong class="source-inline">mount</strong> and <strong class="source-inline">automount</strong>: These contain mount point information for filesystems that are controlled by <strong class="source-inline">systemd</strong>. Normally, they get created automatically, so you shouldn't have to do too much with them.</li>
				<li><strong class="source-inline">target</strong>: Target units are used during system startup, for grouping units and for providing well-known synchronization points. (We'll cover these in <a href="B17491_06_Final_NM_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 6</em></a>, <em class="italic">Understanding systemd Targets</em>.)</li>
				<li><strong class="source-inline">timer</strong>: Timer units are for scheduling jobs that run on a schedule. They replace the old cron system. (We'll work with these in <a href="B17491_07_Final_NM_ePub.xhtml#_idTextAnchor091"><em class="italic">Chapter 7</em></a>,<em class="italic"> Understanding systemd Timers</em>.)</li>
				<li><strong class="source-inline">path</strong>: Path units are for services that can be started via path-based activation. (We'll cover service, path, and socket units in <a href="B17491_03_Final_NM_ePub.xhtml#_idTextAnchor039"><em class="italic">Chapter 3</em></a>,<em class="italic"> Understanding Service, Path, and Socket Units</em>.)</li>
				<li><strong class="source-inline">swap</strong>: Swap units contain information about your swap partitions.<p>That's about it <a id="_idIndexMarker029"/>for the basic description of our unit files. We'll go into the nitty-gritty details about them in subsequent chapters.</p></li>
			</ul>
			<h1 id="_idParaDest-35"><a id="_idTextAnchor034"/>Understanding the systemd executables</h1>
			<p>Normally, we <a id="_idIndexMarker030"/>would search for a program's executable files in either a <strong class="source-inline">bin/</strong> or an <strong class="source-inline">sbin/</strong> directory, and you will indeed find some of the <strong class="source-inline">systemd</strong> utility executable files there, but most of the <strong class="source-inline">systemd</strong> executables are found instead in the <strong class="source-inline">/lib/systemd/</strong> directory. To save space, here's just a partial listing:</p>
			<p class="source-code">donnie@donnie-TB250-BTC:/lib/systemd$ ls -l</p>
			<p class="source-code">total 7448</p>
			<p class="source-code">-rw-r--r--  1 root root 2367728 Feb  6  2020 libsystemd-shared-237.so</p>
			<p class="source-code">drwxr-xr-x  2 root root    4096 Apr  3  2020 network</p>
			<p class="source-code">-rw-r--r--  1 root root     699 Feb  6  2020 resolv.conf</p>
			<p class="source-code">-rwxr-xr-x  1 root root    1246 Feb  6  2020 set-cpufreq</p>
			<p class="source-code">drwxr-xr-x 24 root root   36864 Apr  3  2020 system</p>
			<p class="source-code">-rwxr-xr-x  1 root root 1612152 Feb  6  2020 systemd</p>
			<p class="source-code">-rwxr-xr-x  1 root root    6128 Feb  6  2020 systemd-ac-power</p>
			<p class="source-code">-rwxr-xr-x  1 root root   18416 Feb  6  2020 systemd-backlight</p>
			<p class="source-code">-rwxr-xr-x  1 root root   10304 Feb  6  2020 systemd-binfmt</p>
			<p class="source-code">-rwxr-xr-x  1 root root   10224 Feb  6  2020 systemd-cgroups-agent</p>
			<p class="source-code">-rwxr-xr-x  1 root root   26632 Feb  6  2020 systemd-cryptsetup</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p>You see that<a id="_idIndexMarker031"/> the executable for <strong class="source-inline">systemd</strong> itself is here, as well as the executables for the services that <strong class="source-inline">systemd</strong> runs as part of its own system. On some Linux distros, you'll see symbolic links in either the <strong class="source-inline">/bin</strong> or <strong class="source-inline">/usr/bin</strong> directories that point to some of the executable files here. For the most part, you won't directly interact with these files, so let's move on to something that you will interact with.</p>
			<p>The <strong class="source-inline">systemctl</strong> utility is for controlling <strong class="source-inline">systemd</strong>, and you'll use it a lot. It's a multi-purpose tool that can do a lot of things for you. It lets you view the different units and the status of the units, and either enable them or disable them. For now, we'll look at some <strong class="source-inline">systemctl</strong> commands that allow you to view different types of information. Later, we'll talk about using <strong class="source-inline">systemctl</strong> to control and edit specific units. If you'd like to follow along, fire up a VM and start getting your hands dirty.</p>
			<p>One thing to notice is that some <strong class="source-inline">systemctl</strong> commands require root privileges, and others don't. If you're just looking at system or unit information, you can do that with your normal user permissions. If you need to change a configuration, you'll need to assume the awesome powers of root. Okay—let's get started.</p>
			<p>We'll first list the active units that <strong class="source-inline">systemd</strong> currently has in memory. We'll do that with the <strong class="source-inline">systemctl list-units</strong> command. It's a very long output, so I'll just show <a id="_idIndexMarker032"/>you the first few lines here:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl list-units</p>
			<p class="source-code">UNIT                                                                                      LOAD   ACTIVE SUB        DESCRIPTION</p>
			<p class="source-code">proc-sys-fs-binfmt_misc.automount                                                         loaded active waiting   Arbitrary Executable File Formats File System Automount Point</p>
			<p class="source-code">sys-devices-pci0000:00-0000:00:17.0-ata3-host2-target2:0:0-2:0:0:0-block-sda-sda1.device  loaded active plugged   WDC_WDS250G2B0A-00SM50 1</p>
			<p class="source-code">sys-devices-pci0000:00-0000:00:17.0-ata3-host2-target2:0:0-2:0:0:0-block-sda-sda2.device  loaded active plugged   WDC_WDS250G2B0A-00SM50 2</p>
			<p class="source-code">sys-devices-pci0000:00-0000:00:17.0-ata3-host2-target2:0:0-2:0:0:0-block-sda.device       loaded active plugged   WDC_WDS250G2B0A-00SM50</p>
			<p class="source-code">sys-devices-pci0000:00-0000:00:1b.2-0000:02:00.1-sound-card1.device                       loaded active plugged   GP104 High Definition Audio Controller</p>
			<p class="source-code">sys-devices-pci0000:00-0000:00:1b.3-0000:03:00.1-sound-card2.device                       loaded active plugged   GP104 High Definition Audio Controller</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p>This is the <strong class="source-inline">automount</strong> section, which shows the various devices that have been mounted. As you can see, this covers more than just storage devices.</p>
			<p>Next, we<a id="_idIndexMarker033"/> have the mount, path, and scope units, as follows:</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p class="source-code">-.mount                                                                                   loaded active mounted   /</p>
			<p class="source-code">boot.mount                                                                                loaded active mounted   /boot</p>
			<p class="source-code">dev-hugepages.mount                                                                       loaded active mounted   Huge Pages File System</p>
			<p class="source-code">dev-mqueue.mount                                                                          loaded active mounted   POSIX Message Queue File System</p>
			<p class="source-code">home.mount                                                                                loaded active mounted   /home</p>
			<p class="source-code">run-user-1000.mount                                                                       loaded active mounted   /run/user/1000</p>
			<p class="source-code">sys-fs-fuse-connections.mount                                                             loaded active mounted   FUSE Control File System</p>
			<p class="source-code">sys-kernel-config.mount                                                                   loaded active mounted   Kernel Configuration File System</p>
			<p class="source-code">sys-kernel-debug.mount                                                                    loaded active mounted   Kernel Debug File System</p>
			<p class="source-code">tmp.mount                                                                                 loaded active mounted   Temporary Directory (/tmp)</p>
			<p class="source-code">var-lib-nfs-rpc_pipefs.mount                                                              loaded active mounted   RPC Pipe File System</p>
			<p class="source-code">cups.path                                                                                 loaded active running   CUPS Scheduler</p>
			<p class="source-code">systemd-ask-password-plymouth.path                                                        loaded active waiting   Forward Password Requests to Plymouth Directory Watch</p>
			<p class="source-code">systemd-ask-password-wall.path                                                            loaded active waiting   Forward Password Requests to Wall Directory Watch</p>
			<p class="source-code">init.scope                                                                                loaded active running   System and Service Manager</p>
			<p class="source-code">session-1.scope                                                                           loaded active abandoned Session 1 of user donnie</p>
			<p class="source-code">session-3.scope                                                                           loaded active abandoned Session 3 of user donnie</p>
			<p class="source-code">session-4.scope                                                                           loaded active running   Session 4 of user donnie</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p>Note here<a id="_idIndexMarker034"/> that there's a mount unit for each partition on your drive.</p>
			<p>Keep scrolling down, and you'll see the same kind of display for the service, slice, socket, swap, target, and timer units. At the bottom, you'll see a brief explanation of the status codes and a short summary, as follows:</p>
			<p class="source-code">LOAD   = Reflects whether the unit definition was properly loaded.</p>
			<p class="source-code">ACTIVE = The high-level unit activation state, i.e. generalization of SUB.</p>
			<p class="source-code">SUB    = The low-level unit activation state, values depend on unit type.</p>
			<p class="source-code">182 loaded units listed. Pass --all to see loaded but inactive units, too.</p>
			<p class="source-code">To show all installed unit files use 'systemctl list-unit-files'.</p>
			<p class="source-code">lines 136-190/190 (END)</p>
			<p>Use the <strong class="source-inline">--all</strong> option <a id="_idIndexMarker035"/>to also see units that are not active, like so:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl list-units --all</p>
			<p class="source-code">  UNIT                                                                                                           LOAD      ACTIVE   SUB       DESCRIPTION</p>
			<p class="source-code">● boot.automount                                                                                                 not-found inactive dead      boot.automount</p>
			<p class="source-code">  proc-sys-fs-binfmt_misc.automount                                                                              loaded    active   waiting   Arbitrary Executable File Formats File System A</p>
			<p class="source-code">  dev-block-8:2.device                                                                                           loaded    active   plugged   WDC_WDS250G2B0A-00SM50 2</p>
			<p class="source-code">  dev-disk-by\x2did-ata\x2dWDC_WDS250G2B0A\x2d00SM50_181202802064.device                                         loaded    active   plugged   WDC_WDS250G2B0A-00SM50</p>
			<p class="source-code">  dev-disk-by\x2did-ata\x2dWDC_WDS250G2B0A\x2d00SM50_181202802064\x2dpart1.device                                 loaded    active   plugged   WDC_WDS250G2B0A-00SM50 1</p>
			<p class="source-code">  dev-disk-by\x2did-ata\x2dWDC_WDS250G2B0A\x2d00SM50_181202802064\x2dpart2.device                                loaded    active   plugged   WDC_WDS250G2B0A-00SM50 2</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p>That was luck. We found an inactive unit right at the very top.</p>
			<p>You can also view specific types of units with the <strong class="source-inline">-t</strong> option. For example, to see just the<a id="_idIndexMarker036"/> service units, run the following command:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl list-units -t service</p>
			<p class="source-code">UNIT                                                                                      LOAD   ACTIVE SUB     DESCRIPTION</p>
			<p class="source-code">abrt-journal-core.service                                                                 loaded active running Creates ABRT problems from coredumpctl messages</p>
			<p class="source-code">abrt-oops.service                                                                         loaded active running ABRT kernel log watcher</p>
			<p class="source-code">abrt-xorg.service                                                                         loaded active running ABRT Xorg log watcher</p>
			<p class="source-code">abrtd.service                                                                             loaded active running ABRT Automated Bug Reporting Tool</p>
			<p class="source-code">alsa-state.service                                                                        loaded active running Manage Sound Card State (restore and store)</p>
			<p class="source-code">atd.service                                                                               loaded active running Deferred execution scheduler</p>
			<p class="source-code">auditd.service                                                                            loaded active running Security Auditing Service</p>
			<p class="source-code">avahi-daemon.service                                                                      loaded active running Avahi mDNS/DNS-SD Stack</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p>You can view the other units in the same way.</p>
			<p>Now, let's say that we just want to see the services that are dead. We can do that with<a id="_idIndexMarker037"/> the <strong class="source-inline">--state</strong> option, like so:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl list-units -t service --state=dead</p>
			<p class="source-code">  UNIT                                   LOAD      ACTIVE    SUB  DESCRIPTION</p>
			<p class="source-code">  abrt-vmcore.service                    loaded    inactive dead Harvest vmcores for ABRT</p>
			<p class="source-code">  alsa-restore.service                   loaded    inactive dead Save/Restore Sound Card State</p>
			<p class="source-code">  auth-rpcgss-module.service             loaded    inactive dead Kernel Module supporting RPCSEC_GSS</p>
			<p class="source-code">● autofs.service                         not-found inactive dead autofs.service</p>
			<p class="source-code">  blk-availability.service               loaded    inactive dead Availability of block devices</p>
			<p class="source-code">  dbxtool.service                        loaded    inactive dead Secure Boot DBX (blacklist) updater</p>
			<p class="source-code">  dm-event.service                       loaded    inactive dead Device-mapper event daemon</p>
			<p class="source-code">  dmraid-activation.service              loaded    inactive dead Activation of DM RAID sets</p>
			<p class="source-code">  dnf-makecache.service                  loaded    inactive dead dnf makecache</p>
			<p class="source-code">  dracut-cmdline.service                 loaded    inactive dead dracut cmdline hook</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p>By running <strong class="source-inline">systemctl --state=help</strong>, you'll see a list of all of the different states that you can view for the different unit types.</p>
			<p>In addition to seeing the units that are currently in memory, you can also see the unit files <a id="_idIndexMarker038"/>that are installed on the system by running the following command:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl list-unit-files</p>
			<p class="source-code">UNIT FILE                                            STATE</p>
			<p class="source-code">proc-sys-fs-binfmt_misc.automount                    static</p>
			<p class="source-code">-.mount                                              generated</p>
			<p class="source-code">boot.mount                                           generated</p>
			<p class="source-code">dev-hugepages.mount                                  static</p>
			<p class="source-code">dev-mqueue.mount                                     static</p>
			<p class="source-code">home.mount                                           generated</p>
			<p class="source-code">proc-fs-nfsd.mount                                   static</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p class="source-code">session-1.scope                                      transient</p>
			<p class="source-code">session-3.scope                                      transient</p>
			<p class="source-code">session-4.scope                                      transient</p>
			<p class="source-code">abrt-journal-core.service                            enabled</p>
			<p class="source-code">abrt-oops.service                                    enabled</p>
			<p class="source-code">abrt-pstoreoops.service                              disabled</p>
			<p class="source-code">abrt-vmcore.service                                  enabled</p>
			<p class="source-code">abrt-xorg.service                                    enabled</p>
			<p class="source-code">abrtd.service                                        enabled</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p>Here, you see<a id="_idIndexMarker039"/> some things that may seem rather strange. At the top, you see some mount files that are in a <strong class="source-inline">generated</strong> state. These files live in the <strong class="source-inline">/run/systemd/units/</strong> directory and are automatically generated by <strong class="source-inline">systemd</strong>. To create these mount files, <strong class="source-inline">systemd</strong> reads the <strong class="source-inline">/etc/fstab</strong> file every time you either boot the machine or manually reload the <strong class="source-inline">fstab</strong> file.</p>
			<p>Unit files in a <strong class="source-inline">static</strong> state are ones that you can neither enable nor disable. Rather, other units will call in these static units as dependencies.</p>
			<p>Unit files in a <strong class="source-inline">transient</strong> state deal with things that are, well, transient. Here, we see three scope units that are managing three user sessions. When a user logs out of a session, one of these units will disappear.</p>
			<p>And of course, units that are in an <strong class="source-inline">enabled</strong> state will automatically start upon booting the machine, and units that are in a <strong class="source-inline">disabled</strong> state won't.</p>
			<p>To see if just one individual unit is either enabled or active, you can use the <strong class="source-inline">is-enabled</strong> and <strong class="source-inline">is-active</strong> options with <strong class="source-inline">systemctl</strong>. A while back, I told you that the <strong class="source-inline">networkd</strong>, <strong class="source-inline">resolved</strong>, and <strong class="source-inline">timesyncd</strong> services were all disabled on my Fedora machine. Here's how to prove that:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl is-enabled systemd-timesyncd</p>
			<p class="source-code">disabled</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl is-enabled systemd-networkd</p>
			<p class="source-code">disabled</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl is-enabled systemd-resolved</p>
			<p class="source-code">disabled</p>
			<p class="source-code">[donnie@localhost ~]$</p>
			<p>And here's<a id="_idIndexMarker040"/> how to prove that they're not active:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl is-active systemd-timesyncd</p>
			<p class="source-code">inactive</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl is-active systemd-resolved</p>
			<p class="source-code">inactive</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl is-active systemd-timesyncd</p>
			<p class="source-code">inactive</p>
			<p class="source-code">[donnie@localhost ~]$</p>
			<p>On the other hand, the <strong class="source-inline">NetworkManager</strong> service is enabled and active on my Fedora machine, as you can see here:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl is-enabled NetworkManager</p>
			<p class="source-code">enabled</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl is-active NetworkManager</p>
			<p class="source-code">active</p>
			<p class="source-code">[donnie@localhost ~]$</p>
			<p>Now, I'll leave it to you to verify all of this on the Ubuntu machine.</p>
			<p>You can also see information about just one <em class="italic">type</em> of unit file. Here, we'll just look at information about the swap unit files:</p>
			<p class="source-code">[donnie@localhost units]$ systemctl list-unit-files -t swap</p>
			<p class="source-code">UNIT FILE                                            STATE</p>
			<p class="source-code">dev-mapper-fedora_localhost\x2d\x2dlive\x2dswap.swap generated</p>
			<p class="source-code">1 unit files listed.</p>
			<p class="source-code">[donnie@localhost units]$</p>
			<p>Just as it did with the mount unit files, <strong class="source-inline">systemd</strong> generated this file by reading the <strong class="source-inline">/etc/fstab</strong> file.</p>
			<p>Earlier, I showed you the <strong class="source-inline">/etc/systemd/system.conf</strong> file, which sets the global configuration for <strong class="source-inline">systemd</strong>. With the <strong class="source-inline">show</strong> option, you can see the actual running configuration <a id="_idIndexMarker041"/>by doing <strong class="source-inline">systemctl show</strong>. Here's the partial output:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl show</p>
			<p class="source-code">Version=v243.8-1.fc31</p>
			<p class="source-code">Features=+PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUTILS +KMOD +IDN2 -IDN +PCRE2 default-hierarchy=unified</p>
			<p class="source-code">Architecture=x86-64</p>
			<p class="source-code">Tainted=local-hwclock</p>
			<p class="source-code">FirmwareTimestampMonotonic=0</p>
			<p class="source-code">LoaderTimestampMonotonic=0</p>
			<p class="source-code">KernelTimestamp=Thu 2021-03-11 11:58:01 EST</p>
			<p class="source-code">KernelTimestampMonotonic=0</p>
			<p class="source-code">. . .</p>
			<p class="source-code">. . .</p>
			<p class="source-code">DefaultLimitRTPRIOSoft=0</p>
			<p class="source-code">DefaultLimitRTTIME=infinity</p>
			<p class="source-code">DefaultLimitRTTIMESoft=infinity</p>
			<p class="source-code">DefaultTasksMax=4608</p>
			<p class="source-code">TimerSlackNSec=50000</p>
			<p class="source-code">DefaultOOMPolicy=stop</p>
			<p>Use the <strong class="source-inline">--property=</strong> option to view just one item, like so:</p>
			<p class="source-code">[donnie@localhost ~]$ systemctl show --property=DefaultLimitSIGPENDING</p>
			<p class="source-code">DefaultLimitSIGPENDING=15362</p>
			<p class="source-code">[donnie@localhost ~]$</p>
			<p>There is a<a id="_idIndexMarker042"/> man page for <strong class="source-inline">systemctl</strong>, and you're welcome to peruse it. But if you just need a quick reference, run <strong class="source-inline">systemctl -h</strong>.</p>
			<p>All right—I think that's enough for now. So, let's wrap this chapter up and put a bow on it, shall we?</p>
			<h1 id="_idParaDest-36"><a id="_idTextAnchor035"/>Summary</h1>
			<p>Okay—we've hit the ground running and have covered quite a few concepts. We covered the various types of configuration files and unit files and saw where they live. We ended by using the <strong class="source-inline">systemctl</strong> command to view information about our running system.</p>
			<p>In the next chapter, we'll expand on this by showing you the inner workings of the service, path, and socket unit files. I'll see you there.</p>
			<h1 id="_idParaDest-37"><a id="_idTextAnchor036"/>Questions</h1>
			<ol>
				<li>Which of the following commands tells you what the running <strong class="source-inline">systemd</strong> configuration is?<p>a. <strong class="source-inline">systemctl list</strong></p><p>b. <strong class="source-inline">systemctl show</strong></p><p>c. <strong class="source-inline">systemd show</strong></p><p>d. <strong class="source-inline">systemd list</strong></p></li>
				<li>Which of the following statements is true?<p>a. To configure your drive partitions, you need to hand-configure the mount units.</p><p>b. The mount units for your drive partitions get generated automatically when <strong class="source-inline">systemd</strong> reads the <strong class="source-inline">fstab</strong> file.</p><p>c. The mount units for your drive partitions are static units.</p><p>d. No mount units are needed for your drive partitions.</p></li>
				<li>Which of the following will tell you if the <strong class="source-inline">NetworkManager</strong> service is running?<p>a. <strong class="source-inline">systemctl active NetworkManager</strong></p><p>b. <strong class="source-inline">systemd active NetworkManager</strong></p><p>c. <strong class="source-inline">systemd enabled NetworkManager</strong></p><p>d. <strong class="source-inline">systemctl is-enabled NetworkManager</strong></p><p>e. <strong class="source-inline">systemctl is-active NetworkManager</strong></p></li>
			</ol>
			<h1 id="_idParaDest-38"><a id="_idTextAnchor037"/>Answers</h1>
			<ol>
				<li value="1">a</li>
				<li>b</li>
				<li>c</li>
			</ol>
			<h1 id="_idParaDest-39"><a id="_idTextAnchor038"/>Further reading</h1>
			<p><strong class="source-inline">systemd</strong> units and unit files:</p>
			<p><a href="https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files">https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files</a></p>
		</div>
	</body></html>