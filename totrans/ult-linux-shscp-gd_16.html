<html><head></head><body>
  <div id="_idContainer225" class="Basic-Text-Frame">
    <h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">16</span></h1>
    <h1 id="_idParaDest-332" class="chapterTitle"><span class="koboSpan" id="kobo.2.1">Creating User Interfaces with yad, dialog, and xdialog</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.3.1">I know, you’re thinking that shell scripting consists of nothing but entering boring, plain-text commands in a terminal. </span><span class="koboSpan" id="kobo.3.2">But, what if I told you that you can fancy up your scripts by adding a user interface? </span><span class="koboSpan" id="kobo.3.3">What if I told you that you can have a graphical interface for desktop systems or a non-graphical interface for text-mode servers? </span><span class="koboSpan" id="kobo.3.4">Well, you can, and I’m here to show you how.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.4.1">Topics in this chapter include:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.5.1">Creating a graphical user interface with </span><code class="inlineCode"><span class="koboSpan" id="kobo.6.1">yad</span></code></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.7.1">Creating user interfaces with </span><code class="inlineCode"><span class="koboSpan" id="kobo.8.1">dialog</span></code><span class="koboSpan" id="kobo.9.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.10.1">xdialog</span></code></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.11.1">If you’re ready, let’s get started.</span></p>
    <h1 id="_idParaDest-333" class="heading 1"><span class="koboSpan" id="kobo.12.1">Technical Requirements</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.13.1">For </span><code class="inlineCode"><span class="koboSpan" id="kobo.14.1">yad</span></code><span class="koboSpan" id="kobo.15.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.16.1">xdialog</span></code><span class="koboSpan" id="kobo.17.1">, you’ll need to use a desktop implementation of Linux. </span><span class="koboSpan" id="kobo.17.2">It doesn’t much matter which distro you use, as long as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.18.1">yad</span></code><span class="koboSpan" id="kobo.19.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.20.1">xdialog</span></code><span class="koboSpan" id="kobo.21.1"> packages are in the repository. </span><span class="koboSpan" id="kobo.21.2">Just use your distro’s normal package management tool to install them. </span><span class="koboSpan" id="kobo.21.3">(The </span><code class="inlineCode"><span class="koboSpan" id="kobo.22.1">yad</span></code><span class="koboSpan" id="kobo.23.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.24.1">xdialog</span></code><span class="koboSpan" id="kobo.25.1"> packages are also available for GhostBSD, which is FreeBSD with either the Mate or Xfce desktop environment. </span><span class="koboSpan" id="kobo.25.2">If you’re on a Mac, you’ll need to install </span><code class="inlineCode"><span class="koboSpan" id="kobo.26.1">yad</span></code><span class="koboSpan" id="kobo.27.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.28.1">xdialog</span></code><span class="koboSpan" id="kobo.29.1"> via Homebrew. </span><span class="koboSpan" id="kobo.29.2">Alas, neither one is available for OpenIndiana, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.30.1">yad</span></code><span class="koboSpan" id="kobo.31.1"> isn’t available for any of the RHEL 9-type distros.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.32.1">For the </span><code class="inlineCode"><span class="koboSpan" id="kobo.33.1">dialog </span></code><span class="koboSpan" id="kobo.34.1">section, you can use either a desktop or a text-mode server implementation of Linux.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.35.1">And, as always, you can grab the scripts by running:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.36.1">git clone https://github.com/PacktPublishing/The-Ultimate-Linux-Shell-Scripting-Guide.git
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.37.1">Okay, let’s begin by looking at </span><code class="inlineCode"><span class="koboSpan" id="kobo.38.1">yad</span></code><span class="koboSpan" id="kobo.39.1">.</span></p>
    <h1 id="_idParaDest-334" class="heading 1"><span class="koboSpan" id="kobo.40.1">Creating a Graphical User Interface with yad</span></h1>
    <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.41.1">Yet Another Dialog</span></strong><span class="koboSpan" id="kobo.42.1">, or </span><strong class="keyWord"><span class="koboSpan" id="kobo.43.1">yad</span></strong><span class="koboSpan" id="kobo.44.1"> for</span><a id="_idIndexMarker988"/><span class="koboSpan" id="kobo.45.1"> short, is a very cool program</span><a id="_idIndexMarker989"/><span class="koboSpan" id="kobo.46.1"> that allows you to add GUI-type interfaces to your shell scripts. </span><span class="koboSpan" id="kobo.46.2">There’s a lot you can do with it, and I’d like to show you a few simple examples.</span></p>
    <h2 id="_idParaDest-335" class="heading 2"><span class="koboSpan" id="kobo.47.1">The yad Basics</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.48.1">In </span><a id="_idIndexMarker990"/><span class="koboSpan" id="kobo.49.1">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.50.1">yad</span></code><span class="koboSpan" id="kobo.51.1"> man page, you’ll see a list of pre-defined components that you </span><a id="_idIndexMarker991"/><span class="koboSpan" id="kobo.52.1">can use in your </span><code class="inlineCode"><span class="koboSpan" id="kobo.53.1">yad</span></code><span class="koboSpan" id="kobo.54.1"> scripts. </span><span class="koboSpan" id="kobo.54.2">For example, if you do </span><code class="inlineCode"><span class="koboSpan" id="kobo.55.1">yad --file</span></code><span class="koboSpan" id="kobo.56.1">, you’ll open the file manager that looks like this:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.57.1"><img src="../Images/B21693_16_01.png" alt="B21693_16_1"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.58.1">Figure 16.1: The yad file manager</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.59.1">As it is, this </span><a id="_idIndexMarker992"/><span class="koboSpan" id="kobo.60.1">file </span><a id="_idIndexMarker993"/><span class="koboSpan" id="kobo.61.1">manager won’t do anything for you. </span><span class="koboSpan" id="kobo.61.2">If you click on a file and then click the </span><strong class="screenText"><span class="koboSpan" id="kobo.62.1">OK</span></strong><span class="koboSpan" id="kobo.63.1"> button, the manager will close and the name of the file that you chose will print out on the command line, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.64.1">donnie@fedora:~$ yad --file
/home/donnie/win_bentley.pdf
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.65.1">To make this useful, you’ll need to add code that will perform some desired action upon the chosen file. </span><span class="koboSpan" id="kobo.65.2">Before we attempt something this complex though, let’s begin with something that’s a bit more simple.</span></p>
    <h2 id="_idParaDest-336" class="heading 2"><span class="koboSpan" id="kobo.66.1">Creating Data Entry Forms</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.67.1">Let’s say that </span><a id="_idIndexMarker994"/><span class="koboSpan" id="kobo.68.1">you’re a collector of classic automobiles, and you need to create a simple database to keep track of your vast collection. </span><span class="koboSpan" id="kobo.68.2">We’ll begin by testing the basic script, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.69.1">#!/bin/bash
yad --title="Classic Autos" --text="Enter the info about your classic auto:" --form --width=400 --field="Year":NUM --field="Make" --field="Model" --field="Body Style" &gt;&gt; classic_autos.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.70.1">That’s a</span><a id="_idIndexMarker995"/><span class="koboSpan" id="kobo.71.1"> bit hard to read, though. </span><span class="koboSpan" id="kobo.71.2">So, let’s make the </span><code class="inlineCode"><span class="koboSpan" id="kobo.72.1">yad-form-auto1.sh</span></code><span class="koboSpan" id="kobo.73.1"> script a bit more readable, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.74.1">#!/bin/bash
yad --title="Classic Autos" --text="Enter the info about your classic auto:" \
        --form --width=400 \
        --field="Year":NUM \
        --field="Make" \
        --field="Model" \
        --field="Body Style" &gt;&gt; classic_autos.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.75.1">This </span><code class="inlineCode"><span class="koboSpan" id="kobo.76.1">yad</span></code><span class="koboSpan" id="kobo.77.1"> command is actually one long command. </span><span class="koboSpan" id="kobo.77.2">To make it more readable, I’ve broken it up over several lines, by adding a backslash after each option definition. </span><span class="koboSpan" id="kobo.77.3">You could leave out the backslashes and just place the entire command on one line, as you saw above, but this looks much better.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.78.1">On the first line, I’ve placed both the </span><code class="inlineCode"><span class="koboSpan" id="kobo.79.1">--title</span></code><span class="koboSpan" id="kobo.80.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.81.1">--text</span></code><span class="koboSpan" id="kobo.82.1"> definitions, which should be self-explanatory. </span><span class="koboSpan" id="kobo.82.2">The second line defines a form with a width of 400 pixels. </span><span class="koboSpan" id="kobo.82.3">Following that are the definitions for the data entry fields. </span><span class="koboSpan" id="kobo.82.4">Note that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.83.1">Year</span></code><span class="koboSpan" id="kobo.84.1"> field can only accept a numerical value, as indicated by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.85.1">:NUM</span></code><span class="koboSpan" id="kobo.86.1"> parameter. </span><span class="koboSpan" id="kobo.86.2">At the end, I’m redirecting the output into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.87.1">classic_autos.txt</span></code><span class="koboSpan" id="kobo.88.1"> file. </span><span class="koboSpan" id="kobo.88.2">(I’m using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.89.1">&gt;&gt;</span></code><span class="koboSpan" id="kobo.90.1"> operator so that I can add more than one auto to the file.) Here’s how it looks when I run the script:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.91.1"><img src="../Images/B21693_16_02.png" alt="B21693_16_2"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.92.1">Figure 16.2: Running yad-form-auto1.sh</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.93.1">When I hit</span><a id="_idIndexMarker996"/><span class="koboSpan" id="kobo.94.1"> the </span><strong class="screenText"><span class="koboSpan" id="kobo.95.1">OK</span></strong><span class="koboSpan" id="kobo.96.1"> button, the output will be saved to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.97.1">classic_autos.txt</span></code><span class="koboSpan" id="kobo.98.1"> file, which will look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.99.1">donnie@fedora:~$ cat classic_autos.txt
1958|Edsel|Corsair|2 door hardtop|
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.100.1">By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.101.1">yad</span></code><span class="koboSpan" id="kobo.102.1"> uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.103.1">|</span></code><span class="koboSpan" id="kobo.104.1"> symbol as the output field separator. </span><span class="koboSpan" id="kobo.104.2">That’s okay, because if you open this file in a spreadsheet program, you can set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.105.1">|</span></code><span class="koboSpan" id="kobo.106.1"> symbol as the field separator, and it will work just fine. </span><span class="koboSpan" id="kobo.106.2">But, you can change the field separator if you like. </span><span class="koboSpan" id="kobo.106.3">For example, if you want to create </span><code class="inlineCode"><span class="koboSpan" id="kobo.107.1">.csv</span></code><span class="koboSpan" id="kobo.108.1"> files, just add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.109.1">--separator=","</span></code><span class="koboSpan" id="kobo.110.1"> parameter to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.111.1">--form</span></code><span class="koboSpan" id="kobo.112.1"> line.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.113.1">One slight problem with this script is that every time you hit the </span><strong class="screenText"><span class="koboSpan" id="kobo.114.1">OK</span></strong><span class="koboSpan" id="kobo.115.1"> button to create an entry in your text file, the script will exit. </span><span class="koboSpan" id="kobo.115.2">Each time you add an auto, you’ll need to invoke the script again. </span><span class="koboSpan" id="kobo.115.3">Let’s fix that with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.116.1">while</span></code><span class="koboSpan" id="kobo.117.1"> loop, as you see here in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.118.1">yad-form-auto2.sh</span></code><span class="koboSpan" id="kobo.119.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.120.1">#!/bin/bash
while :
do
yad --title="Classic Autos" --text="Enter the info about your classic auto:" \
        --form --width=400 \
        --field="Year":NUM \
        --field="Make" \
        --field="Model" \
        --field="Body Style" \
        --field="Date Acquired":DT &gt;&gt; classic_autos.txt
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.121.1">By using a </span><code class="inlineCode"><span class="koboSpan" id="kobo.122.1">:</span></code><span class="koboSpan" id="kobo.123.1"> as the </span><a id="_idIndexMarker997"/><span class="koboSpan" id="kobo.124.1">while condition, we’re creating what’s known as an infinite loop. </span><span class="koboSpan" id="kobo.124.2">In other words, this will never quit until you press </span><strong class="screenText"><span class="koboSpan" id="kobo.125.1">Ctrl-c</span></strong><span class="koboSpan" id="kobo.126.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.127.1">While I was at it, I added the </span><code class="inlineCode"><span class="koboSpan" id="kobo.128.1">Date Acquired</span></code><span class="koboSpan" id="kobo.129.1"> field with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.130.1">:DT</span></code><span class="koboSpan" id="kobo.131.1"> option. </span><span class="koboSpan" id="kobo.131.2">This option causes a handy-dandy calendar to pop up whenever I click on the calendar icon. </span><span class="koboSpan" id="kobo.131.3">Here’s how it looks:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.132.1"><img src="../Images/B21693_16_03.png" alt="B21693_16_3"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.133.1">Figure 16.3: The yad-form-auto2.sh script</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.134.1">This is good, but it’s</span><a id="_idIndexMarker998"/><span class="koboSpan" id="kobo.135.1"> still not perfect. </span><span class="koboSpan" id="kobo.135.2">Due to using a </span><code class="inlineCode"><span class="koboSpan" id="kobo.136.1">:</span></code><span class="koboSpan" id="kobo.137.1"> for the while condition, the only way to end this script is to </span><strong class="screenText"><span class="koboSpan" id="kobo.138.1">Ctrl-c</span></strong><span class="koboSpan" id="kobo.139.1"> out of it, because the </span><strong class="screenText"><span class="koboSpan" id="kobo.140.1">Cancel</span></strong><span class="koboSpan" id="kobo.141.1"> button won’t do anything. </span><span class="koboSpan" id="kobo.141.2">To fix that, you need to understand that the </span><strong class="screenText"><span class="koboSpan" id="kobo.142.1">OK</span></strong><span class="koboSpan" id="kobo.143.1"> button returns a 0 as the exit code, and the </span><strong class="screenText"><span class="koboSpan" id="kobo.144.1">Cancel</span></strong><span class="koboSpan" id="kobo.145.1"> button returns a 1 as the exit code.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.146.1">If you need to review the concept of exit codes, refer back to </span><em class="chapterRef"><span class="koboSpan" id="kobo.147.1">Chapter 8, Basic Shell Script Construction</span></em><span class="koboSpan" id="kobo.148.1">.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.149.1">So, let’s modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.150.1">while</span></code><span class="koboSpan" id="kobo.151.1"> loop in this </span><code class="inlineCode"><span class="koboSpan" id="kobo.152.1">yad-form-auto3.sh</span></code><span class="koboSpan" id="kobo.153.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.154.1">#!/bin/bash
while [ $? </span><span class="koboSpan" id="kobo.154.2">== 0 ]
do
yad --title="Classic Autos" --text="Enter the info about your classic auto:" \
        --form --width=400 \
        --field="Year":NUM \
        --field="Make" \
        --field="Model" \
        --field="Body Style" \
        --field="Date Acquired":DT &gt;&gt; classic_autos.txt
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.155.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.156.1">$? </span><span class="koboSpan" id="kobo.156.2">== 0</span></code><span class="koboSpan" id="kobo.157.1"> parameter</span><a id="_idIndexMarker999"/><span class="koboSpan" id="kobo.158.1"> retrieves the exit code and verifies that it’s 0. </span><span class="koboSpan" id="kobo.158.2">This keeps the script running as long as you don’t click on either the </span><strong class="screenText"><span class="koboSpan" id="kobo.159.1">Cancel</span></strong><span class="koboSpan" id="kobo.160.1"> button or the </span><strong class="screenText"><span class="koboSpan" id="kobo.161.1">X</span></strong><span class="koboSpan" id="kobo.162.1"> at the top corner of the window. </span><span class="koboSpan" id="kobo.162.2">(I forgot to mention that hitting the </span><strong class="screenText"><span class="koboSpan" id="kobo.163.1">X</span></strong><span class="koboSpan" id="kobo.164.1"> returns an exit code of 252.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.165.1">Now, let’s wrap this section up with one last modification.</span></p>
    <h2 id="_idParaDest-337" class="heading 2"><span class="koboSpan" id="kobo.166.1">Creating a Drop-down List</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.167.1">This</span><a id="_idIndexMarker1000"/><span class="koboSpan" id="kobo.168.1"> time, we’ll add a drop-down list for choosing the body style, and a free-form text box. </span><span class="koboSpan" id="kobo.168.2">Here’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.169.1">yad-form-auto4.sh</span></code><span class="koboSpan" id="kobo.170.1"> script to show you how it’s done:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.171.1">#!/bin/bash
bodystyles=$(echo "2 door hardtop,2 door sedan,4 door hardtop,4 door sedan,station wagon,convertible,pickup truck,other")
while [ $? </span><span class="koboSpan" id="kobo.171.2">== 0 ]
do
yad --title="Classic Autos" --text="Enter the info about your classic auto:" \
        --form --width=400 --item-separator="," \
        --field="Year":NUM \
        --field="Make" \
        --field="Model" \
        --field="Body Style":CBE \
        --field="Date Acquired":DT &gt;&gt; classic_autos.txt \
        --field="Add any additional notes:":TXT \
        "" "" "" "$bodystyles" "Click on the calender icon"
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.172.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.173.1">bodystyles=</span></code><span class="koboSpan" id="kobo.174.1"> line, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.175.1">--item-separator</span></code><span class="koboSpan" id="kobo.176.1"> parameter in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.177.1">--form</span></code><span class="koboSpan" id="kobo.178.1"> line, and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.179.1">"" "" ""</span></code><span class="koboSpan" id="kobo.180.1"> line all work together to create the drop-down list. </span><span class="koboSpan" id="kobo.180.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.181.1">bodystyles=</span></code><span class="koboSpan" id="kobo.182.1"> defines the list of available body styles, separated by commas. </span><span class="koboSpan" id="kobo.182.2">This goes along with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.183.1">--item-separator</span></code><span class="koboSpan" id="kobo.184.1"> parameter, which ensures that the drop-down list appears with only one </span><a id="_idIndexMarker1001"/><span class="koboSpan" id="kobo.185.1">body style per line, instead of having all body styles on one line.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.186.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.187.1">:CBE</span></code><span class="koboSpan" id="kobo.188.1"> parameter at the end of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.189.1">--field="Body Style"</span></code><span class="koboSpan" id="kobo.190.1"> line defines this field as a drop-down list with the option to edit it if you choose the </span><strong class="screenText"><span class="koboSpan" id="kobo.191.1">other</span></strong><span class="koboSpan" id="kobo.192.1"> option. </span><span class="koboSpan" id="kobo.192.2">The last line in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.193.1">while</span></code><span class="koboSpan" id="kobo.194.1"> loop tells </span><code class="inlineCode"><span class="koboSpan" id="kobo.195.1">yad</span></code><span class="koboSpan" id="kobo.196.1"> where to place the values of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.197.1">bodystyles</span></code><span class="koboSpan" id="kobo.198.1"> variable. </span><span class="koboSpan" id="kobo.198.2">We see that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.199.1">Body Style</span></code><span class="koboSpan" id="kobo.200.1"> field is the fourth field. </span><span class="koboSpan" id="kobo.200.2">So to represent the first three fields, which are blank by default, we place three pairs of double quotes ahead of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.201.1">$bodystyles</span></code><span class="koboSpan" id="kobo.202.1"> variable. </span><span class="koboSpan" id="kobo.202.2">The last item on the line places a line of text in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.203.1">Date Acquired</span></code><span class="koboSpan" id="kobo.204.1"> field. </span><span class="koboSpan" id="kobo.204.2">The final field definition is the free-form text box, as you see by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.205.1">:TXT</span></code><span class="koboSpan" id="kobo.206.1"> parameter. </span><span class="koboSpan" id="kobo.206.2">(The text box field comes after the drop-down list field, which means that you don’t have to add another pair of double-quotes to be a placeholder.) Here’s how it looks when I choose a body style:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.207.1"><img src="../Images/B21693_16_04.png" alt="B21693_16_4"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.208.1">Figure 16.4: Using a drop-down list</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.209.1">Of course, you</span><a id="_idIndexMarker1002"/><span class="koboSpan" id="kobo.210.1"> can adapt this script for pretty much any purpose. </span><span class="koboSpan" id="kobo.210.2">That can include keeping inventories of your own personal collections, store merchandise, or software licenses. </span><span class="koboSpan" id="kobo.210.3">(Let your imagination run wild.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.211.1">That wraps it up for this demo. </span><span class="koboSpan" id="kobo.211.2">Now, let’s manage some files.</span></p>
    <h2 id="_idParaDest-338" class="heading 2"><span class="koboSpan" id="kobo.212.1">Using the yad File Manager</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.213.1">The </span><a id="_idIndexMarker1003"/><span class="koboSpan" id="kobo.214.1">easiest way to work with files is to create a variable, with its value assigned by a </span><code class="inlineCode"><span class="koboSpan" id="kobo.215.1">yad</span></code><span class="koboSpan" id="kobo.216.1"> command substitution construct. </span><span class="koboSpan" id="kobo.216.2">Then, you can do whatever you want with the value of the variable. </span><span class="koboSpan" id="kobo.216.3">Let’s see what we can do with that.</span></p>
    <h3 id="_idParaDest-339" class="heading 3"><span class="koboSpan" id="kobo.217.1">Creating a File Checksum Utility</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.218.1">For the first example, let’s say </span><a id="_idIndexMarker1004"/><span class="koboSpan" id="kobo.219.1">that you want to create a list of files with their </span><code class="inlineCode"><span class="koboSpan" id="kobo.220.1">sha512</span></code><span class="koboSpan" id="kobo.221.1"> checksums. </span><span class="koboSpan" id="kobo.221.2">Here’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.222.1">yad-file-checksum1.sh</span></code><span class="koboSpan" id="kobo.223.1"> script that does just that:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.224.1">#!/bin/bash
filetocheck=$(yad --file)
sha512sum $filetocheck &gt;&gt; file_checksums.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.225.1">Clicking on a file assigns the name of that file to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.226.1">filetocheck</span></code><span class="koboSpan" id="kobo.227.1"> variable. </span><span class="koboSpan" id="kobo.227.2">We can then use the value of that variable as the argument for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.228.1">sha512sum</span></code><span class="koboSpan" id="kobo.229.1"> command.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.230.1">Here’s how it looks:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.231.1"><img src="../Images/B21693_16_05.png" alt="B21693_16_5"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.232.1">Figure 16.5: Opening a file with yad-file-checksum1.sh script</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.233.1">Clicking the </span><strong class="screenText"><span class="koboSpan" id="kobo.234.1">OK</span></strong><span class="koboSpan" id="kobo.235.1"> button creates the </span><code class="inlineCode"><span class="koboSpan" id="kobo.236.1">file_checksum.txt</span></code><span class="koboSpan" id="kobo.237.1"> file, which contains the SHA512 checksum of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.238.1">people.txt</span></code><span class="koboSpan" id="kobo.239.1"> file, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.240.1">donnie@fedora:~$ cat file_checksums.txt
0aa501cc947b22c48c8b2bca0e2a9675fad58440133af8794d8e2b51160f72fa6851c6d76a8554 6938c23ff5bf70b841bd1099ca727b39a59f486348d3dcee50  /home/donnie/people.txt
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.241.1">That’s great, but</span><a id="_idIndexMarker1005"/><span class="koboSpan" id="kobo.242.1"> as always, we can fancy things up a bit. </span><span class="koboSpan" id="kobo.242.2">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.243.1">yad-file-checksum2.sh</span></code><span class="koboSpan" id="kobo.244.1"> script, we’ll add a </span><code class="inlineCode"><span class="koboSpan" id="kobo.245.1">while</span></code><span class="koboSpan" id="kobo.246.1"> loop so that the </span><strong class="screenText"><span class="koboSpan" id="kobo.247.1">Cancel</span></strong><span class="koboSpan" id="kobo.248.1"> button will work, and also add the ability to choose multiple files. </span><span class="koboSpan" id="kobo.248.2">And, while we’re at it, let’s add a file preview feature. </span><span class="koboSpan" id="kobo.248.3">Here’s how that looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.249.1">#!/bin/bash
while [ $? </span><span class="koboSpan" id="kobo.249.2">== 0 ]
do
        filetocheck=$(yad --file --multiple --separator='\n' --add-preview --width=800)
        sha512sum $filetocheck &gt;&gt; file_checksums.txt
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.250.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.251.1">--multiple</span></code><span class="koboSpan" id="kobo.252.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.253.1">--separator='\n'</span></code><span class="koboSpan" id="kobo.254.1"> options work together. </span><span class="koboSpan" id="kobo.254.2">Without the </span><code class="inlineCode"><span class="koboSpan" id="kobo.255.1">--separator</span></code><span class="koboSpan" id="kobo.256.1"> option, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.257.1">--multiple</span></code><span class="koboSpan" id="kobo.258.1"> option will cause all filenames to appear as one long line, with filenames separated by a </span><code class="inlineCode"><span class="koboSpan" id="kobo.259.1">|</span></code><span class="koboSpan" id="kobo.260.1"> symbol. </span><span class="koboSpan" id="kobo.260.2">This will cause the </span><code class="inlineCode"><span class="koboSpan" id="kobo.261.1">sha512sum</span></code><span class="koboSpan" id="kobo.262.1"> utility to view that line as a single filename, which will cause an error. </span><span class="koboSpan" id="kobo.262.2">Placing a new line after each filename solves the problem. </span><span class="koboSpan" id="kobo.262.3">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.263.1">--add-preview</span></code><span class="koboSpan" id="kobo.264.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.265.1">--width</span></code><span class="koboSpan" id="kobo.266.1"> options should be self-explanatory, so I won’t comment about them. </span><span class="koboSpan" id="kobo.266.2">At any rate, here’s how the new script works:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.267.1"><img src="../Images/B21693_16_06.png" alt="B21693_16_6"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.268.1">Figure 16.6: The file selector with the preview and multiple file options</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.269.1">You can </span><a id="_idIndexMarker1006"/><span class="koboSpan" id="kobo.270.1">select multiple non-consecutive files by holding down the </span><strong class="screenText"><span class="koboSpan" id="kobo.271.1">Ctrl</span></strong><span class="koboSpan" id="kobo.272.1"> key, or multiple consecutive files by holding down the </span><strong class="screenText"><span class="koboSpan" id="kobo.273.1">Shift</span></strong><span class="koboSpan" id="kobo.274.1"> key. </span><span class="koboSpan" id="kobo.274.2">The end result will be a text file that contains the SHA512 sum checks of all the selected files.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.275.1">I have to confess that there’s something weird going on with this script, and that it has me stumped. </span><span class="koboSpan" id="kobo.275.2">When you click on either the </span><strong class="screenText"><span class="koboSpan" id="kobo.276.1">Cancel</span></strong><span class="koboSpan" id="kobo.277.1"> button or the </span><strong class="screenText"><span class="koboSpan" id="kobo.278.1">X</span></strong><span class="koboSpan" id="kobo.279.1"> button, the dialog box will close down as it’s supposed to do. </span><span class="koboSpan" id="kobo.279.2">But, for some strange reason the process doesn’t end, which means that the terminal never returns to the command-prompt. </span><span class="koboSpan" id="kobo.279.3">I’ve tried performing every unnatural act I could think of to fix that, but to no avail. </span><span class="koboSpan" id="kobo.279.4">So, it appears that whenever you run this script, you’ll just have to </span><strong class="screenText"><span class="koboSpan" id="kobo.280.1">Ctrl-c</span></strong><span class="koboSpan" id="kobo.281.1"> out of it when you’re done.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.282.1">All right, let’s move on to the next example.</span></p>
    <h3 id="_idParaDest-340" class="heading 3"><span class="koboSpan" id="kobo.283.1">Creating a GUI Front-end for ImageMagick</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.284.1">Next, let’s see </span><a id="_idIndexMarker1007"/><span class="koboSpan" id="kobo.285.1">if we can create a GUI front-end for the ImageMagick program that we talked about back in </span><em class="chapterRef"><span class="koboSpan" id="kobo.286.1">Chapter 13, Scripting with ImageMagick</span></em><span class="koboSpan" id="kobo.287.1">. </span><span class="koboSpan" id="kobo.287.2">We’ll begin with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.288.1">yad-image-resize1.sh</span></code><span class="koboSpan" id="kobo.289.1"> script, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.290.1">#!/bin/bash
imageFile=$(yad --file --title="Select the image file" --width=800)
dialog=$(yad --title "Image Resize" --form --field="Resize parameter" --field="Quality")
size=$(echo $dialog | awk 'BEGIN {FS="|" } { print $1 }')
quality=$(echo $dialog | awk 'BEGIN {FS="|" } { print $2 }')
convert "$imageFile" -resize "$size" -quality "$quality"% "$imageFile"
yad --title="Status" --width=300  --button="OK:0"  --text="All done. </span><span class="koboSpan" id="kobo.290.2">Yay!"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.291.1">The first line creates the initial file selection window. </span><span class="koboSpan" id="kobo.291.2">It then assigns the filename of the selected file to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.292.1">imageFile</span></code><span class="koboSpan" id="kobo.293.1"> variable. </span><span class="koboSpan" id="kobo.293.2">Here’s how this initial window looks:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.294.1"><img src="../Images/B21693_16_07.png" alt="B21693_16_7"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.295.1">Figure 16.7: The initial file selection window for resizing images</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.296.1">The </span><a id="_idIndexMarker1008"/><span class="koboSpan" id="kobo.297.1">second line creates the </span><strong class="screenText"><span class="koboSpan" id="kobo.298.1">Image Resize</span></strong><span class="koboSpan" id="kobo.299.1"> window that you’ll use for entering the resize and quality parameters. </span><span class="koboSpan" id="kobo.299.2">When you enter your desired parameters, they’ll get stored in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.300.1">dialog</span></code><span class="koboSpan" id="kobo.301.1"> variable as a single line, with the two parameters separated by a </span><code class="inlineCode"><span class="koboSpan" id="kobo.302.1">|</span></code><span class="koboSpan" id="kobo.303.1"> symbol.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.304.1">The next two lines create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.305.1">size</span></code><span class="koboSpan" id="kobo.306.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.307.1">quality</span></code><span class="koboSpan" id="kobo.308.1"> variables, using the values that are stored in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.309.1">dialog</span></code><span class="koboSpan" id="kobo.310.1"> variable. </span><span class="koboSpan" id="kobo.310.2">We need a way to extract each individual parameter, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.311.1">awk</span></code><span class="koboSpan" id="kobo.312.1"> gives us a handy way to do it. </span><span class="koboSpan" id="kobo.312.2">Anyway, here’s how the </span><strong class="screenText"><span class="koboSpan" id="kobo.313.1">Image Resize</span></strong><span class="koboSpan" id="kobo.314.1"> window looks:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.315.1"><img src="../Images/B21693_16_08.png" alt="B21693_16_8"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.316.1">Figure 16.8: the Image Resize window</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.317.1">Next comes the </span><code class="inlineCode"><span class="koboSpan" id="kobo.318.1">convert</span></code><span class="koboSpan" id="kobo.319.1"> line, which performs the actual resizing. </span><span class="koboSpan" id="kobo.319.2">You see that it’s using values from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.320.1">size</span></code><span class="koboSpan" id="kobo.321.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.322.1">quality</span></code><span class="koboSpan" id="kobo.323.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.324.1">imageFile</span></code><span class="koboSpan" id="kobo.325.1"> variables. </span><span class="koboSpan" id="kobo.325.2">When I click on the </span><strong class="screenText"><span class="koboSpan" id="kobo.326.1">OK</span></strong><span class="koboSpan" id="kobo.327.1"> button, the resizing process will take place.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.328.1">The final line creates the </span><strong class="screenText"><span class="koboSpan" id="kobo.329.1">Status</span></strong><span class="koboSpan" id="kobo.330.1"> window, which shows that the process is complete. </span><span class="koboSpan" id="kobo.330.2">By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.331.1">yad</span></code><span class="koboSpan" id="kobo.332.1"> windows have both a </span><strong class="screenText"><span class="koboSpan" id="kobo.333.1">Cancel</span></strong><span class="koboSpan" id="kobo.334.1"> and an </span><strong class="screenText"><span class="koboSpan" id="kobo.335.1">OK</span></strong><span class="koboSpan" id="kobo.336.1"> button. </span><span class="koboSpan" id="kobo.336.2">In this case, we only want the </span><strong class="screenText"><span class="koboSpan" id="kobo.337.1">OK</span></strong><span class="koboSpan" id="kobo.338.1"> button, so we override the default behavior by explicitly creating an </span><strong class="screenText"><span class="koboSpan" id="kobo.339.1">OK</span></strong><span class="koboSpan" id="kobo.340.1"> button with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.341.1">--button</span></code><span class="koboSpan" id="kobo.342.1"> option. </span><span class="koboSpan" id="kobo.342.2">Here’s how this window looks:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.343.1"><img src="../Images/B21693_16_09.png" alt="B21693_16_9"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.344.1">Figure 16.9: The Status window</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.345.1">Look in</span><a id="_idIndexMarker1009"/><span class="koboSpan" id="kobo.346.1"> your directory, and you should see that the image has indeed been resized.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.347.1">To give credit where credit is due, I borrowed this script from a </span><em class="chapterRef"><span class="koboSpan" id="kobo.348.1">Linux Magazine</span></em><span class="koboSpan" id="kobo.349.1"> article that was posted way back in 2012, and made a couple of minor tweaks to it. </span><span class="koboSpan" id="kobo.349.2">You’ll find the link to the original article in the </span><em class="chapterRef"><span class="koboSpan" id="kobo.350.1">Further Reading</span></em><span class="koboSpan" id="kobo.351.1"> section.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.352.1">The major flaw with this script is that it overwrites the original graphics file with the resized version. </span><span class="koboSpan" id="kobo.352.2">Let’s modify it so that it will save the resized version as a new file with a new filename. </span><span class="koboSpan" id="kobo.352.3">Here’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.353.1">yad-image-resize2.sh</span></code><span class="koboSpan" id="kobo.354.1"> script that does that:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.355.1">#!/bin/bash
imageFile=$(yad --file --title="Select the image file" --width=800 --add-preview)
newfilename=${imageFile%%.*}
suffix=${imageFile: -4}
dialog=$(yad --title "Image Resize" --form --field="Resize parameter" --field="Quality")
size=$(echo $dialog | awk 'BEGIN {FS="|"} {print $1}')
quality=$(echo $dialog | awk 'BEGIN {FS="|"} {print $2}')
convert -resize "$size" -quality "$quality" "$imageFile" -delete 1 "$newfilename"_resized"$suffix"
yad --title="Status" --width=300  --button="OK:0"  --text="All done. </span><span class="koboSpan" id="kobo.355.2">Yay!"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.356.1">To make this work, I created two new variables and used variable expansion to assign them their values. </span><span class="koboSpan" id="kobo.356.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.357.1">newfilename=${imageFile%%.*}</span></code><span class="koboSpan" id="kobo.358.1"> line grabs the first part of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.359.1">imageFile</span></code><span class="koboSpan" id="kobo.360.1"> filename, up to the dot for the filename extension. </span><span class="koboSpan" id="kobo.360.2">For example, let’s say that the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.361.1">imageFile</span></code><span class="koboSpan" id="kobo.362.1"> is </span><code class="inlineCode"><span class="koboSpan" id="kobo.363.1">somegraphic.jpg</span></code><span class="koboSpan" id="kobo.364.1">. </span><span class="koboSpan" id="kobo.364.2">Using variable expansion to strip off the </span><code class="inlineCode"><span class="koboSpan" id="kobo.365.1">.jpg</span></code><span class="koboSpan" id="kobo.366.1"> would result in assigning a value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.367.1">somegraphic</span></code><span class="koboSpan" id="kobo.368.1"> to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.369.1">newfilename</span></code><span class="koboSpan" id="kobo.370.1"> variable. </span><span class="koboSpan" id="kobo.370.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.371.1">suffix</span></code><span class="koboSpan" id="kobo.372.1"> variable uses the offset feature of variable expansion. </span><span class="koboSpan" id="kobo.372.2">In this case, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.373.1">${imageFile: -4}</span></code><span class="koboSpan" id="kobo.374.1"> construct grabs the last four characters of the filename. </span><span class="koboSpan" id="kobo.374.2">This results in assigning a value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.375.1">.jpg</span></code><span class="koboSpan" id="kobo.376.1"> to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.377.1">suffix</span></code><span class="koboSpan" id="kobo.378.1"> variable.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.379.1">The</span><a id="_idIndexMarker1010"/><span class="koboSpan" id="kobo.380.1"> next thing to note is how I had to modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.381.1">convert</span></code><span class="koboSpan" id="kobo.382.1"> command. </span><span class="koboSpan" id="kobo.382.2">(By the way, note that this </span><code class="inlineCode"><span class="koboSpan" id="kobo.383.1">convert</span></code><span class="koboSpan" id="kobo.384.1"> command is quite long, and wraps around on the page.) All I did was to add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.385.1">-delete 1 "$newfilename"_resized"$suffix"</span></code><span class="koboSpan" id="kobo.386.1"> part to the end of the command that I had before. </span><span class="koboSpan" id="kobo.386.2">You’ve probably figured out that with our current example, this would create a new file with the filename, </span><code class="inlineCode"><span class="koboSpan" id="kobo.387.1">somegraphic_resized.jpg</span></code><span class="koboSpan" id="kobo.388.1">. </span><span class="koboSpan" id="kobo.388.2">But, you might be puzzled by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.389.1">-delete 1</span></code><span class="koboSpan" id="kobo.390.1"> part. </span><span class="koboSpan" id="kobo.390.2">Well, it’s just that under certain conditions, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.391.1">convert</span></code><span class="koboSpan" id="kobo.392.1"> command will create two output files, instead of just one, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.393.1">donnie@fedora:~/Pictures$ ls -l *dup*
-rw-r--r--. </span><span class="koboSpan" id="kobo.393.2">1 donnie donnie 2324036 Feb 11 14:38 S1340003-dup.JPG
-rw-r--r--. </span><span class="koboSpan" id="kobo.393.3">1 donnie donnie   29745 Feb 11 15:57 S1340003-dup_resized-0.JPG
-rw-r--r--. </span><span class="koboSpan" id="kobo.393.4">1 donnie donnie  293424 Feb 11 15:57 S1340003-dup_resized-1.JPG
donnie@fedora:~/Pictures$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.394.1">Adding the </span><code class="inlineCode"><span class="koboSpan" id="kobo.395.1">-delete 1</span></code><span class="koboSpan" id="kobo.396.1"> parameter just before the output filename parameter eliminates that problem, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.397.1">donnie@fedora:~/Pictures$ ls -l *dup*
-rw-r--r--. </span><span class="koboSpan" id="kobo.397.2">1 donnie donnie 2324036 Feb 11 14:38 S1340003-dup.JPG
-rw-r--r--. </span><span class="koboSpan" id="kobo.397.3">1 donnie donnie   29745 Feb 11 16:00 S1340003-dup_resized.JPG
donnie@fedora:~/Pictures$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.398.1">The</span><a id="_idIndexMarker1011"/><span class="koboSpan" id="kobo.399.1"> final modification I’ll show you, which I’ll put in </span><code class="inlineCode"><span class="koboSpan" id="kobo.400.1">yad-image-resize3.sh</span></code><span class="koboSpan" id="kobo.401.1">, causes the file manager to only display certain file types. </span><span class="koboSpan" id="kobo.401.2">Since we’re dealing with graphics files, we only want the file manager to show us files with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.402.1">.JPG</span></code><span class="koboSpan" id="kobo.403.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.404.1">.jpg</span></code><span class="koboSpan" id="kobo.405.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.406.1">.PNG</span></code><span class="koboSpan" id="kobo.407.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.408.1">.png</span></code><span class="koboSpan" id="kobo.409.1"> filename extensions. </span><span class="koboSpan" id="kobo.409.2">We’ll do that by just adding the </span><code class="inlineCode"><span class="koboSpan" id="kobo.410.1">--file-filter "Graphics files | *.JPG *.jpg *.PNG *.png")</span></code><span class="koboSpan" id="kobo.411.1"> option to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.412.1">imageFile=</span></code><span class="koboSpan" id="kobo.413.1"> line that’s at the top of the script. </span><span class="koboSpan" id="kobo.413.2">The new line now looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.414.1">imageFile=$(yad --file --title="Select the image file" --width=800 --add-preview --file-filter "Graphics files | *.JPG *.jpg *.PNG *.png")
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.415.1">Now that the line is quite long, let’s make it more readable by breaking it up with backslashes, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.416.1">imageFile=$(yad --file --title="Select the image file" \
        --width=800 --add-preview \
        --file-filter "Graphics files | *.JPG *.jpg *.PNG *.png")
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.417.1">That looks much better, right?</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.418.1">All right, let’s move on to our final example.</span></p>
    <h2 id="_idParaDest-341" class="heading 2"><span class="koboSpan" id="kobo.419.1">Programming Form Buttons</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.420.1">In this</span><a id="_idIndexMarker1012"/><span class="koboSpan" id="kobo.421.1"> scenario, we’re in a software developer’s shop that’s running a small fleet of Fedora Linux-powered workstations. </span><span class="koboSpan" id="kobo.421.2">We want to create a GUI-type setup utility that will simplify the process of setting up a new workstation. </span><span class="koboSpan" id="kobo.421.3">Furthermore, we want to carry this utility around on a USB memory stick so that we can either run it directly from the memory stick, or copy it to each workstation. </span><span class="koboSpan" id="kobo.421.4">Fortunately, that’s easy with </span><code class="inlineCode"><span class="koboSpan" id="kobo.422.1">yad</span></code><span class="koboSpan" id="kobo.423.1">. </span><span class="koboSpan" id="kobo.423.2">Here’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.424.1">yad-system-tool.sh</span></code><span class="koboSpan" id="kobo.425.1"> script that does that:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.426.1">#!/bin/bash
yad --title "System tools for a Fedora Workstation" --form --columns=3 \
        --width=540 --height=190 \
        --text="Tools for setting up Fedora or RHEL-type distros" \
        --field="&lt;b&gt;Update System&lt;/b&gt;":FBTN "dnf -y upgrade" \
        --field="&lt;b&gt;Authoring and Publishing&lt;/b&gt;":FBTN "dnf -y groupinstall --with-optional 'Authoring and Publishing'" \
        --field="&lt;b&gt;Development Tools&lt;/b&gt;":FBTN "dnf -y --with-optional groupinstall 'Development Tools'" \
        --button=Exit:1
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.427.1">In this script, you</span><a id="_idIndexMarker1013"/><span class="koboSpan" id="kobo.428.1"> see some options that you haven’t seen before. </span><span class="koboSpan" id="kobo.428.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.429.1">--columns=3</span></code><span class="koboSpan" id="kobo.430.1"> option in the first line means that we want to create a form with three buttons across on each row. </span><span class="koboSpan" id="kobo.430.2">On the second line, you see a </span><code class="inlineCode"><span class="koboSpan" id="kobo.431.1">--height</span></code><span class="koboSpan" id="kobo.432.1"> option, as well as a </span><code class="inlineCode"><span class="koboSpan" id="kobo.433.1">--width</span></code><span class="koboSpan" id="kobo.434.1"> option. </span><span class="koboSpan" id="kobo.434.2">In each of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.435.1">--field</span></code><span class="koboSpan" id="kobo.436.1"> lines, you see the </span><code class="inlineCode"><span class="koboSpan" id="kobo.437.1">:FBTN</span></code><span class="koboSpan" id="kobo.438.1"> option, which defines the fields as programmable buttons. </span><span class="koboSpan" id="kobo.438.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.439.1">&lt;b&gt;</span></code><span class="koboSpan" id="kobo.440.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.441.1">&lt;/b&gt;</span></code><span class="koboSpan" id="kobo.442.1"> tags that surround the button text make the button text appear in bold type. </span><span class="koboSpan" id="kobo.442.2">The final portion of each </span><code class="inlineCode"><span class="koboSpan" id="kobo.443.1">--field</span></code><span class="koboSpan" id="kobo.444.1"> line consists of the command that will run when you click on the button.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.445.1">The first button is programmed to perform a system update with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.446.1">dnf -y upgrade</span></code><span class="koboSpan" id="kobo.447.1"> command. </span><span class="koboSpan" id="kobo.447.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.448.1">-y</span></code><span class="koboSpan" id="kobo.449.1"> causes the command to run without stopping to prompt the user about whether he or she really wants to do it. </span><span class="koboSpan" id="kobo.449.2">I had to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.450.1">-y</span></code><span class="koboSpan" id="kobo.451.1"> option, because without it, the operation would abort at the prompt. </span><span class="koboSpan" id="kobo.451.2">The next two buttons each install a selected group of software packages. </span><span class="koboSpan" id="kobo.451.3">If you want to see what’s in each of these groups, just run these two commands:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.452.1">donnie@fedora:~$ sudo dnf group info "Authoring and Publishing"
donnie@fedora:~$ sudo dnf group info "Development Tools"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.453.1">Since we’re dealing with administrative commands in this script, we’ll need to run it with </span><code class="inlineCode"><span class="koboSpan" id="kobo.454.1">sudo</span></code><span class="koboSpan" id="kobo.455.1">. </span><span class="koboSpan" id="kobo.455.2">Here’s how it looks:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.456.1"><img src="../Images/B21693_16_10.png" alt="B21693_16_10"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.457.1">Figure 16.10: A yad form with programmable buttons</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.458.1">Now, just </span><a id="_idIndexMarker1014"/><span class="koboSpan" id="kobo.459.1">click on a button and watch what happens.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.460.1">Adding more software installation choices is easy, by just adding more </span><code class="inlineCode"><span class="koboSpan" id="kobo.461.1">--field</span></code><span class="koboSpan" id="kobo.462.1"> lines. </span><span class="koboSpan" id="kobo.462.2">If you want to see the list of software packages that are available on Fedora, just do:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.463.1">donnie@fedora:~$ sudo dnf group list
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.464.1">I know, you’re thinking that this type of chore would be more easily accomplished with a set of plain, text-mode scripts. </span><span class="koboSpan" id="kobo.464.2">And yeah, you’re right. </span><span class="koboSpan" id="kobo.464.3">So, just think of this example as a template that you can use for your own purposes.</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.465.1">Also, I neglected to mention before that you’ll need to manually install </span><code class="inlineCode"><span class="koboSpan" id="kobo.466.1">yad</span></code><span class="koboSpan" id="kobo.467.1"> on each system that you want to administer with this script.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.468.1">That wraps things up for this script, so let’s move on.</span></p>
    <h2 id="_idParaDest-342" class="heading 2"><span class="koboSpan" id="kobo.469.1">Some Final Thoughts about yad</span></h2>
    <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.470.1">yad</span></code><span class="koboSpan" id="kobo.471.1"> is a </span><a id="_idIndexMarker1015"/><span class="koboSpan" id="kobo.472.1">really cool program, and you can do a lot of really cool stuff with it. </span><span class="koboSpan" id="kobo.472.2">In fact, a person could probably write a whole book on nothing but </span><code class="inlineCode"><span class="koboSpan" id="kobo.473.1">yad</span></code><span class="koboSpan" id="kobo.474.1">. </span><span class="koboSpan" id="kobo.474.2">I can’t do that at the moment, but I’ve hopefully given you enough to whet your appetite.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.475.1">The main problem with </span><code class="inlineCode"><span class="koboSpan" id="kobo.476.1">yad</span></code><span class="koboSpan" id="kobo.477.1"> is that for whatever reason, its creator has never written any real documentation for it, other than a very sparse man page. </span><span class="koboSpan" id="kobo.477.2">Fortunately, a lot of other people have taken up the challenge, and have created their own documentation and tutorials on both the web and on YouTube. </span><span class="koboSpan" id="kobo.477.3">(I’ll link to some of these resources in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.478.1">Further Reading</span></code><span class="koboSpan" id="kobo.479.1"> section.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.480.1">Next, let’s turn our attention to </span><code class="inlineCode"><span class="koboSpan" id="kobo.481.1">dialog</span></code><span class="koboSpan" id="kobo.482.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.483.1">xdialog</span></code><span class="koboSpan" id="kobo.484.1">, which we can also use to create user interfaces for our scripts.</span></p>
    <h1 id="_idParaDest-343" class="heading 1"><span class="koboSpan" id="kobo.485.1">Creating User Interfaces with dialog and xdialog</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.486.1">Another </span><a id="_idIndexMarker1016"/><span class="koboSpan" id="kobo.487.1">slight problem with </span><code class="inlineCode"><span class="koboSpan" id="kobo.488.1">yad</span></code><span class="koboSpan" id="kobo.489.1"> is that you can only use it on machines that have a desktop environment installed. </span><span class="koboSpan" id="kobo.489.2">But, many Linux, Unix, and Unix-like servers are set up with a full text-mode environment and don’t have to use graphical desktops. </span><span class="koboSpan" id="kobo.489.3">Another slight problem with </span><code class="inlineCode"><span class="koboSpan" id="kobo.490.1">yad</span></code><span class="koboSpan" id="kobo.491.1"> is that even on desktop-type operating systems, it’s not always available for installation. </span><span class="koboSpan" id="kobo.491.2">However, if </span><code class="inlineCode"><span class="koboSpan" id="kobo.492.1">yad</span></code><span class="koboSpan" id="kobo.493.1"> isn’t available and you still need a GUI solution, you might be able to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.494.1">xdialog</span></code><span class="koboSpan" id="kobo.495.1">, which is more universally available. </span><span class="koboSpan" id="kobo.495.2">Let’s begin with a look at </span><code class="inlineCode"><span class="koboSpan" id="kobo.496.1">dialog</span></code><span class="koboSpan" id="kobo.497.1">, which can be used on text-mode machines.</span></p>
    <h2 id="_idParaDest-344" class="heading 2"><span class="koboSpan" id="kobo.498.1">The dialog Basics</span></h2>
    <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.499.1">dialog</span></code><span class="koboSpan" id="kobo.500.1"> used </span><a id="_idIndexMarker1017"/><span class="koboSpan" id="kobo.501.1">to be installed by default on all Linux systems, but it no longer is. </span><span class="koboSpan" id="kobo.501.2">However, it’s available for installation for pretty much every Linux distro. </span><span class="koboSpan" id="kobo.501.3">So, you can install it with your distro’s normal package manager. </span><span class="koboSpan" id="kobo.501.4">On most Unix and Unix-like systems, such as OpenIndiana and FreeBSD, it still comes installed by default.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.502.1">The basic </span><code class="inlineCode"><span class="koboSpan" id="kobo.503.1">dialog</span></code><span class="koboSpan" id="kobo.504.1"> building blocks are known as </span><strong class="keyWord"><span class="koboSpan" id="kobo.505.1">widgets</span></strong><span class="koboSpan" id="kobo.506.1">. </span><span class="koboSpan" id="kobo.506.2">Each widget has a set of parameters that you need to specify when you use it. </span><span class="koboSpan" id="kobo.506.3">For example, open the </span><code class="inlineCode"><span class="koboSpan" id="kobo.507.1">dialog</span></code><span class="koboSpan" id="kobo.508.1"> man page</span><a id="_idIndexMarker1018"/><span class="koboSpan" id="kobo.509.1"> and scroll down to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.510.1">--msgbox</span></code><span class="koboSpan" id="kobo.511.1"> paragraph, where you’ll see this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.512.1">--msgbox text height width
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.513.1">So, this widget requires you to specify three parameters. </span><span class="koboSpan" id="kobo.513.2">(Unlike </span><code class="inlineCode"><span class="koboSpan" id="kobo.514.1">yad</span></code><span class="koboSpan" id="kobo.515.1">, specifying the dimensions of a </span><code class="inlineCode"><span class="koboSpan" id="kobo.516.1">dialog</span></code><span class="koboSpan" id="kobo.517.1"> box isn’t optional.) Let’s see how that looks in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.518.1">dialog-hello.sh script</span></code><span class="koboSpan" id="kobo.519.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.520.1">#!/bin/bash
dialog --title "Dialog message box" \
        --msgbox "\n Howdy folks!" </span><span class="koboSpan" id="kobo.520.2">6 25
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.521.1">As you’ve seen before in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.522.1">yad</span></code><span class="koboSpan" id="kobo.523.1"> section, I used a backslash to break the command into two lines, which makes things a bit more readable. </span><span class="koboSpan" id="kobo.523.2">On the </span><code class="inlineCode"><span class="koboSpan" id="kobo.524.1">--msgbox</span></code><span class="koboSpan" id="kobo.525.1"> line, we see the message text, the height as defined by the number of rows in the box, and the width as defined by the number of characters that fit on a line. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.526.1">Running the script looks like this:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.527.1"><img src="../Images/B21693_16_11.png" alt="B21693_16_11"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.528.1">Figure 16.11: Running the dialog-hello.sh script</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.529.1">To close the </span><a id="_idIndexMarker1019"/><span class="koboSpan" id="kobo.530.1">window, just hit the </span><strong class="screenText"><span class="koboSpan" id="kobo.531.1">Enter</span></strong><span class="koboSpan" id="kobo.532.1"> key, which activates the </span><strong class="screenText"><span class="koboSpan" id="kobo.533.1">OK</span></strong><span class="koboSpan" id="kobo.534.1"> button by default. </span><span class="koboSpan" id="kobo.534.2">(On a desktop machine, you also have the option of clicking on the </span><strong class="screenText"><span class="koboSpan" id="kobo.535.1">OK</span></strong><span class="koboSpan" id="kobo.536.1"> button with your mouse.) Once the window is closed, run the </span><code class="inlineCode"><span class="koboSpan" id="kobo.537.1">clear</span></code><span class="koboSpan" id="kobo.538.1"> command to remove the blue background from your terminal.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.539.1">By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.540.1">dialog</span></code><span class="koboSpan" id="kobo.541.1"> windows always appear in the center of your terminal, and the blue background won’t clear until you clear it yourself. </span><span class="koboSpan" id="kobo.541.2">Fortunately, you can change both behaviors. </span><span class="koboSpan" id="kobo.541.3">Here’s a slightly modified version of our script, which places the window at the top left corner of the terminal:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.542.1">#!/bin/bash
dialog --title "Dialog message box" \
        --begin 2 2 \
        --msgbox "\nHowdy folks!" </span><span class="koboSpan" id="kobo.542.2">6 25
clear
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.543.1">Here’s </span><a id="_idIndexMarker1020"/><span class="koboSpan" id="kobo.544.1">how that looks:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.545.1"><img src="../Images/B21693_16_12.png" alt="B21693_16_12"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.546.1">Figure 16.12: Placing the dialog box in the upper-left corner</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.547.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.548.1">--begin</span></code><span class="koboSpan" id="kobo.549.1"> option takes two parameters. </span><span class="koboSpan" id="kobo.549.2">The first one denotes the vertical position of the box, and the second one denotes the horizontal position. </span><span class="koboSpan" id="kobo.549.3">For example, by changing the line to </span><code class="inlineCode"><span class="koboSpan" id="kobo.550.1">--begin 15 2</span></code><span class="koboSpan" id="kobo.551.1">, the box would show up in the lower left corner. </span><span class="koboSpan" id="kobo.551.2">To place it into the upper right corner, you could change it to </span><code class="inlineCode"><span class="koboSpan" id="kobo.552.1">--begin 2 50</span></code><span class="koboSpan" id="kobo.553.1">. </span><span class="koboSpan" id="kobo.553.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.554.1">clear</span></code><span class="koboSpan" id="kobo.555.1"> command </span><a id="_idIndexMarker1021"/><span class="koboSpan" id="kobo.556.1">at the end will clear away the blue background when you hit the </span><strong class="screenText"><span class="koboSpan" id="kobo.557.1">OK</span></strong><span class="koboSpan" id="kobo.558.1"> button.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.559.1">Of course, this script isn’t very useful, but that’s okay. </span><span class="koboSpan" id="kobo.559.2">I’ll show you some more useful concepts in just a bit. </span><span class="koboSpan" id="kobo.559.3">First though, allow me to say a few words about </span><code class="inlineCode"><span class="koboSpan" id="kobo.560.1">xdialog</span></code><span class="koboSpan" id="kobo.561.1">.</span></p>
    <h2 id="_idParaDest-345" class="heading 2"><span class="koboSpan" id="kobo.562.1">The xdialog Basics</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.563.1">If you </span><a id="_idIndexMarker1022"/><span class="koboSpan" id="kobo.564.1">need a GUI-type of user interface and </span><code class="inlineCode"><span class="koboSpan" id="kobo.565.1">yad</span></code><span class="koboSpan" id="kobo.566.1"> isn’t available for your desktop system, </span><code class="inlineCode"><span class="koboSpan" id="kobo.567.1">xdialog</span></code><span class="koboSpan" id="kobo.568.1"> could be a good alternative. </span><span class="koboSpan" id="kobo.568.2">(I say could be, because neither </span><code class="inlineCode"><span class="koboSpan" id="kobo.569.1">yad</span></code><span class="koboSpan" id="kobo.570.1"> nor </span><code class="inlineCode"><span class="koboSpan" id="kobo.571.1">xdialog</span></code><span class="koboSpan" id="kobo.572.1"> is available for OpenIndiana.) It should be in the normal repository of your Linux or Unix-like distro, so just use your normal package manager to install it. </span><span class="koboSpan" id="kobo.572.2">The reason I can talk about both </span><code class="inlineCode"><span class="koboSpan" id="kobo.573.1">dialog</span></code><span class="koboSpan" id="kobo.574.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.575.1">xdialog</span></code><span class="koboSpan" id="kobo.576.1"> in the same section is because for the most part, code that’s written for </span><code class="inlineCode"><span class="koboSpan" id="kobo.577.1">dialog</span></code><span class="koboSpan" id="kobo.578.1"> can also run with </span><code class="inlineCode"><span class="koboSpan" id="kobo.579.1">xdialog</span></code><span class="koboSpan" id="kobo.580.1">.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.581.1">There’s one thing to look out for that could trip you up. </span><span class="koboSpan" id="kobo.581.2">For some strange reason, the package name is </span><code class="inlineCode"><span class="koboSpan" id="kobo.582.1">xdialog</span></code><span class="koboSpan" id="kobo.583.1">, in all lower-case letters. </span><span class="koboSpan" id="kobo.583.2">But, after it’s installed, you’ll need to invoke the program by typing </span><code class="inlineCode"><span class="koboSpan" id="kobo.584.1">Xdialog</span></code><span class="koboSpan" id="kobo.585.1">, with an upper-case X. </span><span class="koboSpan" id="kobo.585.2">(After I installed it, it took me a while to figure out why I couldn’t get it to work.)</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.586.1">For the most part, changing a </span><code class="inlineCode"><span class="koboSpan" id="kobo.587.1">dialog</span></code><span class="koboSpan" id="kobo.588.1"> script to run as a GUI-type program is a simple matter of changing all instances of </span><code class="inlineCode"><span class="koboSpan" id="kobo.589.1">dialog</span></code><span class="koboSpan" id="kobo.590.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.591.1">Xdialog</span></code><span class="koboSpan" id="kobo.592.1">, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.593.1">#!/bin/bash
Xdialog --title "Dialog message box" \
        --begin 2 50 \
        --msgbox "\nHowdy folks!" </span><span class="koboSpan" id="kobo.593.2">6 25
clear
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.594.1">Running the script on a desktop system gives you this:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.595.1"><img src="../Images/B21693_16_13.png" alt="B21693_16_13"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.596.1">Figure 16.13: Running the script with xdialog</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.597.1">The</span><a id="_idIndexMarker1023"/><span class="koboSpan" id="kobo.598.1"> first thing to note is that </span><code class="inlineCode"><span class="koboSpan" id="kobo.599.1">xdialog</span></code><span class="koboSpan" id="kobo.600.1"> ignores the </span><code class="inlineCode"><span class="koboSpan" id="kobo.601.1">--begin</span></code><span class="koboSpan" id="kobo.602.1"> option, and just places the box in the center of the terminal. </span><span class="koboSpan" id="kobo.602.2">There’s also the fact that </span><code class="inlineCode"><span class="koboSpan" id="kobo.603.1">xdialog</span></code><span class="koboSpan" id="kobo.604.1"> often requires you to create boxes with larger dimensions so that you can see everything. </span><span class="koboSpan" id="kobo.604.2">So, let’s change that in the final </span><code class="inlineCode"><span class="koboSpan" id="kobo.605.1">xdialog-hello.sh</span></code><span class="koboSpan" id="kobo.606.1"> script, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.607.1">#!/bin/bash
Xdialog --title "Dialog message box" \
        --begin 2 2 \
        --msgbox "\nHowdy folks!" </span><span class="koboSpan" id="kobo.607.2">15 50
clear
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.608.1">As you see here, this makes things look much better:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.609.1"><img src="../Images/B21693_16_14.png" alt="B21693_16_14"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.610.1">Figure 16.14: The improved xdialog script</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.611.1">With </span><code class="inlineCode"><span class="koboSpan" id="kobo.612.1">xdialog</span></code><span class="koboSpan" id="kobo.613.1">, the </span><a id="_idIndexMarker1024"/><span class="koboSpan" id="kobo.614.1">clear command at the end of the script is no longer necessary, but it doesn’t hurt anything to leave it. </span><span class="koboSpan" id="kobo.614.2">In fact, we’ll need it for the next demo.</span></p>
    <h2 id="_idParaDest-346" class="heading 2"><span class="koboSpan" id="kobo.615.1">Automatically Choosing Either dialog or xdialog</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.616.1">Now, here’s something that’s really cool. </span><span class="koboSpan" id="kobo.616.2">With only a few extra lines of code, you can make </span><a id="_idIndexMarker1025"/><span class="koboSpan" id="kobo.617.1">your script automatically detect whether it’s running on a desktop or text-mode machine, and whether </span><code class="inlineCode"><span class="koboSpan" id="kobo.618.1">xdialog</span></code><span class="koboSpan" id="kobo.619.1"> is installed. </span><span class="koboSpan" id="kobo.619.2">Here’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.620.1">xdialog-hello2.sh</span></code><span class="koboSpan" id="kobo.621.1"> script to show how it works:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.622.1">#!/bin/bash
command -v Xdialog
if [[ $? </span><span class="koboSpan" id="kobo.622.2">== 0 ]] &amp;&amp; [[ -n $DISPLAY ]]; then
        diag=Xdialog
else
        diag=dialog
fi
$diag --title "Dialog message box" \
        --begin 2 2 \
        --msgbox "\nHowdy folks!" </span><span class="koboSpan" id="kobo.622.3">15 50
clear
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.623.1">There</span><a id="_idIndexMarker1026"/><span class="koboSpan" id="kobo.624.1"> are several ways to detect if a program is installed. </span><span class="koboSpan" id="kobo.624.2">In </span><em class="chapterRef"><span class="koboSpan" id="kobo.625.1">Chapter 12, Automating Scripts with here Documents and expect</span></em><span class="koboSpan" id="kobo.626.1">, I showed you this method in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.627.1">system_info.sh</span></code><span class="koboSpan" id="kobo.628.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.629.1">if [[ -f /usr/local/bin/pandoc ]] || [[ -f /usr/bin/pandoc ]]; then
        pandoc -o sysinfo.pdf sysinfo.html
        rm sysinfo.html
fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.630.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.631.1">pandoc</span></code><span class="koboSpan" id="kobo.632.1"> executable that we needed is in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.633.1">/usr/local/bin/</span></code><span class="koboSpan" id="kobo.634.1"> directory on FreeBSD, and in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.635.1">/usr/bin/</span></code><span class="koboSpan" id="kobo.636.1"> directory on everything else. </span><span class="koboSpan" id="kobo.636.2">So, I set up this </span><code class="inlineCode"><span class="koboSpan" id="kobo.637.1">if..then</span></code><span class="koboSpan" id="kobo.638.1"> construct to detect if the executable is in either place. </span><span class="koboSpan" id="kobo.638.2">That works, but I’d now like to show you an easier way.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.639.1">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.640.1">xdialog-hello2.sh</span></code><span class="koboSpan" id="kobo.641.1"> script, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.642.1">command -v Xdialog</span></code><span class="koboSpan" id="kobo.643.1"> command detects if the </span><code class="inlineCode"><span class="koboSpan" id="kobo.644.1">Xdialog</span></code><span class="koboSpan" id="kobo.645.1"> executable file is present, regardless of which directory it’s in. </span><span class="koboSpan" id="kobo.645.2">If it is, the command will return exit code 0. </span><span class="koboSpan" id="kobo.645.3">If it’s not, the command will return exit code 1. </span><span class="koboSpan" id="kobo.645.4">To see how this works, go ahead and run this on the command line. </span><span class="koboSpan" id="kobo.645.5">Here’s how it looks if the </span><code class="inlineCode"><span class="koboSpan" id="kobo.646.1">Xdialog</span></code><span class="koboSpan" id="kobo.647.1"> executable isn’t detected:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.648.1">donnie@ubuntu2204:~$ command -v Xdialog
donnie@ubuntu2204:~$ echo $?
</span><span class="koboSpan" id="kobo.648.2">1
donnie@ubuntu2204:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.649.1">And, here’s how it looks if it is detected:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.650.1">donnie@fedora:~$ command -v Xdialog
donnie@fedora:~$ echo $?
</span><span class="koboSpan" id="kobo.650.2">0
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.651.1">In the next line, you see an </span><code class="inlineCode"><span class="koboSpan" id="kobo.652.1">if..then</span></code><span class="koboSpan" id="kobo.653.1"> construct that checks for two things. </span><span class="koboSpan" id="kobo.653.2">First, it checks the exit code from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.654.1">command</span></code><span class="koboSpan" id="kobo.655.1"> command, and then it checks to see if a graphical desktop environment is installed. </span><span class="koboSpan" id="kobo.655.2">If the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.656.1">DISPLAY</span></code><span class="koboSpan" id="kobo.657.1"> environmental </span><a id="_idIndexMarker1027"/><span class="koboSpan" id="kobo.658.1">variable is of a non-zero length, then a desktop environment is installed. </span><span class="koboSpan" id="kobo.658.2">You can see how this works by running the </span><code class="inlineCode"><span class="koboSpan" id="kobo.659.1">echo $DISPLAY</span></code><span class="koboSpan" id="kobo.660.1"> command yourself. </span><span class="koboSpan" id="kobo.660.2">Here’s how it looks on a desktop machine:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.661.1">donnie@fedora:~$ echo $DISPLAY
:0
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.662.1">On a text-mode machine, you’ll get no output at all, as you see here on this Ubuntu Server virtual machine:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.663.1">donnie@ubuntu2204:~$ echo $DISPLAY
donnie@ubuntu2204:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.664.1">For our purposes, we can say that the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.665.1">DISPLAY</span></code><span class="koboSpan" id="kobo.666.1"> is zero characters long on this text-mode machine.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.667.1">Now, let’s take another look at our </span><code class="inlineCode"><span class="koboSpan" id="kobo.668.1">if..then</span></code><span class="koboSpan" id="kobo.669.1"> statement:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.670.1">if [[ $? </span><span class="koboSpan" id="kobo.670.2">== 0 ]] &amp;&amp; [[ -n $DISPLAY ]]; then
        diag=Xdialog
else
        diag=dialog
fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.671.1">This means that if the exit code from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.672.1">command -v Xdialog</span></code><span class="koboSpan" id="kobo.673.1"> line is 0, and the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.674.1">DISPLAY</span></code><span class="koboSpan" id="kobo.675.1"> environmental variable is of a non-zero length, then the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.676.1">diag</span></code><span class="koboSpan" id="kobo.677.1"> variable becomes </span><code class="inlineCode"><span class="koboSpan" id="kobo.678.1">Xdialog</span></code><span class="koboSpan" id="kobo.679.1">. </span><span class="koboSpan" id="kobo.679.2">If either the </span><code class="inlineCode"><span class="koboSpan" id="kobo.680.1">Xdialog</span></code><span class="koboSpan" id="kobo.681.1"> executable is missing or the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.682.1">DISPLAY</span></code><span class="koboSpan" id="kobo.683.1"> is </span><em class="italic"><span class="koboSpan" id="kobo.684.1">not</span></em><span class="koboSpan" id="kobo.685.1"> a non-zero length, then the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.686.1">diag</span></code><span class="koboSpan" id="kobo.687.1"> becomes </span><code class="inlineCode"><span class="koboSpan" id="kobo.688.1">dialog</span></code><span class="koboSpan" id="kobo.689.1">. </span><span class="koboSpan" id="kobo.689.2">What makes this even more cool is that this works the same on all Linux, Unix, or Unix-like systems. </span><span class="koboSpan" id="kobo.689.3">I’ve tested this script on FreeBSD, GhostBSD, DragonflyBSD, OpenIndiana, and on both desktop and text-mode implementations of Linux. </span><span class="koboSpan" id="kobo.689.4">On all of them, the script correctly detects everything that it’s supposed to </span><a id="_idIndexMarker1028"/><span class="koboSpan" id="kobo.690.1">detect, and correctly chooses whether to run either </span><code class="inlineCode"><span class="koboSpan" id="kobo.691.1">dialog</span></code><span class="koboSpan" id="kobo.692.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.693.1">Xdialog</span></code><span class="koboSpan" id="kobo.694.1">.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.695.1">Here’s something that caused me a bit of consternation. </span><span class="koboSpan" id="kobo.695.2">I accidentally found out that the order in which you test for things sometimes matters. </span><span class="koboSpan" id="kobo.695.3">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.696.1">if..then</span></code><span class="koboSpan" id="kobo.697.1"> construct of this script, I originally checked for the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.698.1">DISPLAY</span></code><span class="koboSpan" id="kobo.699.1"> first, and then checked for the exit code of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.700.1">command</span></code><span class="koboSpan" id="kobo.701.1"> command. </span><span class="koboSpan" id="kobo.701.2">The script wouldn’t run correctly like that, because the test for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.702.1">DISPLAY</span></code><span class="koboSpan" id="kobo.703.1"> value was setting the exit code to 0. </span><span class="koboSpan" id="kobo.703.2">When I reversed the order of the tests, everything began to work correctly.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.704.1">Go ahead and try running this script on a variety of systems, just to see what happens.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.705.1">Next, let’s build on what we’ve already done by adding another widget.</span></p>
    <h2 id="_idParaDest-347" class="heading 2"><span class="koboSpan" id="kobo.706.1">Adding Widgets</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.707.1">You can</span><a id="_idIndexMarker1029"/><span class="koboSpan" id="kobo.708.1"> add more functionality by adding more widgets. </span><span class="koboSpan" id="kobo.708.2">Take for example the </span><code class="inlineCode"><span class="koboSpan" id="kobo.709.1">dialog-hello2.sh</span></code><span class="koboSpan" id="kobo.710.1"> script, which you can download from the Github repository. </span><span class="koboSpan" id="kobo.710.2">I can’t show the entire file at once due to formatting constraints, so I’ll show it to you a section at a time. </span><span class="koboSpan" id="kobo.710.3">Here’s the top section:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.711.1">#!/bin/bash
command -v Xdialog
if [[ $? </span><span class="koboSpan" id="kobo.711.2">== 0 ]] &amp;&amp; [[ -n $DISPLAY ]]; then
        diag=Xdialog
else
        diag=dialog
fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.712.1">We’ve already seen this in the previous script, and I’ve already explained it. </span><span class="koboSpan" id="kobo.712.2">So, let’s move on. </span><span class="koboSpan" id="kobo.712.3">Here’s the next section:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.713.1">$diag --title "Dialog message box" \
        --begin 2 2 \
        --msgbox "\n Hello world!" </span><span class="koboSpan" id="kobo.713.2">20 50
$diag --begin 4 4 --yesno "Do you believe in magic?" </span><span class="koboSpan" id="kobo.713.3">0 0
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.714.1">The</span><a id="_idIndexMarker1030"/><span class="koboSpan" id="kobo.715.1"> first </span><code class="inlineCode"><span class="koboSpan" id="kobo.716.1">$diag</span></code><span class="koboSpan" id="kobo.717.1"> line creates the initial message box in the top left corner, as specified by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.718.1">--begin 2 2</span></code><span class="koboSpan" id="kobo.719.1"> option. </span><span class="koboSpan" id="kobo.719.2">The second </span><code class="inlineCode"><span class="koboSpan" id="kobo.720.1">$diag</span></code><span class="koboSpan" id="kobo.721.1"> line creates a box with two buttons that are labeled as </span><strong class="screenText"><span class="koboSpan" id="kobo.722.1">Yes</span></strong><span class="koboSpan" id="kobo.723.1"> and </span><strong class="screenText"><span class="koboSpan" id="kobo.724.1">No</span></strong><span class="koboSpan" id="kobo.725.1">. </span><span class="koboSpan" id="kobo.725.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.726.1">--begin 4 4</span></code><span class="koboSpan" id="kobo.727.1"> option positions the </span><code class="inlineCode"><span class="koboSpan" id="kobo.728.1">yesno</span></code><span class="koboSpan" id="kobo.729.1"> box just slightly lower and slightly more to the right of where the initial message box was. </span><span class="koboSpan" id="kobo.729.2">After </span><code class="inlineCode"><span class="koboSpan" id="kobo.730.1">--yesno</span></code><span class="koboSpan" id="kobo.731.1">, we see the text that we want the box to display and the height and width parameters. </span><span class="koboSpan" id="kobo.731.2">(Setting the height and width to 0 and 0 causes the box to size itself automatically.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.732.1">Next, we have a </span><code class="inlineCode"><span class="koboSpan" id="kobo.733.1">case..esac</span></code><span class="koboSpan" id="kobo.734.1"> construct that assigns commands to the two buttons. </span><span class="koboSpan" id="kobo.734.2">Remember that when clicked, the </span><strong class="screenText"><span class="koboSpan" id="kobo.735.1">Yes</span></strong><span class="koboSpan" id="kobo.736.1"> button returns exit code 0, and the </span><strong class="screenText"><span class="koboSpan" id="kobo.737.1">No</span></strong><span class="koboSpan" id="kobo.738.1"> button returns exit code 1. </span><span class="koboSpan" id="kobo.738.2">Pressing the </span><strong class="screenText"><span class="koboSpan" id="kobo.739.1">Esc</span></strong><span class="koboSpan" id="kobo.740.1"> key returns exit code 255. </span><span class="koboSpan" id="kobo.740.2">We can use these exit codes to trigger a desired command, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.741.1">case $? </span><span class="koboSpan" id="kobo.741.2">in
        0)
                clear
                echo "Cool!  </span><span class="koboSpan" id="kobo.741.3">I'm glad that you do." </span><span class="koboSpan" id="kobo.741.4">;;
        1)
                clear
                echo "I'm sorry that you live such a dull life." </span><span class="koboSpan" id="kobo.741.5">;;
        255)
                clear
                echo "You pressed the ESC key." </span><span class="koboSpan" id="kobo.741.6">;;
esac
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.742.1">Okay, all this script does is display a message when you press a button. </span><span class="koboSpan" id="kobo.742.2">But, it does serve to demonstrate the concept, so it’s all good.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.743.1">You’ve already seen the initial message box, so I won’t show that again. </span><span class="koboSpan" id="kobo.743.2">Instead, I’ll show the </span><code class="inlineCode"><span class="koboSpan" id="kobo.744.1">yesno</span></code><span class="koboSpan" id="kobo.745.1"> box that comes up next:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.746.1"><img src="../Images/B21693_16_15.png" alt="B21693_16_15"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.747.1">Figure 16.15: The yesno box</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.748.1">When I</span><a id="_idIndexMarker1031"/><span class="koboSpan" id="kobo.749.1"> click the </span><strong class="screenText"><span class="koboSpan" id="kobo.750.1">Yes</span></strong><span class="koboSpan" id="kobo.751.1"> button, I’ll see the appropriate message, as you see here:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.752.1"><img src="../Images/B21693_16_16.png" alt="B21693_16_16"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.753.1">Figure 16.16: After clicking on the Yes button</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.754.1">And of course, this</span><a id="_idIndexMarker1032"/><span class="koboSpan" id="kobo.755.1"> script runs equally well with </span><code class="inlineCode"><span class="koboSpan" id="kobo.756.1">xdialog</span></code><span class="koboSpan" id="kobo.757.1"> on a machine that supports it.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.758.1">Next, let’s create something that will actually do some useful work for us.</span></p>
    <h2 id="_idParaDest-348" class="heading 2"><span class="koboSpan" id="kobo.759.1">Creating an SSH Login Interface</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.760.1">Let’s </span><a id="_idIndexMarker1033"/><span class="koboSpan" id="kobo.761.1">say that you have a fleet of Linux, Unix, or Unix-like servers that you need to administer remotely via SSH. </span><span class="koboSpan" id="kobo.761.2">Trying to keep track of the server IP addresses is a confusing mess, so you’ve decided to simplify things. </span><span class="koboSpan" id="kobo.761.3">You’ve decided to create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.762.1">xdialog-menu-test.sh</span></code><span class="koboSpan" id="kobo.763.1"> to help you out. </span><span class="koboSpan" id="kobo.763.2">It’s also too long to show here in its entirety, so I’ll break it up into sections. </span><span class="koboSpan" id="kobo.763.3">Here’s the top part:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.764.1">#!/bin/bash
command -v Xdialog
if [[ $? </span><span class="koboSpan" id="kobo.764.2">== 0 ]] &amp;&amp; [[ -n $DISPLAY ]]; then
        diag=Xdialog
else
        diag=dialog
fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.765.1">This is the same as it was in the previous script, so you already know about it. </span><span class="koboSpan" id="kobo.765.2">Here’s the next section:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.766.1">cmd=($diag --keep-tite --menu "Select options:" 22 76 16)
options=(1 "Remote SSH to Debian miner"
         2 "Remote SSH to Fedora miner"
         3 "Remote SSH to Fedora Workstation"
         4 "Remote SFTP to Fedora Workstation")
choices=$("${cmd[@]}" "${options[@]}" 2&gt;&amp;1 &gt;/dev/tty)
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.767.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.768.1">cmd=</span></code><span class="koboSpan" id="kobo.769.1"> line creates a command within a pair of parentheses, and then assigns that command to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.770.1">cmd</span></code><span class="koboSpan" id="kobo.771.1"> variable array. </span><span class="koboSpan" id="kobo.771.2">This command, which will be invoked in the final line of the script, will build either a </span><code class="inlineCode"><span class="koboSpan" id="kobo.772.1">dialog</span></code><span class="koboSpan" id="kobo.773.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.774.1">xdialog</span></code><span class="koboSpan" id="kobo.775.1"> menu window. </span><span class="koboSpan" id="kobo.775.2">According to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.776.1">dialog</span></code><span class="koboSpan" id="kobo.777.1"> man page, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.778.1">--keep-tite</span></code><span class="koboSpan" id="kobo.779.1"> option is desirable when running the</span><a id="_idIndexMarker1034"/><span class="koboSpan" id="kobo.780.1"> script in a graphical terminal emulator on a desktop machine, because it prevents the script from switching back and forth between the graphical terminal and the underlying shell terminal. </span><span class="koboSpan" id="kobo.780.2">After the </span><code class="inlineCode"><span class="koboSpan" id="kobo.781.1">--menu</span></code><span class="koboSpan" id="kobo.782.1"> option, we see the text that is to be displayed, the height and width of the menu box, followed by the maximum number of menu entries that will be displayed at a time. </span><span class="koboSpan" id="kobo.782.2">(In this example, the user would need to scroll down to see past the first 16 menu entries.) The menu entries would be designated with a tag and an item string. </span><span class="koboSpan" id="kobo.782.3">For example, the first menu entry we see has a </span><strong class="screenText"><span class="koboSpan" id="kobo.783.1">1</span></strong><span class="koboSpan" id="kobo.784.1"> as the tag, and </span><strong class="screenText"><span class="koboSpan" id="kobo.785.1">Remote SSH to Debian miner</span></strong><span class="koboSpan" id="kobo.786.1"> as the item.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.787.1">Next, we have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.788.1">options</span></code><span class="koboSpan" id="kobo.789.1"> stanza, which inserts all of the menu entries into an array. </span><span class="koboSpan" id="kobo.789.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.790.1">choices=</span></code><span class="koboSpan" id="kobo.791.1"> line uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.792.1">2&gt;&amp;1&gt;</span></code><span class="koboSpan" id="kobo.793.1"> redirection operator to dump the contents of the array onto the terminal screen (</span><code class="inlineCode"><span class="koboSpan" id="kobo.794.1">/dev/tty</span></code><span class="koboSpan" id="kobo.795.1">). </span><span class="koboSpan" id="kobo.795.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.796.1">@</span></code><span class="koboSpan" id="kobo.797.1"> in </span><code class="inlineCode"><span class="koboSpan" id="kobo.798.1">${options[@]}</span></code><span class="koboSpan" id="kobo.799.1"> is a form of variable expansion, because it allows an action to be carried out according to which menu item that a user chooses. </span><span class="koboSpan" id="kobo.799.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.800.1">@</span></code><span class="koboSpan" id="kobo.801.1"> represents the index number of the array item that corresponds with a menu choice.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.802.1">In </span><em class="chapterRef"><span class="koboSpan" id="kobo.803.1">Chapter 8, Basic Shell Script Construction</span></em><span class="koboSpan" id="kobo.804.1">, I showed you how to use either the </span><code class="inlineCode"><span class="koboSpan" id="kobo.805.1">*</span></code><span class="koboSpan" id="kobo.806.1"> or the </span><code class="inlineCode"><span class="koboSpan" id="kobo.807.1">@</span></code><span class="koboSpan" id="kobo.808.1"> in place of a specific index number to show all elements in an array. </span><span class="koboSpan" id="kobo.808.2">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.809.1">cmd=</span></code><span class="koboSpan" id="kobo.810.1"> line, each component of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.811.1">$diag --keep-tite --menu "Select options:" 22 76 16</span></code><span class="koboSpan" id="kobo.812.1"> command that’s within the parentheses is a separate element of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.813.1">cmd</span></code><span class="koboSpan" id="kobo.814.1"> array. </span><span class="koboSpan" id="kobo.814.2">For this reason, we need to use either the </span><code class="inlineCode"><span class="koboSpan" id="kobo.815.1">*</span></code><span class="koboSpan" id="kobo.816.1"> or the </span><code class="inlineCode"><span class="koboSpan" id="kobo.817.1">@</span></code><span class="koboSpan" id="kobo.818.1"> as the index for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.819.1">cmd</span></code><span class="koboSpan" id="kobo.820.1"> array in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.821.1">choices=</span></code><span class="koboSpan" id="kobo.822.1"> line at the bottom, so that the entire command will get invoked. </span><span class="koboSpan" id="kobo.822.2">The same thing is true for the list of options that get assigned to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.823.1">options</span></code><span class="koboSpan" id="kobo.824.1"> array in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.825.1">options=</span></code><span class="koboSpan" id="kobo.826.1"> line, as you’ll see in a moment.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.827.1">Now that we have a menu, we need to make it do something. </span><span class="koboSpan" id="kobo.827.2">That comes in the next section, which you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.828.1">for choice in $choices
do
    case $choice in
        1)
            ssh donnie@192.168.0.3
            ;;
        2)
            ssh donnie@192.168.0.12
            ;;
        3)
            ssh donnie@192.168.0.16
            ;;
        4)
            sftp donnie@192.168.0.16
            ;;
    esac
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.829.1">This is</span><a id="_idIndexMarker1035"/><span class="koboSpan" id="kobo.830.1"> nothing that you haven’t seen before. </span><span class="koboSpan" id="kobo.830.2">It’s just a normal </span><code class="inlineCode"><span class="koboSpan" id="kobo.831.1">for</span></code><span class="koboSpan" id="kobo.832.1"> loop that operates a </span><code class="inlineCode"><span class="koboSpan" id="kobo.833.1">case..esac</span></code><span class="koboSpan" id="kobo.834.1"> construct. </span><span class="koboSpan" id="kobo.834.2">What is a bit different is that the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.835.1">choices</span></code><span class="koboSpan" id="kobo.836.1"> variable is the index number of the array item that corresponds with the chosen menu item. </span><span class="koboSpan" id="kobo.836.2">Each of the listed options in the options array consists of a number, followed by a complete phrase, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.837.1">1 "Remote SSH to Debian miner"</span></code><span class="koboSpan" id="kobo.838.1">. </span><span class="koboSpan" id="kobo.838.2">In this example, the number 1 represents element number 0 of the options array, and the following words in the phrase represent elements 1 through 5. </span><span class="koboSpan" id="kobo.838.3">In order for the options to properly display in the menu, you’ll have to invoke the array with either </span><code class="inlineCode"><span class="koboSpan" id="kobo.839.1">*</span></code><span class="koboSpan" id="kobo.840.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.841.1">@</span></code><span class="koboSpan" id="kobo.842.1"> in place of the index number. </span><span class="koboSpan" id="kobo.842.2">Here’s the complete line where that happens:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.843.1">choices=$("${cmd[@]}" "${options[@]}" 2&gt;&amp;1 &gt;/dev/tty)
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.844.1">Since only one index value is ever assigned to </span><code class="inlineCode"><span class="koboSpan" id="kobo.845.1">choices</span></code><span class="koboSpan" id="kobo.846.1">, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.847.1">for</span></code><span class="koboSpan" id="kobo.848.1"> loop exits after its first run.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.849.1">Now that everything is built, let’s see if it works. </span><span class="koboSpan" id="kobo.849.2">Here’s how it looks using </span><code class="inlineCode"><span class="koboSpan" id="kobo.850.1">xdialog</span></code><span class="koboSpan" id="kobo.851.1"> on GhostBSD with the Mate desktop:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.852.1"><img src="../Images/B21693_16_17.png" alt="B21693_16_17"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.853.1">Figure 16.17: The xdialog-menu-test.sh script on GhostBSD</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.854.1">And, here’s </span><a id="_idIndexMarker1036"/><span class="koboSpan" id="kobo.855.1">the exact same script on Fedora with </span><code class="inlineCode"><span class="koboSpan" id="kobo.856.1">dialog</span></code><span class="koboSpan" id="kobo.857.1">:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.858.1"><img src="../Images/B21693_16_18.png" alt="B21693_16_18"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.859.1">Figure 16.18: The xdialog-menu-test.sh script on Fedora with dialog</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.860.1">When </span><a id="_idIndexMarker1037"/><span class="koboSpan" id="kobo.861.1">you choose a menu item, the script will open a remote login prompt in the terminal, and then exit. </span><span class="koboSpan" id="kobo.861.2">That’s okay, because if you want to connect to multiple remote servers at once, you’ll need to open other terminals anyway.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.862.1">Of course, you can fancy this script up to make it even more functional. </span><span class="koboSpan" id="kobo.862.2">For example, you can configure your SSH client to use different profiles or different encryption keys for different server sessions, and modify the commands in the menu accordingly. </span><span class="koboSpan" id="kobo.862.3">Or, you can use this as a template for something else altogether. </span><span class="koboSpan" id="kobo.862.4">As I keep saying, let your imagination run wild!</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.863.1">All right, I think that this about does it for </span><code class="inlineCode"><span class="koboSpan" id="kobo.864.1">yad</span></code><span class="koboSpan" id="kobo.865.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.866.1">dialog</span></code><span class="koboSpan" id="kobo.867.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.868.1">xdialog</span></code><span class="koboSpan" id="kobo.869.1">. </span><span class="koboSpan" id="kobo.869.2">Let’s wrap up and move on.</span></p>
    <h1 id="_idParaDest-349" class="heading 1"><span class="koboSpan" id="kobo.870.1">Summary</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.871.1">As always, we’ve covered a lot of ground in this chapter, and saw some cool stuff. </span><span class="koboSpan" id="kobo.871.2">We began with a discussion of </span><code class="inlineCode"><span class="koboSpan" id="kobo.872.1">yad</span></code><span class="koboSpan" id="kobo.873.1">, and how to use it to create graphical user interfaces for shell scripts. </span><span class="koboSpan" id="kobo.873.2">We then looked at how to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.874.1">dialog</span></code><span class="koboSpan" id="kobo.875.1"> to create user interfaces for text-mode environments, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.876.1">xdialog</span></code><span class="koboSpan" id="kobo.877.1"> for graphical environments. </span><span class="koboSpan" id="kobo.877.2">As an added bonus, you saw how to create scripts that will run with </span><code class="inlineCode"><span class="koboSpan" id="kobo.878.1">xdialog</span></code><span class="koboSpan" id="kobo.879.1"> on machines that support it, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.880.1">dialog</span></code><span class="koboSpan" id="kobo.881.1"> on machines that don’t.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.882.1">These actually aren’t the only three utilities that you can use to create user interfaces for your scripts. </span><span class="koboSpan" id="kobo.882.2">Other choices include </span><code class="inlineCode"><span class="koboSpan" id="kobo.883.1">whiptail</span></code><span class="koboSpan" id="kobo.884.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.885.1">cdialog</span></code><span class="koboSpan" id="kobo.886.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.887.1">zenity</span></code><span class="koboSpan" id="kobo.888.1">. </span><span class="koboSpan" id="kobo.888.2">The good news is that once you’ve learned one, switching to another is fairly easy.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.889.1">Now, you can do more with these utilities than I’ve been able to show you here. </span><span class="koboSpan" id="kobo.889.2">On the other hand, none of these utilities is suitable for creating anything that’s really complex. </span><span class="koboSpan" id="kobo.889.3">For that, you’ll need to learn a more complex programming language. </span><span class="koboSpan" id="kobo.889.4">Regardless, if all you need is a simple interface to make things easier for either yourself or for your users, these utilities can fill the bill.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.890.1">In the next chapter, we’ll look at how to run shell scripts with option switches. </span><span class="koboSpan" id="kobo.890.2">I’ll see you there.</span></p>
    <h1 id="_idParaDest-350" class="heading 1"><span class="koboSpan" id="kobo.891.1">Questions</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.892.1">You want to create a graphical user interface for a shell script that will run on a wide variety of Linux, Unix, and Unix-like operating systems. </span><span class="koboSpan" id="kobo.892.2">Which of the follow utilities would you use for best availability?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.893.1">zenity</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.894.1">cdialog</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.895.1">xdialog</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.896.1">yad</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.897.1">Which of the following statements is true about this code snippet?</span></li>
    </ol>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.898.1">command -v Xdialog
if [[ -n $DISPLAY ]] &amp;&amp; [[ $? </span><span class="koboSpan" id="kobo.898.2">== 0 ]]; then
        diag=Xdialog
else
        diag=dialog
fi
</span></code></pre>
    <ol>
      <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.899.1">It’s good code, and will work just fine.</span></li>
      <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.900.1">It won’t work, because it uses the wrong method to detect if the </span><code class="inlineCode"><span class="koboSpan" id="kobo.901.1">Xdialog</span></code><span class="koboSpan" id="kobo.902.1"> executable is present.</span></li>
      <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.903.1">It won’t work, because it’s not possible to detect if a certain executable is present.</span></li>
      <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.904.1">It won’t work, because having the </span><code class="inlineCode"><span class="koboSpan" id="kobo.905.1">[[ -n $DISPLAY ]]</span></code><span class="koboSpan" id="kobo.906.1"> test come first ensures that </span><code class="inlineCode"><span class="koboSpan" id="kobo.907.1">$?</span></code><span class="koboSpan" id="kobo.908.1"> always returns a value of 0.</span></li>
    </ol>
    <h1 id="_idParaDest-351" class="heading 1"><span class="koboSpan" id="kobo.909.1">Further Reading</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.910.1">Dress Up Bash Scripts with YAD: </span><a href="https://www.linux-magazine.com/Online/Blogs/Productivity-Sauce/Dress-Up-Bash-Scripts-with-YAD"><span class="url"><span class="koboSpan" id="kobo.911.1">https://www.linux-magazine.com/Online/Blogs/Productivity-Sauce/Dress-Up-Bash-Scripts-with-YAD</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.912.1">YAD Guide: </span><a href="https://yad-guide.ingk.se/"><span class="url"><span class="koboSpan" id="kobo.913.1">https://yad-guide.ingk.se/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.914.1">How to use ncurses widgets in shell scripts on Linux: </span><a href="https://linuxconfig.org/how-to-use-ncurses-widgets-in-shell-scripts-on-linux"><span class="url"><span class="koboSpan" id="kobo.915.1">https://linuxconfig.org/how-to-use-ncurses-widgets-in-shell-scripts-on-linux</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.916.1">Designing Simple front ends with dialog/Xdialog: </span><a href="https://linuxgazette.net/101/sunil.html"><span class="url"><span class="koboSpan" id="kobo.917.1">https://linuxgazette.net/101/sunil.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.918.1">Adding dialog boxes to shell scripts: </span><a href="https://www.linux-magazine.com/Issues/2019/228/Let-s-Dialog"><span class="url"><span class="koboSpan" id="kobo.919.1">https://www.linux-magazine.com/Issues/2019/228/Let-s-Dialog</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.920.1">Menu Driven Shell Script - Using Dialog Utility: </span><a href="http://web.archive.org/web/20120318060251/http://www.bashguru.com/2011/01/menu-driven-shell-script-using-dialog.html"><span class="url"><span class="koboSpan" id="kobo.921.1">http://web.archive.org/web/20120318060251/http://www.bashguru.com/2011/01/menu-driven-shell-script-using-dialog.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.922.1">Xdialog Documentation: </span><a href="http://web.mit.edu/outland/share/doc/Xdialog-2.1.2/"><span class="url"><span class="koboSpan" id="kobo.923.1">http://web.mit.edu/outland/share/doc/Xdialog-2.1.2/</span></span></a></li>
    </ul>
    <h1 id="_idParaDest-352" class="heading 1"><span class="koboSpan" id="kobo.924.1">Answers</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.925.1">c</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.926.1">d</span></li>
    </ol>
    <h1 id="_idParaDest-353" class="heading 1"><span class="koboSpan" id="kobo.927.1">Join our community on Discord!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.928.1">Read this book alongside other users, Linux experts, and the author himself. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.929.1">Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. </span><span class="koboSpan" id="kobo.929.2">Scan the QR code or visit the link to join the community.</span></p>
    <p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.930.1">https://packt.link/SecNet</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.931.1"><img src="../Images/QR_Code10596186092701843.png" alt=""/></span></p>
  </div>
</body></html>