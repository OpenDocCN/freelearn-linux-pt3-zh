<html><head></head><body>
  <div id="_idContainer140" class="Basic-Text-Frame">
    <h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">9</span></h1>
    <h1 id="_idParaDest-182" class="chapterTitle"><span class="koboSpan" id="kobo.2.1">Filtering Text with grep, sed, and Regular Expressions</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.3.1">So far, we’ve looked at how to perform file searches with </span><code class="inlineCode"><span class="koboSpan" id="kobo.4.1">find</span></code><span class="koboSpan" id="kobo.5.1">, and at how to use text-stream filter utilities to extract and present data from text files and program output streams. </span><span class="koboSpan" id="kobo.5.2">In this chapter we’ll be looking at two other utilities, </span><code class="inlineCode"><span class="koboSpan" id="kobo.6.1">sed</span></code><span class="koboSpan" id="kobo.7.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.8.1">grep</span></code><span class="koboSpan" id="kobo.9.1">, that will allow you to supercharge both your searches and your text manipulations. </span><span class="koboSpan" id="kobo.9.2">Before that though, you need to understand about Regular Expressions.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.10.1">Topics in this chapter include:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.11.1">Understanding Regular Expressions</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.12.1">Understanding </span><code class="inlineCode"><span class="koboSpan" id="kobo.13.1">sed</span></code></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.14.1">Understanding </span><code class="inlineCode"><span class="koboSpan" id="kobo.15.1">grep</span></code></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.16.1">Using RegEx Buddy</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.17.1">Using RegEx101</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.18.1">Looking at some real-world examples</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.19.1">If you’re ready, let’s get started.</span></p>
    <h1 id="_idParaDest-183" class="heading 1"><span class="koboSpan" id="kobo.20.1">Technical Requirements</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.21.1">Use any of your Linux virtual machines or your Linux host machine.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.22.1">Also, as always, you can grab the scripts and text files from Github, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.23.1">git clone https://github.com/PacktPublishing/The-Ultimate-Linux-Shell-Scripting-Guide.git
</span></code></pre>
    <h1 id="_idParaDest-184" class="heading 1"><span class="koboSpan" id="kobo.24.1">Understanding Regular Expressions</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.25.1">When you worked with the text-stream filters in </span><em class="chapterRef"><span class="koboSpan" id="kobo.26.1">Chapter 6, Text Stream Filters Part 1</span></em><span class="koboSpan" id="kobo.27.1"> and </span><em class="chapterRef"><span class="koboSpan" id="kobo.28.1">Chapter 7, Text Stream Filters Part 2</span></em><span class="koboSpan" id="kobo.29.1">, you were manipulating simple text strings. </span><span class="koboSpan" id="kobo.29.2">That is, you were working with alphabetic characters, numbers, and the control characters that allow you to place tabs, spaces, and newlines into your text files. </span><strong class="keyWord"><span class="koboSpan" id="kobo.30.1">Regular Expressions</span></strong><span class="koboSpan" id="kobo.31.1">, which </span><a id="_idIndexMarker553"/><span class="koboSpan" id="kobo.32.1">you’ll sometimes see shortened to </span><a id="_idIndexMarker554"/><span class="koboSpan" id="kobo.33.1">either </span><strong class="keyWord"><span class="koboSpan" id="kobo.34.1">regexp</span></strong><span class="koboSpan" id="kobo.35.1"> or </span><strong class="keyWord"><span class="koboSpan" id="kobo.36.1">regex</span></strong><span class="koboSpan" id="kobo.37.1">, can include text strings, or</span><a id="_idIndexMarker555"/><span class="koboSpan" id="kobo.38.1"> even be a text string. </span><span class="koboSpan" id="kobo.38.2">They can also include special characters, collectively</span><a id="_idIndexMarker556"/><span class="koboSpan" id="kobo.39.1"> called </span><strong class="keyWord"><span class="koboSpan" id="kobo.40.1">metacharacters</span></strong><span class="koboSpan" id="kobo.41.1">, which give such awesome power to the tools that understand them. </span><span class="koboSpan" id="kobo.41.2">In fact, you can think of Regular Expressions as a sort of programming language, with text strings as the words and metacharacters as the punctuation. </span><span class="koboSpan" id="kobo.41.3">Rather than just enabling you to search for simple text strings, regular expressions allow you to search for patterns. </span><span class="koboSpan" id="kobo.41.4">For example, if you need to search through a file for all telephone numbers or all credit card numbers, you can create a regular expression that searches for text strings that match those patterns.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.42.1">I need to clarify something that’s a bit confusing. </span><em class="italic"><span class="koboSpan" id="kobo.43.1">Regular Expressions</span></em><span class="koboSpan" id="kobo.44.1">, always written in the plural form and with upper-case letters beginning each word, is the name of the pattern-matching language. </span><span class="koboSpan" id="kobo.44.2">That’s different from a </span><em class="italic"><span class="koboSpan" id="kobo.45.1">regular expression</span></em><span class="koboSpan" id="kobo.46.1">, which is a pattern-matching construct that you would build with the </span><em class="italic"><span class="koboSpan" id="kobo.47.1">Regular Expressions</span></em><span class="koboSpan" id="kobo.48.1"> language.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.49.1">Understand, though, that the topic of Regular Expressions</span><code class="inlineCode"> </code><span class="koboSpan" id="kobo.50.1">is a huge one, and is a topic about which whole books are written. </span><span class="koboSpan" id="kobo.50.2">For now, I’ll just give you the basics that you need to understand how to use them with </span><code class="inlineCode"><span class="koboSpan" id="kobo.51.1">grep</span></code><span class="koboSpan" id="kobo.52.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.53.1">sed</span></code><span class="koboSpan" id="kobo.54.1">. </span><span class="koboSpan" id="kobo.54.2">Let’s begin by looking at the two general types of characters that you would use in a regular expression.</span></p>
    <h2 id="_idParaDest-185" class="heading 2"><span class="koboSpan" id="kobo.55.1">Literals and Metacharacters</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.56.1">There are two types of characters that you’ll use in regular expressions. </span><strong class="keyWord"><span class="koboSpan" id="kobo.57.1">Literals</span></strong><span class="koboSpan" id="kobo.58.1"> are any </span><a id="_idIndexMarker557"/><span class="koboSpan" id="kobo.59.1">character which is to be taken literally. </span><span class="koboSpan" id="kobo.59.2">In other words, literals are anything that you want to treat as just plain text. </span><strong class="keyWord"><span class="koboSpan" id="kobo.60.1">Metacharacters</span></strong><span class="koboSpan" id="kobo.61.1"> give you the ability to modify your pattern-matching </span><a id="_idIndexMarker558"/><span class="koboSpan" id="kobo.62.1">according to your needs. </span><span class="koboSpan" id="kobo.62.2">You can, for example, use metacharacters to find a text pattern that occurs at either the beginning or end of a line, while leaving the pattern alone if it occurs somewhere else in the line. </span><span class="koboSpan" id="kobo.62.3">You can also use metacharacters to perform different types of wild-card pattern-matching. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.63.1">There are three types of metacharacters, which are:</span></p>
    <ul>
      <li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.64.1">Positional anchors</span></strong><span class="koboSpan" id="kobo.65.1">: These </span><a id="_idIndexMarker559"/><span class="koboSpan" id="kobo.66.1">define where in either a</span><a id="_idIndexMarker560"/><span class="koboSpan" id="kobo.67.1"> file or a line that you would want to find a match.</span></li>
      <li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.68.1">Character sets</span></strong><span class="koboSpan" id="kobo.69.1">: These</span><a id="_idIndexMarker561"/><span class="koboSpan" id="kobo.70.1"> define either a range or a specific </span><a id="_idIndexMarker562"/><span class="koboSpan" id="kobo.71.1">type of literal character that you want to match. </span><span class="koboSpan" id="kobo.71.2">In other words, if you want to find a text string that contains nothing but lower-case letters, you don’t have to list each lower-case letter in your regular expression. </span><span class="koboSpan" id="kobo.71.3">Instead, just use the lower-case letter character set.</span></li>
      <li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.72.1">Modifiers</span></strong><span class="koboSpan" id="kobo.73.1">: Mainly, these </span><a id="_idIndexMarker563"/><span class="koboSpan" id="kobo.74.1">metacharacters allow </span><a id="_idIndexMarker564"/><span class="koboSpan" id="kobo.75.1">you to define how many of any literal character or string of literal characters that you want to match at a time. </span><span class="koboSpan" id="kobo.75.2">The other modifiers are the or operator and the grouping operator.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.76.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.77.1">positional anchors</span></strong><span class="koboSpan" id="kobo.78.1">, are </span><a id="_idIndexMarker565"/><span class="koboSpan" id="kobo.79.1">as you see in the</span><a id="_idIndexMarker566"/><span class="koboSpan" id="kobo.80.1"> following table:</span></p>
    <table id="table001-5" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.81.1">Positional anchor</span></strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.82.1">Description</span></strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.83.1">^</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.84.1">This </span><a id="_idIndexMarker567"/><span class="koboSpan" id="kobo.85.1">allows you to match a pattern that occurs at the beginning of a line. </span><span class="koboSpan" id="kobo.85.2">You would always place it to the left of the pattern that you want to match, like this: </span><code class="inlineCode"><span class="koboSpan" id="kobo.86.1">^pattern</span></code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.87.1">$</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.88.1">This allows you to match a pattern that occurs at the end of a line. </span><span class="koboSpan" id="kobo.88.2">You would always place it to the right of the pattern that you want to match, like this: </span><code class="inlineCode"><span class="koboSpan" id="kobo.89.1">pattern$</span></code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.90.1">\&lt;pattern\&gt;</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.91.1">This pair of symbols marks word boundaries. </span><span class="koboSpan" id="kobo.91.2">For example, if you were to search for the pattern </span><em class="italic"><span class="koboSpan" id="kobo.92.1">and</span></em><span class="koboSpan" id="kobo.93.1">, use of this metacharacter would only match with</span><a id="_idIndexMarker568"/><span class="koboSpan" id="kobo.94.1"> the whole word </span><em class="italic"><span class="koboSpan" id="kobo.95.1">and</span></em><span class="koboSpan" id="kobo.96.1">, instead of with any word that contains the text string </span><em class="italic"><span class="koboSpan" id="kobo.97.1">and</span></em><span class="koboSpan" id="kobo.98.1">.</span></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal"><span class="koboSpan" id="kobo.99.1">The following table explains the about the </span><a id="_idIndexMarker569"/><span class="koboSpan" id="kobo.100.1">various </span><strong class="keyWord"><span class="koboSpan" id="kobo.101.1">character sets</span></strong><span class="koboSpan" id="kobo.102.1">.</span></p>
    <table id="table002" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.103.1">Character set examples</span></strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.104.1">Description</span></strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.105.1">[abc]</span></code></p>
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.106.1">[a-z]</span></code></p>
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.107.1">[:lower:]</span></code></p>
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.108.1">[:digit:]</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.109.1">This should </span><a id="_idIndexMarker570"/><span class="koboSpan" id="kobo.110.1">already be familiar to you. </span><span class="koboSpan" id="kobo.110.2">This defines either a set of characters or a range of characters to match in a pattern. </span><span class="koboSpan" id="kobo.110.3">You can also use the same character classes that you used with the text-stream filters.</span></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.111.1">[^abc]</span></code></p>
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.112.1">[^a-z]</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.113.1">In the previous table, I showed you how the </span><code class="inlineCode"><span class="koboSpan" id="kobo.114.1">^</span></code><span class="koboSpan" id="kobo.115.1"> can be used as a positional anchor. </span><span class="koboSpan" id="kobo.115.2">But, when used as the first character of a character set, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.116.1">^</span></code><span class="koboSpan" id="kobo.117.1"> acts as a negation operator. </span><span class="koboSpan" id="kobo.117.2">So, while </span><code class="inlineCode"><span class="koboSpan" id="kobo.118.1">[abc] </span></code><span class="koboSpan" id="kobo.119.1">matches everything with an a, b, or c in it, </span><code class="inlineCode"><span class="koboSpan" id="kobo.120.1">[^abc]</span></code><span class="koboSpan" id="kobo.121.1"> matches everything without an a, b, or c in it.</span></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal"><span class="koboSpan" id="kobo.122.1">The final type of </span><a id="_idIndexMarker571"/><span class="koboSpan" id="kobo.123.1">metacharacters consists</span><a id="_idIndexMarker572"/><span class="koboSpan" id="kobo.124.1"> of the </span><strong class="keyWord"><span class="koboSpan" id="kobo.125.1">modifiers</span></strong><span class="koboSpan" id="kobo.126.1">, as you see in this table:</span></p>
    <table id="table003" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.127.1">Basic modifier</span></strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.128.1">Extended modifier</span></strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.129.1">Description</span></strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.130.1">*</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.131.1">*</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.132.1">Wild-card to match zero or more of the single character or single-character regular expression that precedes it. </span><span class="koboSpan" id="kobo.132.2">Note that this behavior is different from what you’re used to seeing with </span><code class="inlineCode"><span class="koboSpan" id="kobo.133.1">*</span></code><span class="koboSpan" id="kobo.134.1"> in normal command-line operations, in commands such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.135.1">ls -l *.txt</span></code><span class="koboSpan" id="kobo.136.1">.</span></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.137.1">\?</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.138.1">?</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.139.1">Wild-card to match zero or one instance of the preceding single character or regular expression.</span></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.140.1">\+</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.141.1">+</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.142.1">A wild-card that must have a match. </span><span class="koboSpan" id="kobo.142.2">Matches one or more instances of the preceding single character or regular expression.</span></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.143.1">\{n\}</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.144.1">{n}</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.145.1">Matches </span><em class="italic"><span class="koboSpan" id="kobo.146.1">n</span></em><span class="koboSpan" id="kobo.147.1"> occurrences of the preceding single character or regular expression.</span></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.148.1">\{n,\}</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.149.1">{n,}</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.150.1">Matches at least </span><em class="italic"><span class="koboSpan" id="kobo.151.1">n</span></em><span class="koboSpan" id="kobo.152.1"> occurrences of the preceding single character or regular expression.</span></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.153.1">\|</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.154.1">|</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.155.1">It’s called an </span><strong class="keyWord"><span class="koboSpan" id="kobo.156.1">alternation</span></strong><span class="koboSpan" id="kobo.157.1">, but think of it as an </span><code class="inlineCode"><span class="koboSpan" id="kobo.158.1">or </span></code><span class="koboSpan" id="kobo.159.1">operator.</span></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.160.1">\(regex\)</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.161.1">(regex)</span></code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.162.1">This</span><a id="_idIndexMarker573"/><span class="koboSpan" id="kobo.163.1"> symbolizes grouping. </span><span class="koboSpan" id="kobo.163.2">It matches the regex that’s within the parentheses, but it can be modified as a whole. </span><span class="koboSpan" id="kobo.163.3">It can also be used in </span><a id="_idIndexMarker574"/><span class="koboSpan" id="kobo.164.1">back-references.</span></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal"><span class="koboSpan" id="kobo.165.1">Don’t worry about the difference between the </span><strong class="keyWord"><span class="koboSpan" id="kobo.166.1">Basic Modifiers</span></strong><span class="koboSpan" id="kobo.167.1"> and </span><strong class="keyWord"><span class="koboSpan" id="kobo.168.1">Extended Modifiers</span></strong><span class="koboSpan" id="kobo.169.1"> just yet. </span><span class="koboSpan" id="kobo.169.2">I’ll cover that when we get to the </span><em class="chapterRef"><span class="koboSpan" id="kobo.170.1">Understanding grep </span></em><span class="koboSpan" id="kobo.171.1">section.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.172.1">As I said before, the topic of Regular Expressions is quite vast and complex. </span><span class="koboSpan" id="kobo.172.2">I don’t have space to give a complete tutorial on the subject, so I’ll instead just provide examples of using various regular expressions in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.173.1">sed</span></code><span class="koboSpan" id="kobo.174.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.175.1">grep</span></code><span class="koboSpan" id="kobo.176.1"> sections.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.177.1">You can find some more information on regular expressions by looking at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.178.1">regex</span></code><span class="koboSpan" id="kobo.179.1"> man page, which is in section 7 of the man pages. </span><span class="koboSpan" id="kobo.179.2">(Just don’t expect to become a regex expert by reading it.) View the proper man page by doing:</span></p>
      <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.180.1">man 7 regex</span></code></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.181.1">Now that I’ve introduced you to Regular Expressions and regular expressions, allow me to introduce you to a utility that uses them.</span></p>
    <h1 id="_idParaDest-186" class="heading 1"><span class="koboSpan" id="kobo.182.1">Understanding sed</span></h1>
    <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.183.1">sed</span></code><span class="koboSpan" id="kobo.184.1">, short for </span><strong class="keyWord"><span class="koboSpan" id="kobo.185.1">Stream Editor</span></strong><span class="koboSpan" id="kobo.186.1">, is an</span><a id="_idIndexMarker575"/><span class="koboSpan" id="kobo.187.1"> extremely powerful utility, and is another subject on which whole books are written. </span><span class="koboSpan" id="kobo.187.2">The goal here is to help you learn the basics for now, and to whet your appetite to learn more later.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.188.1">If you’ve ever had to error-check or edit large text documents, you’ll appreciate the power of </span><code class="inlineCode"><span class="koboSpan" id="kobo.189.1">sed</span></code><span class="koboSpan" id="kobo.190.1">. </span><span class="koboSpan" id="kobo.190.2">For simple jobs, a one-line command, known</span><a id="_idIndexMarker576"/><span class="koboSpan" id="kobo.191.1"> as a </span><strong class="keyWord"><span class="koboSpan" id="kobo.192.1">sed script</span></strong><span class="koboSpan" id="kobo.193.1">, might be all you need. </span><span class="koboSpan" id="kobo.193.2">For more complex jobs, such as when you might need to make multiple changes at a time to one or more documents, you can write lengthy program files and execute them with </span><code class="inlineCode"><span class="koboSpan" id="kobo.194.1">sed</span></code><span class="koboSpan" id="kobo.195.1">. </span><span class="koboSpan" id="kobo.195.2">The only limitation is your own imagination. </span><span class="koboSpan" id="kobo.195.3">But, before we can talk about the cool things you can do with </span><code class="inlineCode"><span class="koboSpan" id="kobo.196.1">sed</span></code><span class="koboSpan" id="kobo.197.1">, we need to take a brief intermission to talk about </span><code class="inlineCode"><span class="koboSpan" id="kobo.198.1">sed</span></code><span class="koboSpan" id="kobo.199.1"> portability issues.</span></p>
    <h2 id="_idParaDest-187" class="heading 2"><span class="koboSpan" id="kobo.200.1">Understanding sed Portability Issues</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.201.1">If you need to work with</span><a id="_idIndexMarker577"/><span class="koboSpan" id="kobo.202.1"> non-Linux operating systems, you’ll encounter two different implementations of </span><code class="inlineCode"><span class="koboSpan" id="kobo.203.1">sed</span></code><span class="koboSpan" id="kobo.204.1">. </span><span class="koboSpan" id="kobo.204.2">Linux operating systems use the GNU implementation, and the BSD implementation is used on macOS, the BSD distros, and OpenIndiana.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.205.1">BSD </span><a id="_idIndexMarker578"/><span class="koboSpan" id="kobo.206.1">stands for </span><strong class="keyWord"><span class="koboSpan" id="kobo.207.1">Berkeley Software Distribution</span></strong><span class="koboSpan" id="kobo.208.1">, and GNU is a recursive acronym that stands for </span><strong class="keyWord"><span class="koboSpan" id="kobo.209.1">GNU is not Unix</span></strong><span class="koboSpan" id="kobo.210.1">.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.211.1">The difference is that the GNU implementation has really cool, advanced features that the BSD implementation lacks. </span><span class="koboSpan" id="kobo.211.2">So, many of the examples that I’m about to show you in this section—specifically the append (</span><code class="inlineCode"><span class="koboSpan" id="kobo.212.1">a)</span></code><span class="koboSpan" id="kobo.213.1">, insert (</span><code class="inlineCode"><span class="koboSpan" id="kobo.214.1">i)</span></code><span class="koboSpan" id="kobo.215.1">, and change (</span><code class="inlineCode"><span class="koboSpan" id="kobo.216.1">c)</span></code><span class="koboSpan" id="kobo.217.1"> commands, as well as any command that uses a regular expression—won’t work on the BSD implementation. </span><span class="koboSpan" id="kobo.217.2">Fortunately though, there’s an easy fix for all of these operating</span><a id="_idIndexMarker579"/><span class="koboSpan" id="kobo.218.1"> systems. </span><span class="koboSpan" id="kobo.218.2">Just install the </span><code class="inlineCode"><span class="koboSpan" id="kobo.219.1">gsed</span></code><span class="koboSpan" id="kobo.220.1"> package, and then create a </span><code class="inlineCode"><span class="koboSpan" id="kobo.221.1">sed</span></code><span class="koboSpan" id="kobo.222.1"> alias that points to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.223.1">gsed</span></code><span class="koboSpan" id="kobo.224.1"> executable. </span><span class="koboSpan" id="kobo.224.2">Here are the directions for the various operating systems.</span></p>
    <h3 id="_idParaDest-188" class="heading 3"><span class="koboSpan" id="kobo.225.1">Installing gsed on FreeBSD</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.226.1">On </span><a id="_idIndexMarker580"/><span class="koboSpan" id="kobo.227.1">FreeBSD, install </span><code class="inlineCode"><span class="koboSpan" id="kobo.228.1">gsed</span></code><span class="koboSpan" id="kobo.229.1"> like </span><a id="_idIndexMarker581"/><span class="koboSpan" id="kobo.230.1">this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.231.1">donnie@freebsd14:~ $ sudo pkg install gsed
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.232.1">Then, edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.233.1">.shrc</span></code><span class="koboSpan" id="kobo.234.1"> file that’s in your home directory, adding the following line to the alias section:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.235.1">alias sed='/usr/local/bin/gsed'
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.236.1">Log out of the terminal and then log back in again. </span><span class="koboSpan" id="kobo.236.2">Verify that the alias has taken effect by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.237.1">donnie@freebsd14:~ $ type sed
sed is an alias for /usr/local/bin/gsed
donnie@freebsd14:~ $
</span></code></pre>
    <h3 id="_idParaDest-189" class="heading 3"><span class="koboSpan" id="kobo.238.1">Installing gsed on macOS</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.239.1">Installing </span><code class="inlineCode"><span class="koboSpan" id="kobo.240.1">gsed</span></code><span class="koboSpan" id="kobo.241.1"> on</span><a id="_idIndexMarker582"/><span class="koboSpan" id="kobo.242.1"> macOS is just as easy, but you’ll first need to</span><a id="_idIndexMarker583"/><span class="koboSpan" id="kobo.243.1"> install the Homebrew system.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.244.1">You’ll find directions on how to install Homebrew</span><a id="_idIndexMarker584"/><span class="koboSpan" id="kobo.245.1"> at: </span><a href="https://brew.sh/"><span class="url"><span class="koboSpan" id="kobo.246.1">https://brew.sh/</span></span></a></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.247.1">Then, install </span><code class="inlineCode"><span class="koboSpan" id="kobo.248.1">gsed</span></code><span class="koboSpan" id="kobo.249.1"> by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.250.1">macmini@MacMinis-Mac-mini ~ % brew install gsed
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.251.1">Add the alias to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.252.1">.zprofile</span></code><span class="koboSpan" id="kobo.253.1"> file that’s in your home directory, by adding this line:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.254.1">alias sed='/usr/local/bin/gsed'
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.255.1">Close your terminal </span><a id="_idIndexMarker585"/><span class="koboSpan" id="kobo.256.1">window and then open it again. </span><span class="koboSpan" id="kobo.256.2">Then, verify that the alias</span><a id="_idIndexMarker586"/><span class="koboSpan" id="kobo.257.1"> has taken effect:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.258.1">macmini@MacMinis-Mac-mini ~ % type sed
sed is an alias for /usr/local/bin/gsed
macmini@MacMinis-Mac-mini ~ %
</span></code></pre>
    <h3 id="_idParaDest-190" class="heading 3"><span class="koboSpan" id="kobo.259.1">Installing gsed on OpenIndiana</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.260.1">OpenIndiana</span><a id="_idIndexMarker587"/><span class="koboSpan" id="kobo.261.1"> doesn’t have </span><code class="inlineCode"><span class="koboSpan" id="kobo.262.1">gsed</span></code><span class="koboSpan" id="kobo.263.1"> in its normal software </span><a id="_idIndexMarker588"/><span class="koboSpan" id="kobo.264.1">repository. </span><span class="koboSpan" id="kobo.264.2">So, you’ll need to install a third-party repository to get it. </span><span class="koboSpan" id="kobo.264.3">First, open Firefox on your OpenIndiana machine and navigate to: </span><a href="http://buildfarm.opencsw.org/opencsw/official/"><span class="url"><span class="koboSpan" id="kobo.265.1">http://buildfarm.opencsw.org/opencsw/official/</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.266.1">Download the the </span><code class="inlineCode"><span class="koboSpan" id="kobo.267.1">pkgutil.pkg</span></code><span class="koboSpan" id="kobo.268.1"> file that you’ll see there.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.269.1">Install the package by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.270.1">donnie@openindiana:~$ sudo pkgadd -d ./pkgutil.pkg
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.271.1">This will install </span><code class="inlineCode"><span class="koboSpan" id="kobo.272.1">pkgutil</span></code><span class="koboSpan" id="kobo.273.1"> into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.274.1">/opt/csw/bin</span></code><span class="koboSpan" id="kobo.275.1">/ directory, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.276.1">donnie@openindiana:/opt/csw/bin$ ls -l
total 209
-rwxr-xr-x   1 root     bin       106397 Nov 12  2013 pkgutil
donnie@openindiana:/opt/csw/bin$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.277.1">This directory isn’t in your </span><code class="inlineCode"><span class="koboSpan" id="kobo.278.1">PATH</span></code><span class="koboSpan" id="kobo.279.1">, so you’ll need to fix that. </span><span class="koboSpan" id="kobo.279.2">The easiest way is to create a symbolic link in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.280.1">/usr/sbin/</span></code><span class="koboSpan" id="kobo.281.1"> directory, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.282.1">donnie@openindiana:/opt/csw/bin$ sudo ln -s /opt/csw/bin/pkgutil /usr/sbin/pkgutil
Password:
donnie@openindiana:/opt/csw/bin$ which pkgutil
/usr/sbin/pkgutil
donnie@openindiana:/opt/csw/bin$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.283.1">Next, install the </span><code class="inlineCode"><span class="koboSpan" id="kobo.284.1">gsed</span></code><span class="koboSpan" id="kobo.285.1"> package, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.286.1">donnie@openindiana:~$ sudo pkgutil -i gsed
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.287.1">Finally, you’re ready </span><a id="_idIndexMarker589"/><span class="koboSpan" id="kobo.288.1">to create the alias. </span><span class="koboSpan" id="kobo.288.2">On OpenIndiana, you’ll </span><a id="_idIndexMarker590"/><span class="koboSpan" id="kobo.289.1">need to create it in two different files. </span><span class="koboSpan" id="kobo.289.2">To enable the alias when you open a terminal on the local machine, you’ll need to add it to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.290.1">.bashrc</span></code><span class="koboSpan" id="kobo.291.1"> file in your home directory, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.292.1">alias sed='/usr/bin/gsed'
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.293.1">To enable the alias when you login remotely via </span><code class="inlineCode"><span class="koboSpan" id="kobo.294.1">ssh</span></code><span class="koboSpan" id="kobo.295.1">, you’ll need to create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.296.1">.bash_profile</span></code><span class="koboSpan" id="kobo.297.1"> file in your home directory, and add the same alias line to it.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.298.1">Now that you’ve installed </span><code class="inlineCode"><span class="koboSpan" id="kobo.299.1">gsed</span></code><span class="koboSpan" id="kobo.300.1"> and created an alias on your non-Linux system, you’ll be able to run any </span><code class="inlineCode"><span class="koboSpan" id="kobo.301.1">sed</span></code><span class="koboSpan" id="kobo.302.1"> command you want from the command-line. </span><span class="koboSpan" id="kobo.302.2">Unfortunately, this won’t work if you place any </span><code class="inlineCode"><span class="koboSpan" id="kobo.303.1">sed</span></code><span class="koboSpan" id="kobo.304.1"> commands into your shell scripts, because shell scripts don’t read the </span><code class="inlineCode"><span class="koboSpan" id="kobo.305.1">.bashrc</span></code><span class="koboSpan" id="kobo.306.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.307.1">.shrc</span></code><span class="koboSpan" id="kobo.308.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.309.1">.bash_profile</span></code><span class="koboSpan" id="kobo.310.1">, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.311.1">.zprofile</span></code><span class="koboSpan" id="kobo.312.1"> files that contain the alias. </span><span class="koboSpan" id="kobo.312.2">That’s okay for now, because I’ll show you how to deal with that later. </span><span class="koboSpan" id="kobo.312.3">First though, I need to show you how to use the various </span><code class="inlineCode"><span class="koboSpan" id="kobo.313.1">sed</span></code><span class="koboSpan" id="kobo.314.1"> commands.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.315.1">Now that that’s done, let’s look at how to actually use </span><code class="inlineCode"><span class="koboSpan" id="kobo.316.1">sed</span></code><span class="koboSpan" id="kobo.317.1">. </span><span class="koboSpan" id="kobo.317.2">There are several different </span><code class="inlineCode"><span class="koboSpan" id="kobo.318.1">sed</span></code><span class="koboSpan" id="kobo.319.1"> functions that you need to know. </span><span class="koboSpan" id="kobo.319.2">Let’s start with the substitute function.</span></p>
    <h2 id="_idParaDest-191" class="heading 2"><span class="koboSpan" id="kobo.320.1">Substitution with sed</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.321.1">In the</span><a id="_idIndexMarker591"/><span class="koboSpan" id="kobo.322.1"> diagram below, you see the breakdown of a typical </span><code class="inlineCode"><span class="koboSpan" id="kobo.323.1">sed</span></code><span class="koboSpan" id="kobo.324.1"> substitution script.</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.325.1"><img src="../Images/B21693_09_01.png" alt="B21693_9_1"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.326.1">Figure 9.1: A typical sed substitution script</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.327.1">Now, let’s look at some specific examples.</span></p>
    <h3 id="_idParaDest-192" class="heading 3"><span class="koboSpan" id="kobo.328.1">Example 1: Modifying an Office Memo</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.329.1">Let’s begin with a simple </span><a id="_idIndexMarker592"/><span class="koboSpan" id="kobo.330.1">office memo. </span><span class="koboSpan" id="kobo.330.2">Create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.331.1">tom.txt</span></code><span class="koboSpan" id="kobo.332.1"> file, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.333.1">Memo:  tom tinker
    We regret to inform you that tom
    Tinker will no longer be working
    with us.  </span><span class="koboSpan" id="kobo.333.2">Tom tinker is leaving to
    embark on his own business venture.
    </span><span class="koboSpan" id="kobo.333.3">We wish tom tinker well.  </span><span class="koboSpan" id="kobo.333.4">Good-bye, tom.
</span><span class="koboSpan" id="kobo.333.5">cc: tom Tinker
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.334.1">You can see that the document has a few problems. </span><span class="koboSpan" id="kobo.334.2">The most obvious is that proper names aren’t always capitalized. </span><span class="koboSpan" id="kobo.334.3">We need a way to automate the process of making these corrections.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.335.1">It’s possible to make all corrections at once, but first, let’s just look at how to replace </span><em class="italic"><span class="koboSpan" id="kobo.336.1">tom</span></em><span class="koboSpan" id="kobo.337.1"> with </span><em class="italic"><span class="koboSpan" id="kobo.338.1">Tom</span></em><span class="koboSpan" id="kobo.339.1">. </span><span class="koboSpan" id="kobo.339.2">Do it like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.340.1">[donnie@fedora ~]$ sed 's/tom/Tom/' tom.txt
Memo:  Tom tinker
    We regret to inform you that Tom
    Tinker will no longer be working
    with us.  </span><span class="koboSpan" id="kobo.340.2">Tom tinker is leaving to
    embark on his own business venture.
    </span><span class="koboSpan" id="kobo.340.3">We wish Tom tinker well.  </span><span class="koboSpan" id="kobo.340.4">Good-bye, tom.
</span><span class="koboSpan" id="kobo.340.5">cc: Tom Tinker
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.341.1">The first thing you see within the single quotes is the letter </span><code class="inlineCode"><span class="koboSpan" id="kobo.342.1">s</span></code><span class="koboSpan" id="kobo.343.1">. </span><span class="koboSpan" id="kobo.343.2">That’s what tells </span><code class="inlineCode"><span class="koboSpan" id="kobo.344.1">sed</span></code><span class="koboSpan" id="kobo.345.1"> to perform a substitution. </span><span class="koboSpan" id="kobo.345.2">Next, you see the two patterns that you’re working with. </span><span class="koboSpan" id="kobo.345.3">The first is the pattern that you’re replacing, and the second is what you’re using as the replacement. </span><span class="koboSpan" id="kobo.345.4">After you close the expression with another single quote, list the text file that you want to modify. </span><span class="koboSpan" id="kobo.345.5">(Note that you don’t need a </span><code class="inlineCode"><span class="koboSpan" id="kobo.346.1">stdin</span></code><span class="koboSpan" id="kobo.347.1"> redirector.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.348.1">Now, this did work for the most part, but we still have one lower-case </span><em class="italic"><span class="koboSpan" id="kobo.349.1">tom</span></em><span class="koboSpan" id="kobo.350.1"> in the last line of the body. </span><span class="koboSpan" id="kobo.350.2">That’s because by default, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.351.1">s </span></code><span class="koboSpan" id="kobo.352.1">command for </span><code class="inlineCode"><span class="koboSpan" id="kobo.353.1">sed</span></code><span class="koboSpan" id="kobo.354.1"> will only replace the first occurrence of a pattern in a given line. </span><span class="koboSpan" id="kobo.354.2">To fix this, use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.355.1">s</span></code><span class="koboSpan" id="kobo.356.1"> command with its global (</span><code class="inlineCode"><span class="koboSpan" id="kobo.357.1">g</span></code><span class="koboSpan" id="kobo.358.1">) option. </span><span class="koboSpan" id="kobo.358.2">That way, every occurrence of a pattern in any given line </span><a id="_idIndexMarker593"/><span class="koboSpan" id="kobo.359.1">will be replaced. </span><span class="koboSpan" id="kobo.359.2">Here is what that looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.360.1">[donnie@fedora ~]$ sed 's/tom/Tom/g' tom.txt
Memo:  Tom tinker
    We regret to inform you that Tom
    Tinker will no longer be working
    with us.  </span><span class="koboSpan" id="kobo.360.2">Tom tinker is leaving to
    embark on his own business venture.
    </span><span class="koboSpan" id="kobo.360.3">We wish Tom tinker well.  </span><span class="koboSpan" id="kobo.360.4">Good-bye, Tom.
</span><span class="koboSpan" id="kobo.360.5">cc: Tom Tinker
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.361.1">This works much better. </span><span class="koboSpan" id="kobo.361.2">But, we still have lower-case surnames to replace. </span><span class="koboSpan" id="kobo.361.3">Let’s combine two commands to replace both the first and last names at once, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.362.1">[donnie@fedora ~]$ sed 's/tom/Tom/g ; s/tinker/Tinker/g' tom.txt
Memo:  Tom Tinker
    We regret to inform you that Tom
    Tinker will no longer be working
    with us.  </span><span class="koboSpan" id="kobo.362.2">Tom Tinker is leaving to
    embark on his own business venture.
    </span><span class="koboSpan" id="kobo.362.3">We wish Tom Tinker well.  </span><span class="koboSpan" id="kobo.362.4">Good-bye, Tom.
</span><span class="koboSpan" id="kobo.362.5">cc: Tom Tinker
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.363.1">All you have to do is create two separate </span><code class="inlineCode"><span class="koboSpan" id="kobo.364.1">sed</span></code><span class="koboSpan" id="kobo.365.1"> scripts, and combine them with a semi-colon. </span><span class="koboSpan" id="kobo.365.2">You can place both scripts within only one set of single quotes.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.366.1">By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.367.1">sed</span></code><span class="koboSpan" id="kobo.368.1"> will read in the text file that you want to modify, and send the entire modified file to </span><code class="inlineCode"><span class="koboSpan" id="kobo.369.1">stdout</span></code><span class="koboSpan" id="kobo.370.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.371.1">What if you only want to see the lines that actually got modified?</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.372.1">For that, you </span><a id="_idIndexMarker594"/><span class="koboSpan" id="kobo.373.1">would use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.374.1">-n</span></code><span class="koboSpan" id="kobo.375.1"> switch as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.376.1">sed</span></code><span class="koboSpan" id="kobo.377.1"> option, and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.378.1">p</span></code><span class="koboSpan" id="kobo.379.1"> switch as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.380.1">s</span></code><span class="koboSpan" id="kobo.381.1"> command option. </span><span class="koboSpan" id="kobo.381.2">First, let’s look at what happens when you use only one of these switches at a time. </span><span class="koboSpan" id="kobo.381.3">Here’s what happens if you use </span><code class="inlineCode"><span class="koboSpan" id="kobo.382.1">-n</span></code><span class="koboSpan" id="kobo.383.1"> without the </span><code class="inlineCode"><span class="koboSpan" id="kobo.384.1">p</span></code><span class="koboSpan" id="kobo.385.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.386.1">[donnie@fedora ~]$ sed -n 's/tom/Tom/g ; s/tinker/Tinker/g' tom.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.387.1">Without the </span><code class="inlineCode"><span class="koboSpan" id="kobo.388.1">p</span></code><span class="koboSpan" id="kobo.389.1"> switch for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.390.1">s</span></code><span class="koboSpan" id="kobo.391.1"> command, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.392.1">-n</span></code><span class="koboSpan" id="kobo.393.1"> switch will suppress all output, which isn’t what we want. </span><span class="koboSpan" id="kobo.393.2">This is because the </span><code class="inlineCode"><span class="koboSpan" id="kobo.394.1">-n</span></code><span class="koboSpan" id="kobo.395.1"> switch is the </span><em class="italic"><span class="koboSpan" id="kobo.396.1">quiet</span></em><span class="koboSpan" id="kobo.397.1"> switch, which negates </span><code class="inlineCode"><span class="koboSpan" id="kobo.398.1">sed</span></code><span class="koboSpan" id="kobo.399.1">'s default behavior of passing the processed file to </span><code class="inlineCode"><span class="koboSpan" id="kobo.400.1">stdout</span></code><span class="koboSpan" id="kobo.401.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.402.1">Next, let’s try it with just the </span><code class="inlineCode"><span class="koboSpan" id="kobo.403.1">p</span></code><span class="koboSpan" id="kobo.404.1"> and without the </span><code class="inlineCode"><span class="koboSpan" id="kobo.405.1">-n</span></code><span class="koboSpan" id="kobo.406.1">, which will look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.407.1">[donnie@fedora ~]$ sed 's/tom/Tom/g ; s/tinker/Tinker/gp' tom.txt
Memo:  Tom Tinker
Memo:  Tom Tinker
    We regret to inform you that Tom
    Tinker will no longer be working
    with us.  </span><span class="koboSpan" id="kobo.407.2">Tom Tinker is leaving to
    with us.  </span><span class="koboSpan" id="kobo.407.3">Tom Tinker is leaving to
    embark on his own business venture.
    </span><span class="koboSpan" id="kobo.407.4">We wish Tom Tinker well.  </span><span class="koboSpan" id="kobo.407.5">Good-bye, Tom.
    </span><span class="koboSpan" id="kobo.407.6">We wish Tom Tinker well.  </span><span class="koboSpan" id="kobo.407.7">Good-bye, Tom.
</span><span class="koboSpan" id="kobo.407.8">cc: Tom Tinker
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.408.1">Without the </span><code class="inlineCode"><span class="koboSpan" id="kobo.409.1">-n</span></code><span class="koboSpan" id="kobo.410.1"> option, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.411.1">p</span></code><span class="koboSpan" id="kobo.412.1"> option</span><a id="_idIndexMarker595"/><span class="koboSpan" id="kobo.413.1"> for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.414.1">s</span></code><span class="koboSpan" id="kobo.415.1"> command will cause </span><code class="inlineCode"><span class="koboSpan" id="kobo.416.1">sed </span></code><span class="koboSpan" id="kobo.417.1">to print its default output, in addition to printing the modified lines a second time. </span><span class="koboSpan" id="kobo.417.2">(Actually, we see here that two lines were printed a third time, since more than one replacement was done in each.) This is because without the quiet switch (</span><code class="inlineCode"><span class="koboSpan" id="kobo.418.1">-n</span></code><span class="koboSpan" id="kobo.419.1">), </span><code class="inlineCode"><span class="koboSpan" id="kobo.420.1">sed</span></code><span class="koboSpan" id="kobo.421.1"> once again defaults to printing out the processed file. </span><span class="koboSpan" id="kobo.421.2">Then, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.422.1">p</span></code><span class="koboSpan" id="kobo.423.1"> option for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.424.1">s</span></code><span class="koboSpan" id="kobo.425.1"> command causes all modified lines to print out again.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.426.1">Now, to see only the modified lines, let’s combine the options, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.427.1">[donnie@fedora ~]$ sed -n 's/tom/Tom/gp ; s/tinker/Tinker/gp' tom.txt
Memo:  Tom tinker
Memo:  Tom Tinker
    We regret to inform you that Tom
    with us.  </span><span class="koboSpan" id="kobo.427.2">Tom Tinker is leaving to
    We wish Tom tinker well.  </span><span class="koboSpan" id="kobo.427.3">Good-bye, Tom.
    </span><span class="koboSpan" id="kobo.427.4">We wish Tom Tinker well.  </span><span class="koboSpan" id="kobo.427.5">Good-bye, Tom.
</span><span class="koboSpan" id="kobo.427.6">cc: Tom Tinker
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.428.1">So the lesson here is that you must use </span><code class="inlineCode"><span class="koboSpan" id="kobo.429.1">-n</span></code><span class="koboSpan" id="kobo.430.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.431.1">p</span></code><span class="koboSpan" id="kobo.432.1"> together, because using just one of them won’t give you what you want.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.433.1">Wait though, you’re not through yet. </span><span class="koboSpan" id="kobo.433.2">It seems that your boss is a bit of a practical joker. </span><span class="koboSpan" id="kobo.433.3">So, he tells you to replace the last </span><em class="italic"><span class="koboSpan" id="kobo.434.1">Tinker</span></em><span class="koboSpan" id="kobo.435.1"> with </span><em class="italic"><span class="koboSpan" id="kobo.436.1">Stinker</span></em><span class="koboSpan" id="kobo.437.1">. </span><span class="koboSpan" id="kobo.437.2">As he turns to leave, he winks and says, “Yeah, that’ll get him”. </span><span class="koboSpan" id="kobo.437.3">Here’s where the addressing option comes in handy.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.438.1">Since you know that the last </span><em class="italic"><span class="koboSpan" id="kobo.439.1">Tinker</span></em><span class="koboSpan" id="kobo.440.1"> is the last word in the last line of the file, you can direct </span><code class="inlineCode"><span class="koboSpan" id="kobo.441.1">sed</span></code><span class="koboSpan" id="kobo.442.1"> to only replace that occurrence by placing the </span><em class="italic"><span class="koboSpan" id="kobo.443.1">end-of</span></em><span class="koboSpan" id="kobo.444.1"> metacharacter (</span><code class="inlineCode"><span class="koboSpan" id="kobo.445.1">$</span></code><span class="koboSpan" id="kobo.446.1">), in the address. </span><span class="koboSpan" id="kobo.446.2">Here’s how that</span><a id="_idIndexMarker596"/><span class="koboSpan" id="kobo.447.1"> looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.448.1">[donnie@fedora ~]$ sed 's/tom/Tom/g ; s/tinker/Tinker/g ; $s/Tinker/Stinker/' tom.txt
Memo:  Tom Tinker
    We regret to inform you that Tom
    Tinker will no longer be working
    with us.  </span><span class="koboSpan" id="kobo.448.2">Tom Tinker is leaving to
    embark on his own business venture.
    </span><span class="koboSpan" id="kobo.448.3">We wish Tom Tinker well.  </span><span class="koboSpan" id="kobo.448.4">Good-bye, Tom.
</span><span class="koboSpan" id="kobo.448.5">cc: Tom Stinker
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.449.1">Okay, let’s move on to our next example.</span></p>
    <h3 id="_idParaDest-193" class="heading 3"><span class="koboSpan" id="kobo.450.1">Example 2: Modifying a List of Hollywood Actors</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.451.1">There </span><a id="_idIndexMarker597"/><span class="koboSpan" id="kobo.452.1">are still plenty of other ways to perform substitutions with </span><code class="inlineCode"><span class="koboSpan" id="kobo.453.1">sed</span></code><span class="koboSpan" id="kobo.454.1">. </span><span class="koboSpan" id="kobo.454.2">To demonstrate, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.455.1">actorsfile_11.txt</span></code><span class="koboSpan" id="kobo.456.1"> file with the following list of Hollywood actors:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.457.1">Jessel		George
Marx			Groucho
Cantor		Eddie
Allen		Fred
Burns		George
Wayne		John
Price		Vincent
Besser		Joe
Greenstreet		Sidney
Conrad		William
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.458.1">You’ve decided that you want to replace Groucho Marx with his brother Zeppo. </span><span class="koboSpan" id="kobo.458.2">Search for all lines that begin with Marx, and make the replacement only on those lines, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.459.1">[donnie@fedora ~]$ sed '/^Marx/s/Groucho/Zeppo/' actorfile_11.txt
Jessel		George
Marx			Zeppo
Cantor		Eddie
Allen		Fred
Burns		George
Wayne		John
Price		Vincent
Besser		Joe
Greenstreet		Sidney
Conrad		William
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.460.1">In this</span><a id="_idIndexMarker598"/><span class="koboSpan" id="kobo.461.1"> example, you used a regular expression for an address. </span><span class="koboSpan" id="kobo.461.2">That is, you placed the literal string </span><em class="italic"><span class="koboSpan" id="kobo.462.1">Marx </span></em><span class="koboSpan" id="kobo.463.1">within the default </span><code class="inlineCode"><span class="koboSpan" id="kobo.464.1">sed</span></code><span class="koboSpan" id="kobo.465.1"> delimiters (the forward slashes), then preceded it with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.466.1">^</span></code><span class="koboSpan" id="kobo.467.1"> metacharacter. </span><span class="koboSpan" id="kobo.467.2">That causes the substitute command to look for only the occurrence of </span><em class="italic"><span class="koboSpan" id="kobo.468.1">Marx</span></em><span class="koboSpan" id="kobo.469.1"> at the beginning of a line. </span><span class="koboSpan" id="kobo.469.2">Note again how this address immediately precedes the </span><code class="inlineCode"><span class="koboSpan" id="kobo.470.1">s</span></code><span class="koboSpan" id="kobo.471.1"> command. </span><span class="koboSpan" id="kobo.471.2">You don’t need to use the global option for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.472.1">s</span></code><span class="koboSpan" id="kobo.473.1"> command, because you already know that there’s only one occurrence of a given word in each line.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.474.1">You’ve now decided that you need to replace Joe Besser with Joe DeRita. </span><span class="koboSpan" id="kobo.474.2">(That’s appropriate, because in real life the Three Stooges really did replace Joe Besser with Joe DeRita, after Joe Besser left to care for his ailing wife.) This time, you want to search for lines that end with </span><em class="italic"><span class="koboSpan" id="kobo.475.1">Joe</span></em><span class="koboSpan" id="kobo.476.1">, and make the replacement only on those lines, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.477.1">[donnie@fedora ~]$ sed '/Joe$/s/Besser/DeRita/' actorfile_11.txt
Jessel		George
Marx			Groucho
Cantor		Eddie
Allen		Fred
Burns		George
Wayne		John
Price		Vincent
DeRita		Joe
Greenstreet		Sidney
Conrad		William
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.478.1">This time, you used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.479.1">$</span></code><span class="koboSpan" id="kobo.480.1"> metacharacter in the address to tell </span><code class="inlineCode"><span class="koboSpan" id="kobo.481.1">s</span></code><span class="koboSpan" id="kobo.482.1"> to look at the end of the lines. </span><span class="koboSpan" id="kobo.482.2">Note</span><a id="_idIndexMarker599"/><span class="koboSpan" id="kobo.483.1"> how you had to place this metacharacter at the end of the literal string.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.484.1">Okay, enough of actors. </span><span class="koboSpan" id="kobo.484.2">Let’s look at some classic cars.</span></p>
    <h3 id="_idParaDest-194" class="heading 3"><span class="koboSpan" id="kobo.485.1">Example 3: Modifying Lists of Cars</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.486.1">You can also</span><a id="_idIndexMarker600"/><span class="koboSpan" id="kobo.487.1"> replace individual characters. </span><span class="koboSpan" id="kobo.487.2">Create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.488.1">cars_2.txt</span></code><span class="koboSpan" id="kobo.489.1"> file with the following contents:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.490.1">[donnie@fedora ~]$ cat &gt; cars_2.txt
edsel
Edsel
Edsel
desoto
desoto
Desoto
Desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.491.1">In this</span><code class="inlineCode"> </code><span class="koboSpan" id="kobo.492.1">file, you see that you need to capitalize the names of some of the listed cars. </span><span class="koboSpan" id="kobo.492.2">For now, let’s just concentrate on capitalizing </span><em class="italic"><span class="koboSpan" id="kobo.493.1">Desoto</span></em><span class="koboSpan" id="kobo.494.1">. </span><span class="koboSpan" id="kobo.494.2">If you tell </span><code class="inlineCode"><span class="koboSpan" id="kobo.495.1">sed</span></code><span class="koboSpan" id="kobo.496.1"> to replace every </span><em class="italic"><span class="koboSpan" id="kobo.497.1">d</span></em><span class="koboSpan" id="kobo.498.1"> with a </span><em class="italic"><span class="koboSpan" id="kobo.499.1">D</span></em><span class="koboSpan" id="kobo.500.1">, you’ll get this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.501.1">[donnie@fedora ~]$ sed 's/d/D/' cars_2.txt
eDsel
EDsel
EDsel
Desoto
Desoto
Desoto
Desoto
nash
Nash
nash
HuDson
huDson
huDson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.502.1">That’s </span><a id="_idIndexMarker601"/><span class="koboSpan" id="kobo.503.1">not what you want. </span><span class="koboSpan" id="kobo.503.2">But, you know that there is a lower-case </span><em class="italic"><span class="koboSpan" id="kobo.504.1">desoto</span></em><span class="koboSpan" id="kobo.505.1"> only in lines four and five. </span><span class="koboSpan" id="kobo.505.2">So, you can tell </span><code class="inlineCode"><span class="koboSpan" id="kobo.506.1">sed</span></code><span class="koboSpan" id="kobo.507.1"> to replace the lower-case </span><em class="italic"><span class="koboSpan" id="kobo.508.1">d</span></em><span class="koboSpan" id="kobo.509.1"> in only those two lines, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.510.1">[donnie@fedora ~]$ sed '4,5s/d/D/' cars_2.txt
edsel
Edsel
Edsel
Desoto
Desoto
Desoto
Desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.511.1">Note that the comma between the two line numbers means </span><em class="italic"><span class="koboSpan" id="kobo.512.1">lines four through five</span></em><span class="koboSpan" id="kobo.513.1">, not </span><em class="italic"><span class="koboSpan" id="kobo.514.1">lines four and five</span></em><span class="koboSpan" id="kobo.515.1">.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.516.1">You can tell </span><code class="inlineCode"><span class="koboSpan" id="kobo.517.1">sed</span></code><span class="koboSpan" id="kobo.518.1"> to search for </span><em class="italic"><span class="koboSpan" id="kobo.519.1">desoto</span></em><span class="koboSpan" id="kobo.520.1"> at the beginning of a line, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.521.1">[donnie@fedora ~]$ sed '/^desoto/s/d/D/' cars_2.txt
edsel
Edsel
Edsel
Desoto
Desoto
Desoto
Desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.522.1">Insert the </span><code class="inlineCode"><span class="koboSpan" id="kobo.523.1">-n</span></code><span class="koboSpan" id="kobo.524.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.525.1">p</span></code><span class="koboSpan" id="kobo.526.1"> switches if</span><a id="_idIndexMarker602"/><span class="koboSpan" id="kobo.527.1"> you only want to see the lines that changed, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.528.1">[donnie@fedora ~]$ sed -n '/^desoto/s/d/D/p' cars_2.txt
Desoto
Desoto
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.529.1">There are three ways to save your modifications. </span><span class="koboSpan" id="kobo.529.2">You can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.530.1">stdout</span></code><span class="koboSpan" id="kobo.531.1"> redirector to create a new file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.532.1">[donnie@fedora ~]$ sed -n '/^desoto/s/d/D/p' cars_2.txt &gt; cars_cap.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.533.1">You can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.534.1">w</span></code><span class="koboSpan" id="kobo.535.1"> switch with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.536.1">s</span></code><span class="koboSpan" id="kobo.537.1"> command to save to a new file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.538.1">[donnie@fedora ~]$ sed '/^desoto/s/d/D/w newcarsfile.txt' cars_2.txt
edsel
Edsel
Edsel
Desoto
Desoto
Desoto
Desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.539.1">The only catch with this is that even though the </span><code class="inlineCode"><span class="koboSpan" id="kobo.540.1">w</span></code><span class="koboSpan" id="kobo.541.1"> switch shows the entire contents of the modified file on screen, it only saves the modified lines to a new file, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.542.1">[donnie@fedora ~]$ cat newcarsfile.txt
Desoto
Desoto
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.543.1">The final way to save </span><a id="_idIndexMarker603"/><span class="koboSpan" id="kobo.544.1">your modifications is to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.545.1">-i</span></code><span class="koboSpan" id="kobo.546.1"> switch to modify the original file, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.547.1">[donnie@fedora ~]$ sed -i '/^desoto/s/d/D/' cars_2.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.548.1">Unlike when you use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.549.1">w</span></code><span class="koboSpan" id="kobo.550.1"> switch, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.551.1">-i</span></code><span class="koboSpan" id="kobo.552.1"> saves the entire modified file, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.553.1">[donnie@fedora ~]$ cat cars_2.txt
edsel
Edsel
Edsel
Desoto
Desoto
Desoto
Desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.554.1">If you want to create a backup of the original file before it gets modified, just put the suffix that you want to append to the backup filename after the </span><code class="inlineCode"><span class="koboSpan" id="kobo.555.1">-i</span></code><span class="koboSpan" id="kobo.556.1"> switch, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.557.1">[donnie@fedora ~]$ sed -i.bak '/^desoto/s/d/D/' cars_2.txt
[donnie@fedora ~]
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.558.1">Note that you can’t have a blank space between the </span><code class="inlineCode"><span class="koboSpan" id="kobo.559.1">-i</span></code><span class="koboSpan" id="kobo.560.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.561.1">.bak</span></code><span class="koboSpan" id="kobo.562.1">. </span><span class="koboSpan" id="kobo.562.2">Verify that the operation</span><a id="_idIndexMarker604"/><span class="koboSpan" id="kobo.563.1"> worked, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.564.1">[donnie@fedora ~]$ ls -l cars_2.txt.bak
-rw-r--r--. </span><span class="koboSpan" id="kobo.564.2">1 donnie donnie 82 Oct 11 13:58 cars_2.txt.bak
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.565.1">Next, let’s do some whole-word substitutions.</span></p>
    <h3 id="_idParaDest-195" class="heading 3"><span class="koboSpan" id="kobo.566.1">Example 4: Performing a Whole-Word Substitution</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.567.1">What if you </span><a id="_idIndexMarker605"/><span class="koboSpan" id="kobo.568.1">have a pattern that can be part of other words, but you only want to perform substitutions on the pattern if it’s a whole word unto itself? </span><span class="koboSpan" id="kobo.568.2">To illustrate, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.569.1">ing.txt</span></code><span class="koboSpan" id="kobo.570.1"> file with this somewhat corny story:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.571.1">It began raining just as the
baseball team began their spring
training.  </span><span class="koboSpan" id="kobo.571.2">Meanwhile, Susan began
singing as she was playing the
piano.  </span><span class="koboSpan" id="kobo.571.3">Just being alive was great,
and Michael was thinking about how
he was going to begin working on
his new novel.  </span><span class="koboSpan" id="kobo.571.4">Writing was like
a tonic to him.  </span><span class="koboSpan" id="kobo.571.5">It was just like
acting out all of his fantasies.
</span><span class="koboSpan" id="kobo.571.6">I think I've used ing enough in this
story to illustrate my point about ing.
</span><span class="koboSpan" id="kobo.571.7">So, ing away, and then ing some more.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.572.1">Now, let’s say that you want to replace the word </span><em class="italic"><span class="koboSpan" id="kobo.573.1">ing</span></em><span class="koboSpan" id="kobo.574.1"> with the word </span><em class="italic"><span class="koboSpan" id="kobo.575.1">ING</span></em><span class="koboSpan" id="kobo.576.1">. </span><span class="koboSpan" id="kobo.576.2">Try this command to see what you get:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.577.1">[donnie@fedora ~]$ sed 's/ing/ING/g' ing.txt
It began rainING just as the
baseball team began their sprING
trainING.  </span><span class="koboSpan" id="kobo.577.2">Meanwhile, Susan began
sINGING as she was playING the
piano.  </span><span class="koboSpan" id="kobo.577.3">Just beING alive was great,
and Michael was thinkING about how
he was goING to begin workING on
his new novel.  </span><span class="koboSpan" id="kobo.577.4">WritING was like
a tonic to him.  </span><span class="koboSpan" id="kobo.577.5">It was just like
actING out all of his fantasies.
</span><span class="koboSpan" id="kobo.577.6">I think I've used ING enough in this story to illustrate my point about ING. </span><span class="koboSpan" id="kobo.577.7">So, ING away, and then ING some more.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.578.1">You really</span><a id="_idIndexMarker606"/><span class="koboSpan" id="kobo.579.1"> only wanted to replace the whole word </span><em class="italic"><span class="koboSpan" id="kobo.580.1">ing</span></em><span class="koboSpan" id="kobo.581.1"> with </span><em class="italic"><span class="koboSpan" id="kobo.582.1">ING</span></em><span class="koboSpan" id="kobo.583.1">, but ended up replacing the </span><em class="italic"><span class="koboSpan" id="kobo.584.1">ing</span></em><span class="koboSpan" id="kobo.585.1">’s that show up in other words, also. </span><span class="koboSpan" id="kobo.585.2">Here’s where you need to use word boundaries, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.586.1">[donnie@fedora ~]$ sed 's/\&lt;ing\&gt;/ING/g' ing.txt
It began raining just as the
baseball team began their spring
training.  </span><span class="koboSpan" id="kobo.586.2">Meanwhile, Susan began
singing as she was playing the
piano.  </span><span class="koboSpan" id="kobo.586.3">Just being alive was great,
and Michael was thinking about how
he was going to begin working on
his new novel.  </span><span class="koboSpan" id="kobo.586.4">Writing was like
a tonic to him.  </span><span class="koboSpan" id="kobo.586.5">It was just like
acting out all of his fantasies.
</span><span class="koboSpan" id="kobo.586.6">I think I've used ING enough in this
story to illustrate my point about ING.
</span><span class="koboSpan" id="kobo.586.7">So, ING away, and then ING some more.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.587.1">All you had to do was to place the string that you wanted to replace inside of a of </span><code class="inlineCode"><span class="koboSpan" id="kobo.588.1">\&lt; \&gt;</span></code><span class="koboSpan" id="kobo.589.1"> construct.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.590.1">As you look at the metacharacter chart that I presented a few pages back, you may think, “Hey, I’ve discovered another way to do this. </span><span class="koboSpan" id="kobo.590.2">I can just use a wild-card character”. </span><span class="koboSpan" id="kobo.590.3">Indeed, in this case, it would work, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.591.1">[donnie@fedora ~]$ sed 's/ \+ing/ ING/g' ing.txt
It began raining just as the
baseball team began their spring
training.  </span><span class="koboSpan" id="kobo.591.2">Meanwhile, Susan began
singing as she was playing the
piano.  </span><span class="koboSpan" id="kobo.591.3">Just being alive was great,
and Michael was thinking about how
he was going to begin working on
his new novel.  </span><span class="koboSpan" id="kobo.591.4">Writing was like
a tonic to him.  </span><span class="koboSpan" id="kobo.591.5">It was just like
acting out all of his fantasies.
</span><span class="koboSpan" id="kobo.591.6">I think I've used ING enough in this
story to illustrate my point about ING.
</span><span class="koboSpan" id="kobo.591.7">So, ING away, and then ING some more.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.592.1">Here, you used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.593.1">\+</span></code><span class="koboSpan" id="kobo.594.1"> metacharacter to replace all </span><em class="italic"><span class="koboSpan" id="kobo.595.1">ing</span></em><span class="koboSpan" id="kobo.596.1">’s that are preceded by one or more blank spaces. </span><span class="koboSpan" id="kobo.596.2">(Note that I left a space between the first forward slash and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.597.1">\+</span></code><span class="koboSpan" id="kobo.598.1"> metacharacter in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.599.1">s</span></code><span class="koboSpan" id="kobo.600.1"> command. </span><span class="koboSpan" id="kobo.600.2">I also had to leave a blank space before the </span><em class="italic"><span class="koboSpan" id="kobo.601.1">ING</span></em><span class="koboSpan" id="kobo.602.1"> in order to also leave a space in the output.) However, in this case, this isn’t the most elegant solution, since it won’t work in all cases. </span><span class="koboSpan" id="kobo.602.2">To illustrate, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.603.1">ing_2.txt</span></code><span class="koboSpan" id="kobo.604.1"> file, and make it look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.605.1">I'm writing yet another story about
the suffix ing.  </span><span class="koboSpan" id="kobo.605.2">I hope that this
ing story will help illustrate our point.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.606.1">Perform the previous command again, and you should get this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.607.1">[donnie@fedora ~]$ sed 's/ \+ing/ ING/g' ing_2.txt
I'm writing yet another story about
the suffix ING.  </span><span class="koboSpan" id="kobo.607.2">I hope that this
ing story will help illustrate our point.
</span><span class="koboSpan" id="kobo.607.3">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.608.1">The </span><em class="italic"><span class="koboSpan" id="kobo.609.1">ing</span></em><span class="koboSpan" id="kobo.610.1"> in the</span><a id="_idIndexMarker607"/><span class="koboSpan" id="kobo.611.1"> last line didn’t get replaced, because it’s at the beginning of a line. </span><span class="koboSpan" id="kobo.611.2">Therefore, no blank spaces can precede it. </span><span class="koboSpan" id="kobo.611.3">Wild-card metacharacters are handy devices, and do have legitimate uses. </span><span class="koboSpan" id="kobo.611.4">But here, we find that they’re not the best solution.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.612.1">That covers it for substitution. </span><span class="koboSpan" id="kobo.612.2">Let’s now do some deletions.</span></p>
    <h2 id="_idParaDest-196" class="heading 2"><span class="koboSpan" id="kobo.613.1">Deletion with sed</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.614.1">You can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.615.1">d</span></code><span class="koboSpan" id="kobo.616.1"> command to perform deletions. </span><span class="koboSpan" id="kobo.616.2">This is simpler than the substitution process, since all you really need is an address and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.617.1">d</span></code><span class="koboSpan" id="kobo.618.1"> command. </span><span class="koboSpan" id="kobo.618.2">We’ll begin by deleting some items from a list.</span></p>
    <h3 id="_idParaDest-197" class="heading 3"><span class="koboSpan" id="kobo.619.1">Example 1: Deleting Items from a List</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.620.1">Let’s take another</span><a id="_idIndexMarker608"/><span class="koboSpan" id="kobo.621.1"> look at our </span><code class="inlineCode"><span class="koboSpan" id="kobo.622.1">cars_2.txt</span></code><span class="koboSpan" id="kobo.623.1"> file, and try to delete all references to Edsel. </span><span class="koboSpan" id="kobo.623.2">(We want to forget that the Edsel was ever made, as Ford Motor Company has tried to do ever since 1960.) First, as a reminder, here’s what the original file looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.624.1">[donnie@fedora ~]$ cat cars_2.txt
edsel
Edsel
Edsel
Desoto
Desoto
Desoto
Desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.625.1">Well, it’s not exactly original, because I forgot that I had modified it to capitalize all of the </span><em class="italic"><span class="koboSpan" id="kobo.626.1">desoto</span></em><span class="koboSpan" id="kobo.627.1">’s. </span><span class="koboSpan" id="kobo.627.2">But, that doesn’t matter. </span><span class="koboSpan" id="kobo.627.3">To delete all references to the Edsel, try this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.628.1">[donnie@fedora ~]$ sed '/edsel/d' cars_2.txt
Edsel
Edsel
Desoto
Desoto
Desoto
Desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.629.1">This command</span><a id="_idIndexMarker609"/><span class="koboSpan" id="kobo.630.1"> only deleted the lower-case </span><em class="italic"><span class="koboSpan" id="kobo.631.1">edsel</span></em><span class="koboSpan" id="kobo.632.1">. </span><span class="koboSpan" id="kobo.632.2">But, I need a way to delete all references to Edsel. </span><span class="koboSpan" id="kobo.632.3">Fortunately, you can use a regular expression to specify multiple characters in the address, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.633.1">[donnie@fedora ~]$ sed '/[eE]dsel/d' cars_2.txt
Desoto
Desoto
Desoto
Desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.634.1">All you had to do was to put both </span><em class="italic"><span class="koboSpan" id="kobo.635.1">e</span></em><span class="koboSpan" id="kobo.636.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.637.1">E</span></em><span class="koboSpan" id="kobo.638.1"> within brackets, and use that for the first character of the address.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.639.1">If you want to delete everything except for references to </span><em class="italic"><span class="koboSpan" id="kobo.640.1">Edsel</span></em><span class="koboSpan" id="kobo.641.1">, use an </span><code class="inlineCode"><span class="koboSpan" id="kobo.642.1">!</span></code><span class="koboSpan" id="kobo.643.1"> to invert the command. </span><span class="koboSpan" id="kobo.643.2">Now, you’d think that you’d want to put the inversion character in front of the address that you’re searching for, but that isn’t the case. </span><span class="koboSpan" id="kobo.643.3">Instead, place the inversion character in front of the command character itself. </span><span class="koboSpan" id="kobo.643.4">So, in this case, you would place the exclamation point in front of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.644.1">d</span></code><span class="koboSpan" id="kobo.645.1">, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.646.1">[donnie@fedora ~]$ sed '/[eE]dsel/!d' cars_2.txt
edsel
Edsel
Edsel
[donnie@fedora ~]$
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.647.1">You’ve just seen an example of how things aren’t always implemented consistently across the various shell scripting tools. </span><span class="koboSpan" id="kobo.647.2">A while ago, you saw that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.648.1">^</span></code><span class="koboSpan" id="kobo.649.1"> is the inversion operator for Regular Expressions. </span><span class="koboSpan" id="kobo.649.2">Here, you see that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.650.1">!</span></code><span class="koboSpan" id="kobo.651.1"> is the inversion operator for </span><code class="inlineCode"><span class="koboSpan" id="kobo.652.1">sed</span></code><span class="koboSpan" id="kobo.653.1"> commands. </span><span class="koboSpan" id="kobo.653.2">You’ve also seen that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.654.1">^</span></code><span class="koboSpan" id="kobo.655.1"> can also be used to indicate the beginning of a line. </span><span class="koboSpan" id="kobo.655.2">So yeah, things can get a bit confusing.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.656.1">You can also choose a range of line numbers for the address. </span><span class="koboSpan" id="kobo.656.2">This time, let’s delete all references to Nash, which happen to be in lines eight through ten, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.657.1">[donnie@fedora ~]$ sed '8,10d' cars_2.txt
edsel
Edsel
Edsel
Desoto
Desoto
Desoto
Desoto
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.658.1">Place an</span><a id="_idIndexMarker610"/><span class="koboSpan" id="kobo.659.1"> exclamation point in front of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.660.1">d</span></code><span class="koboSpan" id="kobo.661.1"> to delete everything except for lines eight through ten, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.662.1">[donnie@fedora ~]$ sed '8,10!d' cars_2.txt
nash
Nash
nash
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.663.1">That does it for the classic cars. </span><span class="koboSpan" id="kobo.663.2">Next, I’ll show you what to do if your file has too many blank lines.</span></p>
    <h3 id="_idParaDest-198" class="heading 3"><span class="koboSpan" id="kobo.664.1">Example 2: Deleting Blank Lines</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.665.1">For our last</span><a id="_idIndexMarker611"/><span class="koboSpan" id="kobo.666.1"> deletion trick, here’s how you can delete blank lines from a file. </span><span class="koboSpan" id="kobo.666.2">Just make an address with the start-of-line metacharacter (</span><code class="inlineCode"><span class="koboSpan" id="kobo.667.1">^</span></code><span class="koboSpan" id="kobo.668.1">) right next to the end-of-line metacharacter (</span><code class="inlineCode"><span class="koboSpan" id="kobo.669.1">$</span></code><span class="koboSpan" id="kobo.670.1">). </span><span class="koboSpan" id="kobo.670.2">Start by creating the </span><code class="inlineCode"><span class="koboSpan" id="kobo.671.1">blank_lines.txt</span></code><span class="koboSpan" id="kobo.672.1"> file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.673.1">One non-blank line.
</span><span class="koboSpan" id="kobo.673.2">Another non-blank line.
</span><span class="koboSpan" id="kobo.673.3">Yet another non-blank line.
</span><span class="koboSpan" id="kobo.673.4">And one last non-blank line.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.674.1">Now, perform the deletion, with </span><code class="inlineCode"><span class="koboSpan" id="kobo.675.1">^$</span></code><span class="koboSpan" id="kobo.676.1"> as the regular expression, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.677.1">[donnie@fedora ~]$ sed '/^$/d' blank_lines.txt
One non-blank line.
</span><span class="koboSpan" id="kobo.677.2">Another non-blank line.
</span><span class="koboSpan" id="kobo.677.3">Yet another non-blank line.
</span><span class="koboSpan" id="kobo.677.4">And one last non-blank line.
</span><span class="koboSpan" id="kobo.677.5">[donnie@fedora ~]$
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.678.1">Note the difference between this and the way we previously used the </span><em class="italic"><span class="koboSpan" id="kobo.679.1">end-of</span></em><span class="koboSpan" id="kobo.680.1"> metacharacter in the substitution script. </span><span class="koboSpan" id="kobo.680.2">Since we’re using two metacharacters together to form a regular expression, we have to place them between two forward slashes.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.681.1">Now, for the next trick.</span></p>
    <h2 id="_idParaDest-199" class="heading 2"><span class="koboSpan" id="kobo.682.1">Appending and Inserting with sed</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.683.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.684.1">a</span></code><span class="koboSpan" id="kobo.685.1"> command for the Linux implementation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.686.1">sed</span></code><span class="koboSpan" id="kobo.687.1"> is used to append a line of text after another line of text. </span><span class="koboSpan" id="kobo.687.2">Let’s see how it works.</span></p>
    <h3 id="_idParaDest-200" class="heading 3"><span class="koboSpan" id="kobo.688.1">Example 1: Appending Lines of Text</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.689.1">You can use that </span><a id="_idIndexMarker612"/><span class="koboSpan" id="kobo.690.1">feature to add some model names to the cars list. </span><span class="koboSpan" id="kobo.690.2">Add the </span><em class="italic"><span class="koboSpan" id="kobo.691.1">Ambassador</span></em><span class="koboSpan" id="kobo.692.1"> model for the Nash line, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.693.1">[donnie@fedora ~]$ sed '/[nN]ash/aAmbassador' cars_2.txt
edsel
Edsel
. </span><span class="koboSpan" id="kobo.693.2">. </span><span class="koboSpan" id="kobo.693.3">.
</span><span class="koboSpan" id="kobo.693.4">. </span><span class="koboSpan" id="kobo.693.5">. </span><span class="koboSpan" id="kobo.693.6">.
</span><span class="koboSpan" id="kobo.693.7">nash
Ambassador
Nash
Ambassador
nash
Ambassador
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.694.1">That’s good, but you</span><a id="_idIndexMarker613"/><span class="koboSpan" id="kobo.695.1"> can make it better. </span><span class="koboSpan" id="kobo.695.2">Start by indenting the model names. </span><span class="koboSpan" id="kobo.695.3">Do that by adding a preceding tab, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.696.1">[donnie@fedora ~]$ sed '/[nN]ash/a\\tAmbassador' cars_2.txt
edsel
Edsel
. </span><span class="koboSpan" id="kobo.696.2">. </span><span class="koboSpan" id="kobo.696.3">.
</span><span class="koboSpan" id="kobo.696.4">. </span><span class="koboSpan" id="kobo.696.5">. </span><span class="koboSpan" id="kobo.696.6">.
</span><span class="koboSpan" id="kobo.696.7">nash
	Ambassador
Nash
	Ambassador
nash
	Ambassador
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.697.1">Note that I can only show a partial output here, due to book formatting constraints.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.698.1">The control character for a tab is </span><code class="inlineCode"><span class="koboSpan" id="kobo.699.1">\t</span></code><span class="koboSpan" id="kobo.700.1">. </span><span class="koboSpan" id="kobo.700.2">Note though, that you had to add another backslash so that </span><code class="inlineCode"><span class="koboSpan" id="kobo.701.1">sed</span></code><span class="koboSpan" id="kobo.702.1"> would properly recognize it.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.703.1">You can do the </span><a id="_idIndexMarker614"/><span class="koboSpan" id="kobo.704.1">same thing by using a line address. </span><span class="koboSpan" id="kobo.704.2">Let’s append a model name to line six, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.705.1">[donnie@fedora ~]$ sed '6a\\tFiredome' cars_2.txt
edsel
Edsel
Edsel
Desoto
Desoto
Desoto
	Firedome
Desoto
nash
Nash
nash
Hudson
hudson
hudson
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.706.1">But, that doesn’t cover all of the </span><em class="italic"><span class="koboSpan" id="kobo.707.1">Desoto</span></em><span class="koboSpan" id="kobo.708.1">’s. </span><span class="koboSpan" id="kobo.708.2">Let’s append the model name to lines four through seven, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.709.1">[donnie@fedora ~]$ sed '4,7a\\tFiredome' cars_2.txt
edsel
Edsel
Edsel
Desoto
	Firedome
Desoto
	Firedome
Desoto
	Firedome
Desoto
	Firedome
nash
. </span><span class="koboSpan" id="kobo.709.2">. </span><span class="koboSpan" id="kobo.709.3">.
</span><span class="koboSpan" id="kobo.709.4">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.710.1">Now, let’s combine some operations. </span><span class="koboSpan" id="kobo.710.2">Start by editing the </span><code class="inlineCode"><span class="koboSpan" id="kobo.711.1">cars_2.txt</span></code><span class="koboSpan" id="kobo.712.1"> file so that it once again has</span><a id="_idIndexMarker615"/><span class="koboSpan" id="kobo.713.1"> some lower-case </span><em class="italic"><span class="koboSpan" id="kobo.714.1">desoto</span></em><span class="koboSpan" id="kobo.715.1">’s. </span><span class="koboSpan" id="kobo.715.2">It should look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.716.1">edsel
Edsel
Edsel
desoto
desoto
Desoto
desoto
nash
Nash
nash
Hudson
hudson
hudson
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.717.1">But, you’re not limited to just performing one operation at a time. </span><span class="koboSpan" id="kobo.717.2">So, let’s see how we can combine operations.</span></p>
    <h3 id="_idParaDest-201" class="heading 3"><span class="koboSpan" id="kobo.718.1">Example 2: Performing Multiple Operations at Once</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.719.1">You’ll add a </span><a id="_idIndexMarker616"/><span class="koboSpan" id="kobo.720.1">model to both the Edsel and Desoto lines, and delete every make that isn’t capitalized. </span><span class="koboSpan" id="kobo.720.2">Note that you can’t just place everything within one set of quotes, or use a semi-colon to separate the operations. </span><span class="koboSpan" id="kobo.720.3">For this, you have to give every operation its own set of quotes, and precede every operation with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.721.1">-e</span></code><span class="koboSpan" id="kobo.722.1"> switch. </span><span class="koboSpan" id="kobo.722.2">That’s because these operations are sequential, which means that the first operation must run to completion before the second one can begin. </span><span class="koboSpan" id="kobo.722.3">Here’s how it looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.723.1">[donnie@fedora ~]$ sed -e '6a\\tFiredome' -e '/Edsel/a\\tCorsair' -e '/^[a-z]/d' cars_2.txt
Edsel
	Corsair
Edsel
	Corsair
Desoto
	Firedome
Nash
Hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.724.1">Now that we’ve looked at appending text, let’s see how to insert text.</span></p>
    <h3 id="_idParaDest-202" class="heading 3"><span class="koboSpan" id="kobo.725.1">Example 3: Inserting Lines of Text</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.726.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.727.1">i</span></code><span class="koboSpan" id="kobo.728.1"> command</span><a id="_idIndexMarker617"/><span class="koboSpan" id="kobo.729.1"> works the same way, except that it will insert a line of text before another line of text, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.730.1">[donnie@fedora ~]$ sed -e '/Edsel/i1958' -e '/^[[:lower:]]/d' cars_2.txt
1958
Edsel
1958
Edsel
Desoto
Nash
Hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.731.1">As a bonus, I’ve also shown you another way to get rid of all car names that begin with a lower-case letter.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.732.1">That’s it for this trick. </span><span class="koboSpan" id="kobo.732.2">Let’s move on to the next one.</span></p>
    <h2 id="_idParaDest-203" class="heading 2"><span class="koboSpan" id="kobo.733.1">Changing with sed</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.734.1">You would use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.735.1">c</span></code><span class="koboSpan" id="kobo.736.1"> command to change a string of text. </span><span class="koboSpan" id="kobo.736.2">(You can also change text with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.737.1">s</span></code><span class="koboSpan" id="kobo.738.1"> command, but this is a bit shorter to type.) Let’s see how it’s done.</span></p>
    <h3 id="_idParaDest-204" class="heading 3"><span class="koboSpan" id="kobo.739.1">Example 1: Changing Edsel to Studebaker</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.740.1">As</span><a id="_idIndexMarker618"/><span class="koboSpan" id="kobo.741.1"> before, you’ll work with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.742.1">cars_2.txt</span></code><span class="koboSpan" id="kobo.743.1"> file. </span><span class="koboSpan" id="kobo.743.2">Begin by changing </span><em class="italic"><span class="koboSpan" id="kobo.744.1">Edsel</span></em><span class="koboSpan" id="kobo.745.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.746.1">edsel</span></em><span class="koboSpan" id="kobo.747.1"> to </span><em class="italic"><span class="koboSpan" id="kobo.748.1">Studebaker</span></em><span class="koboSpan" id="kobo.749.1">, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.750.1">[donnie@fedora ~]$ sed '/[eE]dsel/cStudebaker' cars_2.txt
Studebaker
Studebaker
Studebaker
desoto
desoto
Desoto
desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.751.1">You can also specify the change to make by line numbers. </span><span class="koboSpan" id="kobo.751.2">Here’s what happens when you use the </span><em class="italic"><span class="koboSpan" id="kobo.752.1">edsel</span></em><span class="koboSpan" id="kobo.753.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.754.1">Edsel</span></em><span class="koboSpan" id="kobo.755.1"> line numbers as the address:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.756.1">[donnie@fedora ~]$ sed '1,3cStudebaker' cars_2.txt
Studebaker
desoto
desoto
Desoto
desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.757.1">You see that</span><a id="_idIndexMarker619"/><span class="koboSpan" id="kobo.758.1"> this worked a bit differently than before. </span><span class="koboSpan" id="kobo.758.2">Instead of making the change to each line separately, as happened with the other commands, here the command tells </span><code class="inlineCode"><span class="koboSpan" id="kobo.759.1">sed</span></code><span class="koboSpan" id="kobo.760.1"> to replace the range of lines as a group.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.761.1">I know this looks amazing, but you haven’t seen anything yet. </span><span class="koboSpan" id="kobo.761.2">Check out this next amazing trick.</span></p>
    <h3 id="_idParaDest-205" class="heading 3"><span class="koboSpan" id="kobo.762.1">Example 2: Changing Entire Lines of Text</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.763.1">For an even better </span><a id="_idIndexMarker620"/><span class="koboSpan" id="kobo.764.1">example, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.765.1">cars_4.txt</span></code><span class="koboSpan" id="kobo.766.1"> file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.767.1">donnie@fedora:~$ cat cars_4.txt
1958 Edsel Corsair
1949 Oldsmobile 88
1959 Edsel Ranger
1960 Edsel Ranger
1958 Edsel Bermuda
1964 Ford Galaxie
1954 Nash Ambassador
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.768.1">Now, prepare to be amazed when you run this </span><code class="inlineCode"><span class="koboSpan" id="kobo.769.1">sed</span></code><span class="koboSpan" id="kobo.770.1"> command:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.771.1">donnie@fedora:~$ sed '/[eE]dsel/c1963 Studebaker Avanti' cars_4.txt
1963 Studebaker Avanti
1949 Oldsmobile 88
1963 Studebaker Avanti
1963 Studebaker Avanti
1963 Studebaker Avanti
1964 Ford Galaxie
1954 Nash Ambassador
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.772.1">So now, you see the biggest difference between the </span><code class="inlineCode"><span class="koboSpan" id="kobo.773.1">s</span></code><span class="koboSpan" id="kobo.774.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.775.1">c</span></code> <code class="inlineCode"><span class="koboSpan" id="kobo.776.1">sed</span></code><span class="koboSpan" id="kobo.777.1"> commands. </span><span class="koboSpan" id="kobo.777.2">Instead of just replacing the text string or pattern that you specify, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.778.1">c</span></code><span class="koboSpan" id="kobo.779.1"> command replaces the entire line in which the text string or pattern is found. </span><span class="koboSpan" id="kobo.779.2">In this case, every entire line that contains the text string </span><em class="italic"><span class="koboSpan" id="kobo.780.1">Edsel</span></em><span class="koboSpan" id="kobo.781.1"> was replaced with </span><em class="italic"><span class="koboSpan" id="kobo.782.1">1963 Studebaker Avanti</span></em><span class="koboSpan" id="kobo.783.1">. </span><span class="koboSpan" id="kobo.783.2">Cool, right?</span></p>
    <h2 id="_idParaDest-206" class="heading 2"><span class="koboSpan" id="kobo.784.1">Other Miscellaneous sed tricks</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.785.1">We’re not done yet. </span><span class="koboSpan" id="kobo.785.2">Here are a few more cool tricks that you can do with </span><code class="inlineCode"><span class="koboSpan" id="kobo.786.1">sed</span></code><span class="koboSpan" id="kobo.787.1">.</span></p>
    <h3 id="_idParaDest-207" class="heading 3"><span class="koboSpan" id="kobo.788.1">Example 1: Using the q Command</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.789.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.790.1">q </span></code><span class="koboSpan" id="kobo.791.1">command </span><a id="_idIndexMarker621"/><span class="koboSpan" id="kobo.792.1">causes </span><code class="inlineCode"><span class="koboSpan" id="kobo.793.1">sed</span></code><span class="koboSpan" id="kobo.794.1"> to behave just like the </span><code class="inlineCode"><span class="koboSpan" id="kobo.795.1">head</span></code><span class="koboSpan" id="kobo.796.1"> utility. </span><span class="koboSpan" id="kobo.796.2">It tells </span><code class="inlineCode"><span class="koboSpan" id="kobo.797.1">sed</span></code><span class="koboSpan" id="kobo.798.1"> to read in the designated number of lines, and then quit. </span><span class="koboSpan" id="kobo.798.2">If you want to show the first ten lines of our public domain e-book, enter this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.799.1">[donnie@fedora ~]$ sed '10q' pg6409.txt
The Project Gutenberg eBook of How to Speak and Write Correctly
   
This ebook is for the use of anyone anywhere in the United States and
most other parts of the world at no cost and with almost no restrictions
whatsoever. </span><span class="koboSpan" id="kobo.799.2">You may copy it, give it away or re-use it under the terms
of the Project Gutenberg License included with this ebook or online
at www.gutenberg.org. </span><span class="koboSpan" id="kobo.799.3">If you are not located in the United States,
you will have to check the laws of the country where you are located
before using this eBook.
</span><span class="koboSpan" id="kobo.799.4">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.800.1">If you want to view selected lines from somewhere in the middle of a large file, you may find that </span><code class="inlineCode"><span class="koboSpan" id="kobo.801.1">sed</span></code><span class="koboSpan" id="kobo.802.1"> is easier to use than the </span><code class="inlineCode"><span class="koboSpan" id="kobo.803.1">head</span></code><span class="koboSpan" id="kobo.804.1">/</span><code class="inlineCode"><span class="koboSpan" id="kobo.805.1">tail</span></code><span class="koboSpan" id="kobo.806.1"> combination. </span><span class="koboSpan" id="kobo.806.2">Here’s how you can look at lines 1,005 through 1,010 of our e-book file:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.807.1">[donnie@fedora ~]$ sed -n '1005,1010p' pg6409.txt
                Present                     Perfect
              To be loved              To have been loved
                              PARTICIPLES
[donnie@fedora ~]$
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.808.1">Note that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.809.1">p</span></code><span class="koboSpan" id="kobo.810.1"> that I used here isn’t quite the same as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.811.1">p</span></code><span class="koboSpan" id="kobo.812.1"> option for the </span><em class="italic"><span class="koboSpan" id="kobo.813.1">substitute</span></em><span class="koboSpan" id="kobo.814.1"> command. </span><span class="koboSpan" id="kobo.814.2">This </span><code class="inlineCode"><span class="koboSpan" id="kobo.815.1">print</span></code><span class="koboSpan" id="kobo.816.1"> command is a separate command unto itself. </span><span class="koboSpan" id="kobo.816.2">Still though, it has to be used together with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.817.1">-n</span></code><span class="koboSpan" id="kobo.818.1"> option for </span><code class="inlineCode"><span class="koboSpan" id="kobo.819.1">sed</span></code><span class="koboSpan" id="kobo.820.1"> to get the results that you want.</span></p>
    </div>
    <h3 id="_idParaDest-208" class="heading 3"><span class="koboSpan" id="kobo.821.1">Example 2: Using the w Command</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.822.1">Use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.823.1">w</span></code><span class="koboSpan" id="kobo.824.1"> command </span><a id="_idIndexMarker622"/><span class="koboSpan" id="kobo.825.1">to write selected lines of text to a new file. </span><span class="koboSpan" id="kobo.825.2">You can use a regular expression as an address, as you did above for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.826.1">p</span></code><span class="koboSpan" id="kobo.827.1"> command, or you can use line numbers, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.828.1">[donnie@fedora ~]$ sed '11,13whudson_cars.txt' cars_2.txt
edsel
Edsel
Edsel
desoto
desoto
Desoto
desoto
nash
Nash
nash
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.829.1">If the preceding command looks a bit confusing, you can insert some spaces to make it more clear, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.830.1">[donnie@fedora ~]$ sed '11,13 w hudson_cars.txt' cars_2.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.831.1">Although you see the the contents of the entire file on screen, only the selected content gets saved in your new file, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.832.1">[donnie@fedora ~]$ cat hudson_cars.txt
Hudson
hudson
hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.833.1">The output will be the same as it was before. </span><span class="koboSpan" id="kobo.833.2">And, this demonstrates something that can be a bit confusing about </span><code class="inlineCode"><span class="koboSpan" id="kobo.834.1">sed</span></code><span class="koboSpan" id="kobo.835.1">. </span><span class="koboSpan" id="kobo.835.2">In some places of a </span><code class="inlineCode"><span class="koboSpan" id="kobo.836.1">sed</span></code><span class="koboSpan" id="kobo.837.1"> script, blank spaces are optional. </span><span class="koboSpan" id="kobo.837.2">In other places, such as in a previous example when I showed you how to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.838.1">-i</span></code><span class="koboSpan" id="kobo.839.1"> option with a filename suffix for the backup file, you can’t use a blank space. </span><span class="koboSpan" id="kobo.839.2">As I said before, there’s not always a lot of consistency with this stuff.</span></p>
    <h3 id="_idParaDest-209" class="heading 3"><span class="koboSpan" id="kobo.840.1">Example 3: Using the r Command</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.841.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.842.1">r</span></code><span class="koboSpan" id="kobo.843.1"> command </span><a id="_idIndexMarker623"/><span class="koboSpan" id="kobo.844.1">will read a selected file and append it to the specified place in the file you’re working with. </span><span class="koboSpan" id="kobo.844.2">To see this, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.845.1">cars_3.txt</span></code><span class="koboSpan" id="kobo.846.1"> file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.847.1">Packard
Kaiser
Frazer
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.848.1">Now, insert the </span><code class="inlineCode"><span class="koboSpan" id="kobo.849.1">cars_3.txt</span></code><span class="koboSpan" id="kobo.850.1"> file after the second line of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.851.1">cars_2.txt</span></code><span class="koboSpan" id="kobo.852.1"> file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.853.1">[donnie@fedora ~]$ sed '2rcars_3.txt' cars_2.txt
edsel
Edsel
Packard
Kaiser
Frazer
Edsel
desoto
desoto
Desoto
. </span><span class="koboSpan" id="kobo.853.2">. </span><span class="koboSpan" id="kobo.853.3">.
</span><span class="koboSpan" id="kobo.853.4">. </span><span class="koboSpan" id="kobo.853.5">. </span><span class="koboSpan" id="kobo.853.6">.
</span><span class="koboSpan" id="kobo.853.7">hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.854.1">Again, if this is confusing to read, then use the optional spaces, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.855.1">[donnie@fedora ~]$ sed '2 r cars_3.txt' cars_2.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.856.1">Either way works equally well.</span></p>
    <h2 id="_idParaDest-210" class="heading 2"><span class="koboSpan" id="kobo.857.1">Using sed program files</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.858.1">If you have </span><a id="_idIndexMarker624"/><span class="koboSpan" id="kobo.859.1">complex jobs that you perform on a regular basis, such as having to make multiple edits to either one or more documents at a time, you can create program files. </span><span class="koboSpan" id="kobo.859.2">Then, invoke </span><code class="inlineCode"><span class="koboSpan" id="kobo.860.1">sed</span></code><span class="koboSpan" id="kobo.861.1"> with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.862.1">-f</span></code><span class="koboSpan" id="kobo.863.1"> switch to read the scripts from the file. </span><span class="koboSpan" id="kobo.863.2">Let’s look at a few examples</span></p>
    <h3 id="_idParaDest-211" class="heading 3"><span class="koboSpan" id="kobo.864.1">Example 1: Appending Lines in a Text File</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.865.1">To see how this</span><a id="_idIndexMarker625"/><span class="koboSpan" id="kobo.866.1"> works, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.867.1">myfile_3.txt</span></code><span class="koboSpan" id="kobo.868.1"> file, which will look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.869.1">This here is line one.
</span><span class="koboSpan" id="kobo.869.2">And here is the second line.
</span><span class="koboSpan" id="kobo.869.3">The third.
</span><span class="koboSpan" id="kobo.869.4">Line four.
</span><span class="koboSpan" id="kobo.869.5">This is the fifth sentence.
</span><span class="koboSpan" id="kobo.869.6">Six
This here is line seven.
</span><span class="koboSpan" id="kobo.869.7">Eighth and final.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.870.1">Next, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.871.1">demo_append.txt</span></code><span class="koboSpan" id="kobo.872.1"> file, which will serve as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.873.1">sed</span></code><span class="koboSpan" id="kobo.874.1"> program file. </span><span class="koboSpan" id="kobo.874.2">Make it look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.875.1">2a\
I'll place this line after line two.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.876.1">Invoke the program file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.877.1">[donnie@fedora ~]$ sed -f demo_append.txt myfile_3.txt
This here is line one.
</span><span class="koboSpan" id="kobo.877.2">And here is the second line.
</span><span class="koboSpan" id="kobo.877.3">I'll place this line after line two.
</span><span class="koboSpan" id="kobo.877.4">The third.
</span><span class="koboSpan" id="kobo.877.5">Line four.
</span><span class="koboSpan" id="kobo.877.6">This is the fifth sentence.
</span><span class="koboSpan" id="kobo.877.7">Six
This here is line seven.
</span><span class="koboSpan" id="kobo.877.8">Eighth and final.
</span><span class="koboSpan" id="kobo.877.9">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.878.1">Note how I broke the single script in the program file into two lines. </span><span class="koboSpan" id="kobo.878.2">To make that work, I had to place a backslash at the end of the first line to let </span><code class="inlineCode"><span class="koboSpan" id="kobo.879.1">sed</span></code><span class="koboSpan" id="kobo.880.1"> know that the script would continue on the next line. </span><span class="koboSpan" id="kobo.880.2">I’ll show you in a few moments why that is important.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.881.1">Now, let’s try a program file that will insert some lines. </span><span class="koboSpan" id="kobo.881.2">This time, I’ll use a text string for the address. </span><span class="koboSpan" id="kobo.881.3">Create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.882.1">demo_insert.txt</span></code><span class="koboSpan" id="kobo.883.1"> program file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.884.1">/This/i\
I'll insert this line before all lines that contain "This".
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.885.1">Invoke the</span><a id="_idIndexMarker626"/><span class="koboSpan" id="kobo.886.1"> program, and you’ll see this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.887.1">[donnie@fedora ~]$ sed -f demo_insert.txt myfile_3.txt
I'll insert this line before all lines that contain "This".
</span><span class="koboSpan" id="kobo.887.2">This here is line one.
</span><span class="koboSpan" id="kobo.887.3">And here is the second line.
</span><span class="koboSpan" id="kobo.887.4">The third.
</span><span class="koboSpan" id="kobo.887.5">Line four.
</span><span class="koboSpan" id="kobo.887.6">I'll insert this line before all lines that contain "This".
</span><span class="koboSpan" id="kobo.887.7">This is the fifth sentence.
</span><span class="koboSpan" id="kobo.887.8">Six
I'll insert this line before all lines that contain "This".
</span><span class="koboSpan" id="kobo.887.9">This here is line seven.
</span><span class="koboSpan" id="kobo.887.10">Eighth and final.
</span><span class="koboSpan" id="kobo.887.11">[donnie@fedora ~]$
</span></code></pre>
    <h3 id="_idParaDest-212" class="heading 3"><span class="koboSpan" id="kobo.888.1">Example 2: Changing Lines in a Text File</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.889.1">Now, let’s </span><a id="_idIndexMarker627"/><span class="koboSpan" id="kobo.890.1">change lines four through six to something else. </span><span class="koboSpan" id="kobo.890.2">Create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.891.1">demo_change.txt </span></code><span class="koboSpan" id="kobo.892.1">file, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.893.1">4,6c\
Let's replace lines\
four through six\
to something else.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.894.1">Note that I again have to use backslashes to show that the script continues on the next line. </span><span class="koboSpan" id="kobo.894.2">Run</span><a id="_idIndexMarker628"/><span class="koboSpan" id="kobo.895.1"> the program, and you’ll see this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.896.1">[donnie@fedora ~]$ sed -f demo_change.txt myfile_3.txt
This here is line one.
</span><span class="koboSpan" id="kobo.896.2">And here is the second line.
</span><span class="koboSpan" id="kobo.896.3">The third.
</span><span class="koboSpan" id="kobo.896.4">Let's replace lines
four through six
to something else.
</span><span class="koboSpan" id="kobo.896.5">This here is line seven.
</span><span class="koboSpan" id="kobo.896.6">Eighth and final.
</span><span class="koboSpan" id="kobo.896.7">[donnie@fedora ~]$
</span></code></pre>
    <h3 id="_idParaDest-213" class="heading 3"><span class="koboSpan" id="kobo.897.1">Example 3: Substituting Text</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.898.1">Next, let’s </span><a id="_idIndexMarker629"/><span class="koboSpan" id="kobo.899.1">create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.900.1">demo_sub.txt</span></code><span class="koboSpan" id="kobo.901.1"> program file that will substitute </span><em class="italic"><span class="koboSpan" id="kobo.902.1">sentence</span></em><span class="koboSpan" id="kobo.903.1"> for </span><em class="italic"><span class="koboSpan" id="kobo.904.1">line</span></em><span class="koboSpan" id="kobo.905.1">, and that will only send the modified lines to </span><code class="inlineCode"><span class="koboSpan" id="kobo.906.1">stdout</span></code><span class="koboSpan" id="kobo.907.1">. </span><span class="koboSpan" id="kobo.907.2">Make it look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.908.1">s/line/sentence/p
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.909.1">Invoke the program file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.910.1">[donnie@fedora ~]$ sed -nf demo_sub.txt myfile_3.txt
This here is sentence one.
</span><span class="koboSpan" id="kobo.910.2">And here is the second sentence.
</span><span class="koboSpan" id="kobo.910.3">This here is sentence seven.
</span><span class="koboSpan" id="kobo.910.4">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.911.1">Note that I had to invoke the program with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.912.1">-n</span></code><span class="koboSpan" id="kobo.913.1"> option of </span><code class="inlineCode"><span class="koboSpan" id="kobo.914.1">sed</span></code><span class="koboSpan" id="kobo.915.1">, because I used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.916.1">p</span></code><span class="koboSpan" id="kobo.917.1"> option inside the program file.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.918.1">Try this again, except this time, use the write option to send the changed output to a new file. </span><span class="koboSpan" id="kobo.918.2">Create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.919.1">demo_write.txt</span></code><span class="koboSpan" id="kobo.920.1"> program file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.921.1">s/line/sentence/w new_myfile.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.922.1">Invoke the</span><a id="_idIndexMarker630"/><span class="koboSpan" id="kobo.923.1"> program and view the new file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.924.1">[donnie@fedora ~]$ sed -nf demo_write.txt myfile_3.txt
[donnie@fedora ~]$ cat new_myfile.txt
This here is sentence one.
</span><span class="koboSpan" id="kobo.924.2">And here is the second sentence.
</span><span class="koboSpan" id="kobo.924.3">This here is sentence seven.
</span><span class="koboSpan" id="kobo.924.4">[donnie@fedora ~]$
</span></code></pre>
    <h3 id="_idParaDest-214" class="heading 3"><span class="koboSpan" id="kobo.925.1">Example 4: Copying Lines from One File to Another</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.926.1">Finally, create </span><a id="_idIndexMarker631"/><span class="koboSpan" id="kobo.927.1">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.928.1">demo_write_2.txt</span></code><span class="koboSpan" id="kobo.929.1"> program file, which will copy selected lines from one file to another file. </span><span class="koboSpan" id="kobo.929.2">Make it look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.930.1">4,7w new_2_myfile.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.931.1">Invoke it, and view the results, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.932.1">[donnie@fedora ~]$ sed -nf demo_write_2.txt myfile_3.txt
[donnie@fedora ~]$ cat new_2_myfile.txt
Line four.
</span><span class="koboSpan" id="kobo.932.2">This is the fifth sentence.
</span><span class="koboSpan" id="kobo.932.3">Six
This here is line seven.
</span><span class="koboSpan" id="kobo.932.4">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.933.1">That’s it for the simple program files. </span><span class="koboSpan" id="kobo.933.2">Let’s now compound things a bit.</span></p>
    <h2 id="_idParaDest-215" class="heading 2"><span class="koboSpan" id="kobo.934.1">Compound Scripts in sed Program Files</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.935.1">So far, I’ve only shown you</span><a id="_idIndexMarker632"/><span class="koboSpan" id="kobo.936.1"> program files with one single </span><code class="inlineCode"><span class="koboSpan" id="kobo.937.1">sed</span></code><span class="koboSpan" id="kobo.938.1"> script. </span><span class="koboSpan" id="kobo.938.2">You can also have program files with two or more scripts. </span><span class="koboSpan" id="kobo.938.3">Begin by creating the </span><code class="inlineCode"><span class="koboSpan" id="kobo.939.1">demo_compound.txt</span></code><span class="koboSpan" id="kobo.940.1"> program file, which will look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.941.1">1,3s/Edsel/Packard/
2,4s/Packard/Lasalle/
3d
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.942.1">Now, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.943.1">riding.txt</span></code><span class="koboSpan" id="kobo.944.1"> file, which will look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.945.1">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.945.2">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.945.3">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.945.4">Let's go for a ride in my Edsel.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.946.1">Invoke the program file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.947.1">[donnie@fedora ~]$ sed -f demo_compound.txt riding.txt
Let's go for a ride in my Packard.
</span><span class="koboSpan" id="kobo.947.2">Let's go for a ride in my Lasalle.
</span><span class="koboSpan" id="kobo.947.3">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.947.4">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.948.1">Here’s the breakdown:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.949.1">This program first had </span><code class="inlineCode"><span class="koboSpan" id="kobo.950.1">sed</span></code><span class="koboSpan" id="kobo.951.1"> replace </span><em class="italic"><span class="koboSpan" id="kobo.952.1">Edsel</span></em><span class="koboSpan" id="kobo.953.1"> with </span><em class="italic"><span class="koboSpan" id="kobo.954.1">Packard</span></em><span class="koboSpan" id="kobo.955.1"> in lines one through three.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.956.1">In lines two through four, it had </span><code class="inlineCode"><span class="koboSpan" id="kobo.957.1">sed</span></code><span class="koboSpan" id="kobo.958.1"> replace </span><em class="italic"><span class="koboSpan" id="kobo.959.1">Packard</span></em><span class="koboSpan" id="kobo.960.1"> with </span><em class="italic"><span class="koboSpan" id="kobo.961.1">Lasalle</span></em><span class="koboSpan" id="kobo.962.1">.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.963.1">Finally, the last script deleted line three. </span><span class="koboSpan" id="kobo.963.2">Note that you didn’t have to use backslashes here, since none of the scripts carried over on to the next line.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.964.1">To see a second </span><a id="_idIndexMarker633"/><span class="koboSpan" id="kobo.965.1">example, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.966.1">demo_compound_2.txt</span></code><span class="koboSpan" id="kobo.967.1"> program file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.968.1">2a\
No, I'd rather ride in the Hudson Hornet with the Twin-H Power Six.\
He'd rather ride in the Pierce-Arrow.
</span><span class="koboSpan" id="kobo.968.2">3p
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.969.1">Invoke the program, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.970.1">[donnie@fedora ~]$ sed -f demo_compound_2.txt riding.txt
Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.970.2">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.970.3">No, I'd rather ride in the Hudson Hornet with the Twin-H Power Six.
</span><span class="koboSpan" id="kobo.970.4">He'd rather ride in the Pierce-Arrow.
</span><span class="koboSpan" id="kobo.970.5">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.970.6">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.970.7">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.970.8">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.971.1">This time, you have one script that appends two additional lines after line two, and a second script that causes line three to print a second time.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.972.1">Just for fun, do the same thing again, except this time delete the second line. </span><span class="koboSpan" id="kobo.972.2">Create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.973.1">demo_compound_3.txt</span></code><span class="koboSpan" id="kobo.974.1"> program file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.975.1">2a\
No, I'd rather ride in the Hudson Hornet with the Twin-H Power six.\
He'd rather ride in the Pierce-Arrow.
</span><span class="koboSpan" id="kobo.975.2">2d
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.976.1">Run the </span><a id="_idIndexMarker634"/><span class="koboSpan" id="kobo.977.1">program, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.978.1">[donnie@fedora ~]$ sed -f demo_compound_3.txt riding.txt
Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.978.2">No, I'd rather ride in the Hudson Hornet with the Twin-H Power six.
</span><span class="koboSpan" id="kobo.978.3">He'd rather ride in the Pierce-Arrow.
</span><span class="koboSpan" id="kobo.978.4">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.978.5">Let's go for a ride in my Edsel.
</span><span class="koboSpan" id="kobo.978.6">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.979.1">Even though you deleted the second line, you were still able to append the new lines to it.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.980.1">Let’s wrap up the </span><code class="inlineCode"><span class="koboSpan" id="kobo.981.1">sed</span></code><span class="koboSpan" id="kobo.982.1"> discussion with something really fancy. </span><span class="koboSpan" id="kobo.982.2">Create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.983.1">tab.txt</span></code><span class="koboSpan" id="kobo.984.1"> program file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.985.1">2,4s/^./\t&amp;/
8c\
This really is the last line.
</span><span class="koboSpan" id="kobo.985.2">1d
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.986.1">You’ll be amazed when you run this program. </span><span class="koboSpan" id="kobo.986.2">Here’s what you’ll see:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.987.1">[donnie@fedora ~]$ sed -f tab.txt myfile_3.txt
	And here is the second line.
	</span><span class="koboSpan" id="kobo.987.2">The third.
	</span><span class="koboSpan" id="kobo.987.3">Line four.
</span><span class="koboSpan" id="kobo.987.4">This is the fifth sentence.
</span><span class="koboSpan" id="kobo.987.5">Six
This here is line seven.
</span><span class="koboSpan" id="kobo.987.6">This really is the last line.
</span><span class="koboSpan" id="kobo.987.7">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.988.1">The first </span><a id="_idIndexMarker635"/><span class="koboSpan" id="kobo.989.1">script adds a tab to the beginning of every non-blank line. </span><span class="koboSpan" id="kobo.989.2">(The </span><code class="inlineCode"><span class="koboSpan" id="kobo.990.1">^.</span></code><span class="koboSpan" id="kobo.991.1"> combination means to look for every line that begins with a non-blank character. </span><span class="koboSpan" id="kobo.991.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.992.1">&amp;</span></code><span class="koboSpan" id="kobo.993.1"> after the tab character prevents </span><code class="inlineCode"><span class="koboSpan" id="kobo.994.1">sed</span></code><span class="koboSpan" id="kobo.995.1"> from replacing the first character of each line with the tab. </span><span class="koboSpan" id="kobo.995.2">Instead, it just inserts the tab before the first character.) The second script changes the text in line eight. </span><span class="koboSpan" id="kobo.995.3">Finally, the third script deletes line one.</span></p>
    <h2 id="_idParaDest-216" class="heading 2"><span class="koboSpan" id="kobo.996.1">Using sed in Shell Scripts</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.997.1">Using </span><code class="inlineCode"><span class="koboSpan" id="kobo.998.1">sed</span></code><span class="koboSpan" id="kobo.999.1"> in shell </span><a id="_idIndexMarker636"/><span class="koboSpan" id="kobo.1000.1">scripts is easy, if you only intend to run your scripts on Linux systems. </span><span class="koboSpan" id="kobo.1000.2">For example, you can do something like this </span><code class="inlineCode"><span class="koboSpan" id="kobo.1001.1">sed_test_0.sh</span></code><span class="koboSpan" id="kobo.1002.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1003.1">#!/bin/bash
sed '/[Ee]dsel/i1958' cars_2.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1004.1">Here’s how it looks when I run it on my Fedora workstation:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1005.1">donnie@fedora:~$ ./sed_test_0.sh
1958
edsel
1958
Edsel
1958
Edsel
desoto
. </span><span class="koboSpan" id="kobo.1005.2">. </span><span class="koboSpan" id="kobo.1005.3">.
</span><span class="koboSpan" id="kobo.1005.4">. </span><span class="koboSpan" id="kobo.1005.5">. </span><span class="koboSpan" id="kobo.1005.6">.
</span><span class="koboSpan" id="kobo.1005.7">Hudson
hudson
hudson
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1006.1">But, this won’t work with the default implementation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1007.1">sed</span></code><span class="koboSpan" id="kobo.1008.1"> that comes with FreeBSD, OpenIndiana, or macOS. </span><span class="koboSpan" id="kobo.1008.2">In fact, here’s what the above script gives me on a FreeBSD machine:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1009.1">donnie@freebsd14:~ $ ./sed_test_0.sh
sed: 1: "/[Ee]dsel/i1958": command i expects \ followed by text
donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1010.1">According to the error message, I should be able to make this work by preceding </span><em class="italic"><span class="koboSpan" id="kobo.1011.1">1958</span></em><span class="koboSpan" id="kobo.1012.1"> with a backslash. </span><span class="koboSpan" id="kobo.1012.2">But, I tried it, and it still doesn’t work.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1013.1">As I mentioned in the </span><em class="chapterRef"><span class="koboSpan" id="kobo.1014.1">Understanding sed Portability Issues</span></em><span class="koboSpan" id="kobo.1015.1"> section a few pages back, the implementation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1016.1">sed</span></code><span class="koboSpan" id="kobo.1017.1"> that comes with most non-Linux systems lacks the capabilities of the Linux implementation. </span><span class="koboSpan" id="kobo.1017.2">Specifically, the non-Linux implementation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1018.1">sed</span></code><span class="koboSpan" id="kobo.1019.1"> lacks </span><a id="_idIndexMarker637"/><span class="koboSpan" id="kobo.1020.1">the ability to use the append (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1021.1">a</span></code><span class="koboSpan" id="kobo.1022.1">), insert (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1023.1">i</span></code><span class="koboSpan" id="kobo.1024.1">), and change (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1025.1">c</span></code><span class="koboSpan" id="kobo.1026.1">) commands, as well as the ability to deal with regular expressions. </span><span class="koboSpan" id="kobo.1026.2">So, you’ll need to install </span><code class="inlineCode"><span class="koboSpan" id="kobo.1027.1">gsed</span></code><span class="koboSpan" id="kobo.1028.1"> on your non-Linux systems and create an alias in your shell configuration files if you want to experience the full power of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1029.1">sed</span></code><span class="koboSpan" id="kobo.1030.1"> on your non-Linux machines. </span><span class="koboSpan" id="kobo.1030.2">The second problem is that your shell scripts won’t read the shell configuration files that are in your home directory. </span><span class="koboSpan" id="kobo.1030.3">That in turn means that they won’t find the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1031.1">sed</span></code><span class="koboSpan" id="kobo.1032.1"> alias that you created in those configuration files. </span><span class="koboSpan" id="kobo.1032.2">Here’s one solution for fixing that, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1033.1">sed_test_1.sh</span></code><span class="koboSpan" id="kobo.1034.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1035.1">#!/bin/bash
if [[ $(uname) == "Darwin" || $(uname) == "FreeBSD" || $(uname) == "SunOS" ]]; then
        gsed="gsed"
elif [[ $(uname) == "Linux" ]]; then
        gsed="sed"
else
        echo "I don't know that OS."
</span><span class="koboSpan" id="kobo.1035.2">fi
$gsed '/[Ee]dsel/i1958' cars_2.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1036.1">So, we want to invoke </span><code class="inlineCode"><span class="koboSpan" id="kobo.1037.1">sed</span></code><span class="koboSpan" id="kobo.1038.1"> on our Linux machines, but we want to invoke </span><code class="inlineCode"><span class="koboSpan" id="kobo.1039.1">gsed</span></code><span class="koboSpan" id="kobo.1040.1"> on everything else. </span><span class="koboSpan" id="kobo.1040.2">To accomplish that, I’m using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1041.1">$(uname)</span></code><span class="koboSpan" id="kobo.1042.1"> to obtain the name of the operating system. </span><span class="koboSpan" id="kobo.1042.2">In the first </span><code class="inlineCode"><span class="koboSpan" id="kobo.1043.1">if</span></code><span class="koboSpan" id="kobo.1044.1"> statement, I’m using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1045.1">||</span></code><span class="koboSpan" id="kobo.1046.1"> construct as an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1047.1">or</span></code><span class="koboSpan" id="kobo.1048.1"> operator. </span><span class="koboSpan" id="kobo.1048.2">That way, I can test for Darwin, FreeBSD, or SunOS with just this one </span><code class="inlineCode"><span class="koboSpan" id="kobo.1049.1">if</span></code><span class="koboSpan" id="kobo.1050.1"> statement. </span><span class="koboSpan" id="kobo.1050.2">Then, I’m creating the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1051.1">gsed</span></code><span class="koboSpan" id="kobo.1052.1"> variable, and assigning either </span><code class="inlineCode"><span class="koboSpan" id="kobo.1053.1">gsed</span></code><span class="koboSpan" id="kobo.1054.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1055.1">sed</span></code><span class="koboSpan" id="kobo.1056.1">, as appropriate, as its value. </span><span class="koboSpan" id="kobo.1056.2">Finally, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1057.1">$gsed</span></code><span class="koboSpan" id="kobo.1058.1"> line at the bottom, I’m calling back the value of </span><a id="_idIndexMarker638"/><span class="koboSpan" id="kobo.1059.1">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1060.1">gsed</span></code><span class="koboSpan" id="kobo.1061.1"> variable to invoke either the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1062.1">gsed</span></code><span class="koboSpan" id="kobo.1063.1"> or the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1064.1">sed</span></code><span class="koboSpan" id="kobo.1065.1"> command. </span><span class="koboSpan" id="kobo.1065.2">Does it work? </span><span class="koboSpan" id="kobo.1065.3">Let’s see what it does on FreeBSD:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1066.1">donnie@freebsd14:~ $ ./sed_test_1.sh
1958
edsel
1958
Edsel
1958
Edsel
. </span><span class="koboSpan" id="kobo.1066.2">. </span><span class="koboSpan" id="kobo.1066.3">.
</span><span class="koboSpan" id="kobo.1066.4">. </span><span class="koboSpan" id="kobo.1066.5">. </span><span class="koboSpan" id="kobo.1066.6">.
</span><span class="koboSpan" id="kobo.1066.7">hudson
hudson
donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1067.1">Oh, yeah. </span><span class="koboSpan" id="kobo.1067.2">It works like a champ. </span><span class="koboSpan" id="kobo.1067.3">I’ve also tested this on macOS, Linux, and OpenIndiana, and it works properly on all of them.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.1068.1">I know, I’ve never before shown you that you can use a variable with a command as its assigned value. </span><span class="koboSpan" id="kobo.1068.2">But, you see here that it’s a handy little trick that you might find very useful.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.1069.1">And, this pretty much covers our discussion of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1070.1">sed</span></code><span class="koboSpan" id="kobo.1071.1">. </span><span class="koboSpan" id="kobo.1071.2">But, there’s still a lot to learn about </span><code class="inlineCode"><span class="koboSpan" id="kobo.1072.1">sed</span></code><span class="koboSpan" id="kobo.1073.1">. </span><span class="koboSpan" id="kobo.1073.2">As I’ve said before, it’s another one of those topics about which whole books have been written. </span><span class="koboSpan" id="kobo.1073.3">This will give you a good start, and will give you more than enough to pass the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1074.1">sed</span></code><span class="koboSpan" id="kobo.1075.1"> section of an introductory Linux certification exam.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1076.1">Next, let’s talk about </span><code class="inlineCode"><span class="koboSpan" id="kobo.1077.1">grep</span></code><span class="koboSpan" id="kobo.1078.1">.</span></p>
    <h1 id="_idParaDest-217" class="heading 1"><span class="koboSpan" id="kobo.1079.1">Understanding grep</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.1080.1">I’ve already shown you some fancy ways to search for files on your system. </span><span class="koboSpan" id="kobo.1080.2">But, what if you need to search for something that’s </span><em class="italic"><span class="koboSpan" id="kobo.1081.1">in</span></em><span class="koboSpan" id="kobo.1082.1"> a file? </span><span class="koboSpan" id="kobo.1082.2">What if you don’t know exactly what you’re looking for? </span><span class="koboSpan" id="kobo.1082.3">Worse yet, what if you don’t even know which file to look in? </span><span class="koboSpan" id="kobo.1082.4">Not to worry, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1083.1">grep</span></code><span class="koboSpan" id="kobo.1084.1"> is here to help.</span></p>
    <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.1085.1">grep</span></code><span class="koboSpan" id="kobo.1086.1">, short for </span><em class="italic"><span class="koboSpan" id="kobo.1087.1">Global Regular Expression Print</span></em><span class="koboSpan" id="kobo.1088.1">, is a powerful command-line utility that comes packaged with just about every Unix or Unix-derived operating system. </span><span class="koboSpan" id="kobo.1088.2">(This includes Linux and macOS.) There’s also an available version for Windows.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1089.1">You can direct </span><code class="inlineCode"><span class="koboSpan" id="kobo.1090.1">grep</span></code><span class="koboSpan" id="kobo.1091.1"> to </span><a id="_idIndexMarker639"/><span class="koboSpan" id="kobo.1092.1">search through one file or many. </span><span class="koboSpan" id="kobo.1092.2">You can also pipe in output from some other utility so that you’ll see only the information that you want to see. </span><span class="koboSpan" id="kobo.1092.3">And, the fact that </span><code class="inlineCode"><span class="koboSpan" id="kobo.1093.1">grep</span></code><span class="koboSpan" id="kobo.1094.1"> can use regular expressions allows you to perform searches even when you only have an approximate idea of what you’re searching for.</span></p>
    <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.1095.1">grep</span></code><span class="koboSpan" id="kobo.1096.1"> isn’t hard, but is does require a bit of practice. </span><span class="koboSpan" id="kobo.1096.2">If you’re ready, let’s get started.</span></p>
    <h2 id="_idParaDest-218" class="heading 2"><span class="koboSpan" id="kobo.1097.1">Basic Searches with grep</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1098.1">I’ve already shown you some </span><a id="_idIndexMarker640"/><span class="koboSpan" id="kobo.1099.1">examples of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1100.1">grep</span></code><span class="koboSpan" id="kobo.1101.1"> in </span><em class="chapterRef"><span class="koboSpan" id="kobo.1102.1">Chapter 7, Text Stream Filters Part 2</span></em><span class="koboSpan" id="kobo.1103.1"> and </span><em class="chapterRef"><span class="koboSpan" id="kobo.1104.1">Chapter 8, Basic Shell Script Construction</span></em><span class="koboSpan" id="kobo.1105.1">, but that’s okay. </span><span class="koboSpan" id="kobo.1105.2">I’d still like to start with the basics and provide an explanation of how to use it. </span><span class="koboSpan" id="kobo.1105.3">I’ll begin the demos with some text files that you’ve already created.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1106.1">The most basic way to use grep is to search for a text string within a single file, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1107.1">[donnie@fedora ~]$ grep 'Edsel' cars_2.txt
Edsel
Edsel
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1108.1">Here, I listed the text string that I want to find, and then listed the name of the file that contains the text string. </span><span class="koboSpan" id="kobo.1108.2">I surrounded the search term with a pair of single quotes, but I didn’t need to in this case. </span><span class="koboSpan" id="kobo.1108.3">I only need the quotes if the search term contains characters that the shell will interpret incorrectly. </span><span class="koboSpan" id="kobo.1108.4">(I most always use the single quotes, due to force-of-habit.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1109.1">By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1110.1">grep</span></code><span class="koboSpan" id="kobo.1111.1"> is </span><a id="_idIndexMarker641"/><span class="koboSpan" id="kobo.1112.1">case-sensitive. </span><span class="koboSpan" id="kobo.1112.2">Use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1113.1">-i </span></code><span class="koboSpan" id="kobo.1114.1">switch to make it case-insensitive, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1115.1">[donnie@fedora ~]$ grep -i 'Edsel' cars_2.txt
edsel
Edsel
Edsel
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1116.1">If you need to see which lines of the file contain the search term, use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1117.1">-n</span></code><span class="koboSpan" id="kobo.1118.1"> switch, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1119.1">[donnie@fedora ~]$ grep -in 'Edsel' cars_2.txt
1:edsel
2:Edsel
3:Edsel
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1120.1">You can use a wild-card to search through multiple files at once, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1121.1">[donnie@fedora ~]$ grep -in 'Edsel' cars*
cars_2.txt:1:edsel
cars_2.txt:2:Edsel
cars_2.txt:3:Edsel
cars_2.txt.bak:1:edsel
cars_2.txt.bak:2:Edsel
cars_2.txt.bak:3:Edsel
cars_2.txtbak:1:edsel
cars_2.txtbak:2:Edsel
cars_2.txtbak:3:Edsel
cars.txt:1:edsel
cars.txt:2:Edsel
cars.txt:3:Edsel
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1122.1">Note how the filenames are now included in the output.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1123.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1124.1">-v</span></code><span class="koboSpan" id="kobo.1125.1"> switch </span><a id="_idIndexMarker642"/><span class="koboSpan" id="kobo.1126.1">means inverse. </span><span class="koboSpan" id="kobo.1126.2">Use it to show all lines that </span><em class="italic"><span class="koboSpan" id="kobo.1127.1">don’t</span></em><span class="koboSpan" id="kobo.1128.1"> have the specified search term, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1129.1">[donnie@fedora ~]$ grep -inv 'Edsel' cars*
cars_2.txt:4:desoto
cars_2.txt:5:desoto
cars_2.txt:6:Desoto
cars_2.txt:7:desoto
cars_2.txt:8:nash
cars_2.txt:9:Nash
cars_2.txt:10:nash
. </span><span class="koboSpan" id="kobo.1129.2">. </span><span class="koboSpan" id="kobo.1129.3">.
</span><span class="koboSpan" id="kobo.1129.4">. </span><span class="koboSpan" id="kobo.1129.5">. </span><span class="koboSpan" id="kobo.1129.6">.
</span><span class="koboSpan" id="kobo.1129.7">cars.txt:11:Hudson
cars.txt:12:hudson
cars.txt:13:hudson
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1130.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1131.1">-c</span></code><span class="koboSpan" id="kobo.1132.1"> switch shows a count of how many times a search pattern is in a file, but it doesn’t show the lines where the search pattern was found. </span><span class="koboSpan" id="kobo.1132.2">It looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1133.1">[donnie@fedora ~]$ grep -ic 'edsel' cars*
cars_2.txt:3
cars_2.txt.bak:3
cars_2.txtbak:3
cars_3.txt:0
cars_cap.txt:0
cars.txt:3
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1134.1">In these </span><a id="_idIndexMarker643"/><span class="koboSpan" id="kobo.1135.1">examples, I’ve been showing you how to combine the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1136.1">grep</span></code><span class="koboSpan" id="kobo.1137.1"> option switches with just a single </span><code class="inlineCode"><span class="koboSpan" id="kobo.1138.1">-</span></code><span class="koboSpan" id="kobo.1139.1">. </span><span class="koboSpan" id="kobo.1139.2">Of course, you can just use one option at a time, if that fits your needs.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1140.1">Okay, so these were fairly simple examples, and you’re saying, “Hey, when do we get to the good stuff?” </span><span class="koboSpan" id="kobo.1140.2">Well, hang on, it’s coming.</span></p>
    <h2 id="_idParaDest-219" class="heading 2"><span class="koboSpan" id="kobo.1141.1">More Advanced Searches with grep</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1142.1">Here are</span><a id="_idIndexMarker644"/><span class="koboSpan" id="kobo.1143.1"> a few more cool grep optons.</span></p>
    <h3 id="_idParaDest-220" class="heading 3"><span class="koboSpan" id="kobo.1144.1">Example 1: Searching for Whole Words</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.1145.1">By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1146.1">grep</span></code><span class="koboSpan" id="kobo.1147.1"> doesn’t </span><a id="_idIndexMarker645"/><span class="koboSpan" id="kobo.1148.1">search for whole words. </span><span class="koboSpan" id="kobo.1148.2">So, if you search for the text string </span><em class="italic"><span class="koboSpan" id="kobo.1149.1">and</span></em><span class="koboSpan" id="kobo.1150.1">, it will display lines that contain the words </span><em class="italic"><span class="koboSpan" id="kobo.1151.1">land</span></em><span class="koboSpan" id="kobo.1152.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1153.1">hand</span></em><span class="koboSpan" id="kobo.1154.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1155.1">sand</span></em><span class="koboSpan" id="kobo.1156.1">, along with the word </span><em class="italic"><span class="koboSpan" id="kobo.1157.1">and</span></em><span class="koboSpan" id="kobo.1158.1">. </span><span class="koboSpan" id="kobo.1158.2">Let’s look at that by searching through our public-domain e-book for the text string </span><em class="italic"><span class="koboSpan" id="kobo.1159.1">noun</span></em><span class="koboSpan" id="kobo.1160.1">. </span><span class="koboSpan" id="kobo.1160.2">(It’s a very long output, so I’ll only show part of it.) I’ll make it a case-sensitive search, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1161.1">[donnie@fedora ~]$ grep 'noun' pg6409.txt
Noun, Adjective, Pronoun, Verb, Adverb, Preposition, Conjunction and
_Gender_ has the same relation to nouns that sex has to individuals, but
_Case_ is the relation one noun bears to another or to a verb or to a
An _Article_ is a word placed before a noun to show whether the latter is
An _Adjective_ is a word which qualifies a noun, that is, which shows
some distinguishing mark or characteristic belonging to the noun.
</span><span class="koboSpan" id="kobo.1161.2">A _Pronoun_ is a word used for or instead of a noun to keep us from
repeating the same noun too often. </span><span class="koboSpan" id="kobo.1161.3">Pronouns, like nouns, have case,
number, gender and person. </span><span class="koboSpan" id="kobo.1161.4">There are three kinds of pronouns, _personal_,
of speech in properly pronouncing them.
</span><span class="koboSpan" id="kobo.1161.5">. </span><span class="koboSpan" id="kobo.1161.6">. </span><span class="koboSpan" id="kobo.1161.7">.
</span><span class="koboSpan" id="kobo.1161.8">. </span><span class="koboSpan" id="kobo.1161.9">. </span><span class="koboSpan" id="kobo.1161.10">.
</span><span class="koboSpan" id="kobo.1161.11">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1162.1">This search returned not only lines that contain the word </span><em class="italic"><span class="koboSpan" id="kobo.1163.1">noun</span></em><span class="koboSpan" id="kobo.1164.1">, but also lines that contain </span><em class="italic"><span class="koboSpan" id="kobo.1165.1">nouns</span></em><span class="koboSpan" id="kobo.1166.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1167.1">pronouns</span></em><span class="koboSpan" id="kobo.1168.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1169.1">Pronouns</span></em><span class="koboSpan" id="kobo.1170.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.1171.1">Pronoun</span></em><span class="koboSpan" id="kobo.1172.1">. </span><span class="koboSpan" id="kobo.1172.2">One line has the word </span><em class="italic"><span class="koboSpan" id="kobo.1173.1">pronouncing</span></em><span class="koboSpan" id="kobo.1174.1">. </span><span class="koboSpan" id="kobo.1174.2">If you want to search for the word </span><em class="italic"><span class="koboSpan" id="kobo.1175.1">noun</span></em><span class="koboSpan" id="kobo.1176.1">, and only the word </span><em class="italic"><span class="koboSpan" id="kobo.1177.1">noun</span></em><span class="koboSpan" id="kobo.1178.1">, then you’ll have to add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1179.1">-w</span></code><span class="koboSpan" id="kobo.1180.1"> switch, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1181.1">[donnie@fedora ~]$ grep -w 'noun' pg6409.txt
_Case_ is the relation one noun bears to another or to a verb or to a
An _Article_ is a word placed before a noun to show whether the latter is
An _Adjective_ is a word which qualifies a noun, that is, which shows
some distinguishing mark or characteristic belonging to the noun.
</span><span class="koboSpan" id="kobo.1181.2">A _Pronoun_ is a word used for or instead of a noun to keep us from
repeating the same noun too often. </span><span class="koboSpan" id="kobo.1181.3">Pronouns, like nouns, have case,
An _Article_ is a word placed before a noun to show whether the noun is
thing but indicates the noun in its widest sense; thus, _a_ man means any
_Number_ is that inflection of the noun by which we indicate whether it
_Gender_ is that inflection by which we signify whether the noun is the
. </span><span class="koboSpan" id="kobo.1181.4">. </span><span class="koboSpan" id="kobo.1181.5">.
</span><span class="koboSpan" id="kobo.1181.6">. </span><span class="koboSpan" id="kobo.1181.7">. </span><span class="koboSpan" id="kobo.1181.8">.
</span><span class="koboSpan" id="kobo.1181.9">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1182.1">You’ve narrowed</span><a id="_idIndexMarker646"/><span class="koboSpan" id="kobo.1183.1"> the search considerably. </span><span class="koboSpan" id="kobo.1183.2">(You’ll still see some </span><em class="italic"><span class="koboSpan" id="kobo.1184.1">Pronouns</span></em><span class="koboSpan" id="kobo.1185.1"> in here, but only because they were on the same line as a </span><em class="italic"><span class="koboSpan" id="kobo.1186.1">noun</span></em><span class="koboSpan" id="kobo.1187.1">.) </span></p>
    <h5 class="heading 5"><span class="koboSpan" id="kobo.1188.1">Example 2: Making Searches Case-Insensitive</span></h5>
    <p class="normal"><span class="koboSpan" id="kobo.1189.1">Now, add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1190.1">-i</span></code><span class="koboSpan" id="kobo.1191.1"> switch </span><a id="_idIndexMarker647"/><span class="koboSpan" id="kobo.1192.1">to make the search case-insensitive, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1193.1">[donnie@fedora ~]$ grep -iw 'noun' pg6409.txt
Noun, Adjective, Pronoun, Verb, Adverb, Preposition, Conjunction and
Interjection. </span><span class="koboSpan" id="kobo.1193.2">Of these, the Noun is the most important, as all the others
are more or less dependent upon it. </span><span class="koboSpan" id="kobo.1193.3">A Noun signifies the name of any
_Case_ is the relation one noun bears to another or to a verb or to a
An _Article_ is a word placed before a noun to show whether the latter is
An _Adjective_ is a word which qualifies a noun, that is, which shows
some distinguishing mark or characteristic belonging to the noun.
</span><span class="koboSpan" id="kobo.1193.4">A _Pronoun_ is a word used for or instead of a noun to keep us from
repeating the same noun too often. </span><span class="koboSpan" id="kobo.1193.5">Pronouns, like nouns, have case,
An _Article_ is a word placed before a noun to show whether the noun is
thing but indicates the noun in its widest sense; thus, _a_ man means any
NOUN
. </span><span class="koboSpan" id="kobo.1193.6">. </span><span class="koboSpan" id="kobo.1193.7">.
</span><span class="koboSpan" id="kobo.1193.8">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1194.1">Add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1195.1">^</span></code><span class="koboSpan" id="kobo.1196.1"> metacharacter to the left of the search pattern, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1197.1">grep</span></code><span class="koboSpan" id="kobo.1198.1"> will only display the lines where</span><a id="_idIndexMarker648"/><span class="koboSpan" id="kobo.1199.1"> the search pattern appears at the beginning, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1200.1">[donnie@fedora ~]$ grep -iw '^noun' pg6409.txt
Noun, Adjective, Pronoun, Verb, Adverb, Preposition, Conjunction and
NOUN
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1201.1">Just for curiosity, count how many times the whole word </span><em class="italic"><span class="koboSpan" id="kobo.1202.1">noun</span></em><span class="koboSpan" id="kobo.1203.1"> shows up in this document by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1204.1">-c</span></code><span class="koboSpan" id="kobo.1205.1"> switch, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1206.1">[donnie@fedora ~]$ grep -iwc 'noun' pg6409.txt
33
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1207.1">Now, will it make a difference if I omit the -i switch to make this case-sensitive? </span><span class="koboSpan" id="kobo.1207.2">Let’s see:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1208.1">donnie@fedora:~$ grep -wc 'noun' pg6409.txt
29
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1209.1">So, we have a </span><a id="_idIndexMarker649"/><span class="koboSpan" id="kobo.1210.1">total of 33 case-insensitive </span><em class="italic"><span class="koboSpan" id="kobo.1211.1">noun</span></em><span class="koboSpan" id="kobo.1212.1"> strings, and 29 that are case-sensitive. </span><span class="koboSpan" id="kobo.1212.2">This tells me that there are four </span><em class="italic"><span class="koboSpan" id="kobo.1213.1">noun</span></em><span class="koboSpan" id="kobo.1214.1"> strings with at least one upper-case letter.</span></p>
    <h5 class="heading 5"><span class="koboSpan" id="kobo.1215.1">Example 3: Dealing with Carriage Returns</span></h5>
    <p class="normal"><span class="koboSpan" id="kobo.1216.1">Here’s a realistic</span><a id="_idIndexMarker650"/><span class="koboSpan" id="kobo.1217.1"> scenario that you just might encounter at some point in your Linux career. </span><span class="koboSpan" id="kobo.1217.2">It’s one that could cause you a good bit of consternation until you finally figure it out.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1218.1">You’ve just seen how to perform a case-insensitive search for every occurrence of the word </span><em class="italic"><span class="koboSpan" id="kobo.1219.1">noun</span></em><span class="koboSpan" id="kobo.1220.1"> at the start of a line. </span><span class="koboSpan" id="kobo.1220.2">You found one </span><em class="italic"><span class="koboSpan" id="kobo.1221.1">NOUN</span></em><span class="koboSpan" id="kobo.1222.1"> on a line by itself. </span><span class="koboSpan" id="kobo.1222.2">It would make sense then that you would also find that line by performing a case-insensitive search for </span><em class="italic"><span class="koboSpan" id="kobo.1223.1">noun</span></em><span class="koboSpan" id="kobo.1224.1"> at the end of lines. </span><span class="koboSpan" id="kobo.1224.2">So now, give it a try:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1225.1">[donnie@fedora ~]$ grep -iw 'noun$' pg6409.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1226.1">Wait a minute. </span><span class="koboSpan" id="kobo.1226.2">Why didn’t it find anything? </span><span class="koboSpan" id="kobo.1226.3">We know that there’s one to be found. </span><span class="koboSpan" id="kobo.1226.4">Well, here’s a clue.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1227.1">A few chapters back, I told you that I downloaded this file from the Project Gutenberg web site. </span><span class="koboSpan" id="kobo.1227.2">So, there’s a good possibility that the file was created with either a DOS or Windows text editor. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1228.1">That’s significant because DOS and Windows text editors place a carriage return character at the end of each line in text files, where Unix and Linux text editors just use newline characters. </span><span class="koboSpan" id="kobo.1228.2">If </span><code class="inlineCode"><span class="koboSpan" id="kobo.1229.1">grep</span></code><span class="koboSpan" id="kobo.1230.1"> sees a newline character during a search, it will just ignore it. </span><span class="koboSpan" id="kobo.1230.2">However, it won’t ignore a carriage return. </span><span class="koboSpan" id="kobo.1230.3">Now, let’s test our theory. </span><span class="koboSpan" id="kobo.1230.4">I’ll start by showing you how to use another Regular Expressions metacharacter.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1231.1">If you place a dot in a search pattern, it means that you’ll accept the presence of any single character in that position, as long as the rest of the pattern can make a proper match. </span><span class="koboSpan" id="kobo.1231.2">So, place a dot at the end of your search pattern. </span><span class="koboSpan" id="kobo.1231.3">Then, pipe the output into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1232.1">od -c</span></code><span class="koboSpan" id="kobo.1233.1"> command, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1234.1">[donnie@fedora ~]$ grep -iw 'noun.$' pg6409.txt | od -c
0000000   N   O   U   N  \r  \n
0000006
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1235.1">Yeah, there’s the problem. </span><span class="koboSpan" id="kobo.1235.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1236.1">\r</span></code><span class="koboSpan" id="kobo.1237.1"> is the carriage return control character. </span><span class="koboSpan" id="kobo.1237.2">Not to worry, though. </span><span class="koboSpan" id="kobo.1237.3">Just use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1238.1">tr </span></code><span class="koboSpan" id="kobo.1239.1">with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1240.1">-d</span></code><span class="koboSpan" id="kobo.1241.1"> option to get rid of those pesky rascals. </span><span class="koboSpan" id="kobo.1241.2">Save the converted output to a new file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1242.1">[donnie@fedora ~]$ tr -d '\r' &lt; pg6409.txt &gt; linux_pg6409.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1243.1">Verify that the carriage returns are gone and that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1244.1">grep</span></code><span class="koboSpan" id="kobo.1245.1"> search now works correctly, by performing the searches without the dot in the pattern. </span><span class="koboSpan" id="kobo.1245.2">It should look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1246.1">[donnie@fedora ~]$ grep -iw 'noun$' linux_pg6409.txt | od -c
0000000   N   O   U   N  \n
0000005
[donnie@fedora ~]$ grep -iw 'noun$' linux_pg6409.txt
NOUN
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1247.1">Now when you </span><a id="_idIndexMarker651"/><span class="koboSpan" id="kobo.1248.1">feed the search output through </span><code class="inlineCode"><span class="koboSpan" id="kobo.1249.1">od</span></code><span class="koboSpan" id="kobo.1250.1">, you’ll see that the carriage return character is gone. </span><span class="koboSpan" id="kobo.1250.2">Then, when you try the original search, you get just what you’re supposed to get.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1251.1">But, you’re not done yet. </span><span class="koboSpan" id="kobo.1251.2">What if there’s a </span><em class="italic"><span class="koboSpan" id="kobo.1252.1">noun</span></em><span class="koboSpan" id="kobo.1253.1"> at the end of a line that’s also the end of a sentence? </span><span class="koboSpan" id="kobo.1253.2">Then, the </span><em class="italic"><span class="koboSpan" id="kobo.1254.1">noun</span></em><span class="koboSpan" id="kobo.1255.1"> would be followed by a period, and the search as you’ve just performed it wouldn’t pick it up. </span><span class="koboSpan" id="kobo.1255.2">Let’s go back a few steps, and perform the search with our dot metacharacter again, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1256.1">[donnie@fedora ~]$ grep -iw 'noun.$' linux_pg6409.txt
some distinguishing mark or characteristic belonging to the noun.
</span><span class="koboSpan" id="kobo.1256.2">_s_ and these phrases are now idioms of the language. </span><span class="koboSpan" id="kobo.1256.3">All plural nouns
verb, _summons_, a noun.
</span><span class="koboSpan" id="kobo.1256.4">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1257.1">Now that the carriage return character is gone, this search now finds </span><em class="italic"><span class="koboSpan" id="kobo.1258.1">noun.</span></em><span class="koboSpan" id="kobo.1259.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.1260.1">nouns.</span></em><span class="koboSpan" id="kobo.1261.1"> But, you don’t want to find </span><em class="italic"><span class="koboSpan" id="kobo.1262.1">nouns</span></em><span class="koboSpan" id="kobo.1263.1">. </span><span class="koboSpan" id="kobo.1263.2">You only want to find the singular </span><em class="italic"><span class="koboSpan" id="kobo.1264.1">noun</span></em><span class="koboSpan" id="kobo.1265.1">. </span><span class="koboSpan" id="kobo.1265.2">I’ll show you how by introducing another metacharacter, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1266.1">[donnie@fedora ~]$ grep -iw 'noun\.\?$' linux_pg6409.txt
some distinguishing mark or characteristic belonging to the noun.
</span><span class="koboSpan" id="kobo.1266.2">NOUN
verb, _summons_, a noun.
</span><span class="koboSpan" id="kobo.1266.3">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1267.1">By placing a </span><a id="_idIndexMarker652"/><span class="koboSpan" id="kobo.1268.1">backslash in front of the dot, you’ve turned the dot metacharacter into a common period. </span><span class="koboSpan" id="kobo.1268.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1269.1">\?</span></code><span class="koboSpan" id="kobo.1270.1"> tells </span><code class="inlineCode"><span class="koboSpan" id="kobo.1271.1">grep</span></code><span class="koboSpan" id="kobo.1272.1"> to try to find a match for the character that precedes it, but that it’s okay if it doesn’t find a match. </span><span class="koboSpan" id="kobo.1272.2">So here, you’re telling </span><code class="inlineCode"><span class="koboSpan" id="kobo.1273.1">grep</span></code><span class="koboSpan" id="kobo.1274.1"> to perform a case-insensitive search for the whole word </span><em class="italic"><span class="koboSpan" id="kobo.1275.1">noun</span></em><span class="koboSpan" id="kobo.1276.1"> at the ends of lines, with or without the period. </span><span class="koboSpan" id="kobo.1276.2">(Are you beginning to see how much fun that Regular Expressions can be?)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1277.1">Okay, you’ve seen some cool stuff, but you’re still not done. </span><span class="koboSpan" id="kobo.1277.2">So, let’s move on.</span></p>
    <h2 id="_idParaDest-221" class="heading 2"><span class="koboSpan" id="kobo.1278.1">Even More Advanced Searches with grep</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1279.1">You can combine </span><code class="inlineCode"><span class="koboSpan" id="kobo.1280.1">grep</span></code><span class="koboSpan" id="kobo.1281.1"> with other utilities for even more advanced searches. </span><span class="koboSpan" id="kobo.1281.2">Here’s how.</span></p>
    <h3 id="_idParaDest-222" class="heading 3"><span class="koboSpan" id="kobo.1282.1">Example 1: Auditing Source Code Files</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.1283.1">To demo this, use</span><a id="_idIndexMarker653"/><span class="koboSpan" id="kobo.1284.1"> either your Fedora Server or your Debian virtual machine, so that you can install a package that you might not want to install on your Linux workstation, if that’s what you’re using. </span><span class="koboSpan" id="kobo.1284.2">On Fedora Server, install the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1285.1">cairo-devel</span></code><span class="koboSpan" id="kobo.1286.1"> package, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1287.1">[donnie@fedora-server ~]$ sudo dnf install cairo-devel
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1288.1">If you’d rather use the Debian virtual machine, install the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1289.1">libghc-cairo-dev</span></code><span class="koboSpan" id="kobo.1290.1"> package, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1291.1">donnie@debian:~$ sudo apt install libghc-cairo-dev
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1292.1">Next, look</span><a id="_idIndexMarker654"/><span class="koboSpan" id="kobo.1293.1"> through the source code files in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1294.1">/usr/include/cairo/</span></code><span class="koboSpan" id="kobo.1295.1"> directory, looking for lines that have the string </span><code class="inlineCode"><span class="koboSpan" id="kobo.1296.1">#include</span></code><span class="koboSpan" id="kobo.1297.1">, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1298.1">[donnie@fedora-server ~]$ grep -ihr '#include' /usr/include/cairo/* | sort | uniq -c
      1 #include "cairo-deprecated.h"
      1 #include "cairo-features.h"
      9 #include "cairo.h"
      1 #include &lt;cairo.h&gt;
      1 #include "cairo-version.h"
      1 #include &lt;fontconfig/fontconfig.h&gt;
      1 #include &lt;ft2build.h&gt;
      1 #include FT_FREETYPE_H
      2 #include &lt;stdio.h&gt;
      1 #include &lt;X11/extensions/Xrender.h&gt;
      2 #include &lt;X11/Xlib.h&gt;
      1 #include &lt;xcb/render.h&gt;
      1 #include &lt;xcb/xcb.h&gt;
[donnie@fedora-server ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1299.1">If you don’t want to show the filenames where the text strings are found, use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1300.1">-h</span></code><span class="koboSpan" id="kobo.1301.1"> switch. </span><span class="koboSpan" id="kobo.1301.2">Then feed the lines through </span><code class="inlineCode"><span class="koboSpan" id="kobo.1302.1">sort</span></code><span class="koboSpan" id="kobo.1303.1">, which in turn will feed the lines through </span><code class="inlineCode"><span class="koboSpan" id="kobo.1304.1">uniq</span></code><span class="koboSpan" id="kobo.1305.1">. </span><span class="koboSpan" id="kobo.1305.2">That way, you’ll end up with sorted output, and all duplicate lines will be eliminated. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1306.1">Also, by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1307.1">-c</span></code><span class="koboSpan" id="kobo.1308.1"> switch with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1309.1">uniq</span></code><span class="koboSpan" id="kobo.1310.1">, we’ll find out how many times each particular line was duplicated.</span></p>
    <h3 id="_idParaDest-223" class="heading 3"><span class="koboSpan" id="kobo.1311.1">Example 2: Searching for Social Security Numbers</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.1312.1">Here’s a more </span><a id="_idIndexMarker655"/><span class="koboSpan" id="kobo.1313.1">complex example of how to use a regular expression for your search. </span><span class="koboSpan" id="kobo.1313.2">First, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1314.1">ssn.txt</span></code><span class="koboSpan" id="kobo.1315.1"> file with a list of names, birth dates, and US Social Security numbers, like this: </span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1316.1">Knockwurst,     Ronald J.       </span><span class="koboSpan" id="kobo.1316.2">899-98-1247
Born 28 April 1954
Liverwurst,     Alex            988-45-7898
Born 1 Feb 1933
Saurbraten,     Alicia          978-98-6987
Born 5 Apr 1956
Hassenfeffer,   Gerald          999-87-1258
Born 10 Jan 1961
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.1317.1">Note that these are all fictitious, so we’re not violating anyone’s privacy here. </span><span class="koboSpan" id="kobo.1317.2">Also, I have no idea why I chose German foods for the surnames. </span><span class="koboSpan" id="kobo.1317.3">Perhaps I was hungry?</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.1318.1">Then, construct a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1319.1">grep</span></code><span class="koboSpan" id="kobo.1320.1"> command that will only show lines that contain Social Security numbers, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1321.1">[donnie@fedora ~]$ grep '[0-9]\{3\}-[0-9]\{2\}-[0-9]\{4\}' ssn.txt
Knockwurst,	Ronald J.	</span><span class="koboSpan" id="kobo.1321.2">899-98-1247
Liverwurst,	Alex		988-45-7898
Saurbraten,	Alicia		978-98-6987
Hassenfeffer,	Gerald		999-87-1258
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1322.1">Here, each</span><a id="_idIndexMarker656"/><span class="koboSpan" id="kobo.1323.1"> instance of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1324.1">[0-9]</span></code><span class="koboSpan" id="kobo.1325.1"> means that you’re searching for any digit. </span><span class="koboSpan" id="kobo.1325.2">The numbers that are surrounded by the backslashes and curly braces mean that you want to find a certain number of consecutive digits. </span><span class="koboSpan" id="kobo.1325.3">So, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1326.1">[0-9]\{3\}</span></code><span class="koboSpan" id="kobo.1327.1"> construct means that you’re hunting for three consecutive digits. </span><span class="koboSpan" id="kobo.1327.2">There are three of those groupings in this regular expression, all separated by a hyphen.</span></p>
    <h3 id="_idParaDest-224" class="heading 3"><span class="koboSpan" id="kobo.1328.1">Example 3: Using the ^ Metacharacter</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.1329.1">Here’s one </span><a id="_idIndexMarker657"/><span class="koboSpan" id="kobo.1330.1">more example before we move on to the next topic. </span><span class="koboSpan" id="kobo.1330.2">This is an example of how the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1331.1">^</span></code><span class="koboSpan" id="kobo.1332.1"> metacharacter can have two different meanings, depending on its placement in the regular expression. </span><span class="koboSpan" id="kobo.1332.2">See how that works in the following </span><code class="inlineCode"><span class="koboSpan" id="kobo.1333.1">grep</span></code><span class="koboSpan" id="kobo.1334.1"> command:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1335.1">[donnie@fedora ~]$ grep '^[^a-zA-Z]' pg6409.txt | less
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1336.1">In this command, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1337.1">'^[^a-zA-Z]'</span></code><span class="koboSpan" id="kobo.1338.1"> regular expression means to look for all lines that do </span><em class="italic"><span class="koboSpan" id="kobo.1339.1">not</span></em><span class="koboSpan" id="kobo.1340.1"> begin with a letter. </span><span class="koboSpan" id="kobo.1340.2">That’s because outside of the square bracket, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1341.1">^</span></code><span class="koboSpan" id="kobo.1342.1"> means to only look for a match at the beginning of a line. </span><span class="koboSpan" id="kobo.1342.2">Inside the square brackets, in front of the designated search term, it means to display everything that </span><em class="italic"><span class="koboSpan" id="kobo.1343.1">doesn’t</span></em><span class="koboSpan" id="kobo.1344.1"> match that term.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1345.1">Of course, you’ll also see a lot of consecutive blank lines, since blank lines don’t start with a letter. </span><span class="koboSpan" id="kobo.1345.2">If you don’t need to see all of those blank lines, just feed the grep output into </span><code class="inlineCode"><span class="koboSpan" id="kobo.1346.1">uniq</span></code><span class="koboSpan" id="kobo.1347.1">, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1348.1">[donnie@fedora ~]$ grep '^[^a-zA-Z]' pg6409.txt | uniq | less
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1349.1">Be sure to scroll through the output of both of these two commands, and note the difference.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1350.1">All right, let’s move on to see if we can extend things a bit.</span></p>
    <h2 id="_idParaDest-225" class="heading 2"><span class="koboSpan" id="kobo.1351.1">Using Extended Regular Expressions with grep</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1352.1">As you saw on the regular </span><a id="_idIndexMarker658"/><span class="koboSpan" id="kobo.1353.1">expressions metacharacter charts a few pages back in the </span><em class="chapterRef"><span class="koboSpan" id="kobo.1354.1">Understanding Regular Expressions</span></em><span class="koboSpan" id="kobo.1355.1"> section, there are two forms of command syntax for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1356.1">grep</span></code><span class="koboSpan" id="kobo.1357.1">. </span><span class="koboSpan" id="kobo.1357.2">What I’ve shown you so far is the </span><em class="italic"><span class="koboSpan" id="kobo.1358.1">basic</span></em><span class="koboSpan" id="kobo.1359.1"> syntax. </span><span class="koboSpan" id="kobo.1359.2">The other form is the </span><em class="italic"><span class="koboSpan" id="kobo.1360.1">extended</span></em><span class="koboSpan" id="kobo.1361.1"> syntax. </span><span class="koboSpan" id="kobo.1361.2">Here are two differences between the two:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.1362.1">Basic syntax requires the use of a backslash in front of certain metacharacters, but extended syntax doesn’t.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1363.1">Extended syntax requires that you either use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1364.1">egrep</span></code><span class="koboSpan" id="kobo.1365.1"> instead of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1366.1">grep</span></code><span class="koboSpan" id="kobo.1367.1">, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1368.1">grep</span></code><span class="koboSpan" id="kobo.1369.1"> with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1370.1">-E</span></code><span class="koboSpan" id="kobo.1371.1"> option switch. </span><span class="koboSpan" id="kobo.1371.2">(Be aware that although </span><code class="inlineCode"><span class="koboSpan" id="kobo.1372.1">egrep</span></code><span class="koboSpan" id="kobo.1373.1"> still works for now, it’s considered as obsolete and might cease to work in the</span><a id="_idIndexMarker659"/><span class="koboSpan" id="kobo.1374.1"> future. </span><span class="koboSpan" id="kobo.1374.2">So, you should always use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1375.1">grep -E</span></code><span class="koboSpan" id="kobo.1376.1">, instead.)</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.1377.1">Okay, here are some examples.</span></p>
    <h3 id="_idParaDest-226" class="heading 3"><span class="koboSpan" id="kobo.1378.1">Example 1: Basic Search with Extended Syntax</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.1379.1">Let’s take another look at a </span><a id="_idIndexMarker660"/><span class="koboSpan" id="kobo.1380.1">previous example. </span><span class="koboSpan" id="kobo.1380.2">Here’s the command with normal, basic syntax:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1381.1">[donnie@fedora ~]$ grep -iw 'noun\.\?$' linux_pg6409.txt
some distinguishing mark or characteristic belonging to the noun.
</span><span class="koboSpan" id="kobo.1381.2">NOUN
verb, _summons_, a noun.
</span><span class="koboSpan" id="kobo.1381.3">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1382.1">Here’s the exact same command with extended syntax:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1383.1">[donnie@fedora ~]$ grep -E -iw 'noun\.?$' linux_pg6409.txt
some distinguishing mark or characteristic belonging to the noun.
</span><span class="koboSpan" id="kobo.1383.2">NOUN
verb, _summons_, a noun.
</span><span class="koboSpan" id="kobo.1383.3">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1384.1">Okay, it’s not a big deal here, because using the extended syntax only eliminated one backslash that I had to type. </span><span class="koboSpan" id="kobo.1384.2">But, if you have a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1385.1">grep</span></code><span class="koboSpan" id="kobo.1386.1"> command that requires you to escape lots of characters with basic syntax, the extended syntax could considerably cut down on the typing.</span></p>
    <h3 id="_idParaDest-227" class="heading 3"><span class="koboSpan" id="kobo.1387.1">Example 2: Searching for Consecutive Duplicate Words</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.1388.1">The next </span><a id="_idIndexMarker661"/><span class="koboSpan" id="kobo.1389.1">example is just a bit more complex. </span><span class="koboSpan" id="kobo.1389.2">You’re looking through the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1390.1">/etc/services</span></code><span class="koboSpan" id="kobo.1391.1"> file for all lines that contain consecutive duplicate words, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1392.1">[donnie@fedora ~]$ grep -Ei '\&lt;([a-z]+) +\1\&gt;' /etc/services
http            80/tcp          www www-http    # WorldWideWeb HTTP
http            80/udp          www www-http    # HyperText Transfer Protocol
nextstep        178/tcp         NeXTStep NextStep       # NeXTStep window
nextstep        178/udp         NeXTStep NextStep       # server
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1393.1">Here’s the </span><a id="_idIndexMarker662"/><span class="koboSpan" id="kobo.1394.1">breakdown:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.1395.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1396.1">\&lt;. </span><span class="koboSpan" id="kobo.1396.2">. </span><span class="koboSpan" id="kobo.1396.3">.\&gt;</span></code><span class="koboSpan" id="kobo.1397.1"> construct represents a word boundary. </span><span class="koboSpan" id="kobo.1397.2">The pattern that’s inside this construct will match a single word, and only a single word.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1398.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1399.1">[a-z]</span></code><span class="koboSpan" id="kobo.1400.1"> means that we’re looking for a single alphabetic character. </span><span class="koboSpan" id="kobo.1400.2">Of course, you see nothing but lower-case letters here, which would normally mean that this would only match lower-case letters. </span><span class="koboSpan" id="kobo.1400.3">But, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1401.1">i</span></code><span class="koboSpan" id="kobo.1402.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1403.1">grep -Ei</span></code><span class="koboSpan" id="kobo.1404.1"> command makes this case-insensitive.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1405.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1406.1">+</span></code><span class="koboSpan" id="kobo.1407.1"> at the end of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1408.1">[a-z]</span></code><span class="koboSpan" id="kobo.1409.1"> is called</span><a id="_idIndexMarker663"/><span class="koboSpan" id="kobo.1410.1"> a </span><strong class="keyWord"><span class="koboSpan" id="kobo.1411.1">repeat character</span></strong><span class="koboSpan" id="kobo.1412.1">. </span><span class="koboSpan" id="kobo.1412.2">This means that we want to match one or more of whatever character or set of characters precedes it. </span><span class="koboSpan" id="kobo.1412.3">In this case, we want to match a pattern that contains only the set of characters that’s between the two square brackets.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1413.1">Placing the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1414.1">[a-z]+</span></code><span class="koboSpan" id="kobo.1415.1"> within a pair of parentheses indicates that we want to evaluate this part of the regular expression before we evaluate the second part.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1416.1">Finally, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1417.1">+\1</span></code><span class="koboSpan" id="kobo.1418.1"> in the second part of the regular expression means that we want to find an additional second match to the pattern that’s described in the first part. </span><span class="koboSpan" id="kobo.1418.2">In other words, we want to find all lines in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1419.1">/etc/services</span></code><span class="koboSpan" id="kobo.1420.1"> file</span><a id="_idIndexMarker664"/><span class="koboSpan" id="kobo.1421.1"> that contain two consecutive identical words.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.1422.1">Now, make the search case-sensitive by leaving out the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1423.1">-i</span></code><span class="koboSpan" id="kobo.1424.1"> option, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1425.1">[donnie@fedora ~]$ grep -E '\&lt;([a-z]+) +\1\&gt;' /etc/services
http            80/tcp          www www-http    # WorldWideWeb HTTP
http            80/udp          www www-http    # HyperText Transfer Protocol
[donnie@fedora ~]$
</span></code></pre>
    <h3 id="_idParaDest-228" class="heading 3"><span class="koboSpan" id="kobo.1426.1">Example 3: Searching for Words that Begin with a Certain Letter</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.1427.1">Next, look </span><a id="_idIndexMarker665"/><span class="koboSpan" id="kobo.1428.1">through the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1429.1">/etc/</span></code><span class="koboSpan" id="kobo.1430.1"> directory for all files and directories with names that begin with either a </span><em class="italic"><span class="koboSpan" id="kobo.1431.1">p</span></em><span class="koboSpan" id="kobo.1432.1"> or a </span><em class="italic"><span class="koboSpan" id="kobo.1433.1">q</span></em><span class="koboSpan" id="kobo.1434.1">, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1435.1">[donnie@fedora ~]$ ls /etc/ | grep -E '^[pq]'
pam.d
paperspecs
passwd
. </span><span class="koboSpan" id="kobo.1435.2">. </span><span class="koboSpan" id="kobo.1435.3">.
</span><span class="koboSpan" id="kobo.1435.4">. </span><span class="koboSpan" id="kobo.1435.5">. </span><span class="koboSpan" id="kobo.1435.6">.
</span><span class="koboSpan" id="kobo.1435.7">purple
qemu-ga
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1436.1">Try that again, except this time look for files and directories that have </span><em class="italic"><span class="koboSpan" id="kobo.1437.1">p</span></em><span class="koboSpan" id="kobo.1438.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.1439.1">q</span></em><span class="koboSpan" id="kobo.1440.1"> as the first letter, and that also have </span><em class="italic"><span class="koboSpan" id="kobo.1441.1">p</span></em><span class="koboSpan" id="kobo.1442.1"> as the second letter, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1443.1">[donnie@fedora ~]$ ls /etc/ | grep -E '^[pq]p+'
ppp
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1444.1">Now, list all files and directories in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1445.1">/etc/</span></code><span class="koboSpan" id="kobo.1446.1"> directory with names that begin with </span><em class="italic"><span class="koboSpan" id="kobo.1447.1">se</span></em><span class="koboSpan" id="kobo.1448.1"> and have the optional third letter of </span><em class="italic"><span class="koboSpan" id="kobo.1449.1">r</span></em><span class="koboSpan" id="kobo.1450.1">, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1451.1">[donnie@fedora ~]$ ls /etc/ | grep -E '^ser?'
</span><span class="koboSpan" id="kobo.1451.2">security
selinux
services
sestatus.conf
setroubleshoot
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1452.1">Try</span><a id="_idIndexMarker666"/><span class="koboSpan" id="kobo.1453.1"> this again, but this time </span><em class="italic"><span class="koboSpan" id="kobo.1454.1">require</span></em><span class="koboSpan" id="kobo.1455.1"> that the file and directory names have </span><em class="italic"><span class="koboSpan" id="kobo.1456.1">r </span></em><span class="koboSpan" id="kobo.1457.1">as the third letter. </span><span class="koboSpan" id="kobo.1457.2">(I’m not going to show you how this time, but I will give you a hint. </span><span class="koboSpan" id="kobo.1457.3">Just look at the previous example.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1458.1">In this next example, I’m going to show you a bit of shorthand. </span><span class="koboSpan" id="kobo.1458.2">List all files and directories in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1459.1">/etc/</span></code><span class="koboSpan" id="kobo.1460.1"> directory that use non-alphanumeric characters in their names, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1461.1">[donnie@fedora ~]$ ls /etc/ | grep -E '\W'
anthy-unicode.conf
appstream.conf
asound.conf
at.deny
bash_completion.d
. </span><span class="koboSpan" id="kobo.1461.2">. </span><span class="koboSpan" id="kobo.1461.3">.
</span><span class="koboSpan" id="kobo.1461.4">. </span><span class="koboSpan" id="kobo.1461.5">. </span><span class="koboSpan" id="kobo.1461.6">.
</span><span class="koboSpan" id="kobo.1461.7">vmware-vix
whois.conf
xattr.conf
yum.repos.d
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1462.1">You see the file and directory names that contain characters such as dots, underscores, and hyphens. </span><span class="koboSpan" id="kobo.1462.2">Any file or directory name that doesn’t have any of these non-alphanumeric characters won’t show up. </span><span class="koboSpan" id="kobo.1462.3">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1463.1">\W</span></code><span class="koboSpan" id="kobo.1464.1"> in this example is just shorthand for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1465.1">[^_[:alnum:]]</span></code><span class="koboSpan" id="kobo.1466.1">. </span><span class="koboSpan" id="kobo.1466.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1467.1">^</span></code><span class="koboSpan" id="kobo.1468.1"> indicates an inversion, which causes </span><code class="inlineCode"><span class="koboSpan" id="kobo.1469.1">grep</span></code><span class="koboSpan" id="kobo.1470.1"> to search for the non-alphanumeric characters. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1471.1">Using a lower-case </span><em class="italic"><span class="koboSpan" id="kobo.1472.1">w</span></em><span class="koboSpan" id="kobo.1473.1"> (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1474.1">\w</span></code><span class="koboSpan" id="kobo.1475.1">) would replace </span><code class="inlineCode"><span class="koboSpan" id="kobo.1476.1">[_[:alnum:]]</span></code><span class="koboSpan" id="kobo.1477.1">, which would cause </span><code class="inlineCode"><span class="koboSpan" id="kobo.1478.1">grep</span></code><span class="koboSpan" id="kobo.1479.1"> to search for all alpha-numeric characters.</span></p>
    <h3 id="_idParaDest-229" class="heading 3"><span class="koboSpan" id="kobo.1480.1">Example 4: Searching for Words with Digits</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.1481.1">Next, search </span><a id="_idIndexMarker667"/><span class="koboSpan" id="kobo.1482.1">through </span><code class="inlineCode"><span class="koboSpan" id="kobo.1483.1">/etc/</span></code><span class="koboSpan" id="kobo.1484.1"> for all files and directories with a numeric digit in their names, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1485.1">[donnie@fedora ~]$ ls /etc/ | grep -E '[[:digit:]]'
dbus-1
grub2.cfg
grub2-efi.cfg
ImageMagick-7
. </span><span class="koboSpan" id="kobo.1485.2">. </span><span class="koboSpan" id="kobo.1485.3">.
</span><span class="koboSpan" id="kobo.1485.4">. </span><span class="koboSpan" id="kobo.1485.5">. </span><span class="koboSpan" id="kobo.1485.6">.
</span><span class="koboSpan" id="kobo.1485.7">tpm2-tss
udisks2
X11
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1486.1">For the final </span><a id="_idIndexMarker668"/><span class="koboSpan" id="kobo.1487.1">example, use the alternator operator to create an either/or type of regular expression, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1488.1">[donnie@fedora ~]$ ls /etc/ | grep -E '(cron|yum)'
anacrontab
cron.d
cron.daily
cron.deny
cron.hourly
cron.monthly
crontab
cron.weekly
yum.repos.d
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1489.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1490.1">|</span></code><span class="koboSpan" id="kobo.1491.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1492.1">(cron|yum)</span></code><span class="koboSpan" id="kobo.1493.1"> construct acts as an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1494.1">or</span></code><span class="koboSpan" id="kobo.1495.1"> operator, which allows </span><code class="inlineCode"><span class="koboSpan" id="kobo.1496.1">grep</span></code><span class="koboSpan" id="kobo.1497.1"> to search for directories and filenames that contain either </span><em class="italic"><span class="koboSpan" id="kobo.1498.1">cron</span></em><span class="koboSpan" id="kobo.1499.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.1500.1">yum</span></em><span class="koboSpan" id="kobo.1501.1">. </span><span class="koboSpan" id="kobo.1501.2">(By the way, if you’re doing this on a Debian machine instead of a Fedora machine, just replace </span><em class="italic"><span class="koboSpan" id="kobo.1502.1">yum</span></em><span class="koboSpan" id="kobo.1503.1"> with </span><em class="italic"><span class="koboSpan" id="kobo.1504.1">apt</span></em><span class="koboSpan" id="kobo.1505.1">.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1506.1">That’s it for extended </span><code class="inlineCode"><span class="koboSpan" id="kobo.1507.1">grep</span></code><span class="koboSpan" id="kobo.1508.1">. </span><span class="koboSpan" id="kobo.1508.2">Let’s turn our attention to fixed-strings.</span></p>
    <h2 id="_idParaDest-230" class="heading 2"><span class="koboSpan" id="kobo.1509.1">Using Fixed-strings Regular Expressions with grep</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1510.1">Either </span><code class="inlineCode"><span class="koboSpan" id="kobo.1511.1">fgrep</span></code><span class="koboSpan" id="kobo.1512.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1513.1">grep -F</span></code><span class="koboSpan" id="kobo.1514.1"> will </span><a id="_idIndexMarker669"/><span class="koboSpan" id="kobo.1515.1">interpret any patterns you feed it as literal expressions. </span><span class="koboSpan" id="kobo.1515.2">So, if you follow either </span><code class="inlineCode"><span class="koboSpan" id="kobo.1516.1">grep -F</span></code><span class="koboSpan" id="kobo.1517.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1518.1">fgrep</span></code><span class="koboSpan" id="kobo.1519.1"> with a regular expression, you’ll actually be searching for that regular expression, instead of the parsed pattern. </span><span class="koboSpan" id="kobo.1519.2">For example, let’s copy the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1520.1">ssn.txt</span></code><span class="koboSpan" id="kobo.1521.1"> file that we used earlier to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1522.1">ssn_2.txt</span></code><span class="koboSpan" id="kobo.1523.1">, and add a line. </span><span class="koboSpan" id="kobo.1523.2">The new file will look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1524.1">Knockwurst,     Ronald J.       </span><span class="koboSpan" id="kobo.1524.2">899-98-1247
Born 28 April 1954
Liverwurst,     Alex            988-45-7898
Born 1 Feb 1933
Saurbraten,     Alicia          978-98-6987
Born 5 Apr 1956
Hassenfeffer,   Gerald          999-87-1258
Born 10 Jan 1961
'[0-9]\{3\}-[0-9]\{2\}-[0-9]\{4\}'
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1525.1">This new last line is the regular expression that you’ll use to search through the file. </span><span class="koboSpan" id="kobo.1525.2">Using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1526.1">grep</span></code><span class="koboSpan" id="kobo.1527.1"> with no options, as you saw before, will yield a list of lines that contain Social Security numbers, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1528.1">[donnie@fedora ~]$ grep '[0-9]\{3\}-[0-9]\{2\}-[0-9]\{4\}' ssn_2.txt
Knockwurst,		Ronald J.	</span><span class="koboSpan" id="kobo.1528.2">899-98-1247
Liverwurst,		Alex		988-45-7898
Saurbraten,		Alicia		978-98-6987
Hassenfeffer,	Gerald		999-87-1258
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1529.1">But, look </span><a id="_idIndexMarker670"/><span class="koboSpan" id="kobo.1530.1">what happens if you use either </span><code class="inlineCode"><span class="koboSpan" id="kobo.1531.1">fgrep</span></code><span class="koboSpan" id="kobo.1532.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1533.1">grep</span></code> <code class="inlineCode"><span class="koboSpan" id="kobo.1534.1">-F</span></code><span class="koboSpan" id="kobo.1535.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1536.1">[donnie@fedora ~]$ grep -F '[0-9]\{3\}-[0-9]\{2\}-[0-9]\{4\}' ssn_2.txt
'[0-9]\{3\}-[0-9]\{2\}-[0-9]\{4\}'
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1537.1">With either </span><code class="inlineCode"><span class="koboSpan" id="kobo.1538.1">fgrep</span></code><span class="koboSpan" id="kobo.1539.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1540.1">grep -F</span></code><span class="koboSpan" id="kobo.1541.1">, the regular expression is interpreted as just another text string.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1542.1">As is the case with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1543.1">egrep</span></code><span class="koboSpan" id="kobo.1544.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1545.1">fgrep</span></code><span class="koboSpan" id="kobo.1546.1"> is considered as obsolete and might cease to work in the somewhat near future. </span><span class="koboSpan" id="kobo.1546.2">So, your best bet is to get used to using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1547.1">grep -E</span></code><span class="koboSpan" id="kobo.1548.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1549.1">grep -F</span></code><span class="koboSpan" id="kobo.1550.1">, instead of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1551.1">egrep</span></code><span class="koboSpan" id="kobo.1552.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1553.1">fgrep</span></code><span class="koboSpan" id="kobo.1554.1">. </span><span class="koboSpan" id="kobo.1554.2">(The main reason I mention them at all is </span><a id="_idIndexMarker671"/><span class="koboSpan" id="kobo.1555.1">because you might find other tutorials that mention them.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1556.1">Now that you’ve seen some regular expressions in use, let’s look at how to simplify the process of creating them.</span></p>
    <h1 id="_idParaDest-231" class="heading 1"><span class="koboSpan" id="kobo.1557.1">Using RegEx Helper Programs</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.1558.1">Okay, now that you’ve seen so many examples, you can now create regular expressions to do whatever you need to be done.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1559.1"> What?! </span><em class="italic"><span class="koboSpan" id="kobo.1560.1">No</span></em><span class="koboSpan" id="kobo.1561.1">, you say?</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1562.1">Don’t feel bad. </span><span class="koboSpan" id="kobo.1562.2">I’ve told you already that Regular Expressions is quite complex, and is something about which entire books have been written. </span><span class="koboSpan" id="kobo.1562.3">That’s where a helper program can come in handy. </span><span class="koboSpan" id="kobo.1562.4">Let’s look at some examples.</span></p>
    <h2 id="_idParaDest-232" class="heading 2"><span class="koboSpan" id="kobo.1563.1">RegexBuddy and RegexMagic</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1564.1">RegexBuddy</span><a id="_idIndexMarker672"/><span class="koboSpan" id="kobo.1565.1"> and RegexMagic</span><a id="_idIndexMarker673"/><span class="koboSpan" id="kobo.1566.1"> are a pair of helper programs that are published by the </span><em class="italic"><span class="koboSpan" id="kobo.1567.1">Just Great Software</span></em><span class="koboSpan" id="kobo.1568.1"> company. </span><span class="koboSpan" id="kobo.1568.2">The difference between them is that RegexBuddy is mainly a point-and-click interface for building your own regular expressions. </span><span class="koboSpan" id="kobo.1568.3">There is a library of pre-built regular expressions that you can use, but to build anything else you’ll still need to know something about the Regular Expressions language.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1569.1">RegexMagic is great for Regular Expressions beginners, because all you need to do is to enter some sample text and mark the areas that you want to convert to a regular expression. </span><span class="koboSpan" id="kobo.1569.2">RegexMagic then generates the regular expression for you.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1570.1">There are really only two slight drawbacks to RegexBuddy and RegexMagic. </span><span class="koboSpan" id="kobo.1570.2">First, they’re both closed-source, commercial programs, so you’ll need to pay for them. </span><span class="koboSpan" id="kobo.1570.3">But, the price is quite reasonable, at only US $39.95 each. </span><span class="koboSpan" id="kobo.1570.4">(You can get a discount if you buy them both in a bundle.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1571.1">The second slight drawback is that they’re only written for the Windows operating system. </span><span class="koboSpan" id="kobo.1571.2">However, you’ll be glad to know that they both run fine under WINE on Linux machines. </span><span class="koboSpan" id="kobo.1571.3">(In fact, I have them both installed here on this Fedora workstation.) The </span><a id="_idIndexMarker674"/><span class="koboSpan" id="kobo.1572.1">RegexBuddy and</span><a id="_idIndexMarker675"/><span class="koboSpan" id="kobo.1573.1"> RegexMagic websites even give you directions on how to install these programs under WINE.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.1574.1">WINE is a recursive acronym that stands for </span><em class="italic"><span class="koboSpan" id="kobo.1575.1">WINE is Not an Emulator</span></em><span class="koboSpan" id="kobo.1576.1">. </span><span class="koboSpan" id="kobo.1576.2">It’s a translation layer that converts Windows executable code to Linux executable code, and is included in the repositories for pretty much every Linux distro.</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.1577.1">Also, please know that I have no financial arrangements with the folk at Just Great Software, so I don’t receive any compensation for telling you about their products.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.1578.1">To check out these</span><a id="_idIndexMarker676"/><span class="koboSpan" id="kobo.1579.1"> cool products, just visit their websites. </span><span class="koboSpan" id="kobo.1579.2">You can find RegexBuddy here: </span><a href="https://www.regexbuddy.com/index.html"><span class="url"><span class="koboSpan" id="kobo.1580.1">https://www.regexbuddy.com/index.html</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.1581.1">And, you can find</span><a id="_idIndexMarker677"/><span class="koboSpan" id="kobo.1582.1"> RegexMagic here: </span><a href="https://www.regexmagic.com/"><span class="url"><span class="koboSpan" id="kobo.1583.1">https://www.regexmagic.com/</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.1584.1">Now, let’s check out a free tool.</span></p>
    <h2 id="_idParaDest-233" class="heading 2"><span class="koboSpan" id="kobo.1585.1">Regex101</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1586.1">If you prefer to use a</span><a id="_idIndexMarker678"/><span class="koboSpan" id="kobo.1587.1"> free-of-charge tool, you might want to check out Regex101. </span><span class="koboSpan" id="kobo.1587.2">It’s web-based, so there’s nothing to download or to install. </span><span class="koboSpan" id="kobo.1587.3">It doesn’t have the bells and whistles that RegexBuddy and RegexMagic have, but there’s enough there to get you started. </span><span class="koboSpan" id="kobo.1587.4">Signing in to an account is optional, but there are benefits to doing so. </span><span class="koboSpan" id="kobo.1587.5">Note that you won’t be creating an account, but will instead be signing in via either your Google or Github account.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1588.1">You can check out </span><a id="_idIndexMarker679"/><span class="koboSpan" id="kobo.1589.1">Regex101 here: </span><a href="https://regex101.com/"><span class="url"><span class="koboSpan" id="kobo.1590.1">https://regex101.com/</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.1591.1">I think that we’ve covered enough theory. </span><span class="koboSpan" id="kobo.1591.2">Let’s move on to the real world.</span></p>
    <h1 id="_idParaDest-234" class="heading 1"><span class="koboSpan" id="kobo.1592.1">Looking at Some Real-World Examples</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.1593.1">I have some cool case studies on how to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1594.1">sed</span></code><span class="koboSpan" id="kobo.1595.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1596.1">grep</span></code><span class="koboSpan" id="kobo.1597.1">, and regular expressions in real life. </span><span class="koboSpan" id="kobo.1597.2">So, read on and enjoy!</span></p>
    <h2 id="_idParaDest-235" class="heading 2"><span class="koboSpan" id="kobo.1598.1">Modifying Multiple Files at Once</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1599.1">If you have more than </span><a id="_idIndexMarker680"/><span class="koboSpan" id="kobo.1600.1">one file that you need to modify in the same manner, you can have </span><code class="inlineCode"><span class="koboSpan" id="kobo.1601.1">sed</span></code><span class="koboSpan" id="kobo.1602.1"> do them all in one command, just by using a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1603.1">*</span></code><span class="koboSpan" id="kobo.1604.1"> wildcard in the filename. </span><span class="koboSpan" id="kobo.1604.2">Quite a few years ago I assisted a website maintainer in migrating a set of PHP-based websites from a CentOS 5 server to a CentOS 6 server. </span><span class="koboSpan" id="kobo.1604.3">To make the sites work with the newer PHP version, she needed to add a line of new code to each </span><code class="inlineCode"><span class="koboSpan" id="kobo.1605.1">.php</span></code><span class="koboSpan" id="kobo.1606.1"> file. </span><span class="koboSpan" id="kobo.1606.2">That could have been a bit problematic, because she had about 2,000 files to modify, which is more than you’d want to edit manually. </span><span class="koboSpan" id="kobo.1606.3">I suggested that she use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1607.1">sed</span></code><span class="koboSpan" id="kobo.1608.1"> to modify all files at once, and she knew immediately what I was talking about. </span><span class="koboSpan" id="kobo.1608.2">(I jogged her memory by making the suggestion.)</span></p>
    <h2 id="_idParaDest-236" class="heading 2"><span class="koboSpan" id="kobo.1609.1">Searching Through Apache Webserver Logs for Cross-site Scripting Attacks</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1610.1">About 15 years ago, a security worker buddy of mine called me with an urgent plea for help. </span><span class="koboSpan" id="kobo.1610.2">His boss at the credit union where he worked had handed him a USB memory stick with four Gigabyes--Yes, four </span><em class="italic"><span class="koboSpan" id="kobo.1611.1">Gigabytes</span></em><span class="koboSpan" id="kobo.1612.1">!--worth of compressed Apache access logs, and told him to look through them for signs of </span><strong class="keyWord"><span class="koboSpan" id="kobo.1613.1">cross-site scripting attacks</span></strong><span class="koboSpan" id="kobo.1614.1">. </span><span class="koboSpan" id="kobo.1614.2">What’s a</span><a id="_idIndexMarker681"/><span class="koboSpan" id="kobo.1615.1"> poor security admin to do in a case like this?</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1616.1">Cross-site scripting, often </span><a id="_idIndexMarker682"/><span class="koboSpan" id="kobo.1617.1">abbreviated as </span><strong class="keyWord"><span class="koboSpan" id="kobo.1618.1">XSS</span></strong><span class="koboSpan" id="kobo.1619.1">, is used by malicious hackers to steal information or to manipulate websites. </span><span class="koboSpan" id="kobo.1619.2">I know that this name is confusing, and that it doesn’t give you an accurate picture of what XSS attacks really do. </span><span class="koboSpan" id="kobo.1619.3">It would be more accurate to call this type of</span><a id="_idIndexMarker683"/><span class="koboSpan" id="kobo.1620.1"> attack a </span><strong class="keyWord"><span class="koboSpan" id="kobo.1621.1">Javascript injection attack</span></strong><span class="koboSpan" id="kobo.1622.1">, because that’s how it really works.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1623.1">When an attacker finds a website that’s vulnerable to this type of attack, he or she can use an attack tool, such as ones that are part of Kali Linux, to perform his or her dirty deeds. </span><span class="koboSpan" id="kobo.1623.2">Or at least, that’s how it is nowadays. </span><span class="koboSpan" id="kobo.1623.3">When my buddy called me up 15 years ago, it was still possible to perform an XSS attack with a simple web browser. </span><span class="koboSpan" id="kobo.1623.4">All an attacker had to do was to append some special Javascript code to the end of a website’s URL, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1624.1">https://www.mybigbank.com/&lt;BR SIZE="&amp;{alert('XSS')}"&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1625.1">It’s no longer possible to perform an XSS attack with a web browser, because modern versions of all web browsers now sanitize their input. </span><span class="koboSpan" id="kobo.1625.2">So now, the Javascript in the URL no longer has any effect.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1626.1">But, I digress.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1627.1">After my buddy </span><a id="_idIndexMarker684"/><span class="koboSpan" id="kobo.1628.1">called me, I set up a machine with an Apache webserver, and then performed some XSS attacks against it from another machine. </span><span class="koboSpan" id="kobo.1628.2">I discovered that log file entries that were the result of an XSS attack had a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1629.1">%</span></code><span class="koboSpan" id="kobo.1630.1"> pattern in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1631.1">GET</span></code><span class="koboSpan" id="kobo.1632.1"> portion, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1633.1">192.168.0.252 – - [05/Aug/2009:15:16:42 -0400] "GET /%27%27;!–%22%3CXSS%3E=&amp;{()
} HTTP/1.1″ 404 310 "-" "Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.12)
Gecko/2009070812 Ubuntu/8.04 (hardy) Firefox/3.0.12″
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1634.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1635.1">GET /%27%27</span></code><span class="koboSpan" id="kobo.1636.1"> part is what tells us that this is from an XSS attack. </span><span class="koboSpan" id="kobo.1636.2">No log file entries that were the result of normal website access had this pattern.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1637.1">There were also a couple of other variations on this pattern, and the first thing I had to do was to create the regular expressions that I needed to match all of them. </span><span class="koboSpan" id="kobo.1637.2">The regular expressions that I created were </span><code class="inlineCode"><span class="koboSpan" id="kobo.1638.1">GET /%</span></code><span class="koboSpan" id="kobo.1639.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1640.1">GET /.%</span></code><span class="koboSpan" id="kobo.1641.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1642.1">GET /.=%</span></code><span class="koboSpan" id="kobo.1643.1">. </span><span class="koboSpan" id="kobo.1643.2">(The dot is a wildcard, which tells the script to search for any character in that position.) Next, I created the script, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1644.1">find</span></code><span class="koboSpan" id="kobo.1645.1"> utility to find and read all of the Apache log files. </span><span class="koboSpan" id="kobo.1645.2">Here’s the script that I created:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1646.1">#!/bin/bash
inputpath=$1
output_file=$2
if [ -f $output_file ]; then
        echo "This file already exists.  </span><span class="koboSpan" id="kobo.1646.2">Choose another filename."
        </span><span class="koboSpan" id="kobo.1646.3">exit;
fi
find $inputpath -iname '*.gz' -exec zcat {} \; | grep 'GET /%' &gt; $output_file
find $inputpath -iname '*.gz' -exec zcat {} \; | grep 'GET /.%' &gt;&gt; $output_file
find $inputpath -iname '*.gz' -exec zcat {} \; | grep 'GET /.=%' &gt;&gt; $output_file
less $output_file
exit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1647.1">The first thing you see is that I’m using positional parameter </span><code class="inlineCode"><span class="koboSpan" id="kobo.1648.1">$1</span></code><span class="koboSpan" id="kobo.1649.1"> to designate the mount point of the USB memory stick, and positional parameter </span><code class="inlineCode"><span class="koboSpan" id="kobo.1650.1">$2</span></code><span class="koboSpan" id="kobo.1651.1"> to designate the filename of the report file. </span><span class="koboSpan" id="kobo.1651.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1652.1">if..then</span></code><span class="koboSpan" id="kobo.1653.1"> construct is a safety feature that prevents the user</span><a id="_idIndexMarker685"/><span class="koboSpan" id="kobo.1654.1"> from overwriting an existing file. </span><span class="koboSpan" id="kobo.1654.2">The command to invoke the script would have looked something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1655.1">./cross-site-search /media/PATRIOT/ ~/cross-site-search-results.txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1656.1">Linux system log files are normally always compressed with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1657.1">gzip</span></code><span class="koboSpan" id="kobo.1658.1">, and the filenames will end with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1659.1">.gz</span></code><span class="koboSpan" id="kobo.1660.1">. </span><span class="koboSpan" id="kobo.1660.2">So, I had </span><code class="inlineCode"><span class="koboSpan" id="kobo.1661.1">find</span></code><span class="koboSpan" id="kobo.1662.1"> search for all </span><code class="inlineCode"><span class="koboSpan" id="kobo.1663.1">.gz</span></code><span class="koboSpan" id="kobo.1664.1"> files on the memory stick, read them with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1665.1">zcat</span></code><span class="koboSpan" id="kobo.1666.1">, and pipe the output into </span><code class="inlineCode"><span class="koboSpan" id="kobo.1667.1">grep</span></code><span class="koboSpan" id="kobo.1668.1">. </span><span class="koboSpan" id="kobo.1668.2">Finally, I had the report automatically open in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1669.1">less</span></code><span class="koboSpan" id="kobo.1670.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1671.1">Fortunately, my buddy was able to verify that this script actually does work. </span><span class="koboSpan" id="kobo.1671.2">The previous autumn, the credit union had hired a penetration testing outfit to test security, with </span><a id="_idIndexMarker686"/><span class="koboSpan" id="kobo.1672.1">XSS attacks being part of the test. </span><span class="koboSpan" id="kobo.1672.2">The script found all instances of the pen tester’s attack, so everyone was happy.</span></p>
    <h2 id="_idParaDest-237" class="heading 2"><span class="koboSpan" id="kobo.1673.1">Automating Third-party Repository Installations</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1674.1">The</span><a id="_idIndexMarker687"/><span class="koboSpan" id="kobo.1675.1"> next real-world script that I’ll show you is, sadly, one that you won’t be able to run. </span><span class="koboSpan" id="kobo.1675.2">That’s because I created it sometime in either 2010 or 2011, when I was creating training documentation and plug-ins for the Nagios monitoring system. </span><span class="koboSpan" id="kobo.1675.3">My client and I were doing everything with CentOS 5 and CentOS 6 at the time, which are now both obsolete.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1676.1">This scenario is part of a larger scenario that involved automatically downloading and compiling Nagios Core source code on a CentOS server. </span><span class="koboSpan" id="kobo.1676.2">One of the prerequisites was to install the RPMForge and EPEL third-party software repositories. </span><span class="koboSpan" id="kobo.1676.3">At that time, installing a third-party repository on CentOS also required you to configure the priorities of each of the repositories, in order to prevent having one repository overwrite packages that had been installed from another repository. </span><span class="koboSpan" id="kobo.1676.4">Since my client and I were constantly having to perform new Nagios installations, I wrote a script to help automate the process. </span><span class="koboSpan" id="kobo.1676.5">The script is too large to reproduce here, so I’ll invite you to download the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1677.1">add-repos.sh</span></code><span class="koboSpan" id="kobo.1678.1"> script from Github. </span><span class="koboSpan" id="kobo.1678.2">However, I will reproduce a few snippets here to explain things.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1679.1">At the top of the script, you see this </span><code class="inlineCode"><span class="koboSpan" id="kobo.1680.1">if..then..else</span></code><span class="koboSpan" id="kobo.1681.1"> construct:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1682.1">if [ $(uname -m) == x86_64 ]; then
        rpm -Uvh http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el6.rf.x86_64.rpm
else
        rpm -Uvh http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el6.rf.i686.rpm
fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1683.1">At that time, the computer industry was still transitioning from 32-bit to 64-bit CPUs. </span><span class="koboSpan" id="kobo.1683.2">So, the maintainer of the now defunct RPMForge repository offered separate installation packages for each. </span><span class="koboSpan" id="kobo.1683.3">(I wanted to completely make the break to 64-bit, but my client insisted on still supporting 32-bit.) This construct automatically detects which flavor of CentOS is installed, and then downloads and installs the appropriate RPMForge package.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1684.1">Next is the line that installs the packages for the EPEL repository and for setting the repository priorities. </span><span class="koboSpan" id="kobo.1684.2">It looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1685.1">yum install -y epel-release yum-plugin-priorities
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1686.1">The final step is to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1687.1">sed</span></code><span class="koboSpan" id="kobo.1688.1"> to automatically set the priorities for each section of the various repository configuration files. </span><span class="koboSpan" id="kobo.1688.2">Here’s a snippet from one of those files:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1689.1">[base]
name=CentOS-$releasever - Base
mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo
=os&amp;infra=$infra
#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1690.1">Other </span><a id="_idIndexMarker688"/><span class="koboSpan" id="kobo.1691.1">sections of the file were named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1692.1">[updates]</span></code><span class="koboSpan" id="kobo.1693.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1694.1">[extras]</span></code><span class="koboSpan" id="kobo.1695.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1696.1">[centosplus]</span></code><span class="koboSpan" id="kobo.1697.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1698.1">[contrib]</span></code><span class="koboSpan" id="kobo.1699.1">. </span><span class="koboSpan" id="kobo.1699.2">(To see the whole file, download the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1700.1">CentOS-Base.repo</span></code><span class="koboSpan" id="kobo.1701.1"> file from GitHub.) The other configuration files were also divided into sections with different names. </span><span class="koboSpan" id="kobo.1701.2">The goal was to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1702.1">sed</span></code><span class="koboSpan" id="kobo.1703.1"> to automatically append a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1704.1">priority=</span></code><span class="koboSpan" id="kobo.1705.1"> line just under the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1706.1">[section_name]</span></code><span class="koboSpan" id="kobo.1707.1"> line of every section of every file. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1708.1">Here’s what those </span><code class="inlineCode"><span class="koboSpan" id="kobo.1709.1">sed </span></code><span class="koboSpan" id="kobo.1710.1">scripts look like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1711.1">sed -i '/\[base\]/apriority=1' /etc/yum.repos.d/CentOS-Base.repo
sed -i '/\[updates\]/apriority=1' /etc/yum.repos.d/CentOS-Base.repo
sed -i '/\[extras\]/apriority=1' /etc/yum.repos.d/CentOS-Base.repo
sed -i '/\[centosplus\]/apriority=2' /etc/yum.repos.d/CentOS-Base.repo
sed -i '/\[contrib\]/apriority=2' /etc/yum.repos.d/CentOS-Base.repo
sed -i '/\[rpmforge\]/apriority=10' /etc/yum.repos.d/rpmforge.repo
sed -i '/\[rpmforge-extras\]/apriority=11' /etc/yum.repos.d/rpmforge.repo
sed -i '/\[rpmforge-testing\]/apriority=11' /etc/yum.repos.d/rpmforge.repo
sed -i '/\[epel\]/apriority=12' /etc/yum.repos.d/epel.repo
sed -i '/\[epel-debuginfo\]/apriority=13' /etc/yum.repos.d/epel.repo
sed -i '/\[epel-source\]/apriority=13' /etc/yum.repos.d/epel.repo
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1712.1">You see that each </span><code class="inlineCode"><span class="koboSpan" id="kobo.1713.1">sed</span></code><span class="koboSpan" id="kobo.1714.1"> script appends the proper priorities settings to their proper places. </span><span class="koboSpan" id="kobo.1714.2">The</span><a id="_idIndexMarker689"/><span class="koboSpan" id="kobo.1715.1"> result would have looked something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1716.1">[base]
priority=1
name=CentOS-$releasever - Base
. </span><span class="koboSpan" id="kobo.1716.2">. </span><span class="koboSpan" id="kobo.1716.3">.
</span><span class="koboSpan" id="kobo.1716.4">. </span><span class="koboSpan" id="kobo.1716.5">. </span><span class="koboSpan" id="kobo.1716.6">.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1717.1">And now, let’s look at one final real-life scenario.</span></p>
    <h2 id="_idParaDest-238" class="heading 2"><span class="koboSpan" id="kobo.1718.1">Filling Empty Fields in a .csv File</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1719.1">If you ever</span><a id="_idIndexMarker690"/><span class="koboSpan" id="kobo.1720.1"> have to work with columnar data, you might find yourself having to work with </span><strong class="keyWord"><span class="koboSpan" id="kobo.1721.1">Comma Separated Value</span></strong><span class="koboSpan" id="kobo.1722.1"> (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1723.1">.csv</span></code><span class="koboSpan" id="kobo.1724.1">) files. </span><span class="koboSpan" id="kobo.1724.2">As the name suggests, these are files with rows of data, with the same number of fields in each row. </span><span class="koboSpan" id="kobo.1724.3">The fields are all separated by commas, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1725.1">donnie@fedora:~$ cat inventory_2.csv
Kitchen spatula,$4.99,Housewares,Sale Over
Raincoat,$36.99,Clothing,On Sale!
</span><span class="koboSpan" id="kobo.1725.2">Claw hammer,$7.99,Tools,On Sale Next Week
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1726.1">The beauty of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1727.1">.csv</span></code><span class="koboSpan" id="kobo.1728.1"> files is that you can use a normal plain-text editor to create them. </span><span class="koboSpan" id="kobo.1728.2">Then, you can open them up in any spreadsheet program, like this:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.1729.1"><img src="../Images/B21693_09_02.png" alt="B21693_9_2"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.1730.1">Figure 9.2: Opening a .csv file as a spreadsheet</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1731.1">At times, you</span><a id="_idIndexMarker691"/><span class="koboSpan" id="kobo.1732.1"> might encounter a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1733.1">.csv</span></code><span class="koboSpan" id="kobo.1734.1"> file that contains empty fields, like this one:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1735.1">donnie@fedora:~$ cat myfile.csv
1,2,3,4,5,6,7
,,,,,,
1,,,4,5,,
,2,3,4,5,,
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1736.1">You see that the commas are there, but there are no values in the fields between them. </span><span class="koboSpan" id="kobo.1736.2">Opening this file in a spreadsheet program would look like this:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.1737.1"><img src="../Images/B21693_09_03.png" alt="B21693_9_3"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.1738.1">Figure 9.3: Opening a .csv file with empty fields</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1739.1">Okay, that</span><a id="_idIndexMarker692"/><span class="koboSpan" id="kobo.1740.1"> doesn’t look like a complete disaster, but you want something that looks better. </span><span class="koboSpan" id="kobo.1740.2">So, you need to find an easy way to place values in all of the empty fields. </span><span class="koboSpan" id="kobo.1740.3">You might want to insert some value as just a placeholder, or you might want to insert some text that explains why the fields are empty. </span><span class="koboSpan" id="kobo.1740.4">Either way, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1741.1">sed</span></code><span class="koboSpan" id="kobo.1742.1"> makes that easy.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1743.1">But, I have to confess that someone else has already created a solution for this, and I can’t really improve upon it. </span><span class="koboSpan" id="kobo.1743.2">So, rather than try to explain the solution myself, I’ll invite you to visit the author’s original article that contains the solution, which is here: </span><a href="https://linuxconfig.org/how-to-fill-all-empty-valued-cells-within-a-csv-file-with-sed-and-bash-shell"><span class="url"><span class="koboSpan" id="kobo.1744.1">https://linuxconfig.org/how-to-fill-all-empty-valued-cells-within-a-csv-file-with-sed-and-bash-shell</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.1745.1">Okay, that covers it for this chapter. </span><span class="koboSpan" id="kobo.1745.2">Let’s wrap this baby up and move on.</span></p>
    <h1 id="_idParaDest-239" class="heading 1"><span class="koboSpan" id="kobo.1746.1">Summary</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.1747.1">As always, we’ve covered lots of ground in this chapter. </span><span class="koboSpan" id="kobo.1747.2">I first gave you a basic explanation of Regular Expressions, regular expressions, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1748.1">sed</span></code><span class="koboSpan" id="kobo.1749.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1750.1">grep</span></code><span class="koboSpan" id="kobo.1751.1">. </span><span class="koboSpan" id="kobo.1751.2">Then, I showed you how to use regular expressions with both </span><code class="inlineCode"><span class="koboSpan" id="kobo.1752.1">sed</span></code><span class="koboSpan" id="kobo.1753.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1754.1">grep</span></code><span class="koboSpan" id="kobo.1755.1">. </span><span class="koboSpan" id="kobo.1755.2">I also showed you some cool tools that can help simplify the process of creating regular expressions. </span><span class="koboSpan" id="kobo.1755.3">Finally, I showed you some real-live scenarios in which I actually used these concepts for my own scripts.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1756.1">The next chapter will be about functions. </span><span class="koboSpan" id="kobo.1756.2">I’ll see you there.</span></p>
    <h1 id="_idParaDest-240" class="heading 1"><span class="koboSpan" id="kobo.1757.1">Questions</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.1758.1">Which of the following is the preferred method for using grep with extended syntax?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.1759.1">Egrep</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1760.1">egrep</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1761.1">grep -e</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1762.1">grep -E</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1763.1">Which of the following are the two general types of characters that are used in regular expressions? </span><span class="koboSpan" id="kobo.1763.2">(Choose two.)</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.1764.1">digits</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1765.1">alphabetic</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1766.1">literals</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1767.1">numbers</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1768.1">metacharacters</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1769.1">When creating a regular expression, which of the following would you use as an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1770.1">or</span></code><span class="koboSpan" id="kobo.1771.1"> operator?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.1772.1">or</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1773.1">-o</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1774.1">-or</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1775.1">|</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1776.1">?</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1777.1">What are the three types of metacharaters in Regular Expressions? </span><span class="koboSpan" id="kobo.1777.2">(Choose three.)</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.1778.1">Literals</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1779.1">Positional anchors</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1780.1">Numbers</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1781.1">Character sets</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1782.1">Modifiers</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1783.1">Which option switch would you use with sed to save changes to the source file?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.1784.1">-o</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1785.1">-i</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1786.1">-s</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1787.1">-n</span></code></li>
        </ol>
      </li>
    </ol>
    <h1 id="_idParaDest-241" class="heading 1"><span class="koboSpan" id="kobo.1788.1">Further Reading</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.1789.1">Regex Tutorial—How to write regular expressions?: </span><a href="https://www.geeksforgeeks.org/write-regular-expressions/"><span class="url"><span class="koboSpan" id="kobo.1790.1">https://www.geeksforgeeks.org/write-regular-expressions/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1791.1">Regular Expressions.info: </span><a href="https://www.regular-expressions.info/"><span class="url"><span class="koboSpan" id="kobo.1792.1">https://www.regular-expressions.info/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1793.1">Learn Regex: A Beginner’s Guide: </span><a href="https://www.sitepoint.com/learn-regex/"><span class="url"><span class="koboSpan" id="kobo.1794.1">https://www.sitepoint.com/learn-regex/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1795.1">A Practical Guide to Regular Expressions: </span><a href="https://www.freecodecamp.org/news/practical-regex-guide-with-real-life-examples/"><span class="url"><span class="koboSpan" id="kobo.1796.1">https://www.freecodecamp.org/news/practical-regex-guide-with-real-life-examples/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1797.1">Regex Cheat Sheet and Quick Reference: </span><a href="https://quickref.me/regex.html"><span class="url"><span class="koboSpan" id="kobo.1798.1">https://quickref.me/regex.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1799.1">How to Use the sed Command on Linux: </span><a href="https://www.howtogeek.com/666395/how-to-use-the-sed-command-on-linux/"><span class="url"><span class="koboSpan" id="kobo.1800.1">https://www.howtogeek.com/666395/how-to-use-the-sed-command-on-linux/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1801.1">How to Use sed to Find and Replace String in Files: </span><a href="https://linuxize.com/post/how-to-use-sed-to-find-and-replace-string-in-files/"><span class="url"><span class="koboSpan" id="kobo.1802.1">https://linuxize.com/post/how-to-use-sed-to-find-and-replace-string-in-files/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1803.1">How to Use the grep Command on Linux: </span><a href="https://www.howtogeek.com/496056/how-to-use-the-grep-command-on-linux/"><span class="url"><span class="koboSpan" id="kobo.1804.1">https://www.howtogeek.com/496056/how-to-use-the-grep-command-on-linux/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1805.1">How to use the Linux grep command: </span><a href="https://opensource.com/article/21/3/grep-cheat-sheet"><span class="url"><span class="koboSpan" id="kobo.1806.1">https://opensource.com/article/21/3/grep-cheat-sheet</span></span></a></li>
    </ul>
    <h1 id="_idParaDest-242" class="heading 1"><span class="koboSpan" id="kobo.1807.1">Answers</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.1808.1">d</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1809.1">c and e</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1810.1">d</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1811.1">b, d, and e</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1812.1">b</span></li>
    </ol>
    <h1 id="_idParaDest-243" class="heading 1"><span class="koboSpan" id="kobo.1813.1">Join our community on Discord!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.1814.1">Read this book alongside other users, Linux experts, and the author himself. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1815.1">Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. </span><span class="koboSpan" id="kobo.1815.2">Scan the QR code or visit the link to join the community.</span></p>
    <p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.1816.1">https://packt.link/SecNet</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.1817.1"><img src="../Images/QR_Code10596186092701843.png" alt=""/></span></p>
<h1 id="_idParaDest-4" class="heading 1"><span class="koboSpan" id="kobo.1818.1">Leave a Review!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.1819.1">Thank you for purchasing this book from Packt Publishing—we hope you enjoy it! </span><span class="koboSpan" id="kobo.1819.2">Your feedback is invaluable and helps us improve and grow. </span><span class="koboSpan" id="kobo.1819.3">Once you've completed reading it, please take a moment to leave an Amazon review; it will only take a minute, but it makes a big difference for readers like you.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1820.1">Scan the QR code below to receive a free ebook of your choice.</span></p>
    <p class="normal"><a href="https://packt.link/NzOWQ"><span class="url"><span class="koboSpan" id="kobo.1821.1">https://packt.link/NzOWQ</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.1822.1"><img src="../Images/review.png" alt=""/></span></p>
  </div>
</body></html>