<html><head></head><body>
		<div id="_idContainer004">
			<h1 id="_idParaDest-5"><a id="_idTextAnchor004"/>Preface</h1>
			<p>PowerShell is a free, powerful, and easy-to-learn programming language. Originally written as a scripting and administration tool for Windows, it’s now available as an open source resource that can be installed on almost all laptops and desktops. I have been teaching PowerShell to my colleagues for the last decade, and in my spare time, I teach coding to kids in local schools, mostly in Python. Why not teach coding <span class="No-Break">with PowerShell?</span></p>
			<p>Many books and courses on PowerShell assume an audience with access to multiple machines, Active Directory domains, and various other enterprise environments. They often also play down the traditional coding elements of PowerShell. This book does neither and attempts to teach coding with PowerShell, in a similar way to how we teach coding with Python. I’ve been inspired by the incredible work of Dr Chuck Severance of the University of Michigan – if you want to learn Python, his <em class="italic">Python for Everybody</em> course at <a href="http://py4e.org">py4e.org</a> <span class="No-Break">is excellent.</span></p>
			<p>The book is split into three parts. In the first part, we cover traditional coding theory; starting with how PowerShell works as a language, we look at the building blocks of the language and then move on to how we can combine them in a <span class="No-Break">programmatic flow.</span></p>
			<p>In the second part, we start to put together the principles we’ve learned into scripts and modules that we can share <span class="No-Break">and reuse.</span></p>
			<p>In the final part of the book, we look at how PowerShell works in different environments, before finishing with a chapter on how we can access the underlying framework that PowerShell is <span class="No-Break">built on.</span></p>
			<p>I’ve included many interesting and varied examples and exercises in the book. To get the most out of it, I encourage you to actually type out the code, rather than just read it; the physical act of typing it drives a much deeper engagement than just scanning it ever will. Try out the questions and activities, and have a good think about the questions before skipping ahead to the answers. You’ll get much more out of the exercises if you have to work <span class="No-Break">a little.</span></p>
			<p>I would love to hear what you think and any suggestions you have for how the book might <span class="No-Break">be improved.</span></p>
			<h1 id="_idParaDest-6"><a id="_idTextAnchor005"/>Who this book is for</h1>
			<p>This book is for people who want to learn to write code and want to learn it using PowerShell. That might be school pupils who want to try something different, IT engineers who want to move to the next level, hobbyists, makers… everybody. It’s probably not for experienced programmers who want to add PowerShell to their impressive list of competencies; if you can already write in Java, C++, or C#, then you might do better to look at a book such as <em class="italic">Mastering PowerShell Scripting</em> by Chris Dent, published <span class="No-Break">by Packt.</span></p>
			<h1 id="_idParaDest-7"><a id="_idTextAnchor006"/>What this book covers</h1>
			<p><a href="B17600_01.xhtml#_idTextAnchor013"><span class="No-Break"><em class="italic">Chapter 1</em></span></a>, <em class="italic">Introduction to PowerShell – What It Is and How to Get It</em>, explains what PowerShell 7 is, describes its uses, and how it differs from Windows PowerShell. It describes how to get it, how to install it, and how to run it, explaining the difference between User and Administrator mode. It describes how to run cmdlets and how to get help <span class="No-Break">in PowerShell.</span></p>
			<p><a href="B17600_02.xhtml#_idTextAnchor034"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, <em class="italic">Exploring PowerShell Cmdlets and Syntax</em>, focuses on how PowerShell cmdlets work, approved verbs, parameters, how to find new cmdlets with the PowerShell Gallery and elsewhere on the internet, and finally, how to work interactively <span class="No-Break">with PowerShell.</span></p>
			<p><a href="B17600_03.xhtml#_idTextAnchor049"><span class="No-Break"><em class="italic">Chapter 3</em></span></a>, <em class="italic">The PowerShell Pipeline – How to String Cmdlets Together</em>, covers how the PowerShell pipeline is one of the most important concepts in PowerShell and is quite different from how pipelines work in Bash and the Command Prompt. This chapter will show you how to successfully chain cmdlets together in a pipeline to produce useful outcomes. It will talk about filtering, output, how the pipeline works, and why it <span class="No-Break">sometimes doesn’t!</span></p>
			<p><a href="B17600_04.xhtml#_idTextAnchor071"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, <em class="italic">PowerShell Variables and Data Structures</em>, is an introduction to variables and the different types they may be, integers, floats, and how these are all objects. We’ll explore the object concept and why it is important. We’ll look at data structures as collections of objects, then arrays and hash tables, and finish <span class="No-Break">with splatting.</span></p>
			<p><a href="B17600_05.xhtml#_idTextAnchor096"><span class="No-Break"><em class="italic">Chapter 5</em></span></a>, <em class="italic">PowerShell Control Flow – Conditionals and Loops</em>, covers conditional flow (<strong class="source-inline">*IF*</strong> this, <strong class="source-inline">*THEN*</strong> that) and loops, including <strong class="source-inline">for</strong>, <strong class="source-inline">each</strong>, and <strong class="source-inline">while</strong> loops. Often, you won’t want to process cmdlets in a linear fashion – you’ll want to only do something if another thing is true or do something for all the objects in a pipeline. Control flow is how we do this. This chapter will also move us on from running interactive cmdlets to writing very simple scripts in <span class="No-Break">VS Code.</span></p>
			<p><a href="B17600_06.xhtml#_idTextAnchor117"><span class="No-Break"><em class="italic">Chapter 6</em></span></a>, <em class="italic">PowerShell and Files – Reading, Writing, and Manipulating Data</em>, shows you how to take data from common file types such as CSV and TXT files and manipulate it, as well as how to send your output to files, alleviating the tedium of having to read output off a screen and typing loads of it in. We’ll also cover how to output to HTML, which is great for creating formatted reports and live data in <span class="No-Break">web-hosted dashboards.</span></p>
			<p><a href="B17600_07.xhtml#_idTextAnchor140"><span class="No-Break"><em class="italic">Chapter 7</em></span></a>, <em class="italic">PowerShell and the Web – HTTP, REST, and JSON</em>, explores PowerShell and the web. Files are all very well, but a lot of cloud administration requires the manipulation of data from the internet; to do this, we’ll need to be able to manipulate the most common internet data type, JSON. We’ll also want to manipulate cloud services, for which we will need to be able to use REST API calls. This chapter will walk <span class="No-Break">through that.</span></p>
			<p><a href="B17600_08.xhtml#_idTextAnchor162"><span class="No-Break"><em class="italic">Chapter 8</em></span></a>, <em class="italic">Writing Our First Script – Turning Simple Cmdlets into Reusable Code</em>, focuses on how we can turn lines of code into a script that we can save and run over and over again. We’ve covered how to write a few lines of code in an IDE. How do we turn that into something that we would want to run repeatedly, and make it useful for other people <span class="No-Break">to run?</span></p>
			<p><a href="B17600_09.xhtml#_idTextAnchor184"><span class="No-Break"><em class="italic">Chapter 9</em></span></a>, <em class="italic">Don’t Repeat Yourself – Functions and Scriptblocks</em>, introduces you to functions in PowerShell as well as script blocks and lambdas. When writing a script, we will frequently find ourselves running the same few lines of code. Turning them into functions within the script means we only need to write it once, just calling it every time we <span class="No-Break">need it.</span></p>
			<p><a href="B17600_10.xhtml#_idTextAnchor201"><span class="No-Break"><em class="italic">Chapter 10</em></span></a>, <em class="italic">Error Handling – Oh No! It’s Gone Wrong!</em>, covers the two main types of errors that we’re likely to encounter – problems that our code encounters and problems with our code. In the first part of the chapter, we’ll define what an error is, how we can set PowerShell up to handle errors gracefully, and how we can make sense of them. In the second part, we’ll look at how we can identify problems with our code and use VS Code <span class="No-Break">for debugging.</span></p>
			<p><a href="B17600_11.xhtml#_idTextAnchor218"><span class="No-Break"><em class="italic">Chapter 11</em></span></a>, <em class="italic">Creating Our First Module</em>, examines how to turn functions and scripts into a module that can be reused, easily distributed, and incorporated into other scripts. Now we have a script, containing a set of functions, the next step is to turn that into a tool that others can use <span class="No-Break">for themselves.</span></p>
			<p><a href="B17600_12.xhtml#_idTextAnchor236"><span class="No-Break"><em class="italic">Chapter 12</em></span></a>, <em class="italic">Securing PowerShell</em>, delves into how to secure our PowerShell scripts and modules and run them in a secure fashion. PowerShell is a very powerful tool, and with great power comes great responsibility. The chapter will cover script execution policies, code signing, AppLocker, and some of the other <span class="No-Break">security features.</span></p>
			<p><a href="B17600_13.xhtml#_idTextAnchor267"><span class="No-Break"><em class="italic">Chapter 13</em></span></a>, <em class="italic">Working with PowerShell 7 and Windows</em>, explores how to use PowerShell 7 on Windows, when we will need to use PowerShell 5.1, how to interact with remote machines using WinRM, how to manage machines with CIM, and basic interaction with Windows features such as storage. PowerShell originated on Windows, and PowerShell 7 is intended to eventually replace Windows PowerShell, but we’re not <span class="No-Break">there yet.</span></p>
			<p><a href="B17600_14.xhtml#_idTextAnchor280"><span class="No-Break"><em class="italic">Chapter 14</em></span></a>, <em class="italic">PowerShell 7 for Linux and macOS</em>, explains how to install PowerShell on Linux, how it differs from running PowerShell on Windows, and how to use VS Code on Linux. It explains remoting with OpenSSH, how to run scripts, and some common administration tasks. It finishes with a section on installing and running PowerShell and VS Code <span class="No-Break">on macOS.</span></p>
			<p><a href="B17600_15.xhtml#_idTextAnchor302"><span class="No-Break"><em class="italic">Chapter 15</em></span></a>, <em class="italic">PowerShell 7 and the Raspberry Pi</em>, examines how to get started with PowerShell on Raspberry Pi, allowing us to do home automation, maker projects and more. It covers installing PowerShell and VS Code, connecting to the Pi, and running scripts. Raspberry Pi is everybody’s favorite single board computer, and we can transfer our PowerShell skills to our <span class="No-Break">Pi stable.</span></p>
			<p><a href="B17600_16.xhtml#_idTextAnchor320"><span class="No-Break"><em class="italic">Chapter 16</em></span></a>, <em class="italic">Working with PowerShell and .NET</em>, delves into .NET, which is the developer platform that PowerShell 7 is built on; it’s free, open source, and works well with VS Code. There are lots of things we can’t do easily with PowerShell alone, but we can leverage .NET to achieve them. Familiarity with .NET is an essential skill for every advanced PowerShell coder, and this chapter will help you <span class="No-Break">get there.</span></p>
			<h1 id="_idParaDest-8"><a id="_idTextAnchor007"/>To get the most out of this book</h1>
			<p>This book assumes you have a client machine, either laptop or PC, that is running Windows, Linux, or macOS. However, at a push, you can use Raspberry Pi for pretty much everything. It also assumes you have an internet connection. The majority of exercises will work on Windows, Linux and macOS; where they don’t, it’s noted. Read the first chapter, which has installation instructions for Windows, and then follow the installation instructions in the chapters on Linux/macOS or <span class="No-Break">Raspberry Pi.</span></p>
			<table id="table001" class="T---Table _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<thead>
					<tr class="T---Table">
						<td class="T---Table T---Body T---Header">
							<p><strong class="bold">Software/hardware covered in </strong><span class="No-Break"><strong class="bold">the book</strong></span></p>
						</td>
						<td class="T---Table T---Body T---Header">
							<p><strong class="bold">Operating </strong><span class="No-Break"><strong class="bold">system requirements</strong></span></p>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr class="T---Table">
						<td class="T---Table T---Body T---Body">
							<p><span class="No-Break">PowerShell 7.x</span></p>
						</td>
						<td class="T---Table T---Body T---Body">
							<p>Windows, macOS, <span class="No-Break">or Linux</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p><strong class="bold">If you are using the digital version of this book, I advise you to type the code yourself. Errors are part of the fun, and the sense of achievement when I </strong><strong class="bold">realize</strong><strong class="bold"> what I’ve done wrong is not something I’d want you to miss </strong><span class="No-Break"><strong class="bold">out on.</strong></span></p>
			<h1 id="_idParaDest-9"><a id="_idTextAnchor008"/>Conventions used</h1>
			<p>There are a number of text conventions used throughout <span class="No-Break">this book.</span></p>
			<p><strong class="source-inline">Code in text</strong>: Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: “The application gets installed by default in <strong class="source-inline">C:\Users\&lt;username&gt;\AppData\Local\Programs\Microsoft VS Code</strong> and is only available for the user who <span class="No-Break">installed it.”</span></p>
			<p>A block of code is set <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
$x = 5
if ($X -gt 4) {
    Write-Output '$x is bigger than 4'
}</pre>			<p>When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set <span class="No-Break">in bold:</span></p>
			<pre class="source-code">
$Array  = 1,2,3,4,5
<strong class="bold">switch</strong> ($Array) {
    1 {Write-Output '$Array contains 1'}
    3 {Write-Output '$Array contains 3'}
    6 {Write-Output '$Array contains 6'}
}</pre>			<p>Any command-line input or output is written <span class="No-Break">as follows:</span></p>
			<pre class="console">
sudo apt update
sudo apt install ./&lt;filename&gt;.deb</pre>			<p><strong class="bold">Bold</strong>: Indicates a new term, an important word, or words that you see on screen. For instance, words in menus or dialog boxes appear in <strong class="bold">bold</strong>. Here is an example: “On the <strong class="bold">Select Additional Tasks</strong> dialog, decide whether you want a desktop icon and file and directory context menu options, enabling you to open files and folders directly in <span class="No-Break">VS Code.”</span></p>
			<p class="callout-heading">Tips or important notes</p>
			<p class="callout">Appear like this.</p>
			<h1 id="_idParaDest-10"><a id="_idTextAnchor009"/>Get in touch</h1>
			<p>Feedback from our readers is <span class="No-Break">always welcome.</span></p>
			<p><strong class="bold">General feedback</strong>: If you have questions about any aspect of this book, email us at <a href="mailto:customercare@packtpub.com">customercare@packtpub.com</a> and mention the book title in the subject of <span class="No-Break">your message.</span></p>
			<p><strong class="bold">Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit <a href="http://www.packtpub.com/support/errata">www.packtpub.com/support/errata</a> and fill in <span class="No-Break">the form.</span></p>
			<p><strong class="bold">Piracy</strong>: If you come across any illegal copies of our works in any form on the internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <a href="mailto:copyright@packt.com">copyright@packt.com</a> with a link to <span class="No-Break">the material.</span></p>
			<p><strong class="bold">If you are interested in becoming an author</strong>: If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please <span class="No-Break">visit </span><a href="http://authors.packtpub.com"><span class="No-Break">authors.packtpub.com</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-11"><a id="_idTextAnchor010"/>Share your thoughts</h1>
			<p>Once you’ve read <em class="italic">PowerShell 7 Workshop</em>, we’d love to hear your thoughts! Please <a href="https://packt.link/r/1801812985">click here to go straight to the Amazon review page</a> for this book and share <span class="No-Break">your feedback.</span></p>
			<p>Your review is important to us and the tech community and will help us make sure we’re delivering excellent <span class="No-Break">quality content.</span></p>
			<h1 id="_idParaDest-12"><a id="_idTextAnchor011"/>Download a free PDF copy of this book</h1>
			<p>Thanks for purchasing <span class="No-Break">this book!</span></p>
			<p>Do you like to read on the go but are unable to carry your print <span class="No-Break">books everywhere?</span></p>
			<p>Is your eBook purchase not compatible with the device of <span class="No-Break">your choice?</span></p>
			<p>Don’t worry, now with every Packt book you get a DRM-free PDF version of that book at <span class="No-Break">no cost.</span></p>
			<p>Read anywhere, any place, on any device. Search, copy, and paste code from your favorite technical books directly into your application. </p>
			<p>The perks don’t stop there, you can get exclusive access to discounts, newsletters, and great free content in your <span class="No-Break">inbox daily</span></p>
			<p>Follow these simple steps to get <span class="No-Break">the benefits:</span></p>
			<ol>
				<li>Scan the QR code or visit the <span class="No-Break">link below</span></li>
			</ol>
			<p class="IMG---Figure"> </p>
			<div>
				<div id="_idContainer003" class="IMG---Figure">
					<img src="image/B17600_QR_Free_PDF.jpg" alt="" role="presentation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><a href="https://packt.link/free-ebook/9781801812986">https://packt.link/free-ebook/9781801812986</a></p>
			<ol>
				<li value="2">Submit your proof <span class="No-Break">of purchase</span></li>
				<li>That’s it! We’ll send your free PDF and other benefits to your <span class="No-Break">email directly</span></li>
			</ol>
		</div>
	

		<div id="_idContainer005" class="Content">
			<h1 id="_idParaDest-13" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor012"/>Part 1: PowerShell Fundamentals</h1>
			<p>In this part, we’ll learn about the basics of PowerShell, how the language syntax works, how we can send the results of one operation straight into another with the pipeline, how PowerShell uses objects, variables, and data structures, how we can create branched and looped code, and finally, how we can write to and from <span class="No-Break">stored files.</span></p>
			<p>This part has the <span class="No-Break">following chapters:</span></p>
			<ul>
				<li><a href="B17600_01.xhtml#_idTextAnchor013"><em class="italic">Chapter 1</em></a>, <em class="italic">Introduction to PowerShell – What It Is and How to Get It</em></li>
				<li><a href="B17600_02.xhtml#_idTextAnchor034"><em class="italic">Chapter 2</em></a>, <em class="italic">Exploring PowerShell Cmdlets and Syntax</em></li>
				<li><a href="B17600_03.xhtml#_idTextAnchor049"><em class="italic">Chapter 3</em></a>, <em class="italic">The PowerShell Pipeline – How to String Cmdlets Together</em></li>
				<li><a href="B17600_04.xhtml#_idTextAnchor071"><em class="italic">Chapter 4</em></a>, <em class="italic">PowerShell Variables and Data Structures</em></li>
				<li><a href="B17600_05.xhtml#_idTextAnchor096"><em class="italic">Chapter 5</em></a>, <em class="italic">PowerShell Control Flow – Conditionals and Loops</em></li>
				<li><a href="B17600_06.xhtml#_idTextAnchor117"><em class="italic">Chapter 6</em></a>, <em class="italic">PowerShell and Files – Reading, Writing, and Manipulating Data</em></li>
				<li><a href="B17600_07.xhtml#_idTextAnchor140"><em class="italic">Chapter 7</em></a>, <em class="italic">PowerShell and the Web – HTTP, REST, and JSON</em></li>
			</ul>
		</div>
		<div>
			<div id="_idContainer006">
			</div>
		</div>
	</body></html>