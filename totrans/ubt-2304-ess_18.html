<html><head></head><body>
<div class="_idGenObjectStyleOverride-1" id="_idContainer259">
<p class="Chapter-Title" id="_idParaDest-178" lang="en-US"><span class="ChapterMarker"><span class="koboSpan" id="kobo.1.1">19. </span></span><a id="_idTextAnchor316"/><span class="koboSpan" id="kobo.2.1">Displaying Ubuntu 23.04 Applications Remotely (</span><a id="_idIndexMarker449"/><span class="koboSpan" id="kobo.3.1">X11 Forwarding)</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.4.1">In the previous chapter, we looked at how to display the entire Ubuntu desktop on a remote computer. </span><span class="koboSpan" id="kobo.4.2">While this works well if you need to display the entire desktop remotely, it could be considered overkill if you only want to display a single application. </span><span class="koboSpan" id="kobo.4.3">Therefore, this chapter will look at displaying individual applications on a remote system. </span></p>
<p class="Heading-1-1" id="_idParaDest-179" lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.5.1">19.1 </span></span><a id="_idTextAnchor317"/><span class="koboSpan" id="kobo.6.1">Requirements for Remotely Displaying Ubuntu Applications </span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.7.1">There are some prerequisites to running an application on one Ubuntu system and displaying it on another. </span><span class="koboSpan" id="kobo.7.2">First, the system on which the application is to be displayed must be running an X server. </span><span class="koboSpan" id="kobo.7.3">If the system is a Linux or UNIX-based system with a desktop environment running, then this is no problem. </span><span class="koboSpan" id="kobo.7.4">However, if the system is running Windows or macOS, you must install an X server on it before you can display applications from a remote system. </span><span class="koboSpan" id="kobo.7.5">Several commercial and free Windows-based X servers are available for this purpose, and a web search should provide you with a list of options. </span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.8.1">Second, the system on which the application is being run (as opposed to the system on which the application is to be displayed) must be configured to allow SSH access. </span><span class="koboSpan" id="kobo.8.2">Details on configuring SSH on an Ubuntu system can be found in the chapter </span><a href="SSH_Authentication.xhtml#_idTextAnchor281"><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.9.1">“Configuring SSH Key-based Authentication on Ubuntu 23.04”</span></span></a><span class="koboSpan" id="kobo.10.1">. </span><span class="koboSpan" id="kobo.10.2">This system must also run the </span><a id="_idIndexMarker450"/><span class="koboSpan" id="kobo.11.1">X Window System from </span><a id="_idIndexMarker451"/><span class="koboSpan" id="kobo.12.1">X.org instead of </span><a id="_idIndexMarker452"/><span class="koboSpan" id="kobo.13.1">Wayland. </span><span class="koboSpan" id="kobo.13.2">To enable the X.org system from within the desktop, log out of the Gnome desktop, select your user account from the login screen, and then click the settings button in the bottom right-hand corner of the screen:</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US"><span class="koboSpan" id="kobo.14.1"><img alt="" class="_idGenObjectAttribute-1" src="image/ubuntu_change_to_xorg.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.15.1">Figure 19-1</span></span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.16.1">Select the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.17.1">GNOME on Xorg</span></span><span class="koboSpan" id="kobo.18.1"> option from the menu before logging in as usual. </span><span class="koboSpan" id="kobo.18.2">To revert to Wayland, repeat these steps, selecting the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.19.1">Ubuntu</span></span><span class="koboSpan" id="kobo.20.1"> option from the login screen settings menu.</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.21.1">Another option is to edit the </span><a id="_idIndexMarker453"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.22.1">/etc/gdm3/custom.conf</span></span><span class="koboSpan" id="kobo.23.1"> file, uncomment the </span><a id="_idIndexMarker454"/><span class="koboSpan" id="kobo.24.1">WaylandEnable line as follows and restart the system:</span></p>
<p class="Code"><span class="koboSpan" id="kobo.25.1"># Uncomment the line below to force the login screen to use Xorg</span></p>
<p class="Code"><span class="koboSpan" id="kobo.26.1">WaylandEnable=false</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.27.1">Once you have logged back into the desktop, open a Terminal window and run the following command to confirm that the X.org system has been enabled:</span></p>
<p class="Code"><span class="koboSpan" id="kobo.28.1">$ echo $XDG_SESSION_TYPE</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.29.1">The above command will output either </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.30.1">x11</span></span><span class="koboSpan" id="kobo.31.1"> or </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.32.1">wayland</span></span><span class="koboSpan" id="kobo.33.1">, depending on the current configuration.</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.34.1">Finally, SSH must be configured to allow X11 forwarding. </span><span class="koboSpan" id="kobo.34.2">This is achieved by adding the following directive to the SSH configuration on the system from which forwarding is to occur. </span><span class="koboSpan" id="kobo.34.3">By default on Ubuntu, the </span><a id="_idIndexMarker455"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.35.1">/etc/ssh/sshd_config</span></span><span class="koboSpan" id="kobo.36.1"> file contains a directive to include all of the configuration files contained in the </span><a id="_idIndexMarker456"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.37.1">/etc/ssh/sshd_config.d</span></span><span class="koboSpan" id="kobo.38.1"> directory:</span></p>
<p class="Code"><span class="koboSpan" id="kobo.39.1">Include /etc/ssh/sshd_config.d/*.conf</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.40.1">Create a new file in the  </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.41.1">/etc/ssh/</span></span><span class="My-Italic CharOverride-1"><a id="_idIndexMarker457"/></span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.42.1">sshd_config.d</span></span><span class="koboSpan" id="kobo.43.1"> folder named </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.44.1">05_x11forwarding</span></span><span class="koboSpan" id="kobo.45.1"> and edit it to enable the </span><a id="_idIndexMarker458"/><span class="koboSpan" id="kobo.46.1">X11Forwarding property is enabled as follows:</span></p>
<p class="Code"><span class="koboSpan" id="kobo.47.1">X11Forwarding yes</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.48.1">After making the change, save the file and restart the SSH service:</span></p>
<p class="Code"><span class="koboSpan" id="kobo.49.1"># systemctl restart ssh</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.50.1">Once the above requirements are met, it should be possible to display an X-based desktop application remotely. </span><span class="koboSpan" id="kobo.50.2">Keep in mind that not all GNOME apps are compatible with X11 forwarding. </span><span class="koboSpan" id="kobo.50.3">If an app is not compatible, the following error will appear when you try to run it using X11 forwarding:</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="CharOverride-2"><span class="koboSpan" id="kobo.51.1">X11 connection rejected because of wrong authentication.</span></span> </p>
<p class="Heading-1-1" id="_idParaDest-180" lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.52.1">19.2 </span></span><a id="_idTextAnchor318"/><span class="koboSpan" id="kobo.53.1">Displaying an Ubuntu Application Remotely </span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.54.1">The first step in remotely displaying an application is to move to the system where the application is to be displayed. </span><span class="koboSpan" id="kobo.54.2">At this system, establish an SSH connection to the remote system so that you have a command prompt. </span><span class="koboSpan" id="kobo.54.3">This can be achieved using the ssh command. </span><span class="koboSpan" id="kobo.54.4">When using the </span><a id="_idIndexMarker459"/><a id="_idIndexMarker460"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.55.1">ssh</span></span><span class="koboSpan" id="kobo.56.1"> command, we need to use the -X flag to tell it that we plan to tunnel X11 traffic through the connection: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.57.1">$ ssh -X user@hostname</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.58.1">In the above example, </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.59.1">user </span></span><span class="koboSpan" id="kobo.60.1">is the user name to use to log into the remote system, and </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.61.1">hostname</span></span><span class="koboSpan" id="kobo.62.1"> is the hostname or IP address of the remote system. </span><span class="koboSpan" id="kobo.62.2">Enter your password at the login prompt and, once logged in, run the following command to see the </span><a id="_idIndexMarker461"/><a id="_idIndexMarker462"/><span class="koboSpan" id="kobo.63.1">DISPLAY setting: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.64.1">$ echo $DISPLAY</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.65.1">The command should output something similar to the following: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.66.1">localhost:10.0</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.67.1">To display an application, run it from the command prompt. </span><span class="koboSpan" id="kobo.67.2">For example: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.68.1">$ xclock</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.69.1">When executed, the above command should run </span><a id="_idIndexMarker463"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.70.1">xclock</span></span><span class="koboSpan" id="kobo.71.1"> on the remote system but display the user interface on the local system. </span></p>
<p class="Heading-1-1" id="_idParaDest-181" lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.72.1">19.3 </span></span><a id="_idTextAnchor319"/><a id="_idIndexMarker464"/><a id="_idTextAnchor320"/><span class="koboSpan" id="kobo.73.1">Trusted X11 Forwarding </span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.74.1">You can also enable trusted X11 forwarding by adding the following line to the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.75.1">05_x11forwarding </span></span><span class="koboSpan" id="kobo.76.1">and restarting the ssh server: </span></p>
<p class="Code"><a id="_idIndexMarker465"/><span class="koboSpan" id="kobo.77.1">ForwardX11Trusted yes</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.78.1">Trusted X11 forwarding is slightly faster than untrusted forwarding but is less secure since it does not engage the X11 security controls. </span><span class="koboSpan" id="kobo.78.2">The -Y flag is needed when using trusted X11 forwarding: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.79.1">$ ssh -Y user@hostname</span></p>
<p class="Heading-1-1" id="_idParaDest-182" lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.80.1">19.4 </span></span><a id="_idTextAnchor321"/><a id="_idIndexMarker466"/><a id="_idIndexMarker467"/><span class="koboSpan" id="kobo.81.1">Compressed X11 Forwarding </span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.82.1">When using slower connections, the X11 data can be compressed using the </span><a id="_idIndexMarker468"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.83.1">ssh</span></span><span class="koboSpan" id="kobo.84.1"> -C flag to improve performance: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.85.1">$ ssh -X -C user@hostname</span></p>
<p class="Heading-1-1" id="_idParaDest-183" lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.86.1">19.5 </span></span><a id="_idTextAnchor322"/><span class="koboSpan" id="kobo.87.1">Displaying Remote Ubuntu Apps on Windows</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.88.1">To display Ubuntu-based apps on Windows, an SSH client and an X server must be installed on the Windows system. </span><span class="koboSpan" id="kobo.88.2">Installing and using the PuTTY client on Windows was covered earlier in the book in the </span><a href="SSH_Authentication.xhtml#_idTextAnchor281"><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.89.1">“Configuring SSH Key-based Authentication on Ubuntu 23.04”</span></span></a><span class="koboSpan" id="kobo.90.1"> chapter. </span><span class="koboSpan" id="kobo.90.2">Refer to this chapter if you have not already installed PuTTY on your Windows system.</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.91.1">In terms of the X server, several options are available, though a popular choice appears to be </span><a id="_idIndexMarker469"/><span class="koboSpan" id="kobo.92.1">VcXsrv which is available for free from the following URL:</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><a href="https://sourceforge.net/projects/vcxsrv/"><span class="Hyperlink _idGenCharOverride-1"><span class="koboSpan" id="kobo.93.1">https://sourceforge.net/projects/vcxsrv/</span></span></a></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.94.1">Once the VcXsrv X server has been installed, an application named </span><a id="_idIndexMarker470"/><span class="koboSpan" id="kobo.95.1">XLaunch will appear on the desktop and in the start menu. </span><span class="koboSpan" id="kobo.95.2">Start XLaunch and select a display option (the most flexible being the Multiple windows option which allows each client app to appear in its own window):</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US"><span class="koboSpan" id="kobo.96.1"><img alt="" class="_idGenObjectAttribute-2" src="image/vcxsrvr_xlaunch_settings.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.97.1">Figure 19-2</span></span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.98.1">Click the Next button to proceed through the remaining screens, accepting the default configuration settings. </span><span class="koboSpan" id="kobo.98.2">On the final screen, click the Finish button to start the X server. </span><span class="koboSpan" id="kobo.98.3">If the Windows Defender dialog appears, click the button to allow access to your chosen networks. </span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.99.1">Once running, XLaunch will appear in the taskbar and can be exited by right-clicking on the icon and selecting the Exit... </span><span class="koboSpan" id="kobo.99.2">menu option:</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US"><span class="koboSpan" id="kobo.100.1"><img alt="" class="_idGenObjectAttribute-3" src="image/vcxsrvr_xlaunch_menu.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.101.1">Figure 19-3</span></span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.102.1">With the X server installed and running, launch </span><a id="_idIndexMarker471"/><span class="koboSpan" id="kobo.103.1">PuTTY and either enter the connection information for the remote host or load a previously saved session profile. </span><span class="koboSpan" id="kobo.103.2">Before establishing the connection, however, X11 forwarding needs to be enabled. </span><span class="koboSpan" id="kobo.103.3">Therefore, within the PuTTY main window, scroll down the options in the left-hand panel, unfold the SSH section, and select the X11 option, as shown in </span><a href="X11_Forwarding.xhtml#_idTextAnchor323"><span class="koboSpan" id="kobo.104.1">Figure 19-4</span></a><span class="koboSpan" id="kobo.105.1">:</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US"><span class="koboSpan" id="kobo.106.1"><img alt="" class="_idGenObjectAttribute-4" src="image/win_10_putty_ssh.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.107.1">Figure 19-4</span></span><a id="_idTextAnchor323"/></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.108.1">Turn on the Enable X11 forwarding checkbox highlighted in </span><a href="X11_Forwarding.xhtml#_idTextAnchor324"><span class="koboSpan" id="kobo.109.1">Figure 19-5</span></a><span class="koboSpan" id="kobo.110.1">, return to the sessions screen, and open the connection (saving the session beforehand if you plan to use it again):</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US"><span class="koboSpan" id="kobo.111.1"><img alt="" class="_idGenObjectAttribute-5" src="image/putty_enable_x11_forwarding.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.112.1">Figure 19-5</span></span><a id="_idTextAnchor324"/></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.113.1">Log into the Ubuntu system within the PuTTY session window and run a desktop app. </span><span class="koboSpan" id="kobo.113.2">After a short delay, the app will appear on the Windows desktop in its own window. </span><span class="koboSpan" id="kobo.113.3">Any dialogs the app opens will also appear in separate windows, just as they would on the Ubuntu GNOME desktop. </span><a href="X11_Forwarding.xhtml#_idTextAnchor325"><span class="koboSpan" id="kobo.114.1">Figure 19-6</span></a><span class="koboSpan" id="kobo.115.1">, for example, shows the Ubuntu </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.116.1">nm-connection-editor</span></span><span class="koboSpan" id="kobo.117.1"> tool displayed on a Windows 11 system:</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US"><span class="koboSpan" id="kobo.118.1"><img alt="" class="_idGenObjectAttribute-6" src="image/x11_windows_forwarding.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.119.1">Figure 19-6</span></span><a id="_idTextAnchor325"/></p>
<p class="Heading-1-1" id="_idParaDest-184" lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.120.1">19.6 </span></span><a id="_idTextAnchor326"/><span class="koboSpan" id="kobo.121.1">Summary</span></p>
<p class="My-Basic-Paragraph" lang="en-US"><span class="koboSpan" id="kobo.122.1">For situations where remote access to individual Ubuntu desktop applications is required as opposed to the entire GNOME desktop, X11 forwarding provides a lightweight solution to remotely displaying graphical applications. </span><span class="koboSpan" id="kobo.122.2">The system on which the applications are to appear must be running an X Window System-based desktop environment (such as GNOME) or have an X server installed and running. </span><span class="koboSpan" id="kobo.122.3">Once X11 forwarding has been enabled on the remote server and a secure SSH connection established from the local system using the X11 forwarding option, most applications can be displayed remotely on the local X server.</span></p>
</div>
</body></html>