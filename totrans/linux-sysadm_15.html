<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer082">
<h1 class="chapter-number" id="_idParaDest-236"><a id="_idTextAnchor267"/>15</h1>
<h1 id="_idParaDest-237"><a id="_idTextAnchor268"/>Security Guidelines and Best Practices</h1>
<p>In the modern world, where almost all computers are connected to the internet and online applications play an increasingly larger role in all aspects of our lives, information security is also becoming more and more important. When information stored in digital form becomes more valuable and malicious actors constantly devise new attacks, every system administrator must make a conscious effort to keep their <span class="No-Break">machines secure.</span></p>
<p>Luckily, following security guidelines and best practices can prevent most attacks and limit the impact of successful attacks if <span class="No-Break">they occur.</span></p>
<p>In this chapter, we will learn about <span class="No-Break">the following:</span></p>
<ul>
<li>Information security components and types <span class="No-Break">of breaches</span></li>
<li>Common types of attacks <span class="No-Break">and threats</span></li>
<li>Attack vectors and <span class="No-Break">security vulnerabilities</span></li>
<li>Ways to keep your system secure <span class="No-Break">and stable</span></li>
</ul>
<h1 id="_idParaDest-238"><a id="_idTextAnchor269"/>Common threats and attack types</h1>
<p>There are many <a id="_idIndexMarker763"/>reasons why attackers may target a system, many ways to attack targets, and multiple possible consequences for the operator of the compromised system. Let’s examine them <span class="No-Break">in detail.</span></p>
<h2 id="_idParaDest-239"><a id="_idTextAnchor270"/>The motivation of attackers and the possible consequences</h2>
<p>The picture of an attack on computer systems that movies, literature, and video games tend to show is <a id="_idIndexMarker764"/>usually an attack on a carefully selected target with a specific goal – most often, to steal some valuable information, modify it, or perhaps <span class="No-Break">destroy it.</span></p>
<p>Such attacks certainly exist in the real world and they are a huge concern for high-profile companies and government agencies. However, that popular depiction often misleads people into believing that security is not important for them because they do not have any valuable information and are not <span class="No-Break">high-profile targets.</span></p>
<p>That perception might have been correct in the early days of the internet but, these days, it is a very dangerous assumption. In reality, most attacks are no longer targeted and carefully prepared, but rather automated and opportunistic. Every machine connected to the internet is constantly probed by automated tools that attempt to exploit known <span class="No-Break">security weaknesses.</span></p>
<p>Worse yet, automated attacks often rely on the availability of compromised third-party machines – running automated attack tools on machines that belong to the attackers themselves would be expensive and <a id="_idIndexMarker765"/>easy to detect and mitigate. To avoid paying for hosting and evade detection and blocking, attackers often gain unauthorized access to a few machines and use them to facilitate further attacks. A group of machines controlled by a malicious entity is <a id="_idIndexMarker766"/>often called a <strong class="bold">botnet</strong>. Botnets are used to probe more machines and take control of them, distribute malware, send unsolicited messages (spam), and perform other types <span class="No-Break">of attacks.</span></p>
<p>Thus, a careless system administrator can become not only a victim of an attack but also an unintentional and unknowing accomplice of the attacker. In some cases, owners of compromised systems can come under investigation from law enforcement agencies and be suspected of conducting the attack because it came from their machines. Such cases are rare but even if the owner is not held legally liable, there are still many possible consequences of allowing an attacker to control your machine: cost of electricity (for on-premises machines or co-location) or CPU time on cloud platforms, bandwidth use fees, and system overload that takes resources away from <span class="No-Break">legitimate users.</span></p>
<p>Finally, a machine that was identified as a source of attacks or spam can be added to blacklists. Multiple blacklists are maintained by various companies, so if your IP address or a domain name ends up in those lists, removing it from every list can be a very time-consuming endeavor. Moreover, blacklist maintainers are not required to remove your address since they are private companies, and blacklist inclusion and removal are not governed by any laws, and they may refuse to remove entries of repeat offenders or demand extensive proof that the current owner significantly improved its <span class="No-Break">security practices.</span></p>
<h2 id="_idParaDest-240"><a id="_idTextAnchor271"/>Information security properties and attacks on them</h2>
<p>The three <a id="_idIndexMarker767"/>components of information security are usually defined <span class="No-Break">as follows:</span></p>
<ul>
<li><span class="No-Break">Availability</span></li>
<li><span class="No-Break">Confidentiality</span></li>
<li>Integrity (<span class="No-Break">or authenticity)</span></li>
</ul>
<p>Information availability means that authorized users can access it when they need it. Confidentiality means that users can only access the information they are authorized to access. Finally, integrity means that there are no accidental or deliberate modifications that are performed or authorized by <span class="No-Break">legitimate users.</span></p>
<p>Attacks can have different goals – either to compromise information availability or to gain control of the target to compromise the confidentiality and authenticity of information stored on it. In the modern world, many attackers are also interested solely in the resources of the machine and not in any information stored on it. Let’s look at these attacks <span class="No-Break">in detail.</span></p>
<h3>Denial of service</h3>
<p>An attack <a id="_idIndexMarker768"/>on information availability is called a <strong class="bold">Denial of Service</strong> (<strong class="bold">DoS</strong>) attack. On the surface, it may look like the most <a id="_idIndexMarker769"/>benign type of attack because its effects are usually temporary. However, such attacks still can have severe consequences – for example, an online store whose website becomes unavailable can experience a significant loss of revenue, while an attack on a phone system may leave subscribers unable to make emergency calls and lead to loss of life as well. Some DoS attacks are performed simply as acts of vandalism but many such attacks are launched to extort money from the target system operator in exchange for stopping the attack, harm its reputation by rendering the service unreliable, or prevent it from making information available to users (the last goal is especially common for <span class="No-Break">politically-motivated attacks).</span></p>
<p>There are two possible ways to perform a DoS attack. The classic way involves exploiting a flaw in the system software to crash it or make it repeatedly perform complex operations and thus slow it down. These attacks can be prevented by proper software development <span class="No-Break">and configuration.</span></p>
<p>The other, increasingly <a id="_idIndexMarker770"/>more common, type is the <strong class="bold">Distributed Denial of Service</strong> (<strong class="bold">DDoS</strong>) attack. Such attacks use large numbers of machines to saturate the network link of the target system or overload it with requests beyond its capacity. The attacker can either generate attack traffic from a large botnet or use an amplification attack – that is, they can send DNS or NTP requests to public servers and specify the address of the attack target as the source address to make them send unsolicited reply packets to the target that the target never requested. Since replies are typically larger than requests, an amplification attack can save the attacker considerable bandwidth and computational resources by involving well-intentioned third parties in <span class="No-Break">the attack.</span></p>
<p>The worst <a id="_idIndexMarker771"/>part of a DDoS attack is that if an attacker generates enough traffic to saturate the network link of the target, there is <a id="_idIndexMarker772"/>nothing the administrator of the target machine itself can do to mitigate it – if the attack traffic has reached the target, its damage is already done. Such attacks can only be mitigated by the hosting or internet service provider, or a dedicated DDoS protection service that filters out malicious packets and forwards legitimate requests to the target machine. However, DDoS attacks are always targeted and never opportunistic since they require sending traffic from multiple machines to a single designated target, and most systems never become DDoS <span class="No-Break">attack targets.</span></p>
<h3>Credential theft and brute-force attacks</h3>
<p>Taking full control of a target machine is one of the most attractive goals for any attacker because it <a id="_idIndexMarker773"/>allows them to easily compromise the integrity and confidentiality of any information stored on it and use the machine itself for <span class="No-Break">their purposes.</span></p>
<p>The cleanest way to gain access is to impersonate a legitimate user. If attackers somehow gain possession of a password, a cryptographic key, or an API key used for authentication, their use of the system will look indistinguishable from <span class="No-Break">normal access.</span></p>
<p>Even credentials for access to small servers can be valuable in the modern world if the attacker can steal enough of them – one of the most common attacker actions after gaining access is to run cryptocurrency mining software on the compromised machine and thus directly convert its CPU and GPU power into money. Stealing credentials for access to cloud platforms, email services, or <strong class="bold">Voice over Internet Protocol</strong> (<strong class="bold">VoIP</strong>) is even more lucrative because attackers can use them to spawn new virtual machines, send spam, or make international calls – some even go as far as selling such illegally acquired resources to third parties who are unaware of their origin. The cost of those services, of course, has to be paid by the lawful owner of <span class="No-Break">those credentials.</span></p>
<p>A lot of malware is programmed to steal passwords and keys from end user computers. This method is ideal for attackers because it leaves no traces on the target machines that they access using those <span class="No-Break">stolen credentials.</span></p>
<p>However, many other attacks exploit the fact that end users often use weak passwords that are easy to guess. This is the basis for brute-force attacks, which are conducted by attempting to log in repeatedly with different passwords from a password dictionary that contains common words, commonly <a id="_idIndexMarker774"/>used passphrases, and often passwords stolen from other machines in the hope that someone used them for more than one machine or service (which is often <span class="No-Break">the case).</span></p>
<p>Brute-force attacks can be made significantly harder to execute by using strong passwords, encrypted keys, and setting up rate limiting to give the attacker fewer chances to log in and guess <span class="No-Break">the password.</span></p>
<h3>Attacks using configuration and software vulnerabilities</h3>
<p>Finally, in some cases, attackers can perform actions that logically must be denied to them by exploiting flaws in the <span class="No-Break">system itself.</span></p>
<p>There <a id="_idIndexMarker775"/>are two classes of such flaws: configuration issues and <span class="No-Break">software vulnerabilities.</span></p>
<p>For an <a id="_idIndexMarker776"/>example of a configuration flaw, consider that the standard protocol for email submission – <strong class="bold">Simple Mail Transport Protocol</strong> (<strong class="bold">SMTP</strong>) – does not require mandatory authentication. For this reason, every SMTP server implementation can be configured to allow anyone to send mail through it and act as an open relay. If a server with such a configuration is exposed to the public internet, attackers can use it to send large amounts of spam through it simply because it does not check whether the sender is a legitimate user of the system <span class="No-Break">or not.</span></p>
<p>In other cases, the flaw is in the software itself. For a contrived example, suppose a web application implements user authentication and correctly redirects users to their account pages upon login – say, a user with a login name of <strong class="source-inline">bob</strong> gets redirected from <strong class="source-inline">https://example.com/login</strong> to <strong class="source-inline">https://example.com/users/bob</strong> when they enter their login and password. However, due to a programming mistake, the application never checks the user account when someone tries to access an account page, so anyone who knows that there is a user named <strong class="source-inline">bob</strong> in that system can access their account page simply by typing <strong class="source-inline">https://example.com/users/bob</strong> in the <span class="No-Break">address bar.</span></p>
<p>This example may sound egregious but it is not very far from vulnerabilities sometimes found in real software, even if their exploitation method might be more complex than typing a URL into the <span class="No-Break">address bar.</span></p>
<p>Luckily, most vulnerabilities are not as dangerous. When security researchers publish their findings and when software maintainers release fixes for discovered vulnerabilities, they use a set of terms <a id="_idIndexMarker777"/>for vulnerability types and severity levels that you should be familiar with to estimate how important a <span class="No-Break">fix is.</span></p>
<p>Vulnerability reports are published by individual researchers and software vendors and also aggregated <a id="_idIndexMarker778"/>in databases such as the National Vulnerability Database, which is maintained by the United States <strong class="bold">National Institute of Standards and Technology</strong> (<strong class="bold">NIST</strong>). Every known vulnerability in those databases is assigned a unique <a id="_idIndexMarker779"/>identifier such as CVE-2023-28531 (<a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28531">https://nvd.nist.gov/vuln/detail/CVE-2023-28531</a>), where <strong class="bold">CVE</strong> stands for <strong class="bold">Common Vulnerabilities </strong><span class="No-Break"><strong class="bold">and Exposures</strong></span><span class="No-Break">.</span></p>
<p>The usual set of severity levels is <span class="No-Break">as follows:</span></p>
<ul>
<li><strong class="bold">Critical</strong>: Usually, this allows any attacker who can connect to the system to gain complete control of it. Vulnerable systems should be patched immediately or, if a patch is not available yet, isolated to make them inaccessible <span class="No-Break">to attackers.</span></li>
<li><strong class="bold">High and medium</strong>: These may allow the attacker to significantly compromise the system but require special circumstances (for example, certain features enabled in the system) or difficult exploitation procedures. Affected systems should always be patched as soon as possible and may need temporary mitigation methods if a patch is not available (such as disabling the <span class="No-Break">affected feature).</span></li>
<li><strong class="bold">Low</strong>: This does not give significant advantages to attackers as exploitation is only possible under <span class="No-Break">rare circumstances.</span></li>
</ul>
<p>Databases assign these levels based on multiple factors such as risk level, the skill required of an attacker to exploit the vulnerability, the impact, and more. For details, you may want to read about the Common Vulnerability Scoring System used by NIST or the OWASP Risk <span class="No-Break">Rating Methodology.</span></p>
<p>Here are some common <span class="No-Break">vulnerability types:</span></p>
<ul>
<li>Arbitrary <span class="No-Break">code execution</span></li>
<li><span class="No-Break">Privilege escalation</span></li>
<li>Denial <span class="No-Break">of service</span></li>
</ul>
<p><strong class="bold">Arbitrary code execution</strong> attacks tend to be the most dangerous because they allow attackers to introduce <a id="_idIndexMarker780"/>new program logic to the target system rather than merely use or abuse the software already running on it. However, there can be many <a id="_idIndexMarker781"/>mitigating factors. A vulnerability that allows remote unauthenticated attackers to execute arbitrary code by sending a specially crafted request to the target system over the network is the worst threat of all and may warrant taking the affected systems offline completely until they can be patched. However, if the user must be authenticated to execute the attack, it limits its impact greatly – to get to the arbitrary code execution stage, the attacker needs to steal valid user credentials first. Moreover, executing arbitrary code from a process that is running with highly restricted privileges and does not have access to any sensitive information may not benefit the <span class="No-Break">attacker much.</span></p>
<p><strong class="bold">Privilege escalation</strong> attacks allow legitimate users to perform actions that are not supposed to be available <a id="_idIndexMarker782"/>to them. Their impact can be severe – for example, if a vulnerability allows any authenticated user to read every file on the system regardless of its permissions, any machine where non-administrator users are allowed to log in is at risk of privacy breaches. However, before attackers outside of your organization can take advantage of it, they first need to find a way to log in. For systems where only administrators are allowed, such a vulnerability is not a concern at all, unless it is present at the same time with a remote arbitrary code execution vulnerability or <span class="No-Break">credential theft.</span></p>
<p>Finally, <strong class="bold">denial of service</strong> vulnerabilities <a id="_idIndexMarker783"/>merely allow the attacker to compromise the availability of the system, as we <span class="No-Break">already discussed.</span></p>
<p>With this in mind, let’s discuss how to protect your system from those types <span class="No-Break">of attacks.</span></p>
<h1 id="_idParaDest-241"><a id="_idTextAnchor272"/>Keeping your system secure</h1>
<p>A common joke <a id="_idIndexMarker784"/>in information security circles is that the only perfectly secure system is one that is powered off. Such a system is only secure in the sense of integrity and confidentiality, of course – at the cost of availability. Any realistic scenario is always a compromise and there is always a risk; the system administrator’s goal is to prevent known attacks and reduce the impact of unknown ones, and every administrator must always be ready to respond to new threats and <span class="No-Break">mitigate them.</span></p>
<p>Luckily, following simple guidelines can considerably reduce the risk – let’s discuss the general strategies and tactics to prevent specific <span class="No-Break">attack types.</span></p>
<h2 id="_idParaDest-242"><a id="_idTextAnchor273"/>Reducing the attack surface</h2>
<p>A system’s attack surface is, roughly speaking, the set of all ways to access it. For example, a machine that <a id="_idIndexMarker785"/>is running a web server and also a mail server has a larger attack surface than a system that only runs one of those. If we assume that vulnerabilities and configuration issues are equally probable in those services and can arise independently, then a system running both is twice as likely to <span class="No-Break">be vulnerable.</span></p>
<p>Of course, many real systems need to provide both services – for example, an email provider needs mail servers and a website for customers. Reducing the attack surface is not about running fewer services, but rather about isolating services from one another and, ideally, <span class="No-Break">from attackers.</span></p>
<p>For example, a typical web application stack involves application servers and database servers. Most of the time, there is no reason for database servers to be publicly accessible – it is always a good idea to restrict access to them to the internal network. Moreover, application servers do not need to be <em class="italic">directly</em> publicly accessible either – as we discussed in <a href="B18575_13.xhtml#_idTextAnchor216"><span class="No-Break"><em class="italic">Chapter 13</em></span></a>, <em class="italic">High Availability</em>, they can be kept behind a load balancer. Not only will a load balancer improve the system’s availability but it will also reduce the attack surfaces that are available to attackers from the public internet. Additionally, it can provide rate limiting and a threat detection system and shield application servers from at least some <span class="No-Break">attack traffic.</span></p>
<h2 id="_idParaDest-243"><a id="_idTextAnchor274"/>Compartmentalization and privilege separation</h2>
<p>A long time ago, the only way to isolate different components of a system from one another was to run them <a id="_idIndexMarker786"/>on different physical machines. This approach <a id="_idIndexMarker787"/>is very expensive and is only practiced when there are also significant reasons to do so – for example, applications designed to handle high loads have to use separate databases and application servers simply to meet their performance requirements, rather than solely to reduce the attack surface of <span class="No-Break">the system.</span></p>
<p>However, in the last two decades, there have been many more granular methods to isolate processes, even on commodity hardware. Virtualization allows you to run multiple instances of operating systems on a single physical machine, and modern virtual machine managers make it easy to spawn them – not to mention cloud platforms that allow VMs to be spawned with your operating system of choice with a single click or <span class="No-Break">API call.</span></p>
<p>Apart from full virtualization, there are many ways to isolate applications on a single machine from one another. Those include <strong class="source-inline">chroot</strong> environments, containers, and mandatory access <span class="No-Break">control systems.</span></p>
<h3>Using chroot</h3>
<p>The oldest way to completely separate processes is <strong class="source-inline">chroot</strong>. Technically, <strong class="source-inline">chroot</strong> (change root) is a system call <a id="_idIndexMarker788"/>in the kernel that changes the root directory for a process. A process whose root directory was changed no longer has access to any files outside of it – to that process, it looks as if its directory is all that exists in the system. Setting up a <strong class="source-inline">chroot</strong> environment for a process by hand may be a time-consuming task, so many distributions provide special packages to simplify <span class="No-Break">the process.</span></p>
<p>For example, Fedora provides an easy way to run ISC BIND (also known as <strong class="source-inline">named</strong>), a popular DNS server, <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">chroot</strong></span><span class="No-Break">:</span></p>
<pre class="source-code">
$ sudo dnf install bind9-next-chroot
Installed:
  bind9-next-32:9.19.11-1.fc37.x86_64     bind9-next-chroot-32:9.19.11-1.fc37.x86_64     bind9-next-dnssec-utils-32:9.19.11-1.fc37.x86_64     bind9-next-libs-32:9.19.11-1.fc37.x86_64     bind9-next-license-32:9.19.11-1.fc37.noarch
Complete!
$ sudo systemctl enable  named-chroot
Created symlink /etc/systemd/system/multi-user.target.wants/named-chroot.service → /usr/lib/systemd/system/named-chroot.service.
$ tree /var/named/chroot/
/var/named/chroot/
├── dev
├── etc
│   ├── crypto-policies
│   │   └── back-ends
│   ├── named
│   └── pki
│     └── dnssec-keys
├── proc
│   └── sys
│       └── net
│           └── ipv4
...</pre>
<p>As you can see, the directory that will serve as a limited root for the BIND process mimics the real root in that it also has <strong class="source-inline">/dev</strong> and <strong class="source-inline">/proc</strong> hierarchies – global versions of those directories become unavailable to <span class="No-Break">the process.</span></p>
<p>Thus, even if attackers <a id="_idIndexMarker789"/>manage to inject malicious code into the BIND process using a remote code execution vulnerability, they will be unable to read any files outside <strong class="source-inline">/var/named/chroot</strong>. However, they will still be free to interact with other processes on the system. If deeper isolation is required, you can use <span class="No-Break">containers instead.</span></p>
<h3>Using containers</h3>
<p>The Linux kernel provides a container technology named <strong class="bold">LXC</strong>. It consists of multiple sub-components <a id="_idIndexMarker790"/>such as process groups, control groups, and network namespaces. Creating container environments and launching them by hand is a laborious process, so people created tools that automated the process, as well as registries of ready-to-use <span class="No-Break">container images.</span></p>
<p>At this time, the most popular tool for managing containers on Linux is Docker, although there are alternatives to it, such as Podman. We will demonstrate process isolation by launching a Fedora image <span class="No-Break">using Docker:</span></p>
<pre class="source-code">
$ sudo dnf install docker
$ sudo docket pull fedora:latest
$ docker run -it fedora:latest bash
[root@df231cc10b87 /]# dnf install procps-ng
[root@df231cc10b87 /]# ps aux
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.0  0.0   4720  3712 pts/0    Ss   15:21   0:00 /bin/bash
root          55  0.0  0.0   5856  2688 pts/0    R+   15:23   0:00 ps aux</pre>
<p>As you can see, when we start a <strong class="source-inline">bash</strong> shell process in a container, from inside the container, it looks as if it is the <a id="_idIndexMarker791"/>only process in the system. None of the processes of the host system, such as systemd or the Docker daemon process, are visible and processes inside the container cannot interact with them in <span class="No-Break">any way.</span></p>
<h3>Using mandatory access control</h3>
<p>Finally, there are ways to grant users and processes different capabilities – ideally, only the capabilities they <a id="_idIndexMarker792"/>need to function. Such mechanisms <a id="_idIndexMarker793"/>are known as <strong class="bold">Mandatory Access Control</strong> (<strong class="bold">MAC</strong>) systems – as opposed <a id="_idIndexMarker794"/>to the classic <strong class="bold">Discretionary Access Control</strong> – that is, the Unix file <span class="No-Break">permission system.</span></p>
<p>The most popular <a id="_idIndexMarker795"/>MAC system for Linux these days is <strong class="bold">Security Enhanced Linux</strong> (<strong class="bold">SELinux</strong>), although there are less common alternatives as well – most notably, the AppArmor <span class="No-Break">kernel module.</span></p>
<p>These days, many Linux distributions enable SELinux by default and include capabilities and object contexts for <span class="No-Break">popular services.</span></p>
<p>You can check whether SELinux is enabled on your system with the <span class="No-Break"><strong class="source-inline">getenforce</strong></span><span class="No-Break"> command:</span></p>
<pre class="source-code">
$ getenforce
Enforcing</pre>
<p>In <strong class="source-inline">Enforcing</strong> mode, SELinux disallows actions not permitted by capabilities granted to a user or a process – for example, a process without the <strong class="source-inline">can_network_connect</strong> capability will not be able to initiate any network connections. In <strong class="source-inline">Permissive</strong> mode, SELinux will generate alerts in the system log but not enforce capabilities – this mode is ideal for testing. Finally, if the mode is <strong class="source-inline">Disabled</strong>, SELinux does not perform any capability checks <span class="No-Break">at all.</span></p>
<p>Configuring SELinux policies is a subject far beyond the scope of an introductory book. However, if you choose to keep SELinux enabled, you will often need to know how to grant processes access <span class="No-Break">to files.</span></p>
<p>For example, in the Apache HTTPd configuration files, it is possible to specify any directory as a website root. That is also a possible security problem if an attacker gains control of the Apache process. That is why, in Fedora, the maintainers of that package introduced a set of special SELinux contexts for files that must be accessible to the <span class="No-Break">web server.</span></p>
<p>You can view the SELinux contexts of a file by adding the <strong class="source-inline">-Z</strong> option to the <strong class="source-inline">ls</strong> command. For example, the <strong class="source-inline">/var/lib/httpd</strong> directory has the <strong class="source-inline">httpd_var_lib_t</strong> context, which grants <span class="No-Break">read access:</span></p>
<pre class="source-code">
$ sudo ls -alZ /var/lib/httpd/
total 8
drwx------.  2 apache apache system_u:object_r:httpd_var_lib_t:s0 4096 Jun 17  2022 .
drwxr-xr-x. 55 root   root   system_u:object_r:var_lib_t:s0       4096 Nov 16 02:39 ..</pre>
<p>Website <a id="_idIndexMarker796"/>directories that may be writable use a different context – <span class="No-Break"><strong class="source-inline">httpd_sys_content_t</strong></span><span class="No-Break">:</span></p>
<pre class="source-code">
$ ls -alZ /var/www/html/
total 8
drwxr-xr-x. 2 root root system_u:object_r:httpd_sys_content_t:s0 4096 Jun 17  2022 .
drwxr-xr-x. 6 root root system_u:object_r:httpd_sys_content_t:s0 4096 Jun 17  2022 ..</pre>
<p>If you set a website root to a newly created directory elsewhere, the Apache process will not have access to it because it lacks the required context, even if it should be readable to it according to Unix permissions. You can grant it access using the <span class="No-Break"><strong class="source-inline">chcon</strong></span><span class="No-Break"> command:</span></p>
<pre class="source-code">
$ sudo chcon system_u:object_r:httpd_sys_content_t:s0 /home/webmaster/public_html</pre>
<p>There are many more possibilities for creating flexible and fine-grained security policies with SELinux, but beginners should certainly start by using the distribution <span class="No-Break">defaults first.</span></p>
<h2 id="_idParaDest-244"><a id="_idTextAnchor275"/>Preventing credential theft and brute-force attacks</h2>
<p>Credential <a id="_idIndexMarker797"/>theft must be addressed at user workstations. There is no definitive way to prevent credential theft, so you should strive to protect your laptop or desktop system from attacks in general – keep it up to date, protect it from malware, and avoid falling for social engineering attacks such as phishing letters that contain <span class="No-Break">malicious links.</span></p>
<p>When it comes to brute-force attacks, there are two complementary approaches – keeping passwords hard to guess and limiting <span class="No-Break">authentication attempts.</span></p>
<p>Most Linux distributions have a PAM module named <strong class="source-inline">pam_pwquality.so</strong> enabled by default, which prevents unprivileged users from using insecure passwords. You can verify this by trying to set your <a id="_idIndexMarker798"/>password to something way too short or a simple <span class="No-Break">dictionary word:</span></p>
<pre class="source-code">
$ passwd
Changing password for user ...
Current password:
New password: qwerty
BAD PASSWORD: The password is shorter than 8 characters
passwd: Authentication token manipulation error
$ passwd
Changing password for user ...
Current password:
New password: swordfish
BAD PASSWORD: The password fails the dictionary check - it is based on a dictionary word
passwd: Authentication token manipulation error</pre>
<p>The backend that it uses for password strength checking is called <strong class="source-inline">cracklib</strong>. It normally keeps its data in <strong class="source-inline">/usr/share/cracklib</strong>. Its dictionary is in a binary format but it offers tools for manipulating those dictionary files and checking password strength without actually trying to set <span class="No-Break">a password:</span></p>
<pre class="source-code">
$ echo "swordfish" | cracklib-check
swordfish: it is based on a dictionary word</pre>
<p>Note that the root user is exempt from password quality checking and is free to set any password for <span class="No-Break">any user.</span></p>
<p>There is also a tool for generating secure random passwords named <strong class="bold">pwgen</strong> that is present in the package repositories of most Linux distributions. It allows you to specify whether passwords should be completely random, what characters they should contain, how long they should be, and how many passwords to generate <span class="No-Break">at once:</span></p>
<pre class="source-code">
$ pwgen --secure 40 1
DMYRsJNuXJQb98scCUASDzt3GFPa7yzGg9eS1L1U
$ pwgen --secure 8 16
Ob4r24Sp KwGCF63L 3bgKI79L aWK2K7aK MFf1ykum y74VTKqb OxbrNlI0 8Dl4yilz
bmI1RsKr oM4p8dsJ 2EXmmHIJ bt9Go1gg 3znmVqpo vZ9BDIlz QMZ7eME0 izkB15Xe</pre>
<p>Rate limiting <a id="_idIndexMarker799"/>is a broad subject and its setup varies between services and applications. However, there are also general integrated solutions that support multiple services, such <span class="No-Break">as </span><span class="No-Break"><strong class="bold">fail2ban</strong></span><span class="No-Break">.</span></p>
<h2 id="_idParaDest-245"><a id="_idTextAnchor276"/>Reducing the risk of software vulnerabilities</h2>
<p>The best way to ensure that your system does not have vulnerable software in it is to use software from your <a id="_idIndexMarker800"/>distribution repositories and install updates on time. Installing packages by hand should be avoided because such packages will not automatically receive updates from the distribution maintainers. If they are required, you should make sure you subscribe to their release announcements and check for <span class="No-Break">updates yourself.</span></p>
<p>A lot of the time, vulnerabilities are found in already released software versions rather than during development – this <a id="_idIndexMarker801"/>situation is called a <strong class="bold">zero-day vulnerability</strong> (often shortened to <strong class="bold">0day</strong>). Sometimes, they turn out to have existed for months or even years before their discovery. Updated packages that fix such vulnerabilities may appear later than malicious actors start exploiting them. In that case, software maintainers often suggest a temporary mitigation strategy that may involve changing configuration options, disabling specific features, or making other changes in the system to make the attack harder to execute. For this reason, it is also a good idea to follow the blogs or mailing lists or the distribution and software projects that you <span class="No-Break">use often.</span></p>
<h1 id="_idParaDest-246"><a id="_idTextAnchor277"/>Summary</h1>
<p>In this chapter, we learned about various types of attacks on computer systems, attackers’ motivation to execute them, and possible consequences <span class="No-Break">for users.</span></p>
<p>We also learned about common strategies for keeping your systems protected from attacks. However, we only scratched the surface – information security is a large field, and keeping your knowledge of it up to date and your systems safe is a life-long pursuit for every <span class="No-Break">system administrator.</span></p>
<h1 id="_idParaDest-247"><a id="_idTextAnchor278"/>Further reading</h1>
<p>To learn more about the topics that were covered in this chapter, take a look at the <span class="No-Break">following resources:</span></p>
<ul>
<li>NIST vulnerability <span class="No-Break">database: </span><a href="https://nvd.nist.gov/%0D"><span class="No-Break">https://nvd.nist.gov/</span></a></li>
<li>Common Vulnerability Scoring <span class="No-Break">System: </span><a href="https://nvd.nist.gov/vuln-metrics/cvss%0D"><span class="No-Break">https://nvd.nist.gov/vuln-metrics/cvss</span></a></li>
<li>OWASP Risk Rating <span class="No-Break">Methodology: </span><a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology%0D"><span class="No-Break">https://owasp.org/www-community/OWASP_Risk_Rating_Methodology</span></a></li>
<li>Fail2Ban rate limiting <span class="No-Break">daemon: </span><a href="https://www.fail2ban.org"><span class="No-Break">https://www.fail2ban.org</span></a></li>
</ul>
</div>
</div></body></html>