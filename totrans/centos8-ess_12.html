<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer145" class="_idGenObjectStyleOverride-1">&#13;
			<p id="_idParaDest-132" class="Chapter-Title"><span class="ChapterMarker">14. </span><a id="_idTextAnchor181"/>Configuring SSH Key-based Authentication on CentOS 8</p>&#13;
			<p class="My-Basic-Paragraph">When a CentOS 8 system is first installed, it is configured by default to allow remote command-line access via Secure Shell (SSH) connections. This provides password protected and encrypted access to the system for the root account and any other users added during the installation phase. This level of security is far from adequate and should be upgraded to SSH key-based authentication as soon as possible.</p>&#13;
			<p class="My-Basic-Paragraph">This chapter will outline the steps to increase the security of a CentOS 8 system by implementing key-based SSH authentication.</p>&#13;
			<p id="_idParaDest-133" class="Heading-1-1"><span class="Heading11Marker">14.1 </span><a id="_idTextAnchor182"/>An Overview of Secure Shell (<a id="_idIndexMarker307"/>SSH)</p>&#13;
			<p class="My-Basic-Paragraph">SSH is designed to allow secure remote access to systems for the purposes of gaining shell access and transferring files and data. As will be covered in <a href="../Text/Remote_Desktop_Access.xhtml#_idTextAnchor196"><span class="My-Italic _idGenCharOverride-1">“CentOS 8 Remote Desktop Access with VNC”</span></a>, SSH can also be used to provide a secure <span class="My-Italic _idGenCharOverride-1">tunnel</span> through which remote access to the GNOME desktop can be achieved over a network connection. </p>&#13;
			<p class="My-Basic-Paragraph">A basic SSH configuration consists of a client (used on the computer establishing the connection) and a server (running on the system to which the connection is to be established). A user might, for example, use an SSH client running on a Linux, Windows or macOS system to connect to the SSH server running on a CentOS 8 system to gain access to a shell command-line prompt or to perform file transfers. All of the communications between client and server, including the password entered to gain access, are encrypted preventing outside parties from intercepting the data. </p>&#13;
			<p class="My-Basic-Paragraph">The inherent weakness in a basic SSH implementation is that it depends entirely on the strength of the passwords assigned to the accounts on the system. If a malicious party is able to identify the password for an account (either through guess work, subterfuge or a brute force attack) the system becomes vulnerable. This weakness can be addressed by implementing SSH key-based authentication.</p>&#13;
			<p id="_idParaDest-134" class="Heading-1-1"><span class="Heading11Marker">14.2 </span><a id="_idTextAnchor183"/>SSH Key-based Authentication</p>&#13;
			<p class="My-Basic-Paragraph">SSH key-based authentication makes use of asymmetric <a id="_idIndexMarker308"/><span class="My-Italic _idGenCharOverride-1">public key encryption</span> to add an extra layer of security to remote system access. The concept of public key encryption was devised in 1975 by <a id="_idIndexMarker309"/>Whitfield Diffie and <a id="_idIndexMarker310"/>Martin Hellman and is based on the concept of using a pair of keys, one private and one public.</p>&#13;
			<p class="My-Basic-Paragraph">In a public key encryption system, the public key is used to encrypt data that can only be decrypted by the owner of the private key.</p>&#13;
			<p class="My-Basic-Paragraph">In the case of <a id="_idIndexMarker311"/>SSH key-based authentication, the private key is held by the host on which the SSH client is located while the corresponding public key resides on the system on which the SSH server is running. It is important to protect the private key, since ownership of the key will allow anyone to log into the remote system. As an added layer of protection, therefore, the private key may also be encrypted and protected by a password which must be entered each time a connection is established to the server.</p>&#13;
			<p id="_idParaDest-135" class="Heading-1-1"><span class="Heading11Marker">14.3 </span><a id="_idTextAnchor184"/>Setting Up Key-based Authentication</p>&#13;
			<p class="My-Basic-Paragraph">There are four steps to setting up key-based SSH authentication which can be summarized as follows:</p>&#13;
			<p class="My-Basic-Paragraph">1. Generate the public and private keys.</p>&#13;
			<p class="My-Basic-Paragraph">2. Install the public key on the server.</p>&#13;
			<p class="My-Basic-Paragraph">3. Test authentication.</p>&#13;
			<p class="My-Basic-Paragraph">4. Disable password-based authentication on the server.</p>&#13;
			<p class="My-Basic-Paragraph">The remainder of this chapter will outline these steps in greater detail for Linux, macOS and Windows-based client operating systems.</p>&#13;
			<p id="_idParaDest-136" class="Heading-1-1"><span class="Heading11Marker">14.4 </span><a id="_idTextAnchor185"/><a id="_idIndexMarker312"/><a id="_idIndexMarker313"/>SSH Key-based Authentication from Linux and macOS Clients</p>&#13;
			<p class="My-Basic-Paragraph">The first step in setting up SSH key-based authentication is to generate the key pairs on the client system. If the client system is running Linux or macOS, this is achieved using the <a id="_idIndexMarker314"/><a id="_idIndexMarker315"/><span class="My-Italic _idGenCharOverride-1">ssh-keygen</span> utility:</p>&#13;
			<p class="Code"># ssh-keygen</p>&#13;
			<p class="My-Basic-Paragraph">This will result in output similar to the following:</p>&#13;
			<p class="Code">Generating public/private rsa key pair.</p>&#13;
			<p class="Code">Enter file in which to save the key (/home/&lt;username&gt;/.ssh/id_rsa):</p>&#13;
			<p class="My-Basic-Paragraph">Press the Enter key to accept the default location for the key files. This will place two files in the <span class="My-Italic _idGenCharOverride-1">.ssh</span> sub-directory of the current user’s home directory. The private key will be stored in a file named <a id="_idIndexMarker316"/><span class="My-Italic _idGenCharOverride-1">id_rsa</span> while the public key will reside in the file named <span class="My-Italic _idGenCharOverride-1">id_rsa.pub</span>.</p>&#13;
			<p class="My-Basic-Paragraph">Next, <span class="My-Italic _idGenCharOverride-1">ssh-keygen</span> will prompt for a passphrase with which to protect the private key. If a passphrase is provided, the private key will be encrypted on the local disk and the passphrase required in order to gain access to the remote system. For better security, use of a passphrase is recommended.</p>&#13;
			<p class="Code">Enter passphrase (empty for no passphrase):</p>&#13;
			<p class="My-Basic-Paragraph">Finally, the <span class="My-Italic _idGenCharOverride-1">ssh-keygen</span> tool will generate the following output indicating that the keys have been generated:</p>&#13;
			<p class="Code">Your identification has been saved in /home/neil/.ssh/id_rsa.</p>&#13;
			<p class="Code">Your public key has been saved in /home/neil/.ssh/id_rsa.pub.</p>&#13;
			<p class="Code">The key fingerprint is:</p>&#13;
			<p class="Code">SHA256:FOLGWEEGFIjWnCT5wtTOv5VK4hdimzWghZizUEMYbfo &lt;username&gt;@&lt;hostname&gt;</p>&#13;
			<p class="Code">The key’s randomart image is:</p>&#13;
			<p class="Code">+---[RSA 2048]----+</p>&#13;
			<p class="Code">|.BB+=+*..        |</p>&#13;
			<p class="Code">|o+B= * . .       |</p>&#13;
			<p class="Code">|===.. + .        |</p>&#13;
			<p class="Code">|*+ * . .         |</p>&#13;
			<p class="Code">|.++ o   S        |</p>&#13;
			<p class="Code">|..E+ * o         |</p>&#13;
			<p class="Code">|  o B *          |</p>&#13;
			<p class="Code">|   + +           |</p>&#13;
			<p class="Code">|    .            |</p>&#13;
			<p class="Code">+----[SHA256]-----+</p>&#13;
			<p class="My-Basic-Paragraph">The next step is to install the public key onto the remote server system. This can be achieved using the <a id="_idIndexMarker317"/><a id="_idIndexMarker318"/><span class="My-Italic _idGenCharOverride-1">ssh-copy-id </span>utility as follows:</p>&#13;
			<p class="Code">$ ssh-copy-id username@remote_hostname</p>&#13;
			<p class="My-Basic-Paragraph">For example:</p>&#13;
			<p class="Code">$ ssh-copy-id neil@192.168.1.100</p>&#13;
			<p class="Code">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/neil/.ssh/id_rsa.pub"</p>&#13;
			<p class="Code">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</p>&#13;
			<p class="Code">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</p>&#13;
			<p class="Code">neil@192.168.1.100’s password: </p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Number of key(s) added: 1</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Now try logging into the machine, with:   "ssh ‘neil@192.168.1.100’"</p>&#13;
			<p class="Code">and check to make sure that only the key(s) you wanted were added.</p>&#13;
			<p class="My-Basic-Paragraph">Once the key is installed, test that the authentication works by attempting a remote login using the <span class="My-Italic _idGenCharOverride-1">ssh</span> client:</p>&#13;
			<p class="Code">$ ssh -l &lt;username&gt; &lt;hostname&gt;</p>&#13;
			<p class="My-Basic-Paragraph">If the private key is encrypted and protected with a passphrase, enter the phrase when prompted to complete the authentication and establish remote access to the CentOS 8 system:</p>&#13;
			<p class="Code">Enter passphrase for key ‘/home/neil/.ssh/id_rsa’: </p>&#13;
			<p class="Code">Last login: Thu Feb 21 13:41:23 2019 from 192.168.1.101</p>&#13;
			<p class="Code">[neil@demosystem02 ~]$</p>&#13;
			<p class="My-Basic-Paragraph">Repeat these steps for any other accounts on the server for which remote access is required. If access is also required from other client systems, simply copy the <a id="_idIndexMarker319"/><span class="My-Italic _idGenCharOverride-1">id_rsa</span> private key file to the <a id="_idIndexMarker320"/><span class="My-Italic _idGenCharOverride-1">.ssh</span> sub-directory of your home folder of the other systems.</p>&#13;
			<p class="My-Basic-Paragraph">As currently configured, access to the remote system can still be achieved using the less secure password authentication. Once you have verified that key-based authentication works, log into the remote system, edit the <span class="My-Italic _idGenCharOverride-1">/etc/ssh/</span><span class="My-Italic CharOverride-1"><a id="_idIndexMarker321"/><a id="_idIndexMarker322"/><a id="_idIndexMarker323"/></span><span class="My-Italic _idGenCharOverride-1">ssh_config</span> file and change the <span class="My-Italic _idGenCharOverride-1">PasswordAuthentication</span> setting to <span class="My-Italic _idGenCharOverride-1">no</span>:</p>&#13;
			<p class="Code">PasswordAuthentication no</p>&#13;
			<p class="My-Basic-Paragraph">Save the file and restart the <span class="My-Italic _idGenCharOverride-1">sshd</span> service to implement the change:</p>&#13;
			<p class="Code"># systemctl restart <a id="_idIndexMarker324"/>sshd.service</p>&#13;
			<p class="My-Basic-Paragraph">From this point on, it will only be possible to remotely access the system using SSH key-based authentication.</p>&#13;
			<p id="_idParaDest-137" class="Heading-1-1"><span class="Heading11Marker">14.5 </span><a id="_idTextAnchor186"/>Managing <a id="_idIndexMarker325"/>Multiple Keys</p>&#13;
			<p class="My-Basic-Paragraph">It is not uncommon for multiple private keys to reside on a client system, each providing access to a different server. There are a number of options for selecting a specific key when establishing a connection. It is possible, for example, to specify the private key file to be used when launching the <span class="My-Italic _idGenCharOverride-1">ssh</span> client as follows:</p>&#13;
			<p class="Code">$ ssh -l neilsmyth -i ~/.ssh/id_work 35.194.18.119</p>&#13;
			<p class="My-Basic-Paragraph">Alternatively, the SSH client user configuration file may be used to associate key files with servers. The configuration file is named <span class="My-Italic _idGenCharOverride-1">config</span>, must reside in the <span class="My-Italic _idGenCharOverride-1">.ssh</span> directory of the user’s home directory and can be used to configure a wide range of options including the private key file, the default port to use when connecting, the default user name, and an abbreviated nickname via which to reference the server. The following example <span class="My-Italic _idGenCharOverride-1">config</span> file defines different key files for two servers and allows them to be referenced by the nicknames <span class="My-Italic _idGenCharOverride-1">home</span> and <span class="My-Italic _idGenCharOverride-1">work</span>. In the case of the work system, the file also specifies the user name to be used when authenticating:</p>&#13;
			<p class="Code">Host work</p>&#13;
			<p class="Code">  HostName 35.194.18.119</p>&#13;
			<p class="Code">  IdentityFile ~/.ssh/id_work</p>&#13;
			<p class="Code">  User neilsmyth</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Host home</p>&#13;
			<p class="Code">  HostName 192.168.0.21</p>&#13;
			<p class="Code">  IdentityFile ~/.ssh/id_home</p>&#13;
			<p class="My-Basic-Paragraph">Prior to setting up the configuration file, the user would have used the following command to connect to the work system:</p>&#13;
			<p class="Code">$ ssh -l neilsmyth -i ~/.ssh/id_work 35.194.18.119</p>&#13;
			<p class="My-Basic-Paragraph">Now, however, the command can be shortened as follows:</p>&#13;
			<p class="Code">$ ssh work</p>&#13;
			<p class="My-Basic-Paragraph">A full listing of configuration file options can be found by running the following command:</p>&#13;
			<p class="Code">$ man ssh_config</p>&#13;
			<p id="_idParaDest-138" class="Heading-1-1"><span class="Heading11Marker">14.6 </span><a id="_idTextAnchor187"/><a id="_idIndexMarker326"/>SSH Key-based Authentication from Windows 10 Clients</p>&#13;
			<p class="My-Basic-Paragraph">Recent releases of Windows 10 include a subset of the OpenSSH implementation that is used by most Linux and macOS systems as part of Windows PowerShell. This allows SSH key-based authentication to be set up from a Windows 10 client using similar steps to those outlined above for Linux and macOS.</p>&#13;
			<p class="My-Basic-Paragraph">To open <a id="_idIndexMarker327"/>Windows PowerShell on a Windows 10 system press the Win+X keyboard combination and select it from the menu, or locate and select it from the Start menu. Once running, the PowerShell window will appear as shown in <a href="../Text/SSH_Authentication.xhtml#_idTextAnchor188">Figure 14-1</a>:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1"><img class="_idGenObjectAttribute-1" src="Images/windows_10_powwershell.png" alt="" width="1092" height="534"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 14-1</span><a id="_idTextAnchor188"/></p>&#13;
			<p class="My-Basic-Paragraph">If you already have a private key from another client system, simply copy the <a id="_idIndexMarker328"/><span class="My-Italic _idGenCharOverride-1">id_rsa</span> file to a folder named <span class="My-Italic _idGenCharOverride-1">.ssh</span> on the Windows 10 system. Once the file is in place, test the authentication within the PowerShell window as follows:</p>&#13;
			<p class="Code">$ ssh -l &lt;username&gt;@&lt;hostname&gt;</p>&#13;
			<p class="My-Basic-Paragraph">For example:</p>&#13;
			<p class="Code">PS C:\Users\neil&gt; ssh -l neil 192.168.1.101</p>&#13;
			<p class="Code">Enter passphrase for key 'C:\Users\neil/.ssh/id_rsa':</p>&#13;
			<p class="My-Basic-Paragraph">Enter the passphrase when prompted and complete the authentication process.</p>&#13;
			<p class="My-Basic-Paragraph">If an existing private key does not yet exist, generate a new private and public key pair within the PowerShell window using the <span class="My-Italic _idGenCharOverride-1">ssh-keygen</span> utility using the same steps as those outlined for Linux and macOS. Once the keys have been generated, the keys will once again be located in the <span class="My-Italic _idGenCharOverride-1">.ssh</span> directory of the current user’s home folder, and the public key file <span class="My-Italic _idGenCharOverride-1">id_rsa.pub</span> will need to be installed on the remote CentOS 8 system. Unfortunately, Windows PowerShell does not include the <span class="My-Italic _idGenCharOverride-1">ssh-copy-id</span> utility, so this task will need to be performed manually.</p>&#13;
			<p class="My-Basic-Paragraph">Within the PowerShell window, change directory into the <span class="My-Italic _idGenCharOverride-1">.ssh</span> sub-directory and display the content of the public key <a id="_idIndexMarker329"/><span class="My-Italic _idGenCharOverride-1">id_rsa.pub </span>file:</p>&#13;
			<p class="Code">PS C:\Users\neil&gt; cd .ssh</p>&#13;
			<p class="Code">PS C:\Users\neil\.ssh&gt; type id_rsa.pub</p>&#13;
			<p class="Code">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDFgx1vzu59lll6/uQw7FbmKVsQ3fzLz9MW1fgo4sdsxXp81wCHNAlqcjx1Pgr9BJPXWUMInQOi7BQ5I+vc2xQ2AS0kMq3ZH9ybWuQe/U2GjueXZd0FKrEXrT55wM36Rm6Ii3roUCoGCzGR8mn95JvRB3VtCyDdzTWSi8JBpK5gV5oOxNTNPsewlLzouBlCT1qW3CKwEiIwu8S9MTL7m3nrcaNeLewTTHevvHw4QDwzFQ+B0PDg96fzsYoTXVhzyHSWyo6H0gqrft7aK+gILBtEIhWTkSVEMAzy1piKtCr1IYTmVK6engv0aoGtMUq6FnOeGp5FjvKkF4aQkh1QR28r neil@DESKTOP-S8P8D3N</p>&#13;
			<p class="My-Basic-Paragraph">Highlight the content of the file and copy it using the Ctrl-C keyboard shortcut. </p>&#13;
			<p class="My-Basic-Paragraph">Remaining within the PowerShell window, log into the remote system using password authentication:</p>&#13;
			<p class="Code">PS C:\Users\neil\.ssh&gt; ssh -l &lt;username&gt; &lt;hostname&gt;</p>&#13;
			<p class="My-Basic-Paragraph">Once signed in, check if the <span class="My-Italic _idGenCharOverride-1">.ssh</span> sub-directory exists. If it does not, create it as follows:</p>&#13;
			<p class="Code">$ mkdir .ssh</p>&#13;
			<p class="My-Basic-Paragraph">Change directory into <span class="My-Italic _idGenCharOverride-1">.ssh</span> and check whether a file named <span class="My-Italic _idGenCharOverride-1">authorized_keys</span> already exists. If it does not, create it and paste the content of the public key file from the Windows 10 system into it. </p>&#13;
			<p class="My-Basic-Paragraph">If the <span class="My-Italic _idGenCharOverride-1">authorized_keys</span> file already exists it most likely already contains other keys. If this is the case, edit the file and paste the new public key at the end of the file. The following file, for example, contains two keys:</p>&#13;
			<p class="Code">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzRWH27Xs8ZA5rIbZXKgxFY5XXauMv+6F5PljBLJ6j+9nkmykVe3GjZTp3oD+KMRbT2kTEPbDpFD67DNL0eiX2ZuEEiYsxZfGCRCPBGYmQttFRHEAFnlS1Jx/G4W5UNKvhAXWyMwDEKiWvqTVy6syB2Ritoak+D/Sc8nJflQ6dtw0jBs+S7Aim8TPfgpi4p5XJGruXNRScamk68NgnPfTL3vT726EuABCk6C934KARd+/AXa8/5rNOh4ETPstjBRfFJ0tpmsWWhhNEnwJRqS2LD0ug7E3yFI2qsNKGEzvAYUC8Up45MRP7liR3aMlCBil1tsy9R+IB7oMEycZAe/qj neil@localhost.localdomain</p>&#13;
			<p class="Code">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDFgx1vzu59lll6/uQw7FbmKVsQ3fzLz9MW1fgo4sdsxXp81wCHNAlqcjx1Pgr9BJPXWUMInQOi7BQ5I+vc2xQ2AS0kMq3ZH9ybWuQe/U2GjueXZd0FKrEXrT55wM36Rm6Ii3roUCoGCzGR8mn95JvRB3VtCyDdzTWSi8JBpK5gV5oOxNTNPsewlLzouBlCT1qW3CKwEiIwu8S9MTL7m3nrcaNeLewTTHevvHw4QDwzFQ+B0PDg96fzsYoTXVhzyHSWyo6H0gqrft7aK+gILBtEIhWTkSVEMAzy1piKtCr1IYTmVK6engv0aoGtMUq6FnOeGp5FjvKkF4aQkh1QR28r neil@DESKTOP-S8P8D3N</p>&#13;
			<p class="My-Basic-Paragraph">Once the public key is installed on the server, test the authentication by logging in to the server from within the Windows 10 PowerShell window, for example:</p>&#13;
			<p class="Code">PS C:\Users\neil\.ssh&gt; ssh -l neil 192.168.1.100</p>&#13;
			<p class="Code">Enter passphrase for key 'C:\Users\neil/.ssh/id_rsa':</p>&#13;
			<p class="My-Basic-Paragraph">When key-based authentication has been set up for all the accounts and verified, disable password authentication on the CentOS 8 system as outlined at the end of the previous section.</p>&#13;
			<p id="_idParaDest-139" class="Heading-1-1"><span class="Heading11Marker">14.7 </span><a id="_idTextAnchor189"/>SSH Key-based Authentication using <a id="_idIndexMarker330"/><a id="_idIndexMarker331"/>PuTTY</p>&#13;
			<p class="My-Basic-Paragraph">For Windows systems that do not have OpenSSH available, or as a more flexible alternative to using PowerShell, the PuTTY tool is a widely used alternative. The first step in using PuTTY is to download and install it on any Windows systems that need an SSH client. PuTTY is a free utility and can be downloaded using the following link:</p>&#13;
			<p class="My-Basic-Paragraph"><a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html"><span class="Hyperlink _idGenCharOverride-1">https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html</span></a></p>&#13;
			<p class="My-Basic-Paragraph">Download the Windows installer executable that matches your Windows system (32-bit and 64-bit versions are available) then execute the installer to complete installation.</p>&#13;
			<p class="My-Basic-Paragraph">If a private key already exists on another system, create the <span class="My-Italic _idGenCharOverride-1">.ssh</span> folder in the home folder of the current user and copy the private <span class="My-Italic _idGenCharOverride-1">id_rsa key</span> into it.</p>&#13;
			<p class="My-Basic-Paragraph">Next, the private key file needs to be converted to a PuTTY private key format file using the <a id="_idIndexMarker332"/><a id="_idIndexMarker333"/><span class="My-Italic _idGenCharOverride-1">PuTTYgen </span>tool. Locate this utility in the Windows Start menu and launch it:</p>&#13;
			<p class="Centered-Image"><img class="_idGenObjectAttribute-2" src="Images/windows_puttygen_main.png" alt="" width="718" height="730"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 14-2</span></p>&#13;
			<p class="My-Basic-Paragraph">Once launched, click on the<span class="My-Italic _idGenCharOverride-1"> Load</span> button located in the <span class="My-Italic _idGenCharOverride-1">Actions</span> section and navigate to the private key file previously copied to the <span class="My-Italic _idGenCharOverride-1">.ssh</span> folder (note that it may be necessary to change the file type filter to <span class="My-Italic _idGenCharOverride-1">All Files (*.*)</span>)<span class="My-Italic _idGenCharOverride-1"> </span>in order for the key file to be visible. Once located, select the file and load it into <span class="My-Italic _idGenCharOverride-1">PuttyGen</span>. When prompted, enter the passphrase originally used to encrypt the file. Once the private key has been imported, save it as a PuTTY key file by clicking on the <span class="My-Italic _idGenCharOverride-1">Save Private Key </span>button. For consistency, save the key file to the <span class="My-Italic _idGenCharOverride-1">.ssh </span>folder but give it a different name to differentiate it from the original key file.</p>&#13;
			<p class="My-Basic-Paragraph">Launch PuTTY from the Start menu and enter the IP address or host name of the remote server into the main screen before selecting the <span class="My-Italic _idGenCharOverride-1">Connection -&gt; SSH -&gt; Auth</span> category in the left-hand panel as highlighted in <a href="../Text/SSH_Authentication.xhtml#_idTextAnchor190">Figure 14-3</a>:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1"><img class="_idGenObjectAttribute-3" src="Images/windows_putty_ssh_auth.png" alt="" width="677" height="676"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 14-3</span><a id="_idTextAnchor190"/></p>&#13;
			<p class="My-Basic-Paragraph">Click on the Browse button next to the <span class="My-Italic _idGenCharOverride-1">Private key for authentication</span> field and navigate to and select the previously saved PuTTY private key file. Optionally, scroll to the top of the left-hand panel, select the <span class="My-Italic _idGenCharOverride-1">Session </span>entry and enter a name for the session in the <span class="My-Italic _idGenCharOverride-1">Saved Sessions</span> field before clicking on the <span class="My-Italic _idGenCharOverride-1">Save</span> button. This will save the session configuration so that it can be used in future without having to re-enter the settings each time.</p>&#13;
			<p class="My-Basic-Paragraph">Finally, click on the <span class="My-Italic _idGenCharOverride-1">Open</span> button to establish the connection to the remote server, entering the user name and passphrase when prompted to do so to complete the authentication.</p>&#13;
			<p id="_idParaDest-140" class="Heading-1-1"><span class="Heading11Marker">14.8 </span><a id="_idTextAnchor191"/>Generating a Private Key with <a id="_idIndexMarker334"/><a id="_idIndexMarker335"/>PuTTYgen</p>&#13;
			<p class="My-Basic-Paragraph">The previous section explored the use of existing private and public keys when working with PuTTY. If keys do not already exist, they can be created using the <span class="My-Italic _idGenCharOverride-1">PuTTYgen</span> tool which is included with the main PuTTY installation. </p>&#13;
			<p class="My-Basic-Paragraph">To create new keys, launch <span class="My-Italic _idGenCharOverride-1">PuttyGen</span> and click on the<span class="My-Italic _idGenCharOverride-1"> Generate</span> button highlighted in <a href="../Text/SSH_Authentication.xhtml#_idTextAnchor192">Figure 14-4</a>:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1"><img class="_idGenObjectAttribute-4" src="Images/windows_puttygen_main1.png" alt="" width="718" height="721"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 14-4</span><a id="_idTextAnchor192"/></p>&#13;
			<p class="My-Basic-Paragraph">Move the mouse pointer around to generate random data as instructed, then enter an optional passphrase with which to encrypt the private key. Once the keys have been generated, save the files to suitable locations using the <span class="My-Italic _idGenCharOverride-1">Save public key</span> and <span class="My-Italic _idGenCharOverride-1">Save private key</span> buttons. The private key can be used with PuTTY as outlined in the previous section. To install the public key on the remote server use the steps covered in the earlier section on using SSH within PowerShell on Windows 10.</p>&#13;
			<p id="_idParaDest-141" class="Heading-1-1"><span class="Heading11Marker">14.9 </span><a id="_idTextAnchor193"/>Installing the Public Key for a <a id="_idIndexMarker336"/><a id="_idIndexMarker337"/>Google Cloud Instance</p>&#13;
			<p class="My-Basic-Paragraph">If your CentOS 8 system is hosted by Google Cloud, for example as a Compute Engine instance, there are a number of different ways to gain SSH access to the server using key-based authentication. Perhaps the most straightforward is to add your public key to the metadata for your Google Cloud account. This will make the public key available for all Virtual Machine instances that you create within Google Cloud. To add the public key, log into the Google Cloud Platform console, select the <span class="My-Italic _idGenCharOverride-1">Metadata </span>option from the left-hand navigation panel as highlighted in <a href="../Text/SSH_Authentication.xhtml#_idTextAnchor194">Figure 14-5</a> and select the <span class="My-Italic _idGenCharOverride-1">SSH keys</span> tab:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1"><img class="_idGenObjectAttribute-5" src="Images/google_cloud_ssh_key_list.png" alt="" width="974" height="532"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 14-5</span><a id="_idTextAnchor194"/></p>&#13;
			<p class="My-Basic-Paragraph">On the SSH Keys screen, click on the <span class="My-Italic _idGenCharOverride-1">Edit</span> button (also highlighted in <a href="../Text/SSH_Authentication.xhtml#_idTextAnchor194">Figure 14-5</a>) to edit the list of keys. Scroll down to the bottom of the current list and click on the <span class="My-Italic _idGenCharOverride-1">+ Add Item</span> button. A new field will appear into which you will need to paste the entire public key as it appears in your <span class="My-Italic _idGenCharOverride-1">id_rsa.pub</span> file. Once the key has been entered, click on the <span class="My-Italic _idGenCharOverride-1">Save</span> button to add the key.</p>&#13;
			<p class="My-Basic-Paragraph">The public key will now appear in the list of SSH Keys. Note that the key entry also includes the username which must be used when logging into any Google Cloud instances:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1"><img class="_idGenObjectAttribute-6" src="Images/google_cloud_ssh_key_added.png" alt="" width="750" height="174"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 14-6</span></p>&#13;
			<p class="My-Basic-Paragraph">With the public key added to the metadata it should be possible to access any virtual machine instance from any client on which the corresponding private key has been installed and on which the user has an account. In fact, behind the scenes, all Google Cloud has done to enable this is add the public key to the <span class="My-Italic _idGenCharOverride-1">.ssh/authorized_keys</span> file in the user’s home directory on any virtual machines on which the account exists.</p>&#13;
			<p id="_idParaDest-142" class="Heading-1-1"><span class="Heading11Marker">14.10 </span><a id="_idTextAnchor195"/>Summary</p>&#13;
			<p class="My-Basic-Paragraph">It is important that any remote access to a CentOS 8 system be implemented in a way that provides a high level of security. By default, a CentOS 8 system allows SSH based access using password-based authentication. This leaves the system vulnerable to anyone who can either guess a password, or find out the password through other means. For this reason, the use of key-based authentication is recommended to protect system access. Key-based authentication uses the concept of public key encryption involving public and private keys. When implemented, users are only able to connect to a server if they are using a client which has a private key that matches a public key on the server. As an added layer of security, the private key may also be encrypted and password protected. Once key-based encryption has been implemented, the server system is then configured to disable support for the less secure password-based authentication.</p>&#13;
			<p class="My-Basic-Paragraph">This chapter has provided an overview of SSH key-based authentication and outlined the steps involved in generating keys and configuring clients on macOS, Linux and Windows, in addition to the installation and management of public keys on a CentOS 8 server.</p>&#13;
		</div>&#13;
</div>



  </body></html>