["```\n# mkdir -p /srv/web/localhost/htdocs/\n# tar -C /srv/web/localhost/htdocs/ -xvf dokuwiki.tgz\n# chown -R nginx:nginx /srv/web/localhost/htdocs/dokuwiki\n```", "```\n# ls -dZ /srv/web/localhost/htdocs/dokuwiki\nundefined_u:object_r:var_t:s0 /srv/web/localhost/htdocs/dokuwiki\n```", "```\n<namespace>.<attribute>=<value>\n```", "```\n$ getfattr -m . -d dokuwiki\n# file: dokuwiki\nsecurity.selinux=\"unconfined_u:object_r:var_t:s0\"\n```", "```\n$ stat dokuwiki\n  File: dokuwiki\n  Size: 211\t\tBlocks: 0\t\tIO Block: 4096\t\ndirectory\nDevice: fd01h/64769d\tInode: 8512888\tLinks: 8\nAccess: (0755/drwxr-xr-x)\tUid: (\t0/\troot) Gid: (\t0/\troot)\nContext: unconfined_u:object_r:var_t:s0\n...\n```", "```\n$ sesearch -T -s httpd_t -t var_log_t\ntype_transition httpd_t var_log_t:file httpd_log_t;\n```", "```\n$ sesearch -T -s httpd_t -t tmp_t\ntype_transition httpd_t tmp_t:dir httpd_tmp_t;\ntype_transition httpd_t tmp_t:file httpd_tmp_t;\ntype_transition httpd_t tmp_t:file krb5_host_rcache_t HTTP_23;\ntype_transition httpd_t tmp_t:file krb5_host_rcache_t HTTP_48;\ntype_transition httpd_t tmp_t:lnk_file httpd_tmp_t;\ntype_transition httpd_t tmp_t:sock_file httpd_tmp_t;\n```", "```\n# touch test1 test2\n# mv test1 /srv\n# mv -Z test2 /srv\n# ls -Z /srv/test*\nstaff_u:object_r:admin_home_t:s0 /srv/test1\nstaff_u:object_r:var_t:s0 /srv/test2\n```", "```\n# cp test1 /srv\n# cp --preserve=context test2 /srv\n# ls -Z /srv/test*\nstaff_u:object_r:var_t:s0 /srv/test1\nstaff_u:object_r:admin_home_t:s0 /srv/test2\n```", "```\n# mkdir --context=user_u:object_r:user_home_t:s0 /srv/foo\n# ls -dZ /srv/foo\nuser_u:object_r:user_home_t:s0 /srv/foo\n```", "```\n# chcon -R -t httpd_sys_content_t /srv/web\n```", "```\n$ chcon -R --reference /var/www /srv/www\n```", "```\n# chcon -u system_u -R /srv/web\n```", "```\n# chcon -l s0:c0,c2 doku.php\n```", "```\n# chcat -- +Contracts doku.php\n```", "```\n# chcat -- -Contracts doku.php\n```", "```\n# chcat -d doku.php\n```", "```\n$ chcon -R -l s1:c2,c4.c10 /home/lisa\n```", "```\n# tar cjvf dokuwiki-20200405.tar.bz2 /srv/web --selinux\n```", "```\n# mount -o context=\"user_u:object_r:user_home_t:s0\" /dev/sdc1 /media/usb\n```", "```\n# mount -o defcontext=\"system_u:object_r:var_t:s0\" /dev/sdc1 /srv/backups\n```", "```\n# mount -o rootcontext=\"system_u:object_r:tmp_t:s0\" -t tmpfs none /var/tmp\n```", "```\n# semanage fcontext -l\nSELinux fcontext\ttype\t\tContext\n/\t\t\tdirectory\tsystem_u:object_r:root_t:s0\n...\n/vmlinuz.*\t\tsymbolic link\tsystem_u:object_r:boot_t:s0\n/xen(/.*)?\t\tall files\tsystem_u:object_r:xen_image_t:s0\n...\n```", "```\n# matchpathcon /srv/web/localhost/htdocs/dokuwiki\n/srv/web/localhost/htdocs/dokuwiki  system_u:object_r:var_t:s0\n```", "```\n# semanage fcontext -a -t httpd_sys_content_t \"/srv/web(/.*)?\"\n# semanage fcontext -a -t httpd_sys_rw_content_t \"/srv/web/localhost/htdocs/dokuwiki/data(/.*)?\"\n# semanage fcontext -a -t httpd_sys_rw_content_t \"/srv/web/localhost/htdocs/dokuwiki/conf(/.*)?\"\n# restorecon -Rv /srv/web\n```", "```\n# semanage fcontext -a -e /var/www /srv/web\n# restorecon -Rv /srv/web\n```", "```\n# cat /etc/selinux/targeted/contexts/files/file_contexts.subs_dist\n/run /var/run\n...\n/sysroot/tmp /tmp\n```", "```\n# restorecon -RD /home\n```", "```\n# restorecon -RvD /home\nSkipping restorecon as matching digest on: /home\n```", "```\n# semanage fcontext -a -t httpd_user_content_t \"/home/[^/]*/cgi-bin(/.*)?\"\n# restorecon -RvD /home\nRelabeled /home/lisa/cgi-bin from staff_u:object_r:user_home_t:s0 to staff_u:object_r:httpd_user_content_t:s0\nUpdated digest for: /home\n```", "```\n# restorecon_xattr -v /home\nspecfiles SHA1 digest: 7ed69be330ad60811481e455ca8e5ab0b1556036\ncalculated using the following specfile(s):\n/etc/selinux/targeted/contexts/files/file_contexts.subs_dist\n...\n/etc/selinux/targeted/contexts/files/file_contexts.local.bin\n/home Digest: 7ed69be330ad60811481e455ca8e5ab0b1556036 Match\n```", "```\n$ cat /etc/selinux/targeted/contexts/customizable_types\ncontainer_file_t\nsandbox_file_t\n...\nhttpd_user_content_t\ngit_session_content_t\nhome_bin_t\nuser_tty_device_t\n```", "```\n$ chcon -t home_bin_t ~/convert.sh\n```", "```\n# semanage fcontext -a -t home_bin_t \"/home/[^/]*/bin(/.*)?\"\n```", "```\n# cd /etc/selinux/targeted/contexts/files\n# sefcontext_compile file_contexts.local\n```", "```\n# semanage export -f local-mods.conf\n```", "```\n# semanage import -f ./local-mods.conf\n```", "```\n# setfiles /etc/selinux/targeted/contexts/files/file_contexts /srv/web\n```", "```\n# rlpkg nginx\n# fixfiles -R nginx restore\n```", "```\n# rlpkg -a -r\n# fixfiles -f -F relabel\n```", "```\n# touch /.autorelabel\n# reboot\n```", "```\n/etc/services\n/etc/resolv.conf\n/etc/samba/secrets.tdb\n...\n/root/.ssh/*\n```", "```\n# semanage fcontext -a -t tmp_t -f d \"/tmp/tmp-inst\"\n```", "```\nd /tmp/tmp-inst 000 root root\n```", "```\nz /sys/devices/system/cpu/online - - -\n```", "```\n# ps -eZ | grep nginx\nsystem_u:system_r:httpd_t:s0  3744 ?   00:00:00 nginx\n```", "```\n# pidof nginx\n3746 3745 3744\n# cat /proc/3744/attr/current\nsystem_u:system_r:httpd_t:s0\n```", "```\n# secon --pid 3744\nuser: system_u\nrole: system_r\ntype: httpd_t\nsensitivity: s0\nclearance: s0\nmls-range: s0\n```", "```\n# getpidcon 679\nsystem_u:system_r:nginx_t:s0\n```", "```\n$ sesearch -T -t httpd_exec_t\ntype_transition certwatch_t httpd_exec_t:process httpd_t;\ntype_transition cluster_t httpd_exec_t:process httpd_t;\ntype_transition initrc_t httpd_exec_t:process httpd_t;\n...\ntype_transition system_cronjob_t httpd_exec_t:process httpd_t;\n```", "```\n    $ sesearch -s initrc_t -t httpd_t -c process -p transition -A\n    ```", "```\n    $ sesearch -s initrc_t -t httpd_exec_t -c file -p execute -A\n    ```", "```\n    $ sesearch -s httpd_t -t httpd_exec_t -c file -p entrypoint -A\n    ```", "```\n    $ seinfo -r system_r -x | grep httpd_t\n    ```", "```\n# selinuxexeccon /usr/bin/passwd\nunconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023\n```", "```\n# selinuxexeccon /usr/sbin/nginx system_u:system_r:init_t:s0\nsystem_u:system_r:httpd_t:s0\n```", "```\n# seinfo --initalsid -x\nInitial SIDs: 27\n  sid any_socket system_u:object_r:unlabeled_t:s0\n  sid devnull system_u:object_r:null_device_t:s0\n...\n  sid unlabeled system_u:object_r:unlabeled_t:s0\n```", "```\n# sestatus | grep Memory\nMemory protection checking:   actual (secure)\n```", "```\n# echo 1 > /sys/fs/selinux/checkreqprot\n# sestatus | grep Memory\nMemory protection checking:   requested (insecure)\n```", "```\n# sesearch -t mozilla_plugin_t -p noatsecure -A\n...\nallow unconfined_t mozilla_plugin_t:process { ... noatsecure ...};\n...\n```", "```\n$ sesearch -s unconfined_t -p nosuid_transition -A\nallow unconfined_t initrc_t:process2 { nnp_transition nosuid_transition };\n...\n```", "```\n# cat /sys/fs/selinux/policy_capabilities/nnp_nosuid_transition\n1\n```", "```\n# seinfo --typebounds\n```", "```\n#!/usr/bin/env python3\nimport sys, time\nimport subprocess\nimport cgi, cgitb\ncgitb.enable()\nprint('Content-Type: text/html;charset=utf-8\\n')\nPIPE = subprocess.PIPE\nSTDOUT = subprocess.STDOUT\npd = subprocess.Popen(['ping', '-c', '1', 'localhost'], \nstdout=PIPE, stderr=STDOUT)\nwhile True:\n  output = pd.stdout.read(1)\n  if output == '' and pd.poll() != None:\n    break\n  if output != '':\n    sys.stdout.write(output.decode('utf-8'))\n    sys.stdout.flush()\n```", "```\n$ python3 -m http.server --cgi 6020\n```", "```\n$ curl http://localhost:6020/cgi-bin/test.py\nPING localhost(localhost(::1)) 56 data bytes ...\n```", "```\n$ setpriv --no-new-privs python3 -m http.server --cgi 6020\n```", "```\n$ curl http://localhost:6020/cgi-bin/test.py\nping: socket: Permission denied\n```", "```\n$ sesearch -s initrc_t -t httpd_t -c process -p transition -A\nallow initrc_domain daemon:process transition;\n```", "```\n$ seinfo -a initrc_domain -x\nType Attributes: 1\n  attribute initrc_domain;\n    cluster_t;\n    ...\n    initrc_t;\n    ...\n    piranha_pulse_t;\n```", "```\nallow <source> <destination> : <class> <permissions>;\n```", "```\n$ seinfo -c sem -x\nClasses: 1\n  class sem\ninherits ipc\n```", "```\n$ seinfo --common=ipc -x\nCommons: 1\n{\n  write\n  destroy\n  ...\n  create\n}\n```", "```\nallow user_t etc_t : file { ioctl read getattr lock execute execute_no_trans open };\n```", "```\nconstrain process\n  { transition dyntransition noatsecure siginh rlimitinh }\n  (\n    u1 == u2 or\n    (\n      t1 == can_change_process_identity and\n      t2 == process_user_target\n    ) or (\n      t1 == cron_source_domain and\n      (\n        t2 == cron_job_domain or\n        u2 == system_u\n      )\n    ) or (\n      t1 == can_system_change and\n      u2 == system_u\n    ) or (\n      t1 == process_uncond_exempt\n    )\n  );\n```", "```\nu1 == u2\nor u1 == system_u\nor u2 == system_u\nor t1 != ubac_constrained_type\nor t2 != ubac_constrained_type\n```"]