- en: 13\. Ubuntu 23.04 Network Management
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: 13. Ubuntu 23.04 网络管理
- en: It is difficult to envisage an Ubuntu system that does not have at least one
    network connection, and harder still to imagine how such an isolated system could
    be of much practical use. The simple fact is that Ubuntu is designed to provide
    enterprise-level services over network and internet connections. Therefore, a
    crucial part of learning how to administer an Ubuntu system involves learning
    how to configure and manage the network interfaces installed on the system.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 很难想象一个没有至少一个网络连接的 Ubuntu 系统，更难以想象一个如此孤立的系统如何具有多大实际用途。简单的事实是，Ubuntu 被设计为通过网络和互联网连接提供企业级服务。因此，学习如何管理
    Ubuntu 系统的一个关键部分就是学习如何配置和管理系统上安装的网络接口。
- en: This chapter provides an overview of network management on Ubuntu, including
    the NetworkManager service and tools and some other useful utilities.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章概述了 Ubuntu 上的网络管理，包括 NetworkManager 服务和工具以及一些其他有用的实用工具。
- en: 13.1 An Introduction to NetworkManager
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 13.1 NetworkManager 简介
- en: NetworkManager is a service and set of tools designed specifically to make it
    easier to manage the networking configuration on Linux systems and is the default
    network management service on Ubuntu.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: NetworkManager 是一个服务和工具集，专门设计用于简化 Linux 系统的网络配置管理，它是 Ubuntu 默认的网络管理服务。
- en: 'In addition to a service that runs in the background, NetworkManager also includes
    the following tools:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 除了在后台运行的服务外，NetworkManager 还包括以下工具：
- en: •nmcli - A tool for working with NetworkManager via the command line. This tool
    is useful when access to a graphical environment is unavailable and can also be
    used within scripts to make network configuration changes.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: •nmcli - 一个通过命令行与 NetworkManager 配合使用的工具。这个工具在无法访问图形环境时非常有用，也可以在脚本中使用，以进行网络配置更改。
- en: •nmtui - A basic text-based user interface for managing NetworkManager. This
    tool can be run within any terminal window and allows changes to be made by making
    menu selections and entering data. While helpful in performing basic tasks, nmtui
    lacks many of the features provided by the nmcli tool.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: •nmtui - 一个基本的基于文本的用户界面，用于管理 NetworkManager。此工具可以在任何终端窗口中运行，通过选择菜单和输入数据来进行更改。虽然它在执行基本任务时很有帮助，但
    nmtui 缺乏 nmcli 工具提供的许多功能。
- en: •nm-connection-editor - A complete graphical management tool providing access
    to most NetworkManager configuration options.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: •nm-connection-editor - 一个完整的图形管理工具，提供对大多数 NetworkManager 配置选项的访问。
- en: •GNOME Settings - The Network screen of the GNOME desktop Settings application
    allows basic network management tasks to be performed.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: •GNOME 设置 - GNOME 桌面设置应用的网络屏幕允许执行基本的网络管理任务。
- en: •Cockpit Network Settings - The Network screen of the Cockpit web interface
    allows a range of network management tasks to be performed.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: •Cockpit 网络设置 - Cockpit Web 界面的网络屏幕允许执行一系列网络管理任务。
- en: Although there are several ways to manage the network environment on an Ubuntu
    system, this chapter will focus on the nmcli command. While the graphical tools
    are certainly helpful when you have access to a desktop environment or Cockpit
    has been enabled, understanding the command-line interface is essential for situations
    where a command prompt is all that is available. Also, the graphical tools (Cockpit
    included) only include some of the capabilities of the nmcli tool. Finally, once
    you are familiar with NetworkManager and nmcli, those skills will translate easily
    when using the more intuitive tool options. The same cannot be said of the graphical
    tool options. It is harder to use nmcli if, for example, you have only ever used
    nm-connection-editor.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管在 Ubuntu 系统上有几种管理网络环境的方法，本章将重点介绍 nmcli 命令。虽然当你能够访问桌面环境或启用了 Cockpit 时，图形工具无疑很有帮助，但了解命令行界面对于只有命令提示符可用的情况至关重要。此外，图形工具（包括
    Cockpit）仅包括 nmcli 工具的一部分功能。最后，一旦熟悉了 NetworkManager 和 nmcli，这些技能在使用更直观的工具选项时将很容易转化。图形工具选项则不然。如果你只使用过
    nm-connection-editor，举例来说，使用 nmcli 可能会更加困难。
- en: 13.2 Installing and Enabling NetworkManager
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 13.2 安装和启用 NetworkManager
- en: 'NetworkManager should be installed by default for most Ubuntu installations.
    Use the apt command to find out if it needs to be installed:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 对于大多数 Ubuntu 安装，NetworkManager 应该默认已安装。使用 apt 命令检查是否需要安装：
- en: apt -qq list network-manager
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: apt -qq list network-manager
- en: network-manager/lunar,now 1.42.4-1ubuntu2 amd64 [installed,automatic]
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: network-manager/lunar,now 1.42.4-1ubuntu2 amd64 [已安装，自动]
- en: 'If necessary, install the package as follows:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要，按如下方式安装该软件包：
- en: apt install network-manager
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Once the package is installed, the NetworkManager daemon will need to be enabled
    so that it starts each time the system boots:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: systemctl enable NetworkManager
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Finally, start the service running and check the status to verify that the
    launch was successful:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: systemctl start NetworkManager
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: systemctl status NetworkManager
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ● NetworkManager.service - Network Manager
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: 'Loaded: loaded (/lib/systemd/system/NetworkManager.service; enabled; vendor
    preset: enabled)'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: 'Active: active (running) since Sun 2023-07-16 12:46:48 EDT; 24h ago'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: 'Docs: man:NetworkManager(8)'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: 'Main PID: 725 (NetworkManager)'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: 'Tasks: 3 (limit: 4352)'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: 'Memory: 11.9M'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: 'CPU: 5.018s'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: 'CGroup: /system.slice/NetworkManager.service'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: └─725 /usr/sbin/NetworkManager --no-daemon
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: 13.3 Basic nmcli Commands
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
- en: 'The nmcli tool will have been installed as part of the NetworkManager package
    and can be executed from the command line using the following syntax:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: nmcli [Options] Object {Command | help}
  id: totrans-35
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the above syntax, Object will be one of general, networking, radio, connection,
    monitor, device, or agent, which can be abbreviated to a few letters of the word
    (for example, con, or even just the letter c, for connection). For example, all
    of the following commands will output help information relating to the device
    object:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: nmcli device help
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: nmcli dev help
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: nmcli d help
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To check the overall status of NetworkManager on the system, use the following
    command:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: nmcli general status
  id: totrans-41
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: STATE CONNECTIVITY WIFI-HW WIFI WWAN-HW WWAN
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: connected full enabled enabled enabled enabled
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
- en: 'To check the status of the devices installed on a system, the following command
    can be used:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: nmcli dev status
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: DEVICE TYPE STATE CONNECTION
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: eno1 ethernet connected eno1
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: wlp0s26u1u2 wifi connected zoneone
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
- en: virbr0 bridge connected virbr0
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: lo loopback unmanaged --
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: virbr0-nic tun unmanaged --
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: 'The output may also be modified by using the -p (pretty) option to make the
    output more human-friendly:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
- en: nmcli -p dev status
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: =====================
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: Status of devices
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: =====================
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: DEVICE TYPE STATE CONNECTION
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: '-------------------------------------------------------------------'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
- en: eno1 ethernet connected eno1
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: wlp0s26u1u2 wifi connected zoneone
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
- en: virbr0 bridge connected virbr0
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: lo loopback unmanaged --
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
- en: virbr0-nic tun unmanaged --
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: 'Conversely, the -t option may be used to make the output more terse and suitable
    for automated processing:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: nmcli -t dev status
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: eno1:ethernet:connected:eno1
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: wlp0s26u1u2:wifi:connected:emilyzone
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: virbr0:bridge:connected:virbr0
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: 'lo:loopback:unmanaged:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: 'virbr0-nic:tun:unmanaged:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: The status output shows that the system has two physical devices installed,
    one Ethernet and the other a WiFi device.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
- en: The bridge (virbr) entries are virtual devices used to provide networking for
    virtual machines (the topic of virtualization will be covered starting with the
    chapter entitled [“An Overview of Virtualization Techniques”](Virtualization_Overview.xhtml#_idTextAnchor361)).
    Finally, the loopback interface is a special virtual device that allows the system
    to communicate with itself and is typically used to perform network diagnostics.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 桥接（virbr）条目是用于为虚拟机提供网络的虚拟设备（虚拟化的相关内容将在[《虚拟化技术概述》](Virtualization_Overview.xhtml#_idTextAnchor361)章节中讲解）。最后，回环接口是一个特殊的虚拟设备，允许系统与自身进行通信，通常用于进行网络诊断。
- en: When working with NetworkManager, it is important to understand the difference
    between a device and a connection. As described above, a device is either a physical
    or virtual network device, while a connection is a network configuration that
    the device connects to.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用 NetworkManager 时，了解设备与连接之间的区别非常重要。如上所述，设备可以是物理的或虚拟的网络设备，而连接是设备所连接的网络配置。
- en: 'The following command displays information about the connections configured
    on the system:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令显示有关系统中配置的连接的信息：
- en: nmcli con show
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: nmcli con show
- en: NAME UUID TYPE DEVICE
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: NAME UUID TYPE DEVICE
- en: zoneone 2abecafa-4ea2-47f6-b20f-4fb0c0fd5e94 wifi wlp0s26u1u2
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: zoneone 2abecafa-4ea2-47f6-b20f-4fb0c0fd5e94 wifi wlp0s26u1u2
- en: eno1 99d40009-6bb1-4182-baad-a103941c90ff ethernet eno1
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: eno1 99d40009-6bb1-4182-baad-a103941c90ff ethernet eno1
- en: virbr0 e13e9552-1765-42d1-b739-ff981668fbee bridge virbr0
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: virbr0 e13e9552-1765-42d1-b739-ff981668fbee bridge virbr0
- en: zonetwo f940a2d1-8c18-4a9e-bf29-817702429b8a wifi --
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: zonetwo f940a2d1-8c18-4a9e-bf29-817702429b8a wifi --
- en: zonethree fd65c5e5-3e92-4e9e-b924-1b0b07b70032 wifi --
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: zonethree fd65c5e5-3e92-4e9e-b924-1b0b07b70032 wifi --
- en: The above output shows that the WiFi device (wlp0s26u1u2) is connected to a
    wireless network named zoneone while the Ethernet device (eno1) is connected to
    a connection named eno1\. In addition to zoneone, NetworkManager has also listed
    two other WiFi connections named zonetwo and zonethree, neither of which currently
    has a device connected.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 上述输出显示 WiFi 设备（wlp0s26u1u2）已连接到名为 zoneone 的无线网络，而以太网设备（eno1）则连接到名为 eno1 的网络连接。除了
    zoneone，NetworkManager 还列出了另外两个 WiFi 连接，分别是 zonetwo 和 zonethree，但目前没有设备连接到这两个网络。
- en: 'To find out the IP address allocated to a connection, the ip tool can be used
    with the address option:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 若要查找分配给连接的 IP 地址，可以使用 ip 工具与地址选项：
- en: ip address
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ip address
- en: 'The above command can also be abbreviated:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 上述命令也可以简写：
- en: ip a
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ip a
- en: .
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: .
- en: .
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: .
- en: '3: wlp0s26u1u2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP
    group default qlen 1000'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '3: wlp0s26u1u2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP
    group default qlen 1000'
- en: link/ether 74:da:38:ee:be:50 brd ff:ff:ff:ff:ff:ff
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: link/ether 74:da:38:ee:be:50 brd ff:ff:ff:ff:ff:ff
- en: inet 192.168.1.121/24 brd 192.168.1.255 scope global dynamic noprefixroute wlp0s26u1u2
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: inet 192.168.1.121/24 brd 192.168.1.255 scope global dynamic noprefixroute wlp0s26u1u2
- en: valid_lft 57584sec preferred_lft 57584sec
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: valid_lft 57584sec preferred_lft 57584sec
- en: .
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: .
- en: .
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: .
- en: The ip command will output information for all the devices detected on the system.
    For example, the above output shows that the WiFi device has been assigned an
    IP address of 192.168.1.121.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: ip 命令将输出系统中所有设备的信息。例如，上述输出显示 WiFi 设备已分配 IP 地址 192.168.1.121。
- en: 'If we only wanted to list active connections, the nmcli command could have
    been used with the -a option:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们只想列出活动连接，可以使用带有 -a 选项的 nmcli 命令：
- en: nmcli con show -a
  id: totrans-97
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: nmcli con show -a
- en: NAME UUID TYPE DEVICE
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: NAME UUID TYPE DEVICE
- en: zoneone 2abecafa-4ea2-47f6-b20f-4fb0c0fd5e94 wifi wlp0s26u1u2
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: zoneone 2abecafa-4ea2-47f6-b20f-4fb0c0fd5e94 wifi wlp0s26u1u2
- en: eno1 99d40009-6bb1-4182-baad-a103941c90ff ethernet eno1
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: eno1 99d40009-6bb1-4182-baad-a103941c90ff ethernet eno1
- en: virbr0 e13e9552-1765-42d1-b739-ff981668fbee bridge virbr0
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: virbr0 e13e9552-1765-42d1-b739-ff981668fbee bridge virbr0
- en: 'To switch the WiFi device connection from zoneone to zonetwo, we can run the
    following command:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 要将 WiFi 设备连接从 zoneone 切换到 zonetwo，可以运行以下命令：
- en: nmcli device wifi connect zonetwo -ask
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: nmcli device wifi connect zonetwo -ask
- en: 'Password:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 密码：
- en: 'The -ask flag causes nmcli to prompt the user to enter the password for the
    WiFi network. To include the WiFi password on the command line (particularly useful
    if the command is being executed in a script), use the password option:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: -ask 标志使得 nmcli 提示用户输入 WiFi 网络的密码。如果需要在命令行中包含 WiFi 密码（尤其在脚本中执行命令时非常有用），可以使用
    password 选项：
- en: nmcli device wifi connect zonetwo password <password here>
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: nmcli device wifi connect zonetwo password <password here>
- en: 'The nmcli tool may also be used to scan for available WiFi networks as follows:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: nmcli 工具也可以用来扫描可用的 WiFi 网络，方法如下：
- en: nmcli device wifi list
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: nmcli device wifi list
- en: IN-USE SSID MODE CHAN RATE SIGNAL BARS SECURITY
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: zoneone Infra 6 195 Mbit/s 80 WPA2
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: '* zonetwo Infra 11 130 Mbit/s 74 WPA1 WPA2'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: 'A currently active connection can be deactivated as follows:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con down <connection name>
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Similarly, an inactive connection can be brought back up at any time:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con up <connection name>
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'When a connection is brought down, NetworkManager automatically searches for
    another connection, activates it, and assigns it to the device to which the previous
    connection was established. To prevent a connection from being used in this situation,
    disable the autoconnect option as follows:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con mod <connection name> connection.autoconnect no
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following command may be used to obtain additional information about a
    specific connection. This includes the current values for all the connection properties:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con show eno1
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'connection.id: eno1'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.uuid: 99d40009-6bb1-4182-baad-a103941c90ff'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.stable-id: --'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.type: 802-3-ethernet'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.interface-name: eno1'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.autoconnect: yes'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.autoconnect-priority: 0'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.autoconnect-retries: -1 (default)'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.multi-connect: 0 (default)'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.auth-retries: -1'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.timestamp: 1554833695'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.read-only: no'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.permissions: --'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.zone: --'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.master: --'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.slave-type: --'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: 'connection.autoconnect-slaves: -1 (default)'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
- en: .
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
- en: .
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: 'All of these properties can be modified using nmcli with the modify option
    using the following syntax:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con mod <connection name> connection.<property name> <setting>
  id: totrans-140
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 13.4 Working with Connection Profiles
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: 'So far, we have explored using connections without explaining how a connection
    is configured. The configuration of a connection is referred to as a connection
    profile and is stored in a file located in the /etc/NetworkManager/system-connections
    directory, the contents of which might read as follows:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: ls /etc/NetworkManager/system-connections
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: zoneone.nmconnection eno1.nmconnection
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: zonethree.nmconnection zonetwo.nmconnection
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider, for example, the contents of the eno1.nmconnection file:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: id=eno1
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
- en: uuid=efc69a99-17a3-3636-b68f-bfcc56a73844
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: type=ethernet
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
- en: autoconnect-priority=-999
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: interface-name=eno1
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
- en: timestamp=1679678184
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: '[ethernet]'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
- en: '[ipv4]'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: method=auto
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
- en: '[ipv6]'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: addr-gen-mode=eui64
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
- en: method=auto
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: '[proxy]'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
- en: 'The file contains basic information about the connection, including the type
    (Ethernet) of the device to which it is currently assigned (eno1) and the fact
    that the connection is to be automatically activated on system boot with an IP
    address obtained using DHCP (auto). Changes to the connection profile can be implemented
    by modifying this file and instructing nmcli to reload the connection configuration
    files:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con reload
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'New connection profiles can also be created manually or generated automatically
    by nmcli. For example, assume a new network device has been installed on the system.
    When this happens, the NetworkManager service will detect the new hardware and
    create a device for it. In the example below, the new device has been assigned
    the name eno2:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: nmcli dev status
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: DEVICE TYPE STATE CONNECTION
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: en01 ethernet connected eno1
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
- en: eno2 ethernet connected Wired connection 1
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: 'NetworkManager automatically detected the device, activated it, and assigned
    it to a connection named “Wired connection 1”. This is a default connection over
    which we have no configuration control because there is no interface configuration
    file for it in /etc/NetworkManager/system-connections. Therefore, the next steps
    are to delete the “Wired connection 1” connection and use nmcli to create a new
    connection and assign it to the device. The command to delete a connection is
    as follows:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con delete "Wired connection 1"
  id: totrans-168
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Next, nmcli can be used to create a new connection profile configured either
    with a static IP address or a dynamic IP address obtained from a DHCP server.
    To create a dynamic connection profile named dyn_ip, the following command would
    be used:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
- en: nmcli connection add type ethernet con-name dyn_ip ifname eno2
  id: totrans-170
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Connection 'dyn_ip' (160d9e10-bbc8-439a-9c47-a2ec52990472) successfully added.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
- en: 'To create a new connection profile without locking it to a specific device,
    simply omit the ifname option in the command:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
- en: nmcli connection add type ethernet con-name dyn_ip
  id: totrans-173
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: After creating the connection, a file named dyn_ip.nmconnection will be added
    to the /etc/NetworkManager/system-connections directory.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: 'Alternatively, to create a connection named static_ip assigned a static IP
    address (in this case 192.168.1.200) the following command would be used:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con add type ethernet con-name static_ip ifname eno0 ip4 192.168.1.200/24
    gw4 192.168.1.1
  id: totrans-176
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Connection 'static_ip' (3fccafb3-e761-4271-b310-ad0f28ee8606) successfully added.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
- en: 'The corresponding static_ip.nmconnection file will read as follows:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
- en: '[connection]'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: id=static_ip
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: uuid=41eca181-381c-4d12-b6c9-30446d4e29d1
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: type=ethernet
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
- en: interface-name=eno0
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
- en: '[ethernet]'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: '[ipv4]'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
- en: address1=192.168.1.200/24,192.168.1.1
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
- en: method=manual
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
- en: '[ipv6]'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
- en: addr-gen-mode=default
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
- en: method=auto
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
- en: '[proxy]'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: 'The command to add a new connection may be altered slightly to assign both
    IPv4 and IPv6 static addresses:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con add type ethernet con-name static_ip ifname eno0 ip4 192.168.1.200/24
    gw4 192.168.1.1 gw4 192.168.1.1 ip6 cabf::4532 gw6 2010:dfa::1
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 13.5 Interactive Editing
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
- en: 'In addition to using nmcli with command-line options, the tool also includes
    an interactive mode that can be used to create and modify connection profiles.
    The following transcript, for example, shows interactive mode being used to create
    a new Ethernet connection named demo_con:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con edit
  id: totrans-196
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Valid connection types: 6lowpan, 802-11-olpc-mesh (olpc-mesh), 802-11-wireless
    (wifi), 802-3-ethernet (ethernet), adsl, bluetooth, bond, bridge, cdma, dummy,
    generic, gsm, infiniband, ip-tunnel, macsec, macvlan, ovs-bridge, ovs-interface,
    ovs-port, pppoe, team, tun, vlan, vpn, vxlan, wimax, wpan, bond-slave, bridge-slave,
    team-slave'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: 'Enter connection type: ethernet'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: ===| nmcli interactive connection editor |===
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
- en: Adding a new '802-3-ethernet' connection
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
- en: Type 'help' or '?' for available commands.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
- en: Type 'print' to show all the connection properties.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
- en: Type 'describe [<setting>.<prop>]' for detailed property description.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
- en: 'You may edit the following settings: connection, 802-3-ethernet (ethernet),
    802-1x, dcb, sriov, ethtool, match, ipv4, ipv6, tc, proxy'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> set connection.id demo_con
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> set connection.interface eno1
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> set connection.autoconnect yes
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> set ipv4.method auto
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> set 802-3-ethernet.mtu auto
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> set ipv6.method auto
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> save
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
- en: Saving the connection with 'autoconnect=yes'. That might result in an immediate
    activation of the connection.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
- en: Do you still want to save? (yes/no) [yes] yes
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
- en: Connection 'demo_con' (cb837408-6c6f-4572-9548-4932f88b9275) successfully saved.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> quit
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
- en: 'The following transcript, on the other hand, modifies the previously created
    static_ip connection profile to use a different static IP address than the one
    originally specified:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con edit static_ip
  id: totrans-217
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ===| nmcli interactive connection editor |===
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
- en: 'Editing existing ''802-3-ethernet'' connection: ''static_ip'''
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
- en: Type 'help' or '?' for available commands.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
- en: Type 'print' to show all the connection properties.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
- en: Type 'describe [<setting>.<prop>]' for detailed property description.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: 'You may edit the following settings: connection, 802-3-ethernet (ethernet),
    802-1x, dcb, sriov, ethtool, match, ipv4, ipv6, tc, proxy'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> print ipv4.addresses
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
- en: 'ipv4.addresses: 192.168.1.200/24'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> set ipv4.addresses 192.168.1.201/24
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> save
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
- en: Connection 'static_ip' (3fccafb3-e761-4271-b310-ad0f28ee8606) successfully updated.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> quit
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
- en: 'After modifying an existing connection, remember to instruct NetworkManager
    to reload the configuration profiles:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
- en: nmcli con reload
  id: totrans-231
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'When using interactive mode, it is useful to know that an extensive built-in
    help system is available to learn how to use the tool. The help topics can be
    accessed by typing help or ? at the nmcli > prompt:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
- en: nmcli> ?
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
- en: '------------------------------------------------------------------------------'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
- en: '---[ Main menu ]---'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
- en: 'goto [<setting> | <prop>] :: go to a setting or property'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
- en: 'remove <setting>[.<prop>] | <prop> :: remove setting or reset property value'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
- en: 'set [<setting>.<prop> <value>] :: set property value'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: 'describe [<setting>.<prop>] :: describe property'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
- en: 'print [all | <setting>[.<prop>]] :: print the connection'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
- en: 'verify [all | fix] :: verify the connection'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
- en: 'save [persistent|temporary] :: save the connection'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
- en: 'activate [<ifname>] [/<ap>|<nsp>] :: activate the connection'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
- en: 'back :: go one level up (back)'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
- en: 'help/? [<command>] :: print this help'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
- en: 'nmcli <conf-option> <value> :: nmcli configuration'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 'nmcli <conf-option> <value> :: nmcli 配置'
- en: 'quit :: exit nmcli'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 'quit :: 退出 nmcli'
- en: '------------------------------------------------------------------------------'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: '------------------------------------------------------------------------------'
- en: 13.6 Configuring NetworkManager Permissions
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 13.6 配置 NetworkManager 权限
- en: 'In addition to making it easier to manage networks on Ubuntu, NetworkManager
    also allows permissions to be specified for connections. The following command,
    for example, restricts a connection profile to root and user accounts named john
    and caitlyn:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 除了使在 Ubuntu 上管理网络更方便外，NetworkManager 还允许为连接指定权限。例如，以下命令将连接配置限制为 root 用户以及名为
    john 和 caitlyn 的用户账户：
- en: nmcli con mod static_ip connection.permissions user:root,john,caitlyn
  id: totrans-251
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: nmcli con mod static_ip connection.permissions user:root,john,caitlyn
- en: Once NetworkManager has reloaded the connection profiles, the static_ip connection
    will only be active and accessible to other users when at least one designated
    user is logged in to an active session on the system. As soon as the last of these
    users logs out, the connection will go down and remain inactive until one of the
    users signs back in.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦 NetworkManager 重新加载连接配置文件，static_ip 连接将仅在至少有一个指定用户登录到系统并处于活动会话时才会激活并对其他用户可访问。只要最后一个用户注销，连接将会断开，并保持非活动状态，直到其中一个用户重新登录。
- en: In addition, only users with permission can change the connection status or
    configuration.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，只有具有权限的用户才能更改连接状态或配置。
- en: 13.7 Summary
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 13.7 总结
- en: The NetworkManager service handles network management on Ubuntu. NetworkManager
    views a network as consisting of network interface devices and connections. A
    network device can be a physical Ethernet or WiFi device or a virtual device used
    by a virtual machine guest. Connections represent the network to which the devices
    connect and are configured by connection profiles. A configuration profile will,
    among other settings, define whether the connection has a static or dynamic IP
    address, the IP address of any gateway used by the network, and whether or not
    the connection should be established automatically each time the system starts
    up.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: NetworkManager 服务负责在 Ubuntu 上进行网络管理。NetworkManager 将网络视为由网络接口设备和连接组成。网络设备可以是物理以太网或
    WiFi 设备，或者是虚拟机客户机使用的虚拟设备。连接表示设备连接的网络，并通过连接配置文件进行配置。配置文件将定义包括连接是否具有静态或动态 IP 地址、网络使用的任何网关的
    IP 地址，以及连接是否应在每次系统启动时自动建立等设置。
- en: NetworkManager can be administered using several tools, including the nmcli
    and nmtui command-line tools, the nm-connection-editor graphical tool, and the
    network settings section of the Cockpit web interface. In general, the nmcli command-line
    tool provides the most features and flexibility.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用多种工具来管理 NetworkManager，包括 nmcli 和 nmtui 命令行工具、nm-connection-editor 图形工具以及
    Cockpit Web 界面的网络设置部分。通常情况下，nmcli 命令行工具提供了最多的功能和灵活性。
