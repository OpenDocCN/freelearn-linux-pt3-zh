- en: 9\. Managing Ubuntu 23.04 Users and Groups
  prefs: []
  type: TYPE_NORMAL
- en: During the installation of Ubuntu, the installer created a root or superuser
    account and required that a password be configured. The installer also provided
    the opportunity to create a user account for the system. We should remember that
    Ubuntu is an enterprise-class, multi-user, and multi-tasking operating system.
    To use the full power of Ubuntu, therefore, it is likely that more than one user
    will need to be given access to the system. Each user should have their own user
    account login, password, home directory, and privileges.
  prefs: []
  type: TYPE_NORMAL
- en: Users are further divided into groups for easier administration, and those groups
    can have different levels of privileges. For example, you may have a group of
    users who work in the Accounting department. In such an environment, you can create
    an accounts group and assign all the Accounting department users to that group.
  prefs: []
  type: TYPE_NORMAL
- en: This chapter will cover the steps to add, remove and manage users and groups
    on an Ubuntu system. Users and groups may be managed on Ubuntu using command-line
    tools, the Cockpit web interface, and the desktop Settings app. In this chapter,
    we will look at each of these approaches to user management.
  prefs: []
  type: TYPE_NORMAL
- en: 9.1 User Management from the Command-line
  prefs: []
  type: TYPE_NORMAL
- en: 'New users may be added to an Ubuntu system via the command line using the adduser
    utility. To create a new user account, enter a command similar to the following:'
  prefs: []
  type: TYPE_NORMAL
- en: adduser john
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'By default, this will create a home directory for the user in the /home directory
    (in this case, /home/john). To specify a different home directory, use the --home
    command-line option when creating the account:'
  prefs: []
  type: TYPE_NORMAL
- en: adduser --home /users/johnsmith john
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The adduser command will prompt for a password during the account creation.
    This password can be changed later using the passwd command:'
  prefs: []
  type: TYPE_NORMAL
- en: passwd john
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Changing password for user john.
  prefs: []
  type: TYPE_NORMAL
- en: 'New password:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Retype new password:'
  prefs: []
  type: TYPE_NORMAL
- en: 'passwd: all authentication tokens updated successfully.'
  prefs: []
  type: TYPE_NORMAL
- en: 'An existing user may be deleted via the command line using the deluser utility.
    While this will delete the account, the user’s files and data will remain intact
    on the system:'
  prefs: []
  type: TYPE_NORMAL
- en: deluser john
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'It is also possible to remove the user’s home directory and mail spool as part
    of the deletion process:'
  prefs: []
  type: TYPE_NORMAL
- en: deluser --remove-home john
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'All users on an Ubuntu system are members of one or more groups. By default,
    new users are added to a private group with the same name as the user (in the
    above example, the account created for user john was a member of a private group
    also named john). However, as an administrator, it makes sense to organize users
    into more logical groups. For example, all salespeople might belong to a sales
    group, and accounting staff might belong to the accounts group, and so on. New
    groups are added from the command line using the groupadd command-line tool, for
    example:'
  prefs: []
  type: TYPE_NORMAL
- en: groupadd accounts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Use the usermod tool to add an existing user to an existing group from the
    command line:'
  prefs: []
  type: TYPE_NORMAL
- en: usermod -G accounts john
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To add an existing user to multiple existing groups, run the usermod command
    with the -G option:'
  prefs: []
  type: TYPE_NORMAL
- en: usermod -G accounts,sales,support john
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Note that the above commands remove the user from supplementary groups not
    listed after the -G but to which the user is currently a member. To retain any
    current group memberships, use the -a flag to append the new group memberships:'
  prefs: []
  type: TYPE_NORMAL
- en: usermod -aG accounts,sales,support john
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'An existing group may be deleted from a system using the groupdel utility:'
  prefs: []
  type: TYPE_NORMAL
- en: groupdel accounts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Note that if the group to be deleted is the primary or initial group for any
    user, it cannot be deleted. The user must first be deleted or assigned a new primary
    group using the usermod command before the group can be removed. A user can be
    assigned to a new primary group using the usermod -g option:'
  prefs: []
  type: TYPE_NORMAL
- en: usermod -g sales john
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: groupdel accounts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Run the groups command to find out the groups to which a user belongs. For
    example:'
  prefs: []
  type: TYPE_NORMAL
- en: $ groups john
  prefs: []
  type: TYPE_NORMAL
- en: 'john : accounts support'
  prefs: []
  type: TYPE_NORMAL
- en: 'By default, a user account cannot perform tasks requiring superuser (root)
    privileges unless they know the root password. It is, however, possible to configure
    a user account so that privileged tasks can be performed using the sudo command.
    This involves adding the user account as a member of the sudo group, for example:'
  prefs: []
  type: TYPE_NORMAL
- en: adduser john sudo
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Once added to the sudo group, the user will be able to perform otherwise restricted
    tasks using sudo as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: apt update
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Hit:1 http://us.archive.ubuntu.com/ubuntu jammy InRelease
  prefs: []
  type: TYPE_NORMAL
- en: Hit:2 http://security.ubuntu.com/ubuntu jammy-security InRelease
  prefs: []
  type: TYPE_NORMAL
- en: 'The sudo capabilities of the sudo group may be modified by editing the /etc/sudoers
    file and locating the following section:'
  prefs: []
  type: TYPE_NORMAL
- en: Allows people in group sudo to run all commands
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '%sudo ALL=(ALL) ALL'
  prefs: []
  type: TYPE_NORMAL
- en: 'To disable sudo for all sudo group members, comment out the second line as
    follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Allows people in group sudo to run all commands
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '%sudo ALL=(ALL) ALL'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To allow sudo group members to use sudo without entering a password (for security
    reasons, this is not recommended), modify the sudoers file as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Same thing without a password
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '%sudo ALL=(ALL) NOPASSWD: ALL'
  prefs: []
  type: TYPE_NORMAL
- en: Behind the scenes, all these commands are simply changing the /etc/passwd, /etc/group,
    and /etc/shadow files on the system.
  prefs: []
  type: TYPE_NORMAL
- en: 9.2 User Management with Cockpit
  prefs: []
  type: TYPE_NORMAL
- en: 'If the Cockpit web interface is installed and enabled on the system (a topic
    covered in the chapter entitled “An Overview of the Cockpit Web Interface”), several
    user and group management tasks can be performed within the Accounts screen shown
    in [Figure 9-1](User_Management.xhtml#_idTextAnchor181) below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ubuntu_cockpit_users1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9-1
  prefs: []
  type: TYPE_NORMAL
- en: 'The screen will display any existing user accounts on the system and provides
    a button to add additional accounts. To create a new account, click the Create
    New Account button and enter the requested information in the resulting dialog
    ([Figure 9-2](User_Management.xhtml#_idTextAnchor182)). Note that the option is
    also available to create the account but to lock it until later:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/rhel_cockpit_new_account.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9-2
  prefs: []
  type: TYPE_NORMAL
- en: 'To modify a user account, select it from the main screen and make any modifications
    to the account details:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/rhel_cockpit_modify_account.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9-3
  prefs: []
  type: TYPE_NORMAL
- en: This screen allows various tasks, including locking or unlocking the account,
    changing the password, or forcing the user to configure a new password to be performed.
    In addition, if the Server Administrator option is selected, the user will be
    added to the sudo group and permitted to use sudo to perform administrative tasks.
    A button is also provided to delete the user from the system.
  prefs: []
  type: TYPE_NORMAL
- en: If the user is accessing the system remotely using an SSH connection with key
    encryption, the user’s public key may be added within this screen. SSH access
    and authentication will be covered later in [“Configuring SSH Key-based Authentication
    on Ubuntu 23.04”](SSH_Authentication.xhtml#_idTextAnchor281).
  prefs: []
  type: TYPE_NORMAL
- en: 9.3 User Management using the Settings App
  prefs: []
  type: TYPE_NORMAL
- en: 'A third user account management option is available via the GNOME desktop settings
    app. This app is accessed by clicking on icons in the top right-hand corner of
    the GNOME desktop and selecting the Settings option, as shown in Figure 9-4:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ubuntu_gnome_settings_menu1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9-4
  prefs: []
  type: TYPE_NORMAL
- en: 'When the main settings screen appears, click the Users option in the left-hand
    navigation panel. By default, the settings will be locked, and making any changes
    to the user accounts on the system will not be possible. To unlock the Settings
    app, click the Unlock button in [Figure 9-5](User_Management.xhtml#_idTextAnchor184)
    below and enter your password. Note that it will only be possible to unlock the
    settings if you are logged in as a user with sudo privileges:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ubuntu_settings_users.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9-5
  prefs: []
  type: TYPE_NORMAL
- en: 'Once the app has been unlocked, click on Add User... to display the dialog
    shown in [Figure 9-6](User_Management.xhtml#_idTextAnchor185) below:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ubuntu_settings_add_user.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9-6
  prefs: []
  type: TYPE_NORMAL
- en: Select the Administrator option to assign sudo access to the new user if required.
    Next, enter the user’s full name and username and assign a password now, or allow
    the user to set up the password when they first log into their account. Once the
    information has been entered, click the Add button to create the account.
  prefs: []
  type: TYPE_NORMAL
- en: 'The settings for an existing user can be viewed, modified, or the account deleted
    at any time by selecting the corresponding icon within the Users screen, as shown
    in [Figure 9-7](User_Management.xhtml#_idTextAnchor186). The option is also available
    to view the user’s login activity. Note that it will be necessary to unlock the
    Settings app again before any changes can be made to an account:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ubuntu_settings_user_details.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 9-7
  prefs: []
  type: TYPE_NORMAL
- en: 9.4 Summary
  prefs: []
  type: TYPE_NORMAL
- en: As a multi-user operating system, Ubuntu has been designed to support controlled
    access for multiple users. During installation, the root user account was created
    and assigned a password, and the option to create a user account was also provided.
    Additional user accounts may be added to the system using a set of command-line
    tools via the Cockpit web interface or the GNOME Settings app. In addition to
    user accounts, Linux also implements the concept of groups. New groups can be
    added, and users assigned to those groups using command-line tools, and each user
    must belong to at least one group. By default, a standard, non-root user does
    not have permission to perform privileged tasks. Users that are members of the
    special sudo group, however, may perform privileged tasks by making use of the
    sudo command.
  prefs: []
  type: TYPE_NORMAL
