- en: 18\. Sharing Files between CentOS 8 and Windows Systems with Samba
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: 18. 在 CentOS 8 和 Windows 系统之间共享文件
- en: Although Linux has made some inroads into the desktop market, its origins and
    future are very much server-based. It is not surprising therefore that CentOS
    8 has the ability to act as a file server. It is also extremely common for CentOS
    and Windows systems to be used side by side in networked environments. It is a
    common requirement, therefore, that files on a CentOS 8 system be accessible to
    Linux, UNIX and Windows-based systems over network connections. Similarly, shared
    folders and printers residing on Windows systems may also need to be accessible
    from CentOS 8 based systems.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管 Linux 在桌面市场取得了一些进展，但它的起源和未来主要是面向服务器的。因此，CentOS 8 能够作为文件服务器并不令人惊讶。因此，CentOS
    和 Windows 系统通常会在网络环境中并行使用。因此，CentOS 8 系统上的文件需要能够通过网络连接被 Linux、UNIX 和 Windows 系统访问。同样，位于
    Windows 系统上的共享文件夹和打印机也可能需要从 CentOS 8 系统进行访问。
- en: Windows systems share resources such as file systems and printers using a protocol
    known as Server Message Block (SMB). In order for a CentOS 8 system to serve such
    resources over a network to a Windows system and vice versa it must, therefore,
    support SMB. This is achieved using technology called Samba. In addition to providing
    integration between Linux and Windows systems, Samba may also be used to provide
    folder sharing between Linux systems (as an alternative to NFS which was covered
    in the previous chapter).
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 系统使用一种叫做 Server Message Block (SMB) 的协议来共享文件系统和打印机等资源。因此，为了让 CentOS
    8 系统能够通过网络将这些资源提供给 Windows 系统，反之亦然，它必须支持 SMB。这可以通过使用 Samba 技术来实现。除了提供 Linux 和
    Windows 系统之间的集成外，Samba 还可以用于在 Linux 系统之间提供文件夹共享（作为替代方案，与上一章介绍的 NFS 相对）。
- en: In this chapter we will look at the steps necessary to share file system resources
    and printers on a CentOS 8 system with remote Windows and Linux systems, and to
    access Windows resources from CentOS 8\.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍将文件系统资源和打印机从 CentOS 8 系统共享到远程 Windows 和 Linux 系统的步骤，以及从 CentOS 8 访问 Windows
    资源的步骤。
- en: 18.1 Samba and Samba Client
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 18.1 Samba 和 Samba 客户端
- en: Samba allows both CentOS 8 resources to be shared with Windows systems and Windows
    resources to be shared with CentOS 8 systems. CentOS accesses Windows resources
    using the Samba client. CentOS resources, on the other hand, are shared with Windows
    systems by installing and configuring the Samba service.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: Samba 允许 CentOS 8 资源与 Windows 系统共享，也允许 Windows 资源与 CentOS 8 系统共享。CentOS 使用 Samba
    客户端访问 Windows 资源。另一方面，通过安装和配置 Samba 服务，CentOS 资源可以与 Windows 系统共享。
- en: 18.2 Installing Samba on a CentOS 8 System
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 18.2 在 CentOS 8 系统上安装 Samba
- en: 'The default settings used during the CentOS 8 installation process do not typically
    install the necessary Samba packages. Unless you specifically requested that Samba
    be installed it is unlikely that you have Samba installed on your system. To check
    whether Samba is installed, open a terminal window and run the following rpm command:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CentOS 8 安装过程中，默认设置通常不会安装必要的 Samba 包。除非你特别要求安装 Samba，否则系统中很可能没有安装 Samba。要检查
    Samba 是否已安装，可以打开终端窗口并运行以下 rpm 命令：
- en: rpm -q samba samba-common samba-client
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: rpm -q samba samba-common samba-client
- en: 'If any of the Samba packages are not installed, rpm will return with “package
    is not installed”. That being the case, these can be installed using the dnf command-line
    tool:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有安装任何 Samba 包，rpm 会返回“package is not installed”。如果是这种情况，可以使用 dnf 命令行工具来安装它们：
- en: dnf install samba samba-common samba-client
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: dnf install samba samba-common samba-client
- en: 18.3 Configuring the CentOS 8 Firewall to Enable Samba
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 18.3 配置 CentOS 8 防火墙以启用 Samba
- en: 'Next, the firewall currently protecting the CentOS 8 system needs to be configured
    to allow Samba traffic. To achieve this, run the firewall-cmd command as follows:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，需要配置当前保护 CentOS 8 系统的防火墙，以允许 Samba 流量。为此，请执行以下 firewall-cmd 命令：
- en: firewall-cmd --permanent --add-port={139/tcp,445/tcp}
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: firewall-cmd --permanent --add-port={139/tcp,445/tcp}
- en: firewall-cmd --reload
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: firewall-cmd --reload
- en: Before starting the Samba service a number of configuration steps are necessary
    to define how the CentOS system will appear to Windows systems, and the resources
    which are to be shared with remote clients. The majority of these configuration
    tasks take place within the /etc/samba/smb.conf file.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在启动 Samba 服务之前，需要进行一系列配置步骤，以定义 CentOS 系统如何呈现给 Windows 系统，以及需要与远程客户端共享的资源。大多数配置任务都在
    /etc/samba/smb.conf 文件中进行。
- en: 18.4 Configuring the smb.conf File
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 18.4 配置 smb.conf 文件
- en: Prior to the introduction of CentOS 6, a user friendly graphical tool named
    system-config-samba was provided to assist in the configuration of Samba. In CentOS
    7 and later, however, this tool has been removed. This means that the Samba environment
    must be configured manually within the /etc/samba/smb.conf file and using the
    smbpasswd command-line tool. While the loss of system-config-samba may be mourned
    by those who relied on it, the tool’s simplicity actually masked many of the more
    advanced features of Samba. In practice, much more can be achieved by taking the
    time to understand the intricacies of the smb.conf file.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CentOS 6 之前，提供了一个名为 system-config-samba 的图形化工具，帮助配置 Samba。然而，在 CentOS 7 及更高版本中，该工具已被移除。这意味着
    Samba 环境必须手动配置，通过编辑 /etc/samba/smb.conf 文件并使用 smbpasswd 命令行工具来完成。虽然那些依赖于该工具的用户可能会对此感到惋惜，但该工具的简化实际上掩盖了
    Samba 的许多高级功能。实际上，通过花时间理解 smb.conf 文件的复杂性，能实现更多的配置。
- en: Samba is a highly flexible and configurable system that provides many different
    options for controlling how resources are shared on Windows networks. This flexibility
    can lead to the sense that Samba is overly complex to work with. In reality, however,
    many of the configuration options are not needed by the typical installation,
    and the learning curve to set up a basic configuration is actually quite short.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Samba 是一个高度灵活且可配置的系统，提供了多种选项来控制 Windows 网络上资源的共享方式。这种灵活性可能导致 Samba 看起来过于复杂。然而，实际上，许多配置选项对于典型安装并不需要，设置基本配置的学习曲线实际上相当短。
- en: For the purposes of this chapter we will look at joining a CentOS 8 system to
    a Windows workgroup and setting up a directory as a shared resource that can be
    accessed by a specific user. This is a configuration known as a standalone Samba
    server. More advanced configurations such as integrating Samba within an Active
    Directory environment are also available, though these are outside the scope of
    this book.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的目标是将 CentOS 8 系统加入一个 Windows 工作组，并设置一个目录作为共享资源，供特定用户访问。这种配置被称为独立 Samba 服务器。更高级的配置，比如将
    Samba 集成到 Active Directory 环境中，也有提供，但这些超出了本书的范围。
- en: The first step in configuring Samba is to edit the /etc/samba/smb.conf file.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 Samba 的第一步是编辑 /etc/samba/smb.conf 文件。
- en: 18.4.1 Configuring the [global] Section
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 18.4.1 配置 [global] 部分
- en: The smb.conf file is divided into sections. The first section is the [global]
    section where settings can be specified that apply to the entire Samba configuration.
    While these settings are global, each option may be overridden within other sections
    of the configuration file.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: smb.conf 文件被划分为多个部分。第一部分是 [global] 部分，可以在其中指定适用于整个 Samba 配置的设置。尽管这些设置是全局的，但每个选项可以在配置文件的其他部分中被覆盖。
- en: 'The first task is to define the name of the Windows workgroup on which the
    CentOS 8 resources are to be shared. This is controlled via the workgroup = directive
    of the [global] section which by default is configured as follows:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个任务是定义 CentOS 8 资源将要共享的 Windows 工作组名称。这个设置通过 [global] 部分的 workgroup = 指令控制，默认情况下配置如下：
- en: workgroup = SAMBA
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: workgroup = SAMBA
- en: 'Begin by changing this to the actual name of the workgroup. For example, if
    the workgroup is named WORKGROUP (the default for most Windows networks):'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，修改为实际的工作组名称。例如，如果工作组名称为 WORKGROUP（大多数 Windows 网络的默认值）：
- en: '[global]'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '[global]'
- en: workgroup = WORKGROUP
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: workgroup = WORKGROUP
- en: security = user
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: security = user
- en: passdb backend = tdbsam
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: passdb backend = tdbsam
- en: .
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: .
- en: .
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: .
- en: 'In addition to the workgroup setting, the other settings indicate that this
    is a standalone server on which the shared resources will be protected by user
    passwords. Before moving on to configuring the resources to be shared, a number
    of other parameters also need to be added to the [global] section as follows:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 除了 workgroup 设置外，其他设置表明这是一个独立服务器，共享的资源将通过用户密码进行保护。在配置共享资源之前，还需要向 [global] 部分添加以下其他参数：
- en: '[global]'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '[global]'
- en: workgroup = WORKGROUP
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: workgroup = WORKGROUP
- en: security = user
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: security = user
- en: netbios name = LinuxServer
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: netbios name = LinuxServer
- en: passdb backend = tdbsam
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: passdb backend = tdbsam
- en: log file = /var/log/samba/%m.log
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: log file = /var/log/samba/%m.log
- en: log level = 1
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: log level = 1
- en: .
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: .
- en: .
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: .
- en: The “netbios name” property specifies the name by which the server will be visible
    to other systems on the network, while the log settings simply specify a file
    location into which log output is to be recorded.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: “netbios name” 属性指定服务器在网络中对其他系统可见的名称，而日志设置则仅指定日志输出的文件位置。
- en: 18.4.2 Configuring a Shared Resource
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 18.4.2 配置共享资源
- en: 'The next step is to configure the shared resources (in other words the resources
    that will be accessible from other systems on the Windows network). In order to
    achieve this, the section is given a name by which it will be referred to when
    shared. For example, if we plan to share the /sampleshare directory of our CentOS
    8 system, we might entitle the section [sampleshare]. In this section a variety
    of configuration options are possible. For the purposes of this example, however,
    we will simply define the directory that is to be shared, indicate that the directory
    is both browsable and writable and declare the resource public so that guest users
    are able to gain access:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是配置共享资源（换句话说，就是将在 Windows 网络中的其他系统上可以访问的资源）。为了实现这一点，需要为该部分指定一个名称，通过这个名称在共享时进行引用。例如，如果我们计划共享
    CentOS 8 系统上的 /sampleshare 目录，可以将该部分命名为 [sampleshare]。在这个部分中，可以进行各种配置选项。然而，为了这个示例，我们将简单地定义要共享的目录，指定该目录可浏览和可写入，并声明该资源为公共资源，以便访客用户能够访问：
- en: '[sampleshare]'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '[sampleshare]'
- en: comment = Example Samba share
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 注释 = 示例 Samba 共享
- en: path = /sampleshare
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 路径 = /sampleshare
- en: browseable = Yes
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 可浏览 = 是
- en: public = yes
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 公共 = 是
- en: writable = yes
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 可写入 = 是
- en: 'To restrict access to specific users, the “valid users” property may be used,
    for example:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 为了限制对特定用户的访问，可以使用“有效用户”属性，例如：
- en: valid users = demo, bobyoung, marcewing
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 有效用户 = demo, bobyoung, marcewing
- en: 18.4.3 Removing Unnecessary Shares
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 18.4.3 移除不必要的共享
- en: 'The smb.conf file is pre-configured with sections for sharing printers and
    the home folders of the users on the system. If these resources do not need to
    be shared, the corresponding sections can be commented out so that they are ignored
    by Samba. In the following example, the [homes] section has been commented out:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: smb.conf 文件已预先配置了用于共享打印机和系统上用户主文件夹的部分。如果这些资源不需要共享，可以将相应的部分注释掉，这样 Samba 就会忽略它们。在以下示例中，[homes]
    部分已被注释掉：
- en: .
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 。
- en: .
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 。
- en: '#[homes]'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '#[homes]'
- en: comment = Home Directories
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 注释 = 主目录
- en: valid users = %S, %D%w%S
  id: totrans-59
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 有效用户 = %S, %D%w%S
- en: browseable = No
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 可浏览 = 否
- en: read only = No
  id: totrans-61
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 只读 = 否
- en: inherit acls = Yes
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 继承 ACLs = 是
- en: .
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 。
- en: .
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 。
- en: 18.5 Configuring SELinux for Samba
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 18.5 配置 SELinux 以支持 Samba
- en: SELinux is a system integrated by default into the Linux kernel on all CentOS
    8 systems and which provides an extra layer of security and protection to the
    operating system and user files.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: SELinux 是一个默认集成到所有 CentOS 8 系统的 Linux 内核中的系统，为操作系统和用户文件提供额外的安全性和保护。
- en: Traditionally, Linux security has been based on the concept of allowing users
    to decide who has access to their files and other resources for which they have
    ownership. Consider, for example, a file located in the home directory of, and
    owned by, a particular user. That user is able to control the access permissions
    of that file in terms of whether other users on the system are able to read and
    write to or, in the case of a script or binary, execute the file. This type of
    security is referred to as discretionary access control since access to resources
    is left to the discretion of the user.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 传统上，Linux 安全性基于允许用户决定谁可以访问他们拥有的文件和其他资源的概念。例如，考虑一个位于某个特定用户的主目录中的文件，并由该用户拥有。该用户可以控制该文件的访问权限，决定其他系统用户是否可以读取和写入，或者在脚本或二进制文件的情况下，是否可以执行该文件。这种安全性被称为自主访问控制，因为资源的访问权限由用户自行决定。
- en: With SELinux, however, access is controlled by the system administrator and
    cannot be overridden by the user. This is referred to as mandatory access control
    and is defined by the administrator using SELinux policy. To continue the previous
    example, the owner of a file is only able to perform tasks on that file if SELinux
    policy defined either by default by the system, or by the administrator, permits
    it.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，使用 SELinux 时，访问由系统管理员控制，用户无法覆盖此控制。这被称为强制访问控制，由管理员使用 SELinux 策略进行定义。继续之前的示例，文件的所有者只有在
    SELinux 策略（无论是系统默认定义的，还是由管理员定义的）允许时，才能对该文件执行任务。
- en: 'The current status of SELinux on a CentOS 8 system may be identified using
    the sestatus tool as follows:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用 sestatus 工具查看 CentOS 8 系统上 SELinux 的当前状态，方法如下：
- en: sestatus
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: sestatus
- en: 'SELinux status: enabled'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: SELinux 状态：已启用
- en: 'SELinuxfs mount: /sys/fs/selinux'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: SELinuxfs 挂载：/sys/fs/selinux
- en: 'SELinux root directory: /etc/selinux'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: SELinux 根目录：/etc/selinux
- en: 'Loaded policy name: targeted'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 加载的策略名称：targeted
- en: 'Current mode: enforcing'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 当前模式：启用
- en: 'Mode from config file: enforcing'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 配置文件中的模式：启用
- en: 'Policy MLS status: enabled'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 策略 MLS 状态：已启用
- en: 'Policy deny_unknown status: allowed'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 策略 deny_unknown 状态：已允许
- en: 'Memory protection checking: actual (secure)'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 内存保护检查：实际（安全）
- en: 'Max kernel policy version: 31'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 最大内核策略版本：31
- en: SELinux can be run in either enforcing or permissive mode. When enabled, enforcing
    mode denies all actions that are not permitted by SELinux policy. Permissive mode,
    on the other hand, allows actions that would normally have been denied to proceed
    but records the violation in a log file.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: SELinux 可以在强制执行模式或宽容模式下运行。启用时，强制执行模式会拒绝所有 SELinux 策略未允许的操作。而宽容模式则允许本应被拒绝的操作继续进行，但会将违规操作记录在日志文件中。
- en: 'SELinux security is based on the concept of context labels. All resources on
    a system (including processes and files) are assigned SELinux context labels consisting
    of user, role, type and optional security level. The SELinux context of files
    or folders, for example, may be viewed as follows:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: SELinux 安全基于上下文标签的概念。系统上的所有资源（包括进程和文件）都被分配 SELinux 上下文标签，标签包括用户、角色、类型和可选的安全级别。例如，可以按如下方式查看文件或文件夹的
    SELinux 上下文：
- en: $ ls -Z /home/demo
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: $ ls -Z /home/demo
- en: unconfined_u:object_r:user_home_t:s0 Desktop
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: unconfined_u:object_r:user_home_t:s0 Desktop
- en: unconfined_u:object_r:user_home_t:s0 Documents
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: unconfined_u:object_r:user_home_t:s0 Documents
- en: 'Similarly, the ps command may be used to identify the context of a running
    process, in this case the ls command:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，可以使用 ps 命令识别正在运行的进程的上下文，这里是 ls 命令：
- en: $ ps -eZ | grep ls
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: $ ps -eZ | grep ls
- en: unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 14311 tty1 00:00:18 ls
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 14311 tty1 00:00:18 ls
- en: 'When a process (such as the above ls command) attempts to access a file or
    folder, the SELinux system will check the policy to identify whether or not access
    is permitted. Now consider the context of the Samba service:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 当进程（例如上面的 ls 命令）尝试访问文件或文件夹时，SELinux 系统会检查策略以确定是否允许访问。现在考虑 Samba 服务的上下文：
- en: $ ps -eZ | grep smb
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: $ ps -eZ | grep smb
- en: system_u:system_r:smbd_t:s0 14129 ? 00:00:00 smbd
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: system_u:system_r:smbd_t:s0 14129 ? 00:00:00 smbd
- en: system_u:system_r:smbd_t:s0 14132 ? 00:00:00 smbd-notifyd
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: system_u:system_r:smbd_t:s0 14132 ? 00:00:00 smbd-notifyd
- en: SELinux implements security in a number of ways, the most common of which is
    referred to as type enforcement. In basic terms, when a process attempts to perform
    a task on an object (for example writing to a file), SELinux checks the context
    types of both the process and the object and verifies that the security policy
    allows the action to be taken. If a process of type A, for example, attempts to
    write to a file of type B, it will only be permitted to do so if SELinux policy
    specifically states that a process of type A may perform a write operation to
    a file of type B. In SELinux enforcement, all actions are denied by default unless
    a rule exists specifically allowing the action to be performed.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: SELinux 通过多种方式实现安全性，其中最常见的是称为类型强制执行。简单来说，当进程尝试对对象执行任务（例如写入文件）时，SELinux 会检查进程和对象的上下文类型，并验证安全策略是否允许执行该操作。例如，如果类型
    A 的进程尝试写入类型 B 的文件，只有当 SELinux 策略明确表示类型 A 的进程可以执行对类型 B 文件的写入操作时，才会被允许。在 SELinux
    强制执行模式下，默认情况下拒绝所有操作，除非存在专门允许该操作的规则。
- en: The issue with SELinux and Samba is that SELinux policy is not configured to
    allow processes of type smb_t to perform actions on files of any type other than
    samba_share_t. The /home/demo directory listed above, for example, will be inaccessible
    to the Samba service because it has a type of user_home_t. To make files or folders
    on the system accessible to the Samba service, the enforcement type of those specific
    resources must be changed to samba_share_t.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: SELinux 与 Samba 的问题在于 SELinux 策略未配置为允许 smb_t 类型的进程对除 samba_share_t 之外的任何类型文件执行操作。例如，上面列出的
    /home/demo 目录将无法被 Samba 服务访问，因为它的类型是 user_home_t。为了使系统上的文件或文件夹能够被 Samba 服务访问，必须将这些特定资源的强制执行类型更改为
    samba_share_t。
- en: 'For the purposes of this example, we will create the /sampleshare directory
    referenced previously in the smb.conf file and change the enforcement type so
    that it is accessible to the Samba service. Begin by creating the directory as
    follows:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 本示例中，我们将创建前面在 smb.conf 文件中提到的 /sampleshare 目录，并更改强制执行类型，使其能够被 Samba 服务访问。首先按以下步骤创建该目录：
- en: mkdir /sampleshare
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: mkdir /sampleshare
- en: 'Next, check the current SELinux context on the directory:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，检查该目录的当前 SELinux 上下文：
- en: $ ls -aZ /sampleshare/
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: $ ls -aZ /sampleshare/
- en: unconfined_u:object_r:default_t:s0 .
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: unconfined_u:object_r:default_t:s0 .
- en: 'In this instance, the context label of the folder has been assigned a type
    of default_t. To make the folder sharable by Samba, the enforcement type needs
    to be set to samba_share_t using the semanage tool as follows:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 在此实例中，文件夹的上下文标签被分配为 default_t 类型。为了使文件夹可由 Samba 共享，必须使用 semanage 工具将其强制类型设置为
    samba_share_t，如下所示：
- en: semanage fcontext -a -t samba_share_t "/sampleshare(/.*)?"
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: semanage fcontext -a -t samba_share_t "/sampleshare(/.*)?"
- en: 'Note the use of a wildcard in the semanage command to ensure that the type
    is applied to any sub-directories and files contained within the /sampleshare
    directory. Once added, the change needs to be applied using the restorecon command,
    making use of the -R flag to apply the change recursively through any sub-directories:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 注意在 semanage 命令中使用通配符，以确保该类型应用于 /sampleshare 目录中的任何子目录和文件。添加后，需要使用 restorecon
    命令应用更改，并使用 -R 标志递归地应用该更改到所有子目录：
- en: restorecon -R -v /sampleshare
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: restorecon -R -v /sampleshare
- en: Relabeled /sampleshare from unconfined_u:object_r:default_t:s0 to unconfined_u:object_r:samba_share_t:s0
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 将 /sampleshare 的标签从 unconfined_u:object_r:default_t:s0 更改为 unconfined_u:object_r:samba_share_t:s0
- en: Once these changes have been made, the folder is configured to comply with SELinux
    policy for the smb process and is ready to be shared by Samba.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦做出这些更改，文件夹将被配置为符合 smb 进程的 SELinux 策略，并准备通过 Samba 共享。
- en: 18.6 Creating a Samba User
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 18.6 创建 Samba 用户
- en: 'Any user that requires access to a Samba shared resource must be configured
    as a Samba User and assigned a password. This task is achieved using the smbpasswd
    command-line tool. Consider, for example, that a user named demo is required to
    be able to access the /sampleshare directory of our CentOS 8 system from a Windows
    system. In order to fulfill this requirement we must add demo as a Samba user
    as follows:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 任何需要访问 Samba 共享资源的用户，必须配置为 Samba 用户并分配密码。这个任务通过使用 smbpasswd 命令行工具来完成。例如，假设有一个名为
    demo 的用户，需要从 Windows 系统访问我们的 CentOS 8 系统上的 /sampleshare 目录。为了实现这个要求，我们必须如下添加 demo
    为 Samba 用户：
- en: smbpasswd -a demo
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: smbpasswd -a demo
- en: 'New SMB password:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 新的 SMB 密码：
- en: 'Retype new SMB password:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 重新输入新的 SMB 密码：
- en: Added user demo.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 已添加用户 demo。
- en: Now that we have completed the configuration of a very basic Samba server, it
    is time to test our configuration file and then start the Samba services.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经完成了一个非常基础的 Samba 服务器配置，是时候测试我们的配置文件并启动 Samba 服务了。
- en: 18.7 Testing the smb.conf File
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 18.7 测试 smb.conf 文件
- en: 'The settings in the smb.conf file may be checked for errors using the testparm
    command-line tool as follows:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用 testparm 命令行工具检查 smb.conf 文件中的错误，方法如下：
- en: testparm
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: testparm
- en: Load smb config files from /etc/samba/smb.conf
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 从 /etc/samba/smb.conf 加载 smb 配置文件
- en: 'rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: rlimit_max：将 rlimit_max（1024）增加到 Windows 最小限制（16384）
- en: Processing section "[sampleshare]"
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 正在处理部分 "[sampleshare]"
- en: Processing section "[homes]"
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 正在处理部分 "[homes]"
- en: Processing section "[printers]"
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 正在处理部分 "[printers]"
- en: Processing section "[print$]"
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 正在处理部分 "[print$]"
- en: Loaded services file OK.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 服务文件加载成功。
- en: 'Server role: ROLE_STANDALONE'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器角色：ROLE_STANDALONE
- en: Press enter to see a dump of your service definitions
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 按下回车键查看服务定义的输出
- en: Global parameters
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 全局参数
- en: '[global]'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '[global]'
- en: log file = /var/log/samba/%m.log
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 日志文件 = /var/log/samba/%m.log
- en: netbios name = LINUXSERVER
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: netbios 名称 = LINUXSERVER
- en: printcap name = cups
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: printcap 名称 = cups
- en: security = USER
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 安全性 = 用户
- en: wins support = Yes
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: WINS 支持 = 是
- en: 'idmap config * : backend = tdb'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 'idmap 配置 * : 后端 = tdb'
- en: cups options = raw
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: cups 选项 = raw
- en: '[sampleshare]'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '[sampleshare]'
- en: comment = Example Samba share
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 注释 = 示例 Samba 共享
- en: guest ok = Yes
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 允许游客访问 = 是
- en: path = /sampleshare
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 路径 = /sampleshare
- en: read only = No
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 只读 = 否
- en: '[homes]'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '[homes]'
- en: browseable = No
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 可浏览 = 否
- en: comment = Home Directories
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 注释 = 家庭目录
- en: inherit acls = Yes
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 继承 ACL = 是
- en: read only = No
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 只读 = 否
- en: valid users = %S %D%w%S
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 有效用户 = %S %D%w%S
- en: '[printers]'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: '[printers]'
- en: browseable = No
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 可浏览 = 否
- en: comment = All Printers
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 注释 = 所有打印机
- en: create mask = 0600
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 创建掩码 = 0600
- en: path = /var/tmp
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 路径 = /var/tmp
- en: printable = Yes
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 可打印 = 是
- en: '[print$]'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '[print$]'
- en: comment = Printer Drivers
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 注释 = 打印机驱动程序
- en: create mask = 0664
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 创建掩码 = 0664
- en: directory mask = 0775
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 目录掩码 = 0775
- en: force group = @printadmin
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 强制组 = @printadmin
- en: path = /var/lib/samba/drivers
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 路径 = /var/lib/samba/drivers
- en: write list = @printadmin root
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 写入列表 = @printadmin root
- en: 18.8 Starting the Samba and NetBIOS Name Services
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 18.8 启动 Samba 和 NetBIOS 名称服务
- en: 'In order for a CentOS 8 server to operate within a Windows network both the
    Samba (SMB) and NetBOIS nameservice (NMB) services must be started. Optionally,
    also enable the services so that they start each time the system boots:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使 CentOS 8 服务器能够在 Windows 网络中运行，必须启动 Samba (SMB) 和 NetBIOS 名称服务 (NMB)。另外，也可以启用这些服务，以便每次系统启动时自动启动：
- en: systemctl enable smb
  id: totrans-160
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: systemctl enable smb
- en: systemctl start smb
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: systemctl start smb
- en: systemctl enable nmb
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: systemctl enable nmb
- en: systemctl start nmb
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: systemctl start nmb
- en: 'Before attempting to connect from a Windows system, use the smbclient utility
    to verify that the share is configured:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在尝试从 Windows 系统连接之前，使用 smbclient 工具验证共享是否已配置：
- en: smbclient -U demo -L localhost
  id: totrans-165
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: smbclient -U demo -L localhost
- en: 'Enter WORKGROUP\demo’s password:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 输入 WORKGROUP\demo 的密码：
- en: Sharename Type Comment
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 共享名称 类型 注释
- en: '--------- ---- -------'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: '--------- ---- -------'
- en: sampleshare Disk Example Samba share
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: sampleshare 磁盘示例 Samba 共享
- en: print$ Disk Printer Drivers
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: print$ 磁盘打印机驱动程序
- en: IPC$ IPC IPC Service (Samba 4.9.1)
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: IPC$ IPC IPC 服务 (Samba 4.9.1)
- en: demo Disk Home Directories
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: demo 磁盘主目录
- en: Reconnecting with SMB1 for workgroup listing.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 SMB1 重新连接以进行工作组列表。
- en: Server Comment
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器注释
- en: '--------- -------'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '--------- -------'
- en: Workgroup Master
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 工作组主机
- en: '--------- -------'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: '--------- -------'
- en: WORKGROUP LINUXSERVER
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: WORKGROUP LINUXSERVER
- en: 18.9 Accessing Samba Shares
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 18.9 访问 Samba 共享
- en: 'Now that the Samba resources are configured and the services are running, it
    is time to access the shared resource from a Windows system. On a suitable Windows
    system on the same workgroup as the CentOS 8 system, open Windows Explorer and
    navigate to the Network panel. At this point, explorer should search the network
    and list any systems using the SMB protocol that it finds. The following figure
    illustrates a CentOS 8 system named LINUXSERVER located using Windows Explorer
    on a Windows 10 system:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 现在 Samba 资源已配置并且服务正在运行，是时候从 Windows 系统访问共享资源了。在与 CentOS 8 系统处于同一工作组的合适 Windows
    系统上，打开 Windows 资源管理器并导航到“网络”面板。此时，资源管理器应搜索网络并列出它找到的任何使用 SMB 协议的系统。下图展示了一个名为 LINUXSERVER
    的 CentOS 8 系统，在 Windows 10 系统上通过 Windows 资源管理器找到：
- en: '![](img/rhel_8_samba_share_on_windows.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![](img/rhel_8_samba_share_on_windows.png)'
- en: Figure 18-1
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 图 18-1
- en: 'Double clicking on the LINUXSERVER host will prompt for the name and password
    of a user with access privileges. In this case it is the demo account that we
    configured using the smbpasswd tool:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 双击 LINUXSERVER 主机将提示输入具有访问权限的用户的用户名和密码。在这种情况下，是我们使用 smbpasswd 工具配置的 demo 帐户：
- en: '![](img/rhel_8_samba_windows_login.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](img/rhel_8_samba_windows_login.png)'
- en: Figure 18-2
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 图 18-2
- en: 'Entering the username and password will result in the shared resources configured
    for that user appearing in the explorer window, including the previously configured
    /sampleshare resource:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 输入用户名和密码后，配置给该用户的共享资源将出现在资源管理器窗口中，包括之前配置的 /sampleshare 资源：
- en: '![](img/rhel_8_samba_folder_on_windows.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![](img/rhel_8_samba_folder_on_windows.png)'
- en: Figure 18-3
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 图 18-3
- en: Double clicking on the /sampleshare shared resource will display a listing of
    the files and directories contained therein.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 双击 /sampleshare 共享资源将显示其中包含的文件和目录列表。
- en: 18.10 Accessing Windows Shares from CentOS 8
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 18.10 从 CentOS 8 访问 Windows 共享
- en: 'As previously mentioned, Samba is a two way street, allowing not only Windows
    systems to access files and printers hosted on a CentOS 8 system, but also allowing
    the CentOS 8 system to access shared resources on Windows systems. This is achieved
    using the samba-client package which was installed at the start of this chapter.
    If it is not currently installed, install it from a terminal window as follows:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，Samba 是一条双向通道，允许 Windows 系统访问托管在 CentOS 8 系统上的文件和打印机，也允许 CentOS 8 系统访问
    Windows 系统上的共享资源。通过使用本章开始时安装的 samba-client 软件包来实现这一点。如果目前尚未安装，可以通过终端窗口按如下方式安装：
- en: dnf install samba-client
  id: totrans-192
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: dnf install samba-client
- en: Shared resources on a Windows system can be accessed either from the CentOS
    desktop using the Files application, or from the command-line prompt using the
    smbclient and mount tools. The steps in this section assume that appropriate network
    sharing settings have been enabled on the Windows system.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过 CentOS 桌面上的“文件”应用程序或通过命令行提示符使用 smbclient 和 mount 工具来访问 Windows 系统上的共享资源。本节的步骤假设
    Windows 系统已启用适当的网络共享设置。
- en: 'To access any shared resources on a Windows system using the desktop, begin
    by launching the Files application and selecting the Other Locations option. This
    will display the screen shown in [Figure 18-4](../Text/Samba_File_Sharing.xhtml#_idTextAnchor246)
    below including an icon for the Windows Network (if one is detected):'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 要通过桌面访问 Windows 系统上的共享资源，首先启动“文件”应用程序并选择“其他位置”选项。这将显示如下图 [图 18-4](../Text/Samba_File_Sharing.xhtml#_idTextAnchor246)
    所示的屏幕，包括 Windows 网络图标（如果检测到的话）：
- en: '![](img/rhel_8_connect_to_windows_share.png)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![](img/rhel_8_connect_to_windows_share.png)'
- en: Figure 18-4
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 图 18-4
- en: Selecting the Windows Network option will display the Windows systems detected
    on the network and allow access to any shared resources.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 选择 Windows 网络选项将显示网络上检测到的 Windows 系统，并允许访问任何共享的资源。
- en: '![](img/rhel_8_files_windows_10_share.png)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
  zh: '![](img/rhel_8_files_windows_10_share.png)'
- en: Figure 18-5
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 图 18-5
- en: 'Alternatively, the Connect to Server option may be used to connect to a specific
    system. Note that the name or IP address of the remote system must be prefixed
    by smb:// and may be followed by the path to a specific shared resource, for example:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，还可以使用“连接到服务器”选项来连接到特定的系统。请注意，远程系统的名称或 IP 地址必须以 smb:// 前缀，并且可以跟随特定共享资源的路径，例如：
- en: smb://WinServer10/Documents
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: smb://WinServer10/Documents
- en: 'In the absence of a desktop environment, a remote Windows share may be mounted
    from the command-line using the mount command and specifying the cifs filesystem
    type. The following command, for example, mounts a share named Documents located
    on a Windows system named WinServer at a local mount point named /winfiles:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 在没有桌面环境的情况下，可以通过命令行使用 mount 命令并指定 cifs 文件系统类型来挂载远程 Windows 共享。例如，以下命令将挂载一个名为
    Documents 的共享，该共享位于名为 WinServer 的 Windows 系统上，挂载点为本地路径 /winfiles：
- en: mount -t cifs //WinServer/Documents /winfiles -o user=demo
  id: totrans-203
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: mount -t cifs //WinServer/Documents /winfiles -o user=demo
- en: 18.11 Summary
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 18.11 总结
- en: In this chapter we have looked at the steps necessary to configure a CentOS
    8 system to act as both a Samba client and server allowing the sharing of resources
    with Windows based systems. Topics covered included the installation of Samba
    client and server packages and configuration of Samba as a standalone server.
    In addition, the basic concepts of SELinux were introduced together with the steps
    to provide Samba with access to a shared resource.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们探讨了配置 CentOS 8 系统作为 Samba 客户端和服务器的必要步骤，从而允许与基于 Windows 的系统共享资源。涵盖的主题包括
    Samba 客户端和服务器软件包的安装以及将 Samba 配置为独立服务器。此外，还介绍了 SELinux 的基本概念，并讲解了如何为 Samba 提供访问共享资源的步骤。
