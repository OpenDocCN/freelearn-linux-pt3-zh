<html><head></head><body>
<div id="_idContainer176">
<h1 class="chapter-number" id="_idParaDest-130"><a id="_idTextAnchor158"/><span class="koboSpan" id="kobo.1.1">13</span></h1>
<h1 id="_idParaDest-131"><a id="_idTextAnchor159"/><span class="koboSpan" id="kobo.2.1">Customizing Existing Recipes</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In the course of our work with Yocto Project’s tools, it is expected that we will need to customize existing recipes. </span><span class="koboSpan" id="kobo.3.2">In this chapter, we will explore some examples, such as changing compilation options, enabling or disabling features of a recipe, applying an extra patch, and using configuration </span><a id="_idTextAnchor160"/><span class="koboSpan" id="kobo.4.1">fragments to customize </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">some recipes.</span></span></p>
<h1 id="_idParaDest-132"><a id="_idTextAnchor161"/><span class="koboSpan" id="kobo.6.1">Understanding common use cases</span></h1>
<p><span class="koboSpan" id="kobo.7.1">Nowadays, projects usually </span><a id="_idIndexMarker405"/><span class="koboSpan" id="kobo.8.1">have a set of layers to provide the required features. </span><span class="koboSpan" id="kobo.8.2">We certainly need to make changes on top of them to adapt them to our specific needs. </span><span class="koboSpan" id="kobo.8.3">They may be cosmetic or substantive changes, but the way to make them is </span><span class="No-Break"><span class="koboSpan" id="kobo.9.1">the same.</span></span></p>
<p><span class="koboSpan" id="kobo.10.1">We must create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.11.1">.bbappend</span></strong><span class="koboSpan" id="kobo.12.1"> file to change a preexisting recipe in our project layer. </span><span class="koboSpan" id="kobo.12.2">For example, suppose the original recipe was named </span><strong class="source-inline"><span class="koboSpan" id="kobo.13.1">&lt;original-layer&gt;/recipes-core/app/app_1.2.3.bb</span></strong><span class="koboSpan" id="kobo.14.1">. </span><span class="koboSpan" id="kobo.14.2">When you create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.15.1">.bbappend</span></strong><span class="koboSpan" id="kobo.16.1"> file, you can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.17.1">%</span></strong><span class="koboSpan" id="kobo.18.1"> wildcard character to allow for matching recipe names. </span><span class="koboSpan" id="kobo.18.2">So, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.19.1">.bbappend</span></strong><span class="koboSpan" id="kobo.20.1"> file could have the following </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">different forms:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.22.1">App_1.2.3.bbappend</span></strong><span class="koboSpan" id="kobo.23.1">: This applies the change only for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.24.1">1.2.3</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.25.1"> version</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.26.1">app_1.2.%.bbappend</span></strong><span class="koboSpan" id="kobo.27.1">: This applies the change only for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.28.1">1.2.y</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.29.1"> version</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.30.1">app_1.%.bbappend</span></strong><span class="koboSpan" id="kobo.31.1">: This applies the change only for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.32.1">1.x</span></strong><span class="koboSpan" id="kobo.33.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.34.1">1.x.y</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.35.1"> versions</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.36.1">app_%.bbappend</span></strong><span class="koboSpan" id="kobo.37.1">: This applies the change for </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">any version</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.39.1">We can have multiple </span><strong class="source-inline"><span class="koboSpan" id="kobo.40.1">.bbappend</span></strong><span class="koboSpan" id="kobo.41.1"> files, depending on the intended changes we want to apply to the app recipe. </span><span class="koboSpan" id="kobo.41.2">Sometimes we can restrict the changes to one version, but sometimes, we want to change all </span><span class="No-Break"><span class="koboSpan" id="kobo.42.1">available recipes.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.43.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.44.1">When there is more than one </span><strong class="source-inline"><span class="koboSpan" id="kobo.45.1">.bbappend</span></strong><span class="koboSpan" id="kobo.46.1"> file for a recipe, all of them are joined following the layer’s </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">priority order.</span></span></p>
<p><span class="koboSpan" id="kobo.48.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.49.1">.bbappend</span></strong><span class="koboSpan" id="kobo.50.1"> file can be seen</span><a id="_idIndexMarker406"/><span class="koboSpan" id="kobo.51.1"> as a text appended at the end of the original recipe. </span><span class="koboSpan" id="kobo.51.2">It empowers us with a highly flexible mechanism to avoid duplicating source code to apply the required changes to our </span><span class="No-Break"><span class="koboSpan" id="kobo.52.1">project’s layers.</span></span></p>
<h2 id="_idParaDest-133"><a id="_idTextAnchor162"/><span class="koboSpan" id="kobo.53.1">Extending a task</span></h2>
<p><span class="koboSpan" id="kobo.54.1">When the task content does</span><a id="_idIndexMarker407"/><span class="koboSpan" id="kobo.55.1"> not satisfy our requirements, we replace it (providing our implementation) or append it. </span><span class="koboSpan" id="kobo.55.2">As we will learn more extensively about the BitBake metadata syntax in </span><a href="B19361_08.xhtml#_idTextAnchor110"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.56.1">Chapter 8</span></em></span></a><span class="koboSpan" id="kobo.57.1">, </span><em class="italic"><span class="koboSpan" id="kobo.58.1">Diving into BitBake Metadata</span></em><span class="koboSpan" id="kobo.59.1">, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.60.1">:append</span></strong><span class="koboSpan" id="kobo.61.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.62.1">:prepend</span></strong><span class="koboSpan" id="kobo.63.1"> operators can extend a task with extra content. </span><span class="koboSpan" id="kobo.63.2">For example, to extend a </span><strong class="source-inline"><span class="koboSpan" id="kobo.64.1">do_install</span></strong><span class="koboSpan" id="kobo.65.1"> task, we can use the </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">following code:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer163">
<span class="koboSpan" id="kobo.67.1"><img alt="Figure 13.1 – Example on how to extend the do_install task" src="image/Figure_13.01_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.68.1">Figure 13.1 – Example on how to extend the do_install task</span></p>
<p><span class="koboSpan" id="kobo.69.1">This way, the new content is concatenated in the </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">original task.</span></span></p>
<h1 id="_idParaDest-134"><a id="_idTextAnchor163"/><span class="koboSpan" id="kobo.71.1">Adding extra options to recipes based on Autotools</span></h1>
<p><span class="koboSpan" id="kobo.72.1">Let’s assume we</span><a id="_idIndexMarker408"/><span class="koboSpan" id="kobo.73.1"> have Autotools-based application, along with a preexisting recipe for it, and we want to do </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">the following:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.75.1">Enable </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.76.1">my-feature</span></strong></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.77.1">Disable </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.78.1">another-feature</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.79.1">The content of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.80.1">.bbappend</span></strong><span class="koboSpan" id="kobo.81.1"> file to make the changes will be </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">the following:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer164">
<span class="koboSpan" id="kobo.83.1"><img alt="Figure 13.2 – Adding extra configuration to the Autoconf flags" src="image/Figure_13.02_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.84.1">Figure 13.2 – Adding extra configuration to the Autoconf flags</span></p>
<p><span class="koboSpan" id="kobo.85.1">The same strategy can be used if we need to enable it conditionally based on the hardware we are building for, </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer165">
<span class="koboSpan" id="kobo.87.1"><img alt="Figure 13.3 – Conditionally adding extra configuration to the Autoconf flags" src="image/Figure_13.03_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.88.1">Figure 13.3 – Conditionally adding extra configuration to the Autoconf flags</span></p>
<p><span class="koboSpan" id="kobo.89.1">The Yocto Project supports </span><a id="_idIndexMarker409"/><span class="koboSpan" id="kobo.90.1">many different build systems, and the variables to configure them are shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">following table:</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-2">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.92.1">Build System</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.93.1">Variable</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.94.1">Autotools</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.95.1">EXTRA_OECONF</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.96.1">Cargo</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.97.1">EXTRA_OECARGO</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.98.1">CMake</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.99.1">EXTRA_OECMAKE</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.100.1">Make</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.101.1">EXTRA_OEMAKE</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.102.1">Meson</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.103.1">EXTRA_OEMESON</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.104.1">NPM</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.105.1">EXTRA_OENPM</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.106.1">SCons</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.107.1">EXTRA_OESCONS</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.108.1">WAF</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.109.1">EXTRA_OEWAF</span></strong></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.110.1">Table 13.1 – The list of variables to configure each build system</span></p>
<p><span class="koboSpan" id="kobo.111.1">The variables from </span><em class="italic"><span class="koboSpan" id="kobo.112.1">Table 13.1</span></em><span class="koboSpan" id="kobo.113.1"> are given as arguments for the respective </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">build system.</span></span></p>
<h1 id="_idParaDest-135"><a id="_idTextAnchor164"/><span class="koboSpan" id="kobo.115.1">Applying a patch</span></h1>
<p><span class="koboSpan" id="kobo.116.1">For cases where we need to apply a patch to an existing package, we should use </span><strong class="source-inline"><span class="koboSpan" id="kobo.117.1">FILESEXTRAPATHS</span></strong><span class="koboSpan" id="kobo.118.1">, which includes </span><a id="_idIndexMarker410"/><span class="koboSpan" id="kobo.119.1">new directories in the searching algorithm, making the additional file visible to BitBake, as </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer166">
<span class="koboSpan" id="kobo.121.1"><img alt="Figure 13.4 – The content of .bbappend is used only to apply mypatch.patch" src="image/Figure_13.04_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.122.1">Figure 13.4 – The content of .bbappend is used only to apply mypatch.patch</span></p>
<p><span class="koboSpan" id="kobo.123.1">In the preceding example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">THISDIR</span></strong><span class="koboSpan" id="kobo.125.1"> expands to the current directory, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.126.1">PN</span></strong><span class="koboSpan" id="kobo.127.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.128.1">PV</span></strong><span class="koboSpan" id="kobo.129.1"> expand to the package name and version, respectively. </span><span class="koboSpan" id="kobo.129.2">This new path is then included in the directories list used for file searching. </span><span class="koboSpan" id="kobo.129.3">The prepend operator is crucial as it guarantees that the file is picked from this directory, even if a file with the same name is added in the lower priority layers in </span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">the future.</span></span></p>
<p><span class="koboSpan" id="kobo.131.1">BitBake assumes that every file with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.132.1">.patch</span></strong><span class="koboSpan" id="kobo.133.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.134.1">.diff</span></strong><span class="koboSpan" id="kobo.135.1"> extension is a patch and applies </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">them accordingly.</span></span></p>
<h1 id="_idParaDest-136"><a id="_idTextAnchor165"/><span class="koboSpan" id="kobo.137.1">Adding extra files to the existing packages</span></h1>
<p><span class="koboSpan" id="kobo.138.1">If we need to include an </span><a id="_idIndexMarker411"/><span class="koboSpan" id="kobo.139.1">additional configuration file, we should use </span><strong class="source-inline"><span class="koboSpan" id="kobo.140.1">FILESEXTRAPATHS</span></strong><span class="koboSpan" id="kobo.141.1">, as explained in the previous example and shown in the following lines </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">of code:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer167">
<span class="koboSpan" id="kobo.143.1"><img alt="Figure 13.5 – The content of the .bbappend file to install a new configuration file" src="image/Figure_13.05_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.144.1">Figure 13.5 – The content of the .bbappend file to install a new configuration file</span></p>
<p><span class="koboSpan" id="kobo.145.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.146.1">do_install:append</span></strong><span class="koboSpan" id="kobo.147.1"> function appends the provided block below the metadata already available in the original </span><strong class="source-inline"><span class="koboSpan" id="kobo.148.1">do_install</span></strong><span class="koboSpan" id="kobo.149.1"> function. </span><span class="koboSpan" id="kobo.149.2">It includes the command to copy our new configuration file into the package’s filesystem. </span><span class="koboSpan" id="kobo.149.3">The file is copied from </span><strong class="source-inline"><span class="koboSpan" id="kobo.150.1">${WORKDIR}</span></strong><span class="koboSpan" id="kobo.151.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.152.1">${D}</span></strong><span class="koboSpan" id="kobo.153.1"> as these are the directories used by Poky to build the package and the destination directory used by Poky to create </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">the package.</span></span></p>
<p><span class="koboSpan" id="kobo.155.1">There are many variables to define paths in our recipes, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.156.1">bindir</span></strong><span class="koboSpan" id="kobo.157.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.158.1">datadir</span></strong><span class="koboSpan" id="kobo.159.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.160.1">sysconfdir</span></strong><span class="koboSpan" id="kobo.161.1">. </span><span class="koboSpan" id="kobo.161.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.162.1">poky/meta/conf/bitbake.conf</span></strong><span class="koboSpan" id="kobo.163.1"> file defines all those commonly used variables. </span><span class="koboSpan" id="kobo.163.2">The</span><a id="_idIndexMarker412"/><span class="koboSpan" id="kobo.164.1"> variables exist, so the installation paths of binaries can be customized depending on the use case. </span><span class="koboSpan" id="kobo.164.2">For example, the native SDK binaries require a specific installation path, so the binaries don’t conflict with the </span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">target ones.</span></span></p>
<p><span class="koboSpan" id="kobo.166.1">The following table shows the most common variables and their default </span><span class="No-Break"><span class="koboSpan" id="kobo.167.1">expanded values:</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table002">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.168.1">Variable</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold"><span class="koboSpan" id="kobo.169.1">Default </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.170.1">Expanded Value</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.171.1">base_bindir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.172.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">bin</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.174.1">base_sbindir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.175.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.176.1">sbin</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">sysconfdir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.178.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.179.1">etc</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.180.1">localstatedir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.181.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.182.1">var</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.183.1">datadir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.185.1">usr/share</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.186.1">bindir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.187.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">usr/bin</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">sbindir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.190.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.191.1">usr/sbin</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.192.1">libdir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.193.1">/usr/lib</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.194.1">or </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">/usr/lib64</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.196.1">libexecdir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.197.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">usr/libexec</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.199.1">includedir</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.201.1">usr/include</span></strong></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.202.1">Table 13.2 – The list of commonly used variables and their default expanded value</span></p>
<p><span class="koboSpan" id="kobo.203.1">The use of hard coded paths in recipes should be avoided, so we reduce the risk of misconfiguration. </span><span class="koboSpan" id="kobo.203.2">For example, when using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">usrmerge</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.205.1">DISTRO_FEATURE</span></strong><span class="koboSpan" id="kobo.206.1">, behind the scenes, all recipes set </span><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">base_bindir</span></strong><span class="koboSpan" id="kobo.208.1"> as </span><strong class="source-inline"><span class="koboSpan" id="kobo.209.1">bindir</span></strong><span class="koboSpan" id="kobo.210.1">, so if a recipe uses </span><strong class="source-inline"><span class="koboSpan" id="kobo.211.1">/bin</span></strong><span class="koboSpan" id="kobo.212.1"> as a hard coded path, the</span><a id="_idIndexMarker413"/><span class="koboSpan" id="kobo.213.1"> installation won’t happen </span><span class="No-Break"><span class="koboSpan" id="kobo.214.1">as expected.</span></span></p>
<h2 id="_idParaDest-137"><a id="_idTextAnchor166"/><span class="koboSpan" id="kobo.215.1">Understanding file searching paths</span></h2>
<p><span class="koboSpan" id="kobo.216.1">When a file (a patch or a generic file) is</span><a id="_idIndexMarker414"/><span class="koboSpan" id="kobo.217.1"> included in </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">SRC_URI</span></strong><span class="koboSpan" id="kobo.219.1">, BitBake searches for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">FILESPATH</span></strong><span class="koboSpan" id="kobo.221.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">FILESEXTRAPATH</span></strong><span class="koboSpan" id="kobo.223.1"> variables. </span><span class="koboSpan" id="kobo.223.2">The default setting is to look in the </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">following locations:</span></span></p>
<ol>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.225.1">&lt;</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.226.1">recipe&gt;-&lt;version&gt;/</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.227.1">&lt;</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">recipe&gt;/</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">files/</span></strong></span></li>
</ol>
<p><span class="koboSpan" id="kobo.230.1">In addition to this, it also checks for </span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">OVERRIDES</span></strong><span class="koboSpan" id="kobo.232.1"> for a specific file to be overridden in each folder. </span><span class="koboSpan" id="kobo.232.2">To illustrate this, consider the </span><strong class="source-inline"><span class="koboSpan" id="kobo.233.1">foo_1.0.bb</span></strong><span class="koboSpan" id="kobo.234.1"> recipe. </span><span class="koboSpan" id="kobo.234.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">OVERRIDES = "&lt;board&gt;:&lt;arch&gt;"</span></strong><span class="koboSpan" id="kobo.236.1"> variable for the file will be searched in the following directories, respecting the exact </span><span class="No-Break"><span class="koboSpan" id="kobo.237.1">order shown:</span></span></p>
<ol>
<li value="1"><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">foo-1.0/&lt;board&gt;/</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.239.1">foo-1.0/&lt;arch&gt;/</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.240.1">foo-1.0/</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.241.1">foo/&lt;board&gt;/</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.242.1">foo/&lt;arch&gt;/</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">foo/</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.244.1">files/&lt;board&gt;/</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.245.1">files/&lt;arch&gt;/</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.246.1">files/</span></strong></span></li>
</ol>
<p><span class="koboSpan" id="kobo.247.1">This is just illustrative as the list of </span><strong class="source-inline"><span class="koboSpan" id="kobo.248.1">OVERRIDES</span></strong><span class="koboSpan" id="kobo.249.1"> is huge and machine-specific. </span><span class="koboSpan" id="kobo.249.2">When we work with our recipe, we can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.250.1">bitbake-getvar OVERRIDES</span></strong><span class="koboSpan" id="kobo.251.1"> to find the complete list of available overrides for a specific machine and use them accordingly. </span><span class="koboSpan" id="kobo.251.2">See the Poky output </span><span class="No-Break"><span class="koboSpan" id="kobo.252.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer168">
<span class="koboSpan" id="kobo.253.1"><img alt="Figure 13.6 – Using bitbake-getvar to get the value of the OVERRIDES variable" src="image/Figure_13.06_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.254.1">Figure 13.6 – Using bitbake-getvar to get the value of the OVERRIDES variable</span></p>
<p><span class="koboSpan" id="kobo.255.1">This command is quite</span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.256.1"> useful for debugging the metadata during the </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">debugging process.</span></span></p>
<h2 id="_idParaDest-138"><a id="_idTextAnchor167"/><span class="koboSpan" id="kobo.258.1">Changing recipe feature configuration</span></h2>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.259.1">PACKAGECONFIG</span></strong><span class="koboSpan" id="kobo.260.1"> is a</span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.261.1"> mechanism to simplify feature set customization for recipes. </span><span class="koboSpan" id="kobo.261.2">It provides a way to enable and disable the recipe features. </span><span class="koboSpan" id="kobo.261.3">For example, the recipe has the </span><span class="No-Break"><span class="koboSpan" id="kobo.262.1">following configuration:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer169">
<span class="koboSpan" id="kobo.263.1"><img alt="Figure 13.7 – Example of PACKAGECONFIG" src="image/Figure_13.07_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.264.1">Figure 13.7 – Example of PACKAGECONFIG</span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.265.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.266.1">.7</span></em><span class="koboSpan" id="kobo.267.1"> has two features: </span><strong class="source-inline"><span class="koboSpan" id="kobo.268.1">feature1</span></strong><span class="koboSpan" id="kobo.269.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">feature2</span></strong><span class="koboSpan" id="kobo.271.1">. </span><span class="koboSpan" id="kobo.271.2">The behavior of each feature is defined by six </span><a id="_idIndexMarker417"/><span class="koboSpan" id="kobo.272.1">arguments, separated by commas. </span><span class="koboSpan" id="kobo.272.2">You can omit any argument but must retain the separating commas. </span><span class="koboSpan" id="kobo.272.3">The order is essential and specifies </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">the following:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.274.1">Extra arguments if the feature </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">is enabled.</span></span></li>
<li><span class="koboSpan" id="kobo.276.1">Extra arguments if the feature </span><span class="No-Break"><span class="koboSpan" id="kobo.277.1">is disabled.</span></span></li>
<li><span class="koboSpan" id="kobo.278.1">Additional build dependencies (</span><strong class="source-inline"><span class="koboSpan" id="kobo.279.1">DEPENDS</span></strong><span class="koboSpan" id="kobo.280.1">) if the feature </span><span class="No-Break"><span class="koboSpan" id="kobo.281.1">is enabled.</span></span></li>
<li><span class="koboSpan" id="kobo.282.1">Additional runtime dependencies (</span><strong class="source-inline"><span class="koboSpan" id="kobo.283.1">RDEPENDS</span></strong><span class="koboSpan" id="kobo.284.1">) if the feature </span><span class="No-Break"><span class="koboSpan" id="kobo.285.1">is enabled.</span></span></li>
<li><span class="koboSpan" id="kobo.286.1">Additional runtime recommendations (</span><strong class="source-inline"><span class="koboSpan" id="kobo.287.1">RRECOMMENDS</span></strong><span class="koboSpan" id="kobo.288.1">) if the feature </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">is enabled.</span></span></li>
<li><span class="koboSpan" id="kobo.290.1">Any conflicting (mutually exclusive) </span><strong class="source-inline"><span class="koboSpan" id="kobo.291.1">PACKAGECONFIG</span></strong><span class="koboSpan" id="kobo.292.1"> settings for </span><span class="No-Break"><span class="koboSpan" id="kobo.293.1">this feature.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.294.1">We can create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.295.1">.bbappend</span></strong><span class="koboSpan" id="kobo.296.1"> file that expands the </span><strong class="source-inline"><span class="koboSpan" id="kobo.297.1">PACKAGECONFIG</span></strong><span class="koboSpan" id="kobo.298.1"> variable’s default value to enable </span><strong class="source-inline"><span class="koboSpan" id="kobo.299.1">feature2</span></strong><span class="koboSpan" id="kobo.300.1"> as well, as </span><span class="No-Break"><span class="koboSpan" id="kobo.301.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer170">
<span class="koboSpan" id="kobo.302.1"><img alt="Figure 13.8 – The content of a .bbappend file to expand the PACKAGECONFIG variable" src="image/Figure_13.08_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.303.1">Figure 13.8 – The content of a .bbappend file to expand the PACKAGECONFIG variable</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.304.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.305.1">To add the same feature to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.306.1">build/conf/local.conf</span></strong><span class="koboSpan" id="kobo.307.1"> file, we can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">PACKAGECONFIG:pn-&lt;recipename&gt;:append = ' </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.309.1">feature2'</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.311.1">The list of available </span><strong class="source-inline"><span class="koboSpan" id="kobo.312.1">PACKAGECONFIG</span></strong><span class="koboSpan" id="kobo.313.1"> features for a specific package must be checked inside the recipe file, as</span><a id="_idIndexMarker418"/><span class="koboSpan" id="kobo.314.1"> there is no tool to list </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">them all.</span></span></p>
<h1 id="_idParaDest-139"><a id="_idTextAnchor168"/><span class="koboSpan" id="kobo.316.1">Configuration fragments for Kconfig-based projects</span></h1>
<p><span class="koboSpan" id="kobo.317.1">The Kconfig configuration</span><a id="_idIndexMarker419"/><span class="koboSpan" id="kobo.318.1"> infrastructure has become </span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.319.1">popular due to its flexibility and expressiveness. </span><span class="koboSpan" id="kobo.319.2">Although it started with Linux kernel, some other projects use the same infrastructure, such as U-Boot </span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">and BusyBox.</span></span></p>
<p><span class="koboSpan" id="kobo.321.1">The configuration is based on select-based features where you can enable or disable a feature and save the result of this choice in a file for later use. </span><span class="koboSpan" id="kobo.321.2">So please consider the </span><span class="No-Break"><span class="koboSpan" id="kobo.322.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer171">
<span class="koboSpan" id="kobo.323.1"><img alt="Figure 13.9 – Enable or disable TFTPD on BusyBox KConfig" src="image/Figure_13.09_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.324.1">Figure 13.9 – Enable or disable TFTPD on BusyBox KConfig</span></p>
<p><span class="koboSpan" id="kobo.325.1">We have control whether the TFTPD support in BusyBox is enabled </span><strong class="bold"><span class="koboSpan" id="kobo.326.1">(a)</span></strong><span class="koboSpan" id="kobo.327.1"> or </span><span class="No-Break"><span class="koboSpan" id="kobo.328.1">not </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.329.1">(b)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.331.1">The Yocto Project provides a specialized class to handle the configuration of the Kconfig-based project, allowing</span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.332.1"> minor modifications called configuration fragments. </span><span class="koboSpan" id="kobo.332.2">We can use this to enable or disable features for your machine, for example, when configuring </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">linux-yocto</span></strong><span class="koboSpan" id="kobo.334.1">, we can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">&lt;layer&gt;/recipes-kernel/linux/linux-yocto_%.bbappend</span></strong><span class="koboSpan" id="kobo.336.1"> as in the </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">following code:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer172">
<span class="koboSpan" id="kobo.338.1"><img alt="Figure 13.10 – The .bbappend content for applying a fragment" src="image/Figure_13.10_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.339.1">Figure 13.10 – The .bbappend content for applying a fragment</span></p>
<p><span class="koboSpan" id="kobo.340.1">Every configuration fragment</span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.341.1"> must use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.342.1">.cfg</span></strong><span class="koboSpan" id="kobo.343.1"> file extension. </span><span class="koboSpan" id="kobo.343.2">So, the</span><a id="_idIndexMarker423"/><span class="koboSpan" id="kobo.344.1"> content of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">&lt;layer&gt;/recipes-kernel/linux/linux-yocto/linux-yocto/enable-can.cfg</span></strong><span class="koboSpan" id="kobo.346.1"> file is </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer173">
<span class="koboSpan" id="kobo.348.1"><img alt="Figure 13.11 – The content of enable-can.cfg" src="image/Figure_13.11_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.349.1">Figure 13.11 – The content of enable-can.cfg</span></p>
<p><span class="koboSpan" id="kobo.350.1">We can use BitBake to configure or generate the Linux kernel configuration file. </span><span class="koboSpan" id="kobo.350.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">bitbake virtual/kernel -c menuconfig</span></strong><span class="koboSpan" id="kobo.352.1"> command that allows us to configure the Linux kernel can be seen in the </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer174">
<span class="koboSpan" id="kobo.354.1"><img alt="Figure 13.12 – Enabling CAN bus subsystem support using bitbake virtual/kernel -c menuconfig" src="image/Figure_13.12_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.355.1">Figure 13.12 – Enabling CAN bus subsystem support using bitbake virtual/kernel -c menuconfig</span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.356.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.357.1">.12</span></em><span class="koboSpan" id="kobo.358.1"> shows how to enable CAN bus support using Linux kernel’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.359.1">menuconfig</span></strong><span class="koboSpan" id="kobo.360.1">. </span><span class="koboSpan" id="kobo.360.2">The kernel configuration is changed </span><a id="_idIndexMarker424"/><span class="koboSpan" id="kobo.361.1">when exiting and saving </span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">from </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.363.1">menuconfig</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.364.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.365.1">The next step is to create the</span><a id="_idIndexMarker425"/><span class="koboSpan" id="kobo.366.1"> fragment using </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">bitbake virtual/kernel -c diffconfig</span></strong><span class="koboSpan" id="kobo.368.1">, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer175">
<span class="koboSpan" id="kobo.370.1"><img alt="Figure 13.13 – The diffconfig option generates the configuration fragment" src="image/Figure_13.13_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.371.1">Figure 13.13 – The diffconfig option generates the configuration fragment</span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.372.1">Figure 13</span></em></span><em class="italic"><span class="koboSpan" id="kobo.373.1">.13</span></em><span class="koboSpan" id="kobo.374.1"> displays the log after the command. </span><span class="koboSpan" id="kobo.374.2">It is important to note that the fragment file is created under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.375.1">&lt;build&gt;/tmp/work/</span></strong><span class="koboSpan" id="kobo.376.1"> directory, and the absolute path is shown in the log. </span><span class="koboSpan" id="kobo.376.2">We must copy this fragment file to the layer and use it in a </span><strong class="source-inline"><span class="koboSpan" id="kobo.377.1">.bbappend</span></strong><span class="koboSpan" id="kobo.378.1"> file in order to get </span><span class="No-Break"><span class="koboSpan" id="kobo.379.1">it applied.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.380.1">Tip</span></p>
<p class="callout"><span class="koboSpan" id="kobo.381.1">To save a complete configuration, we can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">bitbake virtual/kernel -c savedefconfig</span></strong><span class="koboSpan" id="kobo.383.1">. </span><span class="koboSpan" id="kobo.383.2">This command generates a </span><strong class="source-inline"><span class="koboSpan" id="kobo.384.1">defconfig</span></strong><span class="koboSpan" id="kobo.385.1"> file to replicate the same configuration. </span><span class="koboSpan" id="kobo.385.2">This is a complete configuration, not a </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">fragment file.</span></span></p>
<p><span class="koboSpan" id="kobo.387.1">The support for the</span><a id="_idIndexMarker426"/><span class="koboSpan" id="kobo.388.1"> configuration</span><a id="_idIndexMarker427"/><span class="koboSpan" id="kobo.389.1"> fragments works for the </span><span class="No-Break"><span class="koboSpan" id="kobo.390.1">following recipes:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.391.1">Linux kernel</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.392.1">U-Boot</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.393.1">BusyBox</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.394.1">Those recipes also offer the </span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">menuconfig</span></strong><span class="koboSpan" id="kobo.396.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">diffconfig</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.398.1"> tasks.</span></span></p>
<h1 id="_idParaDest-140"><a id="_idTextAnchor169"/><span class="koboSpan" id="kobo.399.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.400.1">In this chapter, we learned how to customize existing recipes using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.401.1">.bbappend</span></strong><span class="koboSpan" id="kobo.402.1"> files and benefited from this by avoiding the duplication of source code. </span><span class="koboSpan" id="kobo.402.2">We saw how to enable or disable a feature, how to apply a patch, and how to use the configuration </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">fragment support.</span></span></p>
<p><span class="koboSpan" id="kobo.404.1">In the next chapter, we will discuss how the Yocto Project can help us with some legal aspects of producing a Linux-based system using packages under different licenses. </span><span class="koboSpan" id="kobo.404.2">We will understand which artifacts we need and how Poky can be configured to generate the artifacts that should be shared as part of the copyleft compliance </span><span class="No-Break"><span class="koboSpan" id="kobo.405.1">accomplishment process.</span></span></p>
</div>
</body></html>