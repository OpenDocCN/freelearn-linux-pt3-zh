<html><head></head><body>
<div class="Basic-Text-Frame" id="_idContainer071">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">13</span></h1>
<h1 class="chapterTitle" id="_idParaDest-275"><span class="koboSpan" id="kobo.2.1">Secure Remote Access with SSH</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.4.1">Secure Shell Protocol</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.6.1">SSH</span></strong><span class="koboSpan" id="kobo.7.1">) is a </span><a id="_idIndexMarker437"/><span class="koboSpan" id="kobo.8.1">Swiss Army knife – a do-everything tool – for creating secure connections and tunneling data through them. </span><span class="koboSpan" id="kobo.8.2">During your career, you’ll use SSH for a bit of everything:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.9.1">Securely logging in to a remote system</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.10.1">Cloning your private Git repository</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.11.1">Transferring files from your laptop to a server, or between servers</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.12.1">Mapping a web service behind a VPN to a local port on your laptop so that someone on your home network can use it</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.13.1">Various other tasks that involve tunneling traffic or sending files through multiple network connections</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.14.1">In this chapter, we’ll give you everything you need to be comfortable with the basics. </span><span class="koboSpan" id="kobo.14.2">You’ll learn how public key cryptography works, which is essential to being able to reason about these kinds of tools and their usage. </span><span class="koboSpan" id="kobo.14.3">You’ll create SSH keys and use them to log in to a remote server. </span><span class="koboSpan" id="kobo.14.4">To cement the basics, we’ve even created a small project for you, where you’ll set up key-based logins for a remote host that you work with often.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.15.1">For those times when you inevitably have issues when using SSH, we’ve collected some of the most common SSH errors we see in the wild. </span><span class="koboSpan" id="kobo.15.2">You’ll learn what the most common error messages indicate, and how to use SSH’s built-in “debug” option to troubleshoot your way out of them.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.16.1">In this chapter, we’ll cover the following topics:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.17.1">A primer in public key cryptography</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.18.1">Message encryption</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.19.1">Message signing</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.20.1">SSH keys</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.21.1">Converting SSH2 keys to the OpenSSH format</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.22.1">File transfer</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.23.1">SSH tunneling</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.24.1">The configuration file</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.25.1">Let’s jump right in with the very basics of what you need to understand about public key cryptography so that the rest of this chapter doesn’t just sound like obscure black magic to you.</span></p>
<h1 class="heading-1" id="_idParaDest-276"><span class="koboSpan" id="kobo.26.1">Public key cryptography primer</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.27.1">Depending on what path your career has taken, you may have already come across the topic of</span><a id="_idIndexMarker438"/><span class="koboSpan" id="kobo.28.1"> public key cryptography. </span><span class="koboSpan" id="kobo.28.2">While cryptography is its own field, and this is not a book about cryptography, it </span><em class="italic"><span class="koboSpan" id="kobo.29.1">is</span></em><span class="koboSpan" id="kobo.30.1"> important to have an understanding of the basics. </span><span class="koboSpan" id="kobo.30.2">Thankfully, the core concepts are very simple and will get you far. </span><span class="koboSpan" id="kobo.30.3">We’ll make this section as short as possible, and then dive right into the commands you need to configure and use secure access with SSH.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.31.1">Public key cryptography is a system that uses two </span><a id="_idIndexMarker439"/><span class="koboSpan" id="kobo.32.1">separate keys, called the public key and the </span><a id="_idIndexMarker440"/><span class="koboSpan" id="kobo.33.1">private key. </span><span class="koboSpan" id="kobo.33.2">Together, these make up what is called a key pair. </span><span class="koboSpan" id="kobo.33.3">As the names imply, the public key is a key that can be shared with everyone, while the private key is supposed to remain private at all costs.</span></p>
<h2 class="heading-2" id="_idParaDest-277"><span class="koboSpan" id="kobo.34.1">Message encryption</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.35.1">Once you’ve created a key pair, any </span><a id="_idIndexMarker441"/><span class="koboSpan" id="kobo.36.1">message that has been encrypted using that key pair’s public key can be decrypted with the corresponding private key.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.37.1">Imagine a person named Alice, who wants to send Bob an encrypted message. </span><span class="koboSpan" id="kobo.37.2">To do this, Alice downloads Bob’s public key and uses it to encrypt the message. </span><span class="koboSpan" id="kobo.37.3">Alice then sends the encrypted message to Bob. </span><span class="koboSpan" id="kobo.37.4">As he owns the matching private key, Bob will be able to decrypt and read the message. </span><span class="koboSpan" id="kobo.37.5">Even if someone else sees the encrypted message, they won’t be able to decrypt and read it because only Bob has the private key.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.38.1">For this reason, it is important to </span><em class="italic"><span class="koboSpan" id="kobo.39.1">never</span></em><span class="koboSpan" id="kobo.40.1"> share your private key with a third party. </span><span class="koboSpan" id="kobo.40.2">Doing so would be a breach of security.</span></p>
<h2 class="heading-2" id="_idParaDest-278"><span class="koboSpan" id="kobo.41.1">Message signing</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.42.1">There is another way to use these</span><a id="_idIndexMarker442"/><span class="koboSpan" id="kobo.43.1"> two keys: they can be used to sign a message. </span><span class="koboSpan" id="kobo.43.2">“Signing” a message is a way to cryptographically prove that a message was really written by the person owning the key. </span><span class="koboSpan" id="kobo.43.3">This makes use of the fact that while a message encrypted with the public key can be decrypted with the private key, the reverse is also true – a message </span><em class="italic"><span class="koboSpan" id="kobo.44.1">encrypted</span></em><span class="koboSpan" id="kobo.45.1"> with the private key can be </span><em class="italic"><span class="koboSpan" id="kobo.46.1">decrypted</span></em><span class="koboSpan" id="kobo.47.1"> using the public key.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.48.1">When Alice wants to sign a message, the private key can be used to encrypt the message (or a cryptographically secure hash of the message). </span><span class="koboSpan" id="kobo.48.2">Everyone who possesses Alice’s public key can use it to decrypt the message and, if it works, knows that it must have been encrypted with Alice’s private key.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.49.1">Both mechanisms, encryption and signing, are often used together. </span><span class="koboSpan" id="kobo.49.2">Additionally, signatures themselves are frequently used to ensure security (by verifying authorship) when you’re downloading software, for example, through package managers or app stores.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.50.1">It’s worth noting that these core public-key encryption and signing mechanisms are used for everything from encrypting emails to securing HTTPS web traffic to thousands of other things in the modern world. </span><span class="koboSpan" id="kobo.50.2">In other words, Alice and Bob don’t have to be people; they can be computers, services, and so on.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.51.1">Now that you’ve seen the basic cryptographic building blocks that SSH takes advantage of to secure your remote access, you’re ready to make practical use of all of this fancy technology!</span></p>
<h1 class="heading-1" id="_idParaDest-279"><span class="koboSpan" id="kobo.52.1">SSH keys</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.53.1">One of the first things you are likely to do when it comes to</span><a id="_idIndexMarker443"/><span class="koboSpan" id="kobo.54.1"> SSH is create your very own key pair. </span><span class="koboSpan" id="kobo.54.2">This will allow you to authenticate to an SSH server. </span><span class="koboSpan" id="kobo.54.3">A classic command for creating a key pair is this:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.55.1">ssh-keygen -t ed25519 -C 'John Doe &lt;john.doe@example.org&gt;'
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.56.1">This will create an </span><code class="inlineCode"><span class="koboSpan" id="kobo.57.1">ed25519</span></code><span class="koboSpan" id="kobo.58.1"> (a modern elliptic curve cryptography algorithm) key pair using </span><code class="inlineCode"><span class="koboSpan" id="kobo.59.1">John Doe &lt;john.doe@example.org&gt;</span></code><span class="koboSpan" id="kobo.60.1"> as a comment. </span><span class="koboSpan" id="kobo.60.2">Comments are like the comments you know from programming languages, in that they can be any string of text and won’t interfere with anything on a functional level. </span><span class="koboSpan" id="kobo.60.3">In the case of SSH, this comment will be appended to your public key, making it easier to distinguish keys when they are uploaded to a server, for example, in an </span><code class="inlineCode"><span class="koboSpan" id="kobo.61.1">authorized_keys</span></code><span class="koboSpan" id="kobo.62.1"> file. </span><span class="koboSpan" id="kobo.62.2">Later in this chapter, we’ll dive deeper into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.63.1">authorized_keys</span></code><span class="koboSpan" id="kobo.64.1"> files and how to use them to set up seamless, secure access to remote servers.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.65.1">After you run this command, OpenSSH will </span><a id="_idIndexMarker444"/><span class="koboSpan" id="kobo.66.1">ask you a few questions about where to store the key files it creates and what password you’d like to use to encrypt the private key. </span><span class="koboSpan" id="kobo.66.2">Since this will be the key used to access remote systems, make sure to set a strong password.</span></p>
<div class="note">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.67.1">Note</span></strong></p>
<p class="normal"><span class="koboSpan" id="kobo.68.1">By default, keys will be placed in your </span><code class="inlineCode"><span class="koboSpan" id="kobo.69.1">~/.ssh</span></code><span class="koboSpan" id="kobo.70.1"> directory.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.71.1">Now that you’ve created a key pair, it’s time to reiterate the most important practical point: never, ever share the private key. </span><span class="koboSpan" id="kobo.71.2">Doing so would allow a third party to impersonate you. </span><span class="koboSpan" id="kobo.71.3">No service should ever ask you to share your private key. </span><span class="koboSpan" id="kobo.71.4">The public key, which is supposed to be shared and is safe to make public, will contain a </span><code class="inlineCode"><span class="koboSpan" id="kobo.72.1">.pub</span></code><span class="koboSpan" id="kobo.73.1"> suffix, so you can tell the difference.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.74.1">Thankfully, the contents of these files look very different, so if you ever get confused, you can peek at them to see which is which:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.75.1">The public key is in the format of </span><code class="inlineCode"><span class="koboSpan" id="kobo.76.1">&lt;algorithm&gt; &lt;key&gt; &lt;comment&gt;</span></code><span class="koboSpan" id="kobo.77.1">.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.78.1">The private key starts with a line like </span><code class="inlineCode"><span class="koboSpan" id="kobo.79.1">-----BEGIN OPENSSH PRIVATE KEY-----</span></code><span class="koboSpan" id="kobo.80.1">, followed by the key and a similar ending line.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.81.1">Be careful never to overwrite these key files, and ensure that you have stored both of them in a secure backup. </span><span class="koboSpan" id="kobo.81.2">Again, your password manager is a good choice for this. </span><span class="koboSpan" id="kobo.81.3">Many password managers even have a specific option to store private key files or generic text.</span></p>
<h2 class="heading-2" id="_idParaDest-280"><span class="koboSpan" id="kobo.82.1">Exceptions to these rules</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.83.1">For personal use – on your laptop, for example – you’ll always want to encrypt your private key (by specifying a password during key creation), and then never share it, as mentioned before.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.84.1">However, there are some situations where it’s okay to break these rules – specifically when setting up keys for automated systems to use. </span><span class="koboSpan" id="kobo.84.2">If you want your build server to authenticate to GitHub before checking out your code base, you’d likely use a key pair whose private key is </span><em class="italic"><span class="koboSpan" id="kobo.85.1">not</span></em><span class="koboSpan" id="kobo.86.1"> encrypted (unless you want to have to manually type in that password every time your build service runs).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.87.1">Machine-to-machine authentication and encryption are great reasons to use cryptographic key pairs. </span><span class="koboSpan" id="kobo.87.2">Just be sure to always make dedicated, single-purpose key pairs for jobs like these, and do not reuse or share those key pairs across machines or services.</span></p>
<h2 class="heading-2" id="_idParaDest-281"><span class="koboSpan" id="kobo.88.1">Logging in and authenticating</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.89.1">Logging in to</span><a id="_idIndexMarker445"/><span class="koboSpan" id="kobo.90.1"> a remote system using SSH-based authentication looks similar to this:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.91.1">ssh user@example.org
</span></code></pre>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.92.1">user</span></code><span class="koboSpan" id="kobo.93.1"> is the username that you want to log in as, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.94.1">example.org</span></code><span class="koboSpan" id="kobo.95.1"> is a stand-in for any remote system you’d like to connect to. </span><span class="koboSpan" id="kobo.95.2">This is often just an IP address, as opposed to a fully qualified domain name.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.96.1">If you’re logging in with an SSH key, or you need to specify a specific key (identity, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.97.1">-i)</span></code><span class="koboSpan" id="kobo.98.1">, it’ll look like this:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.99.1">ssh -i ~/.ssh/id_ecdsa user@example.org
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.100.1">When accessing an SSH server that you have never connected to before, you will be presented with the fingerprint of the remote server. </span><span class="koboSpan" id="kobo.100.2">This allows you to make sure that the server you are talking to is indeed the one you intend to connect to and that no man-in-the-middle attack is taking place. </span><span class="koboSpan" id="kobo.100.3">You should make sure this is correct.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.101.1">Once you type </span><code class="inlineCode"><span class="koboSpan" id="kobo.102.1">yes</span></code><span class="koboSpan" id="kobo.103.1"> and mark that fingerprint as trusted, it will be saved to a file. </span><span class="koboSpan" id="kobo.103.2">Should it ever change – for example, if someone sets up a malicious server at the same IP address that your trusted server was using before – you will be notified by your SSH client, and authentication will not be possible.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.104.1">After you mark the server as trusted, your local client and the server will negotiate which form of authentication to use. </span><span class="koboSpan" id="kobo.104.2">OpenSSH offers a wide variety of options, with the two most common ones involving a password or a key pair. </span><span class="koboSpan" id="kobo.104.3">Depending on which is chosen, OpenSSH will ask you to enter the password (or the password to decrypt your private key). </span><span class="koboSpan" id="kobo.104.4">Once the authentication step succeeds, you will be logged in.</span></p>
<h1 class="heading-1" id="_idParaDest-282"><span class="koboSpan" id="kobo.105.1">Practical project: Set up a key-based login to a remote server</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.106.1">Presuming you have access to a</span><a id="_idIndexMarker446"/><span class="koboSpan" id="kobo.107.1"> long-running Linux server that you want to allow key-based login on, follow these steps.</span></p>
<h2 class="heading-2" id="_idParaDest-283"><span class="koboSpan" id="kobo.108.1">Step 1: Open your terminal on the SSH client (not the server)</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.109.1">You’ll be using</span><a id="_idIndexMarker447"/><span class="koboSpan" id="kobo.110.1"> your local command-line environment for the rest of these steps.</span></p>
<h2 class="heading-2" id="_idParaDest-284"><span class="koboSpan" id="kobo.111.1">Step 2: Generate the key pair</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.112.1">If you’ve already</span><a id="_idIndexMarker448"/><span class="koboSpan" id="kobo.113.1"> set up a key pair because you were following along earlier in this chapter, good for you! </span><span class="koboSpan" id="kobo.113.2">You can skip this step.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.114.1">If you don’t yet have an SSH key pair, create one by typing the following command and hitting </span><em class="keystroke"><span class="koboSpan" id="kobo.115.1">Enter</span></em><span class="koboSpan" id="kobo.116.1">:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.117.1">ssh-keygen -t ed25519
# ensure that the public key is not world-readable
chmod 600 ~/.ssh/id_ed25519
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.118.1">As mentioned before, we strongly recommend adding a passphrase for extra security.</span></p>
<h2 class="heading-2" id="_idParaDest-285"><span class="koboSpan" id="kobo.119.1">Step 3: Copy the public key to your server</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.120.1">After generating</span><a id="_idIndexMarker449"/><span class="koboSpan" id="kobo.121.1"> the keys, you’ll need to place the public key on your server. </span><span class="koboSpan" id="kobo.121.2">The public key usually has the extension </span><code class="inlineCode"><span class="koboSpan" id="kobo.122.1">.pub</span></code><span class="koboSpan" id="kobo.123.1"> and by default will be located in your </span><code class="inlineCode"><span class="koboSpan" id="kobo.124.1">~/.ssh</span></code><span class="koboSpan" id="kobo.125.1"> directory.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.126.1">You can manually copy it to the remote user’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.127.1">authorized_keys</span></code><span class="koboSpan" id="kobo.128.1"> file (a file that contains all authorized public keys for that user, one key per line), or you can condense all of those actions into a single command using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.129.1">ssh-copy-id</span></code><span class="koboSpan" id="kobo.130.1"> program:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.131.1">ssh-copy-id username@example.org
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.132.1">Replace </span><code class="inlineCode"><span class="koboSpan" id="kobo.133.1">username</span></code><span class="koboSpan" id="kobo.134.1"> with your user on the remote server and </span><code class="inlineCode"><span class="koboSpan" id="kobo.135.1">remote_server_address</span></code><span class="koboSpan" id="kobo.136.1"> with the server’s IP address or domain name.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.137.1">This command </span><a id="_idIndexMarker450"/><span class="koboSpan" id="kobo.138.1">will ask for your user password on the remote server. </span><span class="koboSpan" id="kobo.138.2">After entering it, the public key will be appended to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.139.1">~/.ssh/authorized_keys</span></code><span class="koboSpan" id="kobo.140.1"> file of the remote user’s home directory. </span><span class="koboSpan" id="kobo.140.2">This allows you to log in and execute commands on the remote machine without being prompted for a password.</span></p>
<h2 class="heading-2" id="_idParaDest-286"><span class="koboSpan" id="kobo.141.1">Step 4: Test it out!</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.142.1">Now try logging</span><a id="_idIndexMarker451"/><span class="koboSpan" id="kobo.143.1"> in to the server:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.144.1">ssh username@example.org
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.145.1">If everything worked, you should be logged in without being asked for a password (unless you set up a passphrase for your SSH key). </span><span class="koboSpan" id="kobo.145.2">Instead of using a small password string that might be guessed by an attacker, you’re now using a </span><em class="italic"><span class="koboSpan" id="kobo.146.1">much</span></em><span class="koboSpan" id="kobo.147.1"> more secure cryptographic key to authenticate yourself.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.148.1">Welcome to the wonderful world of secure, password-free SSH access!</span></p>
<h1 class="heading-1" id="_idParaDest-287"><span class="koboSpan" id="kobo.149.1">Converting SSH2 keys to the OpenSSH format</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.150.1">When </span><a id="_idIndexMarker452"/><span class="koboSpan" id="kobo.151.1">not using a Unix-based operating</span><a id="_idIndexMarker453"/><span class="koboSpan" id="kobo.152.1"> system, you’ll often come across the SSH2 public key format. </span><span class="koboSpan" id="kobo.152.2">PuTTY is probably the most famous software using this format and many people using Windows use it to connect </span><a id="_idIndexMarker454"/><span class="koboSpan" id="kobo.153.1">via SSH. </span><span class="koboSpan" id="kobo.153.2">To connect to an </span><strong class="keyWord"><span class="koboSpan" id="kobo.154.1">SSH File Transfer Protocol</span></strong><span class="koboSpan" id="kobo.155.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.156.1">SFTP</span></strong><span class="koboSpan" id="kobo.157.1">) server, Git repository, or other system that uses the OpenSSH key format, you need to convert an SSH2 public key into the OpenSSH format. </span><span class="koboSpan" id="kobo.157.2">Here is how to convert it.</span></p>
<h2 class="heading-2" id="_idParaDest-288"><span class="koboSpan" id="kobo.158.1">What we are trying to achieve</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.159.1">We start with an SSH2-formatted public key that looks like this:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.160.1">---- BEGIN SSH2 PUBLIC KEY ----
Comment: "rsa-key-20160402"
AAAAB3NzaC1yc2EAAAABJQAAAgEAiL0jjDdFqK/kYThqKt7THrjABTPWvXmB3URI
pGKCP/jZlSuCUP3Oc+IxuFeXSIMvVIYeW2PZAjXQGTn60XzPHr+M0NoGcPAvzZf2
u57aX3YKaL93cZSBHR97H+XhcYdrm7ATwfjMDgfgj7+VTvW4nI46Z+qjxmYifc8u
VELolg1TDHWY789ggcdvy92oGjB0VUgMEywrOP+LS0DgG4dmkoUBWGP9dvYcPZDU
F4q0XY9ZHhvyPWEZ3o2vETTrEJr9QHYwgjmFfJn2VFNnD/4qeDDHOmSlDgEOfQcZ
Im+XUOn9eVsv//dAPSY/yMJXf8d0ZSm+VS29QShMjA4R+7yh5WhsIhouBRno2PpE
VVb37Xwe3V6U3o9UnQ3ADtL75DbrZ5beNWcmKzlJ7jVX5QzHSBAnePbBx/fyeP/f
144xPtJWB3jW/kXjtPyWjpzGndaPQ0WgXkbf8fvIuB3NJTTcZ7PeIKnLaMIzT5XN
CR+xobvdC8J9d6k84/q/laJKF3G8KbRGPNwnoVg1cwWFez+dzqo2ypcTtv/20yAm
z86EvuohZoWrtoWvkZLCoyxdqO93ymEjgHAn2bsIWyOODtXovxAJqPgk3dxM1f9P
AEQwc1bG+Z/Gc1Fd8DncgxyhKSQzLsfWroTnIn8wsnmhPJtaZWNuT5BJa8GhnzX0
9g6nhbk=
---- END SSH2 PUBLIC KEY ----
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.161.1">The goal is to convert it to an OpenSSH public key like the following:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.162.1">ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAgEAiL0jjDdFqK/kYThqKt7THrjABTPWvXmB3URIpGK
CP/jZlSuCUP3Oc+IxuFeXSIMvVIYeW2PZAjXQGTn60XzPHr+M0NoGcPAvzZf2u57aX3YKaL93cZSBHR
97H+XhcYdrm7ATwfjMDgfgj7+VTvW4nI46Z+qjxmYifc8uVELolg1TDHWY789ggcdvy92oG
jB0VUgMEywrOP+LS0DgG4dmkoUBWGP9dvYcPZDUF4q0XY9ZHhvyPWEZ3o2vETTrEJr9QHYwgjmFf
Jn2VFNnD/4qeDDHOmSlDgEOfQcZIm+XUOn9eVsv//dAPSY/yMJXf8d0ZSm+VS29QShMjA4R+7yh5Wh
sIhouBRno2PpEVVb37Xwe3V6U3o9UnQ3ADtL75DbrZ5beNWcmKzlJ7jVX5QzHSBAnePbBx/fyeP/
f144xPtJWB3jW/kXjtPyWjpzGndaPQ0WgXkbf8fvIuB3NJTTcZ7PeIKnLaMIzT5XNCR+xobvdC8
J9d6k84/q/laJKF3G8KbRGPNwnoVg1cwWFez+dzqo2ypcTtv/20yAmz86EvuohZoWrtoWvkZLCoyxdqO93ymE
jgHAn2bsIWyOODtXovxAJqPgk3dxM1f9PAEQwc1bG+Z/Gc1Fd8DncgxyhKSQzLsfWroTn
In8wsnmhPJtaZWNuT5BJa8GhnzX09g6nhbk=
</span></code></pre>
<h2 class="heading-2" id="_idParaDest-289"><span class="koboSpan" id="kobo.163.1">How to convert the SSH2-formatted key to OpenSSH</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.164.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.165.1">ssh-keygen</span></code><span class="koboSpan" id="kobo.166.1"> command, which </span><a id="_idIndexMarker455"/><span class="koboSpan" id="kobo.167.1">we used to create a new key, can also </span><a id="_idIndexMarker456"/><span class="koboSpan" id="kobo.168.1">convert it with this very simple</span><a id="_idIndexMarker457"/><span class="koboSpan" id="kobo.169.1"> command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.170.1">ssh-keygen -i -f ssh2.pub &gt; openssh.pub
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.171.1">The command above will take the key from the file </span><code class="inlineCode"><span class="koboSpan" id="kobo.172.1">ssh2.pub</span></code><span class="koboSpan" id="kobo.173.1"> and write it to </span><code class="inlineCode"><span class="koboSpan" id="kobo.174.1">openssh.pub</span></code><span class="koboSpan" id="kobo.175.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.176.1">If you just want to look at the OpenSSH key material or have it ready for copying and pasting, then you don’t have to worry about piping stdout into a file (the same command as above, without the last part):</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.177.1">ssh-keygen -i -f ssh2.pub
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.178.1">This will simply display the public key in the OpenSSH format.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.179.1">A more practical example of this might be converting and appending a coworker’s key to a server’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.180.1">authorized_keys</span></code><span class="koboSpan" id="kobo.181.1"> file. </span><span class="koboSpan" id="kobo.181.2">This can be achieved using the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.182.1">ssh-keygen -i -f coworker.pub &gt;&gt; ~/.ssh/authorized_keys
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.183.1">After this, a</span><a id="_idIndexMarker458"/><span class="koboSpan" id="kobo.184.1"> coworker using the relevant </span><a id="_idIndexMarker459"/><span class="koboSpan" id="kobo.185.1">private key will be able to log in to the system as the user who runs this command.</span></p>
<h2 class="heading-2" id="_idParaDest-290"><span class="koboSpan" id="kobo.186.1">The other direction: Converting SSH2 keys to the OpenSSH format</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.187.1">The </span><a id="_idIndexMarker460"/><span class="koboSpan" id="kobo.188.1">opposite – converting OpenSSH to SSH2 keys – is also</span><a id="_idIndexMarker461"/><span class="koboSpan" id="kobo.189.1"> possible. </span><span class="koboSpan" id="kobo.189.2">Simply use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.190.1">-e</span></code><span class="koboSpan" id="kobo.191.1"> (for export) flag, instead of </span><code class="inlineCode"><span class="koboSpan" id="kobo.192.1">-i</span></code><span class="koboSpan" id="kobo.193.1"> (for import):</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.194.1">ssh-keygen -e -f openssh.pub &gt; ssh2.pub
</span></code></pre>
<h1 class="heading-1" id="_idParaDest-291"><span class="koboSpan" id="kobo.195.1">SSH-agent</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.196.1">When you’re frequently</span><a id="_idIndexMarker462"/><span class="koboSpan" id="kobo.197.1"> logging in to servers using SSH keys, it can be annoying to have to retype your private key password over and over, every time you connect (or reconnect) to a host. </span><span class="koboSpan" id="kobo.197.2">SSH-Agent allows you to store an identity (private key) for a local session – in other words, it lets you decrypt your private key once, and then keep it in memory until you log out or start a new shell session. </span><span class="koboSpan" id="kobo.197.3">This means that you add an identity (key pair) once, and get to use it over and over again without re-decrypting your private key.</span></p>
<div class="note">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.198.1">Note</span></strong></p>
<p class="normal"><span class="koboSpan" id="kobo.199.1">The SSH Agent doesn’t always run in your local shell session – various IDEs, window managers, desktop managers, and password managers can also run an agent for you. </span><span class="koboSpan" id="kobo.199.2">You’ll know this is the case when you only have to enter the password for an identity once.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.200.1">To add a key to the agent, just use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.201.1">ssh-add</span></code><span class="koboSpan" id="kobo.202.1"> command – the argument is the path to your private key for that identity:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.203.1">ssh-add ~/.ssh/id_ecdsa
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.204.1">We recommend that you make it a habit to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.205.1">–t</span></code><span class="koboSpan" id="kobo.206.1"> option, which adds a time limit to how long your keys are kept decrypted in memory. </span><span class="koboSpan" id="kobo.206.2">The following command is the same as the one above, except it sets a time limit of 30 seconds, after which the agent will delete the keys from memory:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.207.1">ssh-add –t 30 ~/.ssh/id_ecdsa
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.208.1">To show which keys have been added to the agent, use the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.209.1">ssh-add -L
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.210.1">To remove all identities from the </span><a id="_idIndexMarker463"/><span class="koboSpan" id="kobo.211.1">SSH agent, use </span><code class="inlineCode"><span class="koboSpan" id="kobo.212.1">-D</span></code><span class="koboSpan" id="kobo.213.1">:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.214.1">ssh-add -D
</span></code></pre>
<div class="note">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.215.1">Note</span></strong></p>
<p class="normal"><span class="koboSpan" id="kobo.216.1">If you’ve added more than three identities to the agent, you may still have to specify </span><code class="inlineCode"><span class="koboSpan" id="kobo.217.1">-i $YOUR_IDENTITY</span></code><span class="koboSpan" id="kobo.218.1"> when logging in via SSH. </span><span class="koboSpan" id="kobo.218.2">This is because most servers are configured to reject logins after three incorrect attempts, and SSH will try each of the keys stored in the agent, one by one, when logging in. </span><span class="koboSpan" id="kobo.218.3">If the first key doesn’t work, it’ll try the second one, and so on. </span><span class="koboSpan" id="kobo.218.4">If the server aborts the login attempt after three tries, you’ll never get to the fourth key in your agent.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.219.1">You can enable agent forwarding when using SSH to log in to remote machines with </span><code class="inlineCode"><span class="koboSpan" id="kobo.220.1">-A</span></code><span class="koboSpan" id="kobo.221.1">; however, you should do so sparingly and carefully, for reasons we’ll explain:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.222.1">ssh -A user@remotehost
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.223.1">After logging in to </span><code class="inlineCode"><span class="koboSpan" id="kobo.224.1">remotehost</span></code><span class="koboSpan" id="kobo.225.1"> with this command, SSH will forward your keys to that host so you can use them to jump to additional hosts from there. </span><span class="koboSpan" id="kobo.225.2">The reason we recommend doing this sparingly is that it allows a compromised host to see your private keys, which we’ve hopefully taught you should always stay private, preferably on your machine or, during your wildest moments, in your password manager. </span><span class="koboSpan" id="kobo.225.3">In other words, if </span><code class="inlineCode"><span class="koboSpan" id="kobo.226.1">remotehost</span></code><span class="koboSpan" id="kobo.227.1"> has been hacked, then your SSH keys are now compromised.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.228.1">One final note about security: some Linux desktop environments like GNOME/MATE will keep your SSH key in memory indefinitely when you use and decrypt it once. </span><span class="koboSpan" id="kobo.228.2">This happens by default and is a security risk you should be aware of.</span></p>
<h1 class="heading-1" id="_idParaDest-292"><span class="koboSpan" id="kobo.229.1">Common SSH errors and the -v (verbose) argument</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.230.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.231.1">-v</span></code><span class="koboSpan" id="kobo.232.1"> flag in the </span><a id="_idIndexMarker464"/><span class="koboSpan" id="kobo.233.1">SSH command enables verbose mode, which</span><a id="_idIndexMarker465"/><span class="koboSpan" id="kobo.234.1"> prints out a detailed, step-by-step log of the connection process. </span><span class="koboSpan" id="kobo.234.2">This feature is particularly useful for diagnosing common issues such as authentication failures, connection timeouts, and key mismatches. </span><span class="koboSpan" id="kobo.234.3">Use it like this:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.235.1">ssh -v username@example.org
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.236.1">You’ll receive step-by-step information about each stage of the SSH handshake and connection, making it easier to identify and resolve any issues that may arise.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.237.1">Here are some of the frequent errors that you might encounter, which verbose output can help you diagnose:</span></p>
<ul>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.238.1">Permission Denied (public key/password)</span></strong><span class="koboSpan" id="kobo.239.1">: This indicates that the server rejected your login attempt. </span><span class="koboSpan" id="kobo.239.2">The verbose log will show you which keys were tried, helping you to pinpoint whether the correct key was used or even offered. </span><span class="koboSpan" id="kobo.239.3">This is an </span><em class="italic"><span class="koboSpan" id="kobo.240.1">incredibly</span></em><span class="koboSpan" id="kobo.241.1"> common issue when you have more than three key pairs stored on the client, and the server only allows three tries.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.242.1">Connection Timed Out</span></strong><span class="koboSpan" id="kobo.243.1">: If the connection is taking too long, you might have a network issue or an incorrect IP address or port. </span><span class="koboSpan" id="kobo.243.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.244.1">-v</span></code><span class="koboSpan" id="kobo.245.1"> flag will show where the process gets stuck, helping you understand whether the client even reached the server.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.246.1">Connection Refused</span></strong><span class="koboSpan" id="kobo.247.1">: This usually means that SSH isn’t running (or reachable) on the target port on the server. </span><span class="koboSpan" id="kobo.247.2">The verbose output will clearly indicate that the connection attempt was rejected, helping you focus on firewall rules or SSH server settings.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.248.1">Host Key Verification Failed</span></strong><span class="koboSpan" id="kobo.249.1">: The server’s key doesn’t match the one saved in your system’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.250.1">known_hosts</span></code><span class="koboSpan" id="kobo.251.1"> file. </span><span class="koboSpan" id="kobo.251.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.252.1">–v</span></code><span class="koboSpan" id="kobo.253.1"> flag will show the mismatched keys, at which point you can focus on figuring out </span><strong class="keyWord"><span class="koboSpan" id="kobo.254.1">why </span></strong><span class="koboSpan" id="kobo.255.1">(for example, is there a new server at this IP address or hostname?).</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.256.1">Could not resolve hostname</span></strong><span class="koboSpan" id="kobo.257.1">: Often related to DNS or network issues.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.258.1">No Route to Host</span></strong><span class="koboSpan" id="kobo.259.1">: This suggests network issues, maybe involving firewalls or incorrect routing.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.260.1">Too Many Authentication Failures</span></strong><span class="koboSpan" id="kobo.261.1">: The maximum number of authentication attempts has been reached. </span><span class="koboSpan" id="kobo.261.2">The verbose mode will show all the methods tried, which may include unwanted or unexpected key offers.</span></li>
<li class="bulletList"><strong class="keyWord"><span class="koboSpan" id="kobo.262.1">Key Load Errors</span></strong><span class="koboSpan" id="kobo.263.1">: These usually indicate a problem with the format or permissions of your SSH key. </span><span class="koboSpan" id="kobo.263.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.264.1">-v</span></code><span class="koboSpan" id="kobo.265.1"> flag will identify which key the SSH client is</span><a id="_idIndexMarker466"/><span class="koboSpan" id="kobo.266.1"> trying to load, allowing you to check for formatting or permission issues.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.267.1">Using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.268.1">–v</span></code><span class="koboSpan" id="kobo.269.1"> flag will help </span><a id="_idIndexMarker467"/><span class="koboSpan" id="kobo.270.1">you understand what exactly is going wrong and how you might be able to fix it. </span><span class="koboSpan" id="kobo.270.2">At the very least, it will help you start looking in the right direction.</span></p>
<h1 class="heading-1" id="_idParaDest-293"><span class="koboSpan" id="kobo.271.1">File transfer</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.272.1">In the sections below we</span><a id="_idIndexMarker468"/><span class="koboSpan" id="kobo.273.1"> will explore the </span><code class="inlineCode"><span class="koboSpan" id="kobo.274.1">sftp</span></code><span class="koboSpan" id="kobo.275.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.276.1">scp</span></code><span class="koboSpan" id="kobo.277.1"> commands for file transfer. </span><span class="koboSpan" id="kobo.277.2">Going through a few examples using these commands will help you understand how you can handle files in most situations. </span><span class="koboSpan" id="kobo.277.3">That said, we will also cover file transfer without SFTP or SCP, in case they are disabled on the server.</span></p>
<h2 class="heading-2" id="_idParaDest-294"><span class="koboSpan" id="kobo.278.1">SFTP</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.279.1">While </span><a id="_idIndexMarker469"/><span class="koboSpan" id="kobo.280.1">OpenSSH is frequently used as a way to log in to remote systems, it also allows for file transfer independently of a login session. </span><span class="koboSpan" id="kobo.280.2">This is usually accomplished via the SFTP subsystem. </span><span class="koboSpan" id="kobo.280.3">Though SFTP resembles </span><strong class="keyWord"><span class="koboSpan" id="kobo.281.1">File Transfer Protocol</span></strong><span class="koboSpan" id="kobo.282.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.283.1">FTP</span></strong><span class="koboSpan" id="kobo.284.1">), it is actually a completely custom protocol. </span><span class="koboSpan" id="kobo.284.2">Like FTP, SFTP allows authenticated users to transfer files to and from remote servers. </span><span class="koboSpan" id="kobo.284.3">Unlike FTP, which is insecure, SFTP’s authentication and file transfers are secure and fully encrypted.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.285.1">There are many FTP clients that also support SFTP. </span><span class="koboSpan" id="kobo.285.2">One famous example is Filezilla, which has an excellent graphical user interface. </span><span class="koboSpan" id="kobo.285.3">However, since this is a book about the Linux command line, we will give you a basic overview of how to use SFTP on the command line.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.286.1">Authentication is nearly identical to </span><code class="inlineCode"><span class="koboSpan" id="kobo.287.1">ssh</span></code><span class="koboSpan" id="kobo.288.1">:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.289.1">sftp user@example.org
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.290.1">After this, you’ll be presented with an FTP-style interface. </span><span class="koboSpan" id="kobo.290.2">It accepts simpler/modified versions of some shell commands that we have already gone over in previous chapters, and also introduces some</span><a id="_idIndexMarker470"/><span class="koboSpan" id="kobo.291.1"> new ones. </span><span class="koboSpan" id="kobo.291.2">Here are the most common commands:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.292.1">help</span></code><span class="koboSpan" id="kobo.293.1">: lists all commands and gives a short summary</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.294.1">ls</span></code><span class="koboSpan" id="kobo.295.1">: lists the contents of a remote directory</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.296.1">lls</span></code><span class="koboSpan" id="kobo.297.1">: lists the contents of a local directory</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.298.1">cd</span></code><span class="koboSpan" id="kobo.299.1">: changes the remote directory</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.300.1">lcd</span></code><span class="koboSpan" id="kobo.301.1">: changes the local directory</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.302.1">pwd</span></code><span class="koboSpan" id="kobo.303.1">: displays the remote directory you are in</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.304.1">lpwd</span></code><span class="koboSpan" id="kobo.305.1">: displays the local directory you are in</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.306.1">get</span></code><span class="koboSpan" id="kobo.307.1">: downloads a file from the remote server</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.308.1">put</span></code><span class="koboSpan" id="kobo.309.1">: uploads a file to the remote server</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.310.1">chmod</span></code><span class="koboSpan" id="kobo.311.1">: changes the permissions of a remote file or directory</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.312.1">chown</span></code><span class="koboSpan" id="kobo.313.1">: changes the owner of a remote file or directory</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.314.1">quit</span></code><span class="koboSpan" id="kobo.315.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.316.1">exit</span></code><span class="koboSpan" id="kobo.317.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.318.1">bye</span></code><span class="koboSpan" id="kobo.319.1">: exits SFTP (</span><em class="keystroke"><span class="koboSpan" id="kobo.320.1">CTRL</span></em><span class="koboSpan" id="kobo.321.1">+</span><em class="keystroke"><span class="koboSpan" id="kobo.322.1">D</span></em><span class="koboSpan" id="kobo.323.1"> also works)</span></li>
</ul>
<h2 class="heading-2" id="_idParaDest-295"><span class="koboSpan" id="kobo.324.1">SCP</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.325.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.326.1">scp</span></code><span class="koboSpan" id="kobo.327.1"> command</span><a id="_idIndexMarker471"/><span class="koboSpan" id="kobo.328.1"> is often a more practical way to upload and download files and directories than </span><code class="inlineCode"><span class="koboSpan" id="kobo.329.1">sftp</span></code><span class="koboSpan" id="kobo.330.1">. </span><span class="koboSpan" id="kobo.330.2">While it was historically independent of SFTP, today it uses the SFTP subsystem. </span><span class="koboSpan" id="kobo.330.3">It is meant to work as a replacement for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.331.1">cp</span></code><span class="koboSpan" id="kobo.332.1"> command, except that it allows copying to and from remote servers.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.333.1">Commands are in the following format: </span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.334.1">scp $SOURCE:filepath $DESTINATION:filepath
</span></code></pre>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.335.1">$SOURCE</span></code><span class="koboSpan" id="kobo.336.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.337.1">$DESTINATION</span></code><span class="koboSpan" id="kobo.338.1">, or both can be remote systems; </span><code class="inlineCode"><span class="koboSpan" id="kobo.339.1">scp</span></code><span class="koboSpan" id="kobo.340.1"> uses the SSH </span><code class="inlineCode"><span class="koboSpan" id="kobo.341.1">user@example.org</span></code><span class="koboSpan" id="kobo.342.1"> syntax that you’ve already seen.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.343.1">Here is what it looks like in practice:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.344.1">scp user@example.org:/home/user/my_remote_file /home/user/my_local_file
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.345.1">This will do the following:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.346.1">Connect to </span><code class="inlineCode"><span class="koboSpan" id="kobo.347.1">example.org</span></code><span class="koboSpan" id="kobo.348.1">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.349.1">Authenticate as </span><code class="inlineCode"><span class="koboSpan" id="kobo.350.1">user</span></code><span class="koboSpan" id="kobo.351.1"> (prompting you for a password unless you’re using SSH keys and the SSH agent).</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.352.1">Copy the file to the local path </span><code class="inlineCode"><span class="koboSpan" id="kobo.353.1">/home/user/my_local_file</span></code><span class="koboSpan" id="kobo.354.1">.</span></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.355.1">As you can see, the argument order is the same as for the Linux </span><code class="inlineCode"><span class="koboSpan" id="kobo.356.1">cp</span></code><span class="koboSpan" id="kobo.357.1"> (copy) command.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.358.1">Reversing the source and destination arguments – uploading a file, instead of downloading it – looks like you might expect:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.359.1">scp /home/user/my_local_file user@example.org:/home/user/my_remote_file
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.360.1">Just like with </span><code class="inlineCode"><span class="koboSpan" id="kobo.361.1">cp</span></code><span class="koboSpan" id="kobo.362.1">, you can specify relative paths. </span><span class="koboSpan" id="kobo.362.2">The following command will copy the remote file to the current (local) directory:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.363.1">scp user@example.org:/home/user/my_remote_file .
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.364.1">As with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.365.1">cp</span></code><span class="koboSpan" id="kobo.366.1"> command, it is</span><a id="_idIndexMarker472"/><span class="koboSpan" id="kobo.367.1"> also possible to recursively copy an entire directory using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.368.1">-r</span></code><span class="koboSpan" id="kobo.369.1"> (recurse, also </span><code class="inlineCode"><span class="koboSpan" id="kobo.370.1">-R</span></code><span class="koboSpan" id="kobo.371.1"> on some systems) flag:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.372.1">scp -r user@example.org:/home/user/directory local_directory
</span></code></pre>
<h2 class="heading-2" id="_idParaDest-296"><span class="koboSpan" id="kobo.373.1">Clever examples</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.374.1">As with all commands and tools, </span><code class="inlineCode"><span class="koboSpan" id="kobo.375.1">ssh</span></code><span class="koboSpan" id="kobo.376.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.377.1">scp</span></code><span class="koboSpan" id="kobo.378.1"> can also be used in scripts; for example, you can use ssh to quickly back up a database:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.379.1">ssh username@example.org "pg_dump databasename | gzip -c" &gt; database_backup.sql.gz
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.380.1">If you use clever shell hacks like this in a script, take care to alert on errors; otherwise, the process might just silently remain stuck when it runs into an issue. </span><span class="koboSpan" id="kobo.380.2">For development situations, this kind of command can really come in handy.</span></p>
<h3 class="heading-3" id="_idParaDest-297"><span class="koboSpan" id="kobo.381.1">Without SFTP or SCP</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.382.1">In some rare situations, you’ll find that SFTP has been disabled on a server and you can only log in to an interactive shell. </span><span class="koboSpan" id="kobo.382.2">You still want to transfer a file to the remote system, and while it might be possible to just open a file in an editor, this isn’t always possible (for example, with whole directories or binary files). </span><span class="koboSpan" id="kobo.382.3">Here are a few tricks that you can use to still achieve your goal (they all make use of the Unix pipe in combination with an SSH session).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.383.1">The simplest case is downloading a file from a remote server:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.384.1">ssh user@example.org "cat /path/to/file" &gt; local_target_file
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.385.1">This command will do the following:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.386.1">Log in to the server.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.387.1">Run the command </span><code class="inlineCode"><span class="koboSpan" id="kobo.388.1">cat /path/to/file</span></code><span class="koboSpan" id="kobo.389.1"> on the remote server, which will result in the contents of that file being streamed to </span><code class="inlineCode"><span class="koboSpan" id="kobo.390.1">stdout</span></code><span class="koboSpan" id="kobo.391.1">.</span></li>
<li class="numberedList"><code class="inlineCode"><span class="koboSpan" id="kobo.392.1">stdout</span></code><span class="koboSpan" id="kobo.393.1"> can then be locally piped into a file of our choice.</span></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.394.1">Like most well-behaved Unix software, errors and other possibly interfering output will be sent to </span><code class="inlineCode"><span class="koboSpan" id="kobo.395.1">STDERR</span></code><span class="koboSpan" id="kobo.396.1">, so you do not have to fear that a password prompt will get in the way and corrupt the file content being piped across your SSH tunnel, as an example.</span></p>
<h3 class="heading-3" id="_idParaDest-298"><span class="koboSpan" id="kobo.397.1">Directory upload and .tar.gz compression</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.398.1">Let’s do something different and upload a whole directory. </span><span class="koboSpan" id="kobo.398.2">Since this is potentially quite a lot of data, we will also compress it with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.399.1">tar</span></code><span class="koboSpan" id="kobo.400.1"> program. </span><code class="inlineCode"><span class="koboSpan" id="kobo.401.1">tar</span></code><span class="koboSpan" id="kobo.402.1"> is a command that turns multiple files and/or directories into a single file (an “archive”).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.403.1">It’s common to add a compression step after archiving – you’ve probably seen files with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.404.1">tar.gz</span></code><span class="koboSpan" id="kobo.405.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.406.1">tar.bz2</span></code><span class="koboSpan" id="kobo.407.1"> endings, for example. </span><span class="koboSpan" id="kobo.407.2">This means that the files have first been archived into a single file with </span><code class="inlineCode"><span class="koboSpan" id="kobo.408.1">tar</span></code><span class="koboSpan" id="kobo.409.1">, and then compressed using </span><code class="inlineCode"><span class="koboSpan" id="kobo.410.1">gzip</span></code><span class="koboSpan" id="kobo.411.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.412.1">bzip2</span></code><span class="koboSpan" id="kobo.413.1">:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.414.1">tar czf - /home/user/directory_to_upload | ssh user@example.org "tar -xvzf -C /home/user/"
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.415.1">Here, we first archive </span><code class="inlineCode"><span class="koboSpan" id="kobo.416.1">/home/user/directory</span></code><span class="koboSpan" id="kobo.417.1"> with </span><code class="inlineCode"><span class="koboSpan" id="kobo.418.1">tar</span></code><span class="koboSpan" id="kobo.419.1">, turning the result into a stream of bytes.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.420.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.421.1">-</span></code><span class="koboSpan" id="kobo.422.1"> is the target file. </span><span class="koboSpan" id="kobo.422.2">In the case that you want to store it immediately instead of streaming it to another program, this would be something like </span><code class="inlineCode"><span class="koboSpan" id="kobo.423.1">/home/user/directory.tar.gz</span></code><span class="koboSpan" id="kobo.424.1">. </span><span class="koboSpan" id="kobo.424.2">As is customary with many Unix commands, a dash symbolizes that this should instead be written to stdout.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.425.1">This resulting stream will then be piped into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.426.1">ssh</span></code><span class="koboSpan" id="kobo.427.1"> process, which uses it as input (</span><code class="inlineCode"><span class="koboSpan" id="kobo.428.1">stdin</span></code><span class="koboSpan" id="kobo.429.1">) for a </span><code class="inlineCode"><span class="koboSpan" id="kobo.430.1">tar</span></code><span class="koboSpan" id="kobo.431.1"> command on the remote system, which decompresses and unarchives that stream, writing the resulting directory to </span><code class="inlineCode"><span class="koboSpan" id="kobo.432.1">/home/user/directory_to_upload</span></code><span class="koboSpan" id="kobo.433.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-299"><span class="koboSpan" id="kobo.434.1">Tunnels</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.435.1">SSH tunnelling</span><a id="_idIndexMarker473"/><span class="koboSpan" id="kobo.436.1"> is used to </span><a id="_idIndexMarker474"/><span class="koboSpan" id="kobo.437.1">transport data over an SSH connection. </span><span class="koboSpan" id="kobo.437.2">In the following sections, we will look at two methods of tunnelling: local forwarding and proxying.</span></p>
<h2 class="heading-2" id="_idParaDest-300"><span class="koboSpan" id="kobo.438.1">Local forwarding</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.439.1">SSH can</span><a id="_idIndexMarker475"/><span class="koboSpan" id="kobo.440.1"> create secure, encrypted tunnels to remote systems. </span><span class="koboSpan" id="kobo.440.2">This functionality is similar to what a VPN provides and can allow you to access services reachable from the remote system.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.441.1">That’s powerful functionality, and with SSH, it’s actually simple to achieve. </span><span class="koboSpan" id="kobo.441.2">All you have to do is specify an additional argument, </span><code class="inlineCode"><span class="koboSpan" id="kobo.442.1">-L</span></code><span class="koboSpan" id="kobo.443.1">, with the destination and the local port to bind it to when establishing an SSH session.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.444.1">Imagine a remote system running an HTTP server on port </span><code class="inlineCode"><span class="koboSpan" id="kobo.445.1">8080</span></code><span class="koboSpan" id="kobo.446.1">. </span><span class="koboSpan" id="kobo.446.2">You want to access it on your laptop, on port </span><code class="inlineCode"><span class="koboSpan" id="kobo.447.1">3000</span></code><span class="koboSpan" id="kobo.448.1">. </span><span class="koboSpan" id="kobo.448.2">Here is how to accomplish that with a simple command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.449.1">ssh -L 3000:localhost:8080 user@example.org
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.450.1">You can now open a browser and visit </span><code class="inlineCode"><span class="koboSpan" id="kobo.451.1">http://localhost:3000/</span></code><span class="koboSpan" id="kobo.452.1"> to access the web server as if you were opening that browser on the remote system and visiting </span><code class="inlineCode"><span class="koboSpan" id="kobo.453.1">http://localhost:8080</span></code><span class="koboSpan" id="kobo.454.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-301"><span class="koboSpan" id="kobo.455.1">Proxying</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.456.1">The same would be</span><a id="_idIndexMarker476"/><span class="koboSpan" id="kobo.457.1"> true if you wanted to access a server that you don’t have access to, but the remote server does. </span><span class="koboSpan" id="kobo.457.2">Imagine </span><code class="inlineCode"><span class="koboSpan" id="kobo.458.1">app.example.org</span></code><span class="koboSpan" id="kobo.459.1"> is where your web application runs. </span><span class="koboSpan" id="kobo.459.2">This web application connects to a database server like PostgreSQL at </span><code class="inlineCode"><span class="koboSpan" id="kobo.460.1">db.example.org</span></code><span class="koboSpan" id="kobo.461.1">, which is only accessible from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.462.1">www.example.org</span></code><span class="koboSpan" id="kobo.463.1"> internal network. </span><span class="koboSpan" id="kobo.463.2">Like most production databases, it’s guarded by a firewall that prevents direct connections from outside.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.464.1">From a network perspective, it looks like this:</span></p>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.465.1">(localhost) ——-&gt; (app.example.org) ——-&gt; (db.example.org)</span></code></p>
<p class="normal"><span class="koboSpan" id="kobo.466.1">You might want to use your local </span><code class="inlineCode"><span class="koboSpan" id="kobo.467.1">psql</span></code><span class="koboSpan" id="kobo.468.1"> Postgres client to connect to that database. </span><span class="koboSpan" id="kobo.468.2">What you’d do is create a tunnel like this:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.469.1">ssh -L 5000:db.example.org:5432 user@app.example.org
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.470.1">This will open a new SSH session to </span><code class="inlineCode"><span class="koboSpan" id="kobo.471.1">app.example.org</span></code><span class="koboSpan" id="kobo.472.1">, reach out to the DB server from there, and map </span><code class="inlineCode"><span class="koboSpan" id="kobo.473.1">db.example.org:5432</span></code><span class="koboSpan" id="kobo.474.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.475.1">localhost:5000</span></code><span class="koboSpan" id="kobo.476.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.477.1">Now, running </span><code class="inlineCode"><span class="koboSpan" id="kobo.478.1">psql --port=5000 --host=localhost dbname</span></code><span class="koboSpan" id="kobo.479.1"> on your laptop will connect you to the </span><a id="_idIndexMarker477"/><span class="koboSpan" id="kobo.480.1">Postgres database at </span><code class="inlineCode"><span class="koboSpan" id="kobo.481.1">db.example.org:5432</span></code><span class="koboSpan" id="kobo.482.1">, by bouncing through </span><code class="inlineCode"><span class="koboSpan" id="kobo.483.1">app.example.org</span></code><span class="koboSpan" id="kobo.484.1"> to get access.</span></p>
<h1 class="heading-1" id="_idParaDest-302"><span class="koboSpan" id="kobo.485.1">The configuration file</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.486.1">It is possible to</span><a id="_idIndexMarker478"/><span class="koboSpan" id="kobo.487.1"> specify host configuration in </span><code class="inlineCode"><span class="koboSpan" id="kobo.488.1">.ssh/config</span></code><span class="koboSpan" id="kobo.489.1">. </span><span class="koboSpan" id="kobo.489.2">This can be helpful in various situations, as it allows you to specify:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.490.1">Custom (friendly) names for hosts</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.491.1">The default user to use</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.492.1">The port</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.493.1">Tunnels to open before connecting</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.494.1">Identity files (keys)</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.495.1">Among many other things.</span></p>
<div class="note">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.496.1">Note</span></strong></p>
<p class="normal"><span class="koboSpan" id="kobo.497.1">If a server you connect to has a permanent IP address, it can make sense to specify it in your SSH config file to avoid relying on DNS or CDNs during a disaster recovery situation.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.498.1">SSH configuration files aren’t particularly complicated, so we’ll show you an example here that uses many of the available features:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.499.1"># Set Defaults for all hosts using the glob character (*)Host *
  ServerAliveInterval 30     # Check if the connection is alive every 30 seconds
  ForwardAgent yes           # Forward SSH agent to the remote host
  Compression yes            # Enable compression
  IdentityFile ~/.ssh/id_rsa # Default identity file
  
# Specific settings for host "example1.com"
Host example1
  HostName example1.com       # The real hostname to connect to
  User john                   # Default username for this host
  Port 22                     # SSH port (default is 22)
  IdentityFile ~/.ssh/id_ecdsa # Different identity file for this host
 
# Settings for another specific host "example2.com"
Host example2
  HostName example2.com
  User jane
  Port 22000                  # Different SSH port for this host
  IdentityFile ~/.ssh/id_ed25519
  
# Using a jump host to connect to a host behind a firewall
Host target-behind-fw
  HostName 192.168.0.2         # Private IP of the target host
  User alice
  Port 22
  ProxyJump jump-host          # Use 'jump-host' as a jump host
  
# Configuration for the jump host
Host jump-host
  HostName jump.example.com    # Public IP or domain of the jump host
  User jumpuser
  Port 22
  IdentityFile ~/.ssh/jump_key
  
# Using a SOCKS proxy to connect to a host
Host proxy-host
  HostName proxy-target.com    # The real hostname to connect to
  User proxyuser
  Port 22
  ProxyCommand nc -X 5 -x localhost:1080 %h %p  # Using SOCKS proxy on localhost port 1080
</span></code></pre>
<h1 class="heading-1" id="_idParaDest-303"><span class="koboSpan" id="kobo.500.1">Conclusion</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.501.1">OpenSSH</span><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.502.1"> is a very versatile tool, and we hope that the introduction you received in this chapter has motivated you to experiment and learn more. </span><span class="koboSpan" id="kobo.502.2">Just think of everything we’ve covered:</span></p>
<p class="normal"><span class="koboSpan" id="kobo.503.1">You’ve learned the basics of how public key cryptography works, which is essential to being able to reason about these kinds of tools and their usage. </span><span class="koboSpan" id="kobo.503.2">You saw how to create SSH keys and use them for remote shell sessions.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.504.1">Hopefully, you got some practical experience, too, by following along and setting up key-based logins for a remote host that you work with often. </span><span class="koboSpan" id="kobo.504.2">If that remote host happens to be on </span><strong class="keyWord"><span class="koboSpan" id="kobo.505.1">Amazon Web Services</span></strong><span class="koboSpan" id="kobo.506.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.507.1">AWS</span></strong><span class="koboSpan" id="kobo.508.1">) or another platform that uses </span><code class="inlineCode"><span class="koboSpan" id="kobo.509.1">.pem</span></code><span class="koboSpan" id="kobo.510.1"> keys, you learned how to convert between key </span><a id="_idIndexMarker480"/><span class="koboSpan" id="kobo.511.1">formats (that trick alone is sure to impress your coworkers).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.512.1">Even if you didn’t run into them yourself, we exposed you to some of the most common SSH errors we see people get stuck on in the wild, and how to track them down with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.513.1">–v</span></code><span class="koboSpan" id="kobo.514.1"> option.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.515.1">We even covered SSH usage beyond remote interactive shell sessions – file transfers, tunneling network traffic, and setting up custom configurations for different servers. </span><span class="koboSpan" id="kobo.515.2">Surprisingly, there’s even more that OpenSSH</span><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.516.1"> can do:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.517.1">Encrypt and sign files with </span><code class="inlineCode"><span class="koboSpan" id="kobo.518.1">ssh-keygen</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.519.1">Add two-factor authentication via FIDO/U2F, storing your key on an external device</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.520.1">Force certain commands to be run after login, which both limits the attack vector and allows SSH to be an interface to a service</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.521.1">The OpenSSH project provides excellent documentation on its manual pages and on its website. </span><span class="koboSpan" id="kobo.521.2">If you have a problem that requires secure connections between machines and you want technology that is battle-tested and proven, OpenSSH is worth checking out. </span><span class="koboSpan" id="kobo.521.3">Now go forth and encrypt!</span></p>
<h1 class="heading-1"><span class="koboSpan" id="kobo.522.1">Learn more on Discord</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.523.1">To join the Discord community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</span></p>
<p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.524.1">https://packt.link/SecNet</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.525.1"><img alt="" role="presentation" src="../Images/QR_Code1768422420210094187.png"/></span></p>
</div>
</body></html>