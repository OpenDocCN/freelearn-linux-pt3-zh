["```\n$ sudo nmcli connection add type bond con-name bond0 ifname bond0 bond.options \"mode=active-backup\"\n$ sudo nmcli connection add type ethernet slave-type bond con-name bond0-port1 ifname eth0 master bond0\n$ sudo nmcli connection add type ethernet slave-type bond con-name bond0-port2 ifname eth1 master bond0\n$ sudo nmcli connection up bond0\n```", "```\n$ sudo ip route add 0.0.0.0/0 via 192.0.2.1 metric 200\n$ sudo ip route add 0.0.0.0/0 via 203.0.113.1 metric 100\n```", "```\n$ sudo ip route add 0.0.0.0/0 nexthop via 192.0.2.1 weight 5 nexthop via 203.0.113.1 weight 10\n```", "```\nroot@virtual-server# ipvsadm --add-service --tcp-service 192.168.56.100:80\nroot@virtual-server# ipvsadm --add-server --tcp-service 192.168.56.100:80 --real-server 10.20.30.2:8000 --masquerading\n```", "```\nipvsadm -A -t 192.168.56.100:80 -s rr.\n```", "```\nroot@virtual-server# ipvsadm –list\nIP Virtual Server version 1.2.1 (size=4096)\nProt LocalAddress:Port Scheduler Flags\n  -> RemoteAddress:Port           Forward Weight ActiveConn InActConn\nTCP  192.168.56.100:http rr\n  -> 10.20.30.2:8000              Masq    1      0          0\n```", "```\nroot@real-server# tcpdump -n -i eth1 -q tcp port 8000\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on eth1, link-type EN10MB (Ethernet), capture size 262144 bytes\n23:56:16... IP 192.168.56.1.44320 > 10.20.30.2.8000: tcp 0\n23:56:16... IP 10.20.30.2.8000 > 192.168.56.1.44320: tcp 0\n23:56:16... IP 192.168.56.1.44320 > 10.20.30.2.8000: tcp 0\n23:56:16... IP 192.168.56.1.44320 > 10.20.30.2.8000: tcp 129\n```", "```\nroot@virtual-server# tcpdump -n -i eth0 -q tcp port 80\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n00:02:19... IP 192.168.56.1.32890 > 192.168.56.100.80: tcp 0\n00:02:19... IP 192.168.56.100.80 > 192.168.56.1.32890: tcp 0\n00:02:19... IP 192.168.56.1.32890 > 192.168.56.100.80: tcp 0\n00:02:19... IP 192.168.56.1.32890 > 192.168.56.100.80: tcp 129\n```", "```\nroot@virtual-server# ipvsadm --add-service --tcp-service 10.20.30.1:8000\nroot@virtual-server# ipvsadm --add-server --tcp-service 10.20.30.1:8000 --real-server 10.20.30.2 --gatewaying\n```", "```\nroot@real-server# arptables -A IN -d 10.20.30.1 -j DROP\nroot@real-server# arptables -A OUT -d 10.20.30.1 -j mangle --mangle-ip-s 10.20.30.2\n```", "```\nroot@virtual-server# ipvsadm --add-service --tcp-service 192.168.56.100:8000\nroot@virtual-server# ipvsadm --add-server --tcp-service 192.168.56.100:8000 --real-server 10.20.30.2 --ipip\n```", "```\nroot@real-server# ip tunnel add ipip1 mode ipip local 10.20.30.2\nroot@real-server# ip link set dev ipip1 up\nroot@real-server# ip address add 192.168.56.100/32 dev ipip1\n```", "```\nroot@real-server# tcpdump -vvvv -n -i eth1\ntcpdump: listening on eth1, link-type EN10MB (Ethernet), capture size 262144 bytes\n01:06:05.545444 IP (tos 0x0, ttl 63, id 0, offset 0, flags [DF], proto IPIP (4), length 80)\n    10.20.30.1 > 10.20.30.2: IP (tos 0x0, ttl 63, id 44915, offset 0, flags [DF], proto TCP (6), length 60)\n    192.168.56.1.51886 > 192.168.56.106.8000: tcp 0\n```", "```\nroot@virtual-server# ipvsadm --save\n-A -t 192.168.56.100:http -s wlc\n-a -t 192.168.56.100:http -r 10.20.30.2:8000 -m -w 1\n```", "```\nroot@virtual-server# ipvsadm –save > lvs.conf\nroot@virtual-server# cat lvs.conf | ipvsadm --restore\n```", "```\nipvsadm --add-service --tcp-service 192.168.56.100:80 --persistent 600\n```", "```\nroot@first-virtual-server# ipvsadm --start-daemon=master --mcast-interface=eth0\nroot@second-virtual-server# ipvsadm --start-daemon=backup --mcast-interface=eth0\n```", "```\nsudo dnf install keepalived\n```", "```\nsudo apt-get install keepalived\n```", "```\nvrrp_instance LoadBalancers {\n    state BACKUP\n    interface eth1\n    virtual_router_id 100\n    priority 100\n    advert_int 1\n    nopreempt\n    virtual_ipaddress {\n        10.20.30.100/24\n    }\n}\n```", "```\n$ ip address show eth1\n3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n  link/ether 08:00:27:33:48:b8 brd ff:ff:ff:ff:ff:ff\n  inet 10.20.30.1/24 brd 10.20.30.255 scope global eth1\n  valid_lft forever preferred_lft forever\n  inet 10.20.30.100/24 scope global secondary eth1\n  valid_lft forever preferred_lft forever\n  inet6 fe80::a00:27ff:fe33:48b8/64 scope link\n  valid_lft forever preferred_lft forever\n```", "```\n$ sudo tcpdump -i eth1\nlistening on eth1, link-type EN10MB (Ethernet), capture size 262144 bytes\n04:38:54.038630 IP 10.20.30.1 > 224.0.0.18: VRRPv2, Advertisement, vrid 100, prio 100, authtype none, intvl 1s, length 20\n04:38:55.038799 IP 10.20.30.1 > 224.0.0.18: VRRPv2, Advertisement, vrid 100, prio 100, authtype none, intvl 1s, length 20\n04:38:56.039018 IP 10.20.30.1 > 224.0.0.18: VRRPv2, Advertisement, vrid 100, prio 100, authtype none, intvl 1s, length 20\n```", "```\n$ cat /run/keepalived/keepalived.pid\n3241\n$ sudo kill -USR1 3241\n$ sudo cat /etc/keepalived.data\n...\n------< VRRP Topology >------\n  VRRP Instance = LoadBalancers\n   VRRP Version = 2\n   State = MASTER\n   Flags: none\n   Wantstate = MASTER\n   Last transition = ...\n   Interface = eth1\n   Using src_ip = 10.20.30.1\n   Multicast address 224.0.0.18\n   ...\n   Virtual Router ID = 100\n   Priority = 100\n   ...\n   Preempt = enabled\n   Promote_secondaries = disabled\n   Authentication type = none\n   Virtual IP (1):\n     10.20.30.100/24 dev eth1 scope global set\n   ...\n```", "```\n$ sudo kill -USR1 $(cat /run/keepalived.pid)\n$ sudo cat /etc/keepalived.stats\nVRRP Instance: LoadBalancers\n  Advertisements:\n    Received: 0\n    Sent: 112\n  Became master: 1\n  Released master: 0\n  Packet Errors:\n    Length: 0\n    TTL: 0\n    Invalid Type: 0\n    Advertisement Interval: 0\n    Address List: 0\n  Authentication Errors:\n    Invalid Type: 0\n    Type Mismatch: 0\n    Failure: 0\n  Priority Zero:\n    Received: 0\n    Sent: 0\n```", "```\nglobal_defs {\n  lvs_id WEB_SERVERS\n}\nvirtual_server 192.168.56.1 80 {\n    ! Weighted Round Robin\n    lb_algo wrr\n    lb_kind NAT\n    protocol TCP\n    ! Where to send requests if all servers fail\n    sorry_server 192.168.56.250 80\n    real_server 192.168.56.101 80 {\n        weight 1\n    }\n    real_server 192.168.56.102 80 {\n       weight 1\n    }\n}\n```", "```\n$ sudo systemctl restart keepalived\n$ sudo ipvsadm\nIP Virtual Server version 1.2.1 (size=4096)\nProt LocalAddress:Port Scheduler Flags\n  -> RemoteAddress:Port           Forward Weight ActiveConn InActConn\nTCP  server:http wrr\n  -> 192.168.56.101:http          Masq    1      0      0\n  -> 192.168.56.102:http          Masq    1      0       0\n```", "```\nreal_server 192.168.56.101 80 {\n    weight 1\n    TCP_CHECK {\n        connect_timeout 3\n        retry 3\n        delay_before_retry 2\n    }\n}\n```", "```\nKeepalived_healthcheckers: Activating healthchecker for service [192.168.56.101]:tcp:80 for VS [192.168.56.1]:tcp:80\nKeepalived: Startup complete\nKeepalived_healthcheckers: TCP_CHECK on service [192.168.56.101]:tcp:80 failed.\nKeepalived_healthcheckers: Removing service [192.168.56.101]:tcp:80 from VS [192.168.56.1]:tcp:80\n```", "```\nreal_server 192.168.56.101 80 {\n    MISC_CHECK {\n        misc_path \"/tmp/my_check.sh\"\n        misc_timeout 5\n        user nobody\n    }\n}\n```", "```\n$ cat index.xhtml\n<!DOCTYPE html>\n<html>\n  <body>\n    <p>hello world</p>\n  </body>\n</html>\n$ md5sum index.xhtml\nfecf605e44acaaab933e7b509dbde185  index.xhtml\n```", "```\n$ genhash --verbose --server 192.168.56.101 --port 80 --url /index.xhtml\n----------[    HTTP Header Buffer    ]----------\n0000  48 54 54 50 2f 31 2e 30 - 20 32 30 30 20 4f 4b 0d   HTTP/1.0 200 OK.\n...\n----------[ HTTP Header Ascii Buffer ]----------\nHTTP/1.0 200 OK\n...\n----------[        HTML Buffer        ]----------\n0000  3c 21 44 4f 43 54 59 50 - 45 20 68 74 6d 6c 3e 0a   <!DOCTYPE html>.\n...\n---------[    HTML hash resulting    ]---------\n0000  fe cf 60 5e 44 ac aa ab - 93 3e 7b 50 9d bd e1 85   ..`^D....>{P....\n--------[ HTML hash final resulting ]--------\nfecf605e44acaaab933e7b509dbde185\nGlobal response time for [/index.xhtml] = 2468 usecs\n```", "```\nreal_server 192.168.56.101 80 {\n    weight 1\n    HTTP_GET {\n         url {\n             path /index.xhtml\n             digest fecf605e44acaaab933e7b509dbde185\n        }\n        connect_timeout 3\n        retry 3\n        delay_before_retry 2\n    }\n}\n```", "```\nglobal_defs {\n    notification_email {\n        admin@example.com\n        webmaster@example.com\n    }\n    notification_email_from keepalived@example.com\n    smtp_server 203.0.113.100\n    smtp_connect_timeout 30\n}\n```", "```\nfrontend main\n    bind *:80\n    acl url_static path_beg -i /static /images /javascript /stylesheets\n    acl url_static path_end -i .jpg .gif .png .css .js\n    use_backend static          if url_static\n    default_backend             app\nbackend static\n    balance     roundrobin\n    server static 192.168.56.200:80 check\nbackend app\n    balance     roundrobin\n    server  srv1 192.168.56.101:5000 check\n    server  srv2 192.168.56.102:5000 check\n```"]