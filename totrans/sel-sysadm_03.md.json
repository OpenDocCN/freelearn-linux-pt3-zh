["```\n$ grep ^SELINUX= /etc/selinux/config\nSELINUX=enforcing\n```", "```\n$ sestatus | grep mode\nCurrent mode:\tenforcing\n$ getenforce\nEnforcing\n```", "```\n$ cat /sys/fs/selinux/enforce\n1\n```", "```\n# setenforce 0\n```", "```\n# echo 0 > /sys/fs/selinux/enforce\n```", "```\n# setsebool -P secure_mode_policyload on\n```", "```\n# semanage permissive -a minidlna_t\n```", "```\n# semanage permissive -l\nBuiltin Permissive Types\nCustomized Permissive Types\nminidlna_t\n```", "```\n# semodule -l | grep permissive_\npermissive_minidlna_t\n```", "```\n# semanage permissive -d minidlna_t\n```", "```\n$ readelf -d /bin/ls | grep selinux\n0x0000000000000001 (NEEDED)\t\tShared library: [libselinux.so.1]\n$ ldd /bin/ls | grep selinux\nlibselinux.so.1 => /lib64/libselinux.so.1 (0x00005d415f3f03f0)\n$ objdump -x /bin/ls | grep selinux\nNEEDED\tlibselinux.so.1\n```", "```\ntype=AVC msg=audit(03/22/2020 12:15:38.557:2331): avc: denied { read } for pid=12569 comm=\"dmesg\" name=\"xterm-256color\" dev=\"sdb2\" ino=131523 scontext=sysadm_u:sysadm_r:dmesg_t:s0-s0:c0.c1023 tcontext=system_u:object_r:etc_t:s0 tclass=file permissive=0\n```", "```\n# echo 768 > /sys/fs/selinux/avc/cache_threshold\n```", "```\n# cat /sys/fs/selinux/avc/cache_threshold\n768\n```", "```\n$ cat /sys/fs/selinux/avc/hash_stats\nentries: 506\nbuckets used: 233/512\nlongest chain: 5\n```", "```\n$ avcstat 5\nlookups\thits\t\tmisses\tallocs\treclaims\tfrees\n58396334\t58382324\t14010\t\t14010\t\t10736\t\t13511\n591\t\t591\t\t0\t\t0\t\t0\t\t0\n1657\t\t1653\t\t4\t\t4\t\t0\t\t0\n```", "```\n$ cat /sys/fs/selinux/ss/sidtab_hash_stats\nentries: 285\nbuckets use: 55/512\nlongest chain: 3\n```", "```\n$ seinfo | grep -i audit\nAuditallow:\t1\tDontaudit:\t\t5559\nAuditallowxperm:\t0\tDontauditxperm:\t   0\n```", "```\n# semodule –-disable_dontaudit –-build\n```", "```\n# semodule -B\n```", "```\ntype=PROCTITLE msg=audit(...) : proctitle=ping 8.8.8.8 \ntype=SYSCALL msg=audit(...) : arch=x86_64 syscall=socket success=no exit=EACCES(Permission denied) a0=inet a1=SOCK_DGRAM a2=icmp a3=0x7fffac013050 items=0 ppid=2685 pid=17292 auid=admin uid=root gid=root euid=root suid=root fsuid=root egid=root sgid=root fsgid=root tty=tty1 ses=1 comm=ping exe=/bin/ping subj=sysadm_u:sysadm_r:ping_t:s0-s0:c0.c1023 key=(null) \n type=AVC msg=audit(...) : avc:  denied  { create } for  pid=17292 comm=ping scontext=sysadm_u:sysadm_r:ping_t:s0-s0:c0.c1023 tcontext=sysadm_u:sysadm_r:ping_t:s0-s0:c0.c1023 tclass=icmp_socket permissive=0 \n```", "```\n# vi /etc/audit/plugins.d/syslog.conf\nactive = yes\ndirection = out\npath = /sbin/audisp-syslog\ntype = always\nargs = LOG_INFO\nformat = string\n```", "```\n# vi /etc/audit/auditd.conf\ntcp_listen_port = 60\nlog_format = ENRICHED\nname_format = HOSTNAME\naudisp-remote plugin to connect to the target server's audit daemon, as follows:\n# vi /etc/audit/audisp-remote.conf\nremote_server = <targethostname>\nport = 60\n```", "```\n# vi /etc/audit/plugins.d/au-remote.conf\nactive = yes\n```", "```\n# aureport --avc --start recent\nAVC Report\n===============================================================\n# date time comm subj syscall class permission obj result event\n===============================================================\n...\n7\\. 03/21/2020 19:40:55 sudo sysadm_u:sysadm_r:sysadm_sudo_t:s0-s0:c0.c1023 257 dir search sysadm_u:sysadm_r:sysadm_t:s0-s0:c0.c1023 denied 1067\n...\n10\\. 03/21/2020 19:48:19 dmesg sysadm_u:sysadm_r:dmesg_t:s0-s0:c0.c1023 21 file read system_u:object_r:etc_t:s0 denied 1080\n```", "```\n# vi /etc/rsyslog.d/99-selinux.conf\n:msg, contains, \"avc: \"\t-/var/log/avc.log\n```", "```\n# dmesg | grep avc | tail\n```", "```\n# setsebool user_dmesg on\n```", "```\n$ ls /proc/1\nls: cannot access '/proc/1': Permission denied\n# ls -ldZ /proc/1\ndr-xr-xr-x. 9 root system_u:system_r:init_t:s0 0 Mar 21 10:54 /proc/1\n```", "```\n# ausearch -m avc -ts recent -i\ntype=AVC msg=audit(03/22/2020 12:15:38.557:2331): avc: denied { read } for pid=12569 comm=\"dmesg\" name=\"xterm-256color\" dev=\"sdb2\" ino=131523 scontext=sysadm_u:sysadm_r:dmesg_t:s0-s0:c0.c1023 tcontext=system_u:object_r:etc_t:s0 tclass=file permissive=0\n```", "```\ntype=AVC msg=audit(03/22/20 18:12:52.177:2326): avc:  denied  { name_bind } for  pid=15983 comm=\"nginx\" src=89 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:reserved_port_t:s0 tclass=tcp_socket permissive=0\n```", "```\ntype=USER_AVC msg=audit(03/22/2020 11:25:56.123:154) : pid=540 uid=dbus auid=unset ses=unset subj=system_u:system_r:system_dbusd_t:s0-s0:c0.c1023 msg='avc:  denied  { acquire_svc } for service=com.redhat.tuned spid=1460 scontext=system_u:system_r:tuned_t:s0 tcontext=system_u:system_r:tunned_t:s0 tclass=dbus permissive=0  exe=/usr/bin/dbus-daemon sauid=dbus hostname=? addr=? terminal=?'\n```", "```\ntype=PATH msg=audit(03/22/2020 12:25:53.104:2364) : item=0 name=/usr/sbin/rpc.nfsd inode=3019958 dev=08:12 mode=file,755 ouid=root ogid=root rdev=00:00 obj=system_u:object_r:nfsd_exec_t:s0 nametype=NORMAL cap_fp=none cap_fi=none cap_fe=0 cap_fver=0 cap_frootid=0\ntype=SELINUX_ERR msg=audit(03/22/2020 12:25:53.104:2364) : op=security_compute_sid invalid_context=sysadm_u:sysadm_r:nfsd_t:s0-s0:c0.c1023 scontext=sysadm_u:sysadm_r:sysadm_t:s0-s0:c0.c1023 tcontext=system_u:object_r:nfsd_exec_t:s0 tclass=process \n```", "```\ntype=MAC_POLICY_LOAD msg=audit(03/22/2020 12:28:17.077:2368) : auid=admin ses=1 lsm=selinux res=yes\n```", "```\ntype=MAC_CONFIG_CHANGE msg=audit(03/22/2020 12:29:49.564:2370) : bool=virt_use_nfs val=0 old_val=1 auid=admin ses=1\n```", "```\ntype=MAC_STATUS msg=audit(03/22/2020 12:30:45.200:2372) : enforcing=0 old_enforcing=1 auid=admin ses=1 enabled=1 old-enabled=1 lsm=selinux res=yes\n```", "```\n# ausearch --checkpoint /root/ausearch-checkpoint.txt -ts checkpoint\n```", "```\n# ausearch -m avc,user_avc,selinux_err -ts recent\n```", "```\nMar 22 11:40:35 ppubssa3ed setroubleshoot[1544]: SELinux is preventing /usr/sbin/nginx from name_bind access on the tcp_socket port 89\\. For complete SELinux messages run: sealert -l f2914dba-04ef-44ca-9a0b-0f5e62ec72e4\n```", "```\n# sealert -l f2914dba-04ef-44ca-9a0b-0f5e62ec72e4\nSELinux is preventing /usr/sbin/nginx from name_bind access on the tcp_socket port 89.\n*****  Plugin bind_ports (99.5 confidence) suggests   ************************\nIf you want to allow /usr/sbin/nginx to bind to network port 89\nThen you need to modify the port type.\nDo\n# semanage port -a -t PORT_TYPE -p tcp 89\n    where PORT_TYPE is one of the following: http_cache_port_t, http_port_t, jboss_management_port_t, jboss_messaging_port_t, ntop_port_t, puppet_port_t.\n*****  Plugin catchall (1.49 confidence) suggests   **************************\n...\n```", "```\n# vi /etc/setroubleshoot/setroubleshoot.conf\n[email]\nrecipients_filepath = /var/lib/setroubleshoot/email_alert_recipients\nsmtp_port = 25\nsmtp_host = localhost\nfrom_address = selinux@infra.example.com\nsubject = [infra] SELinux Alert for host infra.example.com\n```", "```\n# systemctl restart dbus\n```", "```\n# service dbus restart\n```", "```\n# ausearch -m avc -ts recent | audit2why\ntype=AVC msg=audit(1584880436.644:385): avc:  denied  { name_bind } for  pid=5119 comm=\"nginx\" src=89 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:reserved_port_t:s0 tclass=tcp_socket permissive=0\n  Was caused by:\n    Missing type enforcement (TE) allow rule.\n    You can use audit2allow to generate a loadable module to allow this access.\n```", "```\n# journalctl _SELINUX_CONTEXT=\"system_u:system_r:sssd_t:s0\"\n-- Logs begin at Sun 2020-03-22 10:43:48 UTC, end at Sun 2020-03-22 12:40:12 UTC. --\nMar 22 10:43:51 ppubssa3ed sssd[545]: Starting up\nMar 22 10:43:51 ppubssa3ed sssd[be[implicit_files]][623]: Starting up\nMar 22 10:43:51 ppubssa3ed sssd[nss][630]: Starting up\n```", "```\n# journalctl _SELINUX_CONTEXT=<tab><tab>\nkernel\nsystem_u:system_r:auditd_t:s0\nsystem_u:system_r:chronyd_t:s0\n...\n```", "```\n# journalctl -g nginx\n-- Logs begin at Sun 2020-03-22 10:43:48 UTC, end at Sun 2020-03-22 12:52:26 UTC. --\nMar 22 11:40:32 ppubssa3ed systemd[1]: Starting The nginx HTTP and reverse proxy server...\nMar 22 11:40:32 ppubssa3ed nginx[1538]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nMar 22 11:40:32 ppubssa3ed nginx[1538]: nginx: [emerg] bind() to 0.0.0.0:89 failed (13: Permission denied)\n...\nMar 22 11:40:35 ppubssa3ed setroubleshoot[1544]: SELinux is preventing /usr/sbin/nginx from name_bind access on the tcp_socket port 89\\. For complete SELinux messages run: sealert -l f2914dba-04ef-44ca-9a0b-0f5e62ec72e4\n```", "```\n$ matchpathcon /srv/www/html/index.html\n/srv/www/html/index.html\tsystem_u:object_r:httpd_sys_content_t:s0\n```", "```\n$ man ftpd_selinux\n```"]