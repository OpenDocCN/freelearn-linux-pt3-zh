<html><head></head><body>
  <div id="_idContainer045" class="Basic-Text-Frame">
    <h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">4</span></h1>
    <h1 id="_idParaDest-66" class="chapterTitle"><span class="koboSpan" id="kobo.2.1">Understanding Input/Output Redirection</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.3.1">In the previous chapter, we discussed how to use variables and pipelines in a shell. </span><span class="koboSpan" id="kobo.3.2">This time, we’ll look at how to send the text output of a command to somewhere other than the terminal, which is the default output device. </span><span class="koboSpan" id="kobo.3.3">We’ll then look at how to make a command bring in text from somewhere other than the keyboard, which is the default input device. </span><span class="koboSpan" id="kobo.3.4">Finally, we’ll look at how to send error messages to somewhere other than the terminal.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.4.1">Topics in this chapter include:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.5.1">Understanding </span><code class="inlineCode"><span class="koboSpan" id="kobo.6.1">stdout</span></code></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.7.1">Understanding </span><code class="inlineCode"><span class="koboSpan" id="kobo.8.1">stdin</span></code></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.9.1">Understanding </span><code class="inlineCode"><span class="koboSpan" id="kobo.10.1">stderr</span></code></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.11.1">Understanding </span><code class="inlineCode"><span class="koboSpan" id="kobo.12.1">tee</span></code></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.13.1">Okay, let’s get started.</span></p>
    <h1 id="_idParaDest-67" class="heading 1"><span class="koboSpan" id="kobo.14.1">Introduction to Input/Output Redirection</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.15.1">In order to extract information</span><a id="_idIndexMarker150"/><span class="koboSpan" id="kobo.16.1"> from different sources and format it for presentation, we’ll often need to use various</span><a id="_idIndexMarker151"/><span class="koboSpan" id="kobo.17.1"> utilities that are collectively known as </span><strong class="keyWord"><span class="koboSpan" id="kobo.18.1">text stream filters</span></strong><span class="koboSpan" id="kobo.19.1">. </span><span class="koboSpan" id="kobo.19.2">When you work with text-stream filtering utilities, it only makes sense that you would need a way to feed them some sort of input. </span><span class="koboSpan" id="kobo.19.3">It also makes sense that you would need a way to see the output, and to see error messages if something goes wrong. </span><span class="koboSpan" id="kobo.19.4">For these purposes, we have </span><code class="inlineCode"><span class="koboSpan" id="kobo.20.1">stdin</span></code><span class="koboSpan" id="kobo.21.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.22.1">stdout</span></code><span class="koboSpan" id="kobo.23.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.24.1">stderr</span></code><span class="koboSpan" id="kobo.25.1">.</span></p>
    <ul>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.26.1">stdin</span></code><span class="koboSpan" id="kobo.27.1">: This is short for </span><em class="italic"><span class="koboSpan" id="kobo.28.1">standard input</span></em><span class="koboSpan" id="kobo.29.1">. </span><span class="koboSpan" id="kobo.29.2">By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.30.1">stdin</span></code><span class="koboSpan" id="kobo.31.1"> comes</span><a id="_idIndexMarker152"/><span class="koboSpan" id="kobo.32.1"> from the keyboard. </span><span class="koboSpan" id="kobo.32.2">However, by using pipes or redirectors, you can also obtain </span><code class="inlineCode"><span class="koboSpan" id="kobo.33.1">stdin</span></code><span class="koboSpan" id="kobo.34.1"> from either a file or from the output of another command.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.35.1">stdout</span></code><span class="koboSpan" id="kobo.36.1"> : This is short for </span><em class="italic"><span class="koboSpan" id="kobo.37.1">standard output</span></em><span class="koboSpan" id="kobo.38.1">. </span><span class="koboSpan" id="kobo.38.2">By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.39.1">stdout</span></code><span class="koboSpan" id="kobo.40.1"> gets</span><a id="_idIndexMarker153"/><span class="koboSpan" id="kobo.41.1"> sent to your computer screen. </span><span class="koboSpan" id="kobo.41.2">You can use pipes to have </span><code class="inlineCode"><span class="koboSpan" id="kobo.42.1">stdout</span></code><span class="koboSpan" id="kobo.43.1"> become the </span><code class="inlineCode"><span class="koboSpan" id="kobo.44.1">stdin</span></code><span class="koboSpan" id="kobo.45.1"> for another command, or you can use redirectors to save the </span><code class="inlineCode"><span class="koboSpan" id="kobo.46.1">stdout</span></code><span class="koboSpan" id="kobo.47.1"> as a file on a storage device. </span><span class="koboSpan" id="kobo.47.2">If you don’t want to see any output at all, just use redirectors to send </span><code class="inlineCode"><span class="koboSpan" id="kobo.48.1">stdout</span></code><span class="koboSpan" id="kobo.49.1"> to the proverbial </span><em class="italic"><span class="koboSpan" id="kobo.50.1">bit bucket</span></em><span class="koboSpan" id="kobo.51.1">.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.52.1">stderr</span></code><span class="koboSpan" id="kobo.53.1">: As you may have</span><a id="_idIndexMarker154"/><span class="koboSpan" id="kobo.54.1"> guessed, this is short for </span><em class="italic"><span class="koboSpan" id="kobo.55.1">standard error</span></em><span class="koboSpan" id="kobo.56.1">. </span><span class="koboSpan" id="kobo.56.2">If a command doesn’t execute properly, you’ll receive an error message. </span><span class="koboSpan" id="kobo.56.3">By default, the message shows up on the screen. </span><span class="koboSpan" id="kobo.56.4">However, you can use pipes or redirectors to change </span><code class="inlineCode"><span class="koboSpan" id="kobo.57.1">stderr</span></code><span class="koboSpan" id="kobo.58.1">'s destination, just the same as you can with </span><code class="inlineCode"><span class="koboSpan" id="kobo.59.1">stdout</span></code><span class="koboSpan" id="kobo.60.1">.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.61.1">I’ve told you before that everything</span><a id="_idIndexMarker155"/><span class="koboSpan" id="kobo.62.1"> on a Linux, Unix, or Unix-like systems such as FreeBSD or OpenIndiana is represented by a file. </span><code class="inlineCode"><span class="koboSpan" id="kobo.63.1">stdin</span></code><span class="koboSpan" id="kobo.64.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.65.1">stdout</span></code><span class="koboSpan" id="kobo.66.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.67.1">stderr</span></code><span class="koboSpan" id="kobo.68.1"> are represented on a Linux system by files in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.69.1">/proc/</span></code><span class="koboSpan" id="kobo.70.1"> filesystem. </span><span class="koboSpan" id="kobo.70.2">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.71.1">/dev/</span></code><span class="koboSpan" id="kobo.72.1"> directory, there are symbolic links that point to these files, as we see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.73.1">[donnie@fedora ~]$ cd /dev
[donnie@fedora dev]$ ls -l std*
lrwxrwxrwx. </span><span class="koboSpan" id="kobo.73.2">1 root root 15 Aug 11 13:29 stderr -&gt; /proc/self/fd/2
lrwxrwxrwx. </span><span class="koboSpan" id="kobo.73.3">1 root root 15 Aug 11 13:29 stdin -&gt; /proc/self/fd/0
lrwxrwxrwx. </span><span class="koboSpan" id="kobo.73.4">1 root root 15 Aug 11 13:29 stdout -&gt; /proc/self/fd/1
[donnie@fedora dev]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.74.1">Note that the lowest-level subdirectory</span><a id="_idIndexMarker156"/><span class="koboSpan" id="kobo.75.1"> where these files are found is </span><code class="inlineCode"><span class="koboSpan" id="kobo.76.1">fd</span></code><span class="koboSpan" id="kobo.77.1">, which stands for </span><strong class="keyWord"><span class="koboSpan" id="kobo.78.1">file descriptor</span></strong><span class="koboSpan" id="kobo.79.1">. </span><span class="koboSpan" id="kobo.79.2">So, these files that represent </span><code class="inlineCode"><span class="koboSpan" id="kobo.80.1">stdin</span></code><span class="koboSpan" id="kobo.81.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.82.1">stdout</span></code><span class="koboSpan" id="kobo.83.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.84.1">stderr</span></code><span class="koboSpan" id="kobo.85.1"> are collectively known as file descriptors.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.86.1">I’m not going to delve into the nitty-gritty details of how this works, because it’s not really necessary. </span><span class="koboSpan" id="kobo.86.2">The only part of this that you really need to know is the ID numbers of the file descriptors, which are as follows:</span></p>
    <ul>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.87.1">0</span></code><span class="koboSpan" id="kobo.88.1">: This is for </span><code class="inlineCode"><span class="koboSpan" id="kobo.89.1">stdin</span></code><span class="koboSpan" id="kobo.90.1">.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.91.1">1</span></code><span class="koboSpan" id="kobo.92.1">: This is for </span><code class="inlineCode"><span class="koboSpan" id="kobo.93.1">stdout</span></code><span class="koboSpan" id="kobo.94.1">.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.95.1">2</span></code><span class="koboSpan" id="kobo.96.1">: This is for </span><code class="inlineCode"><span class="koboSpan" id="kobo.97.1">stderr</span></code><span class="koboSpan" id="kobo.98.1">.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.99.1">Remembering the numbers of these file descriptors, which are the same across all Linux, Unix/Unix-like systems, will help you understand some concepts that I’ll present later in this chapter.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.100.1">Here’s what you can do with redirectors:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.101.1">Direct a command to obtain its input (</span><code class="inlineCode"><span class="koboSpan" id="kobo.102.1">stdin</span></code><span class="koboSpan" id="kobo.103.1">) from someplace other than the keyboard.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.104.1">Have a command send its output (</span><code class="inlineCode"><span class="koboSpan" id="kobo.105.1">stdout</span></code><span class="koboSpan" id="kobo.106.1">) to someplace other than the computer screen.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.107.1">Have a command send its error messages (</span><code class="inlineCode"><span class="koboSpan" id="kobo.108.1">stderr</span></code><span class="koboSpan" id="kobo.109.1">) to somplace other than the computer screen.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.110.1">There are several operator symbols</span><a id="_idIndexMarker157"/><span class="koboSpan" id="kobo.111.1"> that you’ll use with redirectors. </span><span class="koboSpan" id="kobo.111.2">Most are easy to understand, but you may find that the ones associated with </span><code class="inlineCode"><span class="koboSpan" id="kobo.112.1">stderr</span></code><span class="koboSpan" id="kobo.113.1"> are a bit confusing. </span><span class="koboSpan" id="kobo.113.2">Not to worry though, because I’m here to help. </span><span class="koboSpan" id="kobo.113.3">Let’s start by taking a look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.114.1">stdout</span></code><span class="koboSpan" id="kobo.115.1"> family of operators, which consists of </span><code class="inlineCode"><span class="koboSpan" id="kobo.116.1">&gt;</span></code><span class="koboSpan" id="kobo.117.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.118.1">&gt;|</span></code><span class="koboSpan" id="kobo.119.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.120.1">&gt;&gt;</span></code><span class="koboSpan" id="kobo.121.1">.</span></p>
    <h1 id="_idParaDest-68" class="heading 1"><span class="koboSpan" id="kobo.122.1">Understanding stdout</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.123.1">Let’s say that you want</span><a id="_idIndexMarker158"/><span class="koboSpan" id="kobo.124.1"> to look at the listing of files that are in a certain directory. </span><span class="koboSpan" id="kobo.124.2">Instead of piping the </span><code class="inlineCode"><span class="koboSpan" id="kobo.125.1">ls</span></code><span class="koboSpan" id="kobo.126.1"> output into </span><code class="inlineCode"><span class="koboSpan" id="kobo.127.1">less</span></code><span class="koboSpan" id="kobo.128.1">, you want to create a text file of this listing so that you can print it later. </span><span class="koboSpan" id="kobo.128.2">Here’s a graphical representation of how it works:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.129.1"><img src="../Images/B21693_04_01.png" alt=""/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.130.1">Figure 4.1: How stdout works</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.131.1">Here’s what it looks like in practice, where I’m sending output from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.132.1">ls</span></code><span class="koboSpan" id="kobo.133.1"> command to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.134.1">filelist.txt</span></code><span class="koboSpan" id="kobo.135.1"> file:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.136.1">[donnie@fedora ~]$ ls &gt; filelist.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.137.1">As you can see, this is fairly simple. </span><span class="koboSpan" id="kobo.137.2">You can take pretty much any command that normally sends its output to the computer screen, and have it sent to a text file instead. </span><span class="koboSpan" id="kobo.137.3">There is one thing that you have to be careful with, though. </span><span class="koboSpan" id="kobo.137.4">If you redirect a command’s output to a file that already exists, you will overwrite it, and all previous information</span><a id="_idIndexMarker159"/><span class="koboSpan" id="kobo.138.1"> in that file will be lost. </span><span class="koboSpan" id="kobo.138.2">There are three ways to prevent this from happening.</span></p>
    <h2 id="_idParaDest-69" class="heading 2"><span class="koboSpan" id="kobo.139.1">Preventing File Overwrites</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.140.1">In this section, I’ll show you two ways</span><a id="_idIndexMarker160"/><span class="koboSpan" id="kobo.141.1"> to prevent overwriting existing files, which are:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.142.1">Ensure that an existing file with same name as the file that you want to create doesn’t already exist.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.143.1">Set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.144.1">noclobber</span></code><span class="koboSpan" id="kobo.145.1"> option.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.146.1">Let’s look at both of these methods.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.147.1">The first way to prevent accidentally overwriting an important file is the most obvious. </span><span class="koboSpan" id="kobo.147.2">That is, before you redirect output to a file, make sure that a file of that name doesn’t already exist. </span><span class="koboSpan" id="kobo.147.3">Later, I’ll show you how trivial it is to write shell script code that will check for this.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.148.1">The second way is to set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.149.1">noclobber</span></code><span class="koboSpan" id="kobo.150.1"> option for your shell environment, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.151.1">[donnie@fedora ~]$ set -o noclobber
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.152.1">You can set this option either from the command-line or from within a shell script. </span><span class="koboSpan" id="kobo.152.2">With this option set, </span><code class="inlineCode"><span class="koboSpan" id="kobo.153.1">bash</span></code><span class="koboSpan" id="kobo.154.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.155.1">zsh</span></code><span class="koboSpan" id="kobo.156.1"> will issue an error message if you try to use a redirector to overwrite a file, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.157.1">[donnie@fedora ~]$ ls -la &gt; filelist.txt
bash: filelist.txt: cannot overwrite existing file
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.158.1">However, if you really want to overwrite a file with this option set, you can do so by making a slight modification to the redirection command. </span><span class="koboSpan" id="kobo.158.2">Just use </span><code class="inlineCode"><span class="koboSpan" id="kobo.159.1">&gt;|</span></code><span class="koboSpan" id="kobo.160.1"> for your operator instead of just a plain </span><code class="inlineCode"><span class="koboSpan" id="kobo.161.1">&gt;</span></code><span class="koboSpan" id="kobo.162.1">, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.163.1">[donnie@fedora ~]$ ls -la &gt;| filelist.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.164.1">There was no error message this time, which means</span><a id="_idIndexMarker161"/><span class="koboSpan" id="kobo.165.1"> that I really did overwrite the file.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.166.1">Be aware that when you set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.167.1">noclobber</span></code><span class="koboSpan" id="kobo.168.1"> option, it’s not a permanent setting. </span><span class="koboSpan" id="kobo.168.2">It will go away as soon as you exit from your </span><code class="inlineCode"><span class="koboSpan" id="kobo.169.1">bash</span></code><span class="koboSpan" id="kobo.170.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.171.1">zsh</span></code><span class="koboSpan" id="kobo.172.1"> session. </span><span class="koboSpan" id="kobo.172.2">(This includes when you close your terminal emulator window.) Also be aware that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.173.1">noclobber</span></code><span class="koboSpan" id="kobo.174.1"> option will not prevent you from losing your files by overwriting them with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.175.1">mv</span></code><span class="koboSpan" id="kobo.176.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.177.1">cp</span></code><span class="koboSpan" id="kobo.178.1"> commands. </span><span class="koboSpan" id="kobo.178.2">It also won’t stop you from deleting them with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.179.1">rm</span></code><span class="koboSpan" id="kobo.180.1"> command.</span></p>
    </div>
    <h2 id="_idParaDest-70" class="heading 2"><span class="koboSpan" id="kobo.181.1">Using the File Descriptor</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.182.1">I told you just a bit ago that the file descriptor</span><a id="_idIndexMarker162"/><span class="koboSpan" id="kobo.183.1"> for </span><code class="inlineCode"><span class="koboSpan" id="kobo.184.1">stdout</span></code><span class="koboSpan" id="kobo.185.1"> is the number </span><code class="inlineCode"><span class="koboSpan" id="kobo.186.1">1</span></code><span class="koboSpan" id="kobo.187.1">. </span><span class="koboSpan" id="kobo.187.2">If you really wanted to, you could include this file descriptor in any of the commands that I’ve shown you, which would look something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.188.1">[donnie@fedora ~]$ ls 1&gt; filelist.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.189.1">“What’s the advantage of this?”, you’re wondering. </span><span class="koboSpan" id="kobo.189.2">Well, in this case, there is none. </span><span class="koboSpan" id="kobo.189.3">Leave out the </span><code class="inlineCode"><span class="koboSpan" id="kobo.190.1">1</span></code><span class="koboSpan" id="kobo.191.1">, and things will work just as well. </span><span class="koboSpan" id="kobo.191.2">But, in a few pages, we’ll be talking about </span><code class="inlineCode"><span class="koboSpan" id="kobo.192.1">stderr</span></code><span class="koboSpan" id="kobo.193.1">. </span><span class="koboSpan" id="kobo.193.2">That’s where the file descriptor ID numbers </span><em class="italic"><span class="koboSpan" id="kobo.194.1">will</span></em><span class="koboSpan" id="kobo.195.1"> come in handy.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.196.1">Okay, that’s enough about getting things out. </span><span class="koboSpan" id="kobo.196.2">Now, let’s get some things in.</span></p>
    <h1 id="_idParaDest-71" class="heading 1"><span class="koboSpan" id="kobo.197.1">Understanding stdin</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.198.1">This will be a bit easier, since only one operator symbol</span><a id="_idIndexMarker163"/><span class="koboSpan" id="kobo.199.1"> is involved. </span><span class="koboSpan" id="kobo.199.2">Here’s the graphical representation:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.200.1"><img src="../Images/B21693_04_02.png" alt=""/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.201.1">Figure 4.2: How stdin works</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.202.1">For our example, we’ll briefly look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.203.1">tr</span></code><span class="koboSpan" id="kobo.204.1"> utility. </span><span class="koboSpan" id="kobo.204.2">(We’ll give </span><code class="inlineCode"><span class="koboSpan" id="kobo.205.1">tr</span></code><span class="koboSpan" id="kobo.206.1"> a more in-depth explanation in </span><em class="chapterRef"><span class="koboSpan" id="kobo.207.1">Chapter 7, Text Stream Filters-Part 2</span></em><span class="koboSpan" id="kobo.208.1">. </span><span class="koboSpan" id="kobo.208.2">For now, let’s just say that it’s a utility that </span><em class="italic"><span class="koboSpan" id="kobo.209.1">translates</span></em><span class="koboSpan" id="kobo.210.1"> things.) By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.211.1">tr </span></code><span class="koboSpan" id="kobo.212.1">would take its </span><code class="inlineCode"><span class="koboSpan" id="kobo.213.1">stdin</span></code><span class="koboSpan" id="kobo.214.1"> from the keyboard. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.215.1">One thing you can do is to type a text string in all lower-case, and have </span><code class="inlineCode"><span class="koboSpan" id="kobo.216.1">tr</span></code><span class="koboSpan" id="kobo.217.1"> echo it back to you in all upper-case. </span><span class="koboSpan" id="kobo.217.2">Hit the </span><em class="keystroke"><span class="koboSpan" id="kobo.218.1">Enter</span></em><span class="koboSpan" id="kobo.219.1"> key after you’ve typed the </span><code class="inlineCode"><span class="koboSpan" id="kobo.220.1">tr [:lower:] [:upper:]</span></code><span class="koboSpan" id="kobo.221.1"> command, and hit it again after you’ve typed your line of text. </span><span class="koboSpan" id="kobo.221.2">When the upper-case line comes up, hit </span><em class="keystroke"><span class="koboSpan" id="kobo.222.1">Ctrl-d</span></em><span class="koboSpan" id="kobo.223.1"> to exit </span><code class="inlineCode"><span class="koboSpan" id="kobo.224.1">tr</span></code><span class="koboSpan" id="kobo.225.1">. </span><span class="koboSpan" id="kobo.225.2">It should look something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.226.1">[donnie@fedora ~]$ tr [:lower:] [:upper:]
i only want to type in all upper-case letters.
</span><span class="koboSpan" id="kobo.226.2">I ONLY WANT TO TYPE IN ALL UPPER-CASE LETTERS.
</span><span class="koboSpan" id="kobo.226.3">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.227.1">If you need for </span><code class="inlineCode"><span class="koboSpan" id="kobo.228.1">tr</span></code><span class="koboSpan" id="kobo.229.1"> to take its input from a file, just add the appropriate redirector operator and the filename, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.230.1">[donnie@fedora ~]$ tr [:lower:] [:upper:] &lt; filelist.txt
15827_ZIP.ZIP
2023-08-01_15-23-31.MP4
2023-08-01_16-26-12.MP4
2023-08-02_13-57-37.MP4
21261.ZIP
. </span><span class="koboSpan" id="kobo.230.2">. </span><span class="koboSpan" id="kobo.230.3">.
</span><span class="koboSpan" id="kobo.230.4">. </span><span class="koboSpan" id="kobo.230.5">. </span><span class="koboSpan" id="kobo.230.6">.
</span><span class="koboSpan" id="kobo.230.7">YAD-FORM.SH
ZONEINFO.ZIP
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.231.1">This won’t change</span><a id="_idIndexMarker164"/><span class="koboSpan" id="kobo.232.1"> the original file. </span><span class="koboSpan" id="kobo.232.2">It will only cause the file contents to be displayed on screen in all upper-case letters. </span><span class="koboSpan" id="kobo.232.3">If you want to save this converted output to another file, just add one of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.233.1">stdout</span></code><span class="koboSpan" id="kobo.234.1"> operators and a new filename, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.235.1">[donnie@fedora ~]$ tr [:lower:] [:upper:] &lt; filelist.txt &gt; filelist_2.txt
[donnie@fedora ~]$
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.236.1">When you use this trick, you’ll always need to specify a new filename for the output. </span><span class="koboSpan" id="kobo.236.2">If you use this trick to try to just modify the original file, you’ll end up with nothing but a file with no contents. </span><span class="koboSpan" id="kobo.236.3">So, entering this would be a bad thing:</span></p>
      <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.237.1">[donnie@localhost ~]$ tr [:lower:] [:upper:] &lt; filelist.txt &gt; filelist.txt
[donnie@localhost ~]$
</span></code></pre>
      <p class="normal"><span class="koboSpan" id="kobo.238.1">Of course, you could also use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.239.1">&gt;&gt;</span></code><span class="koboSpan" id="kobo.240.1"> operator in this trick to append the new information to the original file, like so:</span></p>
      <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.241.1">    [donnie@localhost ~]$ tr [:lower:] [:upper:] &lt; testfile.txt &gt;&gt; testfile.txt
    [donnie@localhost ~]$
</span></code></pre>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.242.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.243.1">stdin</span></code><span class="koboSpan" id="kobo.244.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.245.1">stdout</span></code><span class="koboSpan" id="kobo.246.1"> operators are fairly easy to understand. </span><span class="koboSpan" id="kobo.246.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.247.1">stderr</span></code><span class="koboSpan" id="kobo.248.1"> operator isn’t hard, but some aspects</span><a id="_idIndexMarker165"/><span class="koboSpan" id="kobo.249.1"> of it can be a bit tricky. </span><span class="koboSpan" id="kobo.249.2">So, before getting started, sit back, take a deep breath and relax. </span><span class="koboSpan" id="kobo.249.3">Ready? </span><span class="koboSpan" id="kobo.249.4">Good, let’s go.</span></p>
    <h1 id="_idParaDest-72" class="heading 1"><span class="koboSpan" id="kobo.250.1">Understanding stderr</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.251.1">The redirector operators</span><a id="_idIndexMarker166"/><span class="koboSpan" id="kobo.252.1"> for </span><code class="inlineCode"><span class="koboSpan" id="kobo.253.1">stderr</span></code><span class="koboSpan" id="kobo.254.1"> are </span><code class="inlineCode"><span class="koboSpan" id="kobo.255.1">2&gt;</span></code><span class="koboSpan" id="kobo.256.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.257.1">2&gt;&gt;</span></code><span class="koboSpan" id="kobo.258.1">. </span><span class="koboSpan" id="kobo.258.2">If you’re wondering why, it’s because of the file descriptor ID numbers that we looked at a few pages ago. </span><span class="koboSpan" id="kobo.258.3">The ID number for </span><code class="inlineCode"><span class="koboSpan" id="kobo.259.1">stderr</span></code><span class="koboSpan" id="kobo.260.1"> just happens to be </span><code class="inlineCode"><span class="koboSpan" id="kobo.261.1">2</span></code><span class="koboSpan" id="kobo.262.1">. </span><span class="koboSpan" id="kobo.262.2">As always, here’s the graphical representation:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.263.1"><img src="../Images/B21693_04_03.png" alt=""/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.264.1">Figure 4.3: How stderr works</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.265.1">If you run a command and something goes wrong, it will output an error message via </span><code class="inlineCode"><span class="koboSpan" id="kobo.266.1">stderr</span></code><span class="koboSpan" id="kobo.267.1">. </span><span class="koboSpan" id="kobo.267.2">By default, this message will get sent to the computer screen. </span><span class="koboSpan" id="kobo.267.3">Also by default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.268.1">stderr</span></code><span class="koboSpan" id="kobo.269.1"> messages get mixed in with </span><code class="inlineCode"><span class="koboSpan" id="kobo.270.1">stdout</span></code><span class="koboSpan" id="kobo.271.1"> messages. </span><span class="koboSpan" id="kobo.271.2">So, if your command outputs both good data and error messages, you’ll have to scroll through the output messages on your screen to separate the two. </span><span class="koboSpan" id="kobo.271.3">Fortunately, you can use redirectors to change that behavior. </span><span class="koboSpan" id="kobo.271.4">To show how this works, let’s take another look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.272.1">find</span></code><span class="koboSpan" id="kobo.273.1"> utility that we discussed in </span><em class="chapterRef"><span class="koboSpan" id="kobo.274.1">Chapter 2, Interpreting Commands</span></em><span class="koboSpan" id="kobo.275.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.276.1">If you’re logged on to a computer as a normal user and you use </span><code class="inlineCode"><span class="koboSpan" id="kobo.277.1">find</span></code><span class="koboSpan" id="kobo.278.1"> to search through an entire file system, you’ll get error messages when </span><code class="inlineCode"><span class="koboSpan" id="kobo.279.1">find</span></code><span class="koboSpan" id="kobo.280.1"> tries to access directories that you don’t have permission to access. </span><span class="koboSpan" id="kobo.280.2">You’ll also get good output, but note how the good is mixed</span><a id="_idIndexMarker167"/><span class="koboSpan" id="kobo.281.1"> in with the bad in this example:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.282.1">[donnie@fedora ~]$ find / -name README
find: '/boot/loader/entries': Permission denied
find: '/boot/lost+found': Permission denied
find: '/boot/efi': Permission denied
find: '/boot/grub2': Permission denied
find: '/dev/vboxusb': Permission denied
/home/donnie/.cache/go-build/README
. </span><span class="koboSpan" id="kobo.282.2">. </span><span class="koboSpan" id="kobo.282.3">.
</span><span class="koboSpan" id="kobo.282.4">. </span><span class="koboSpan" id="kobo.282.5">. </span><span class="koboSpan" id="kobo.282.6">.
</span><span class="koboSpan" id="kobo.282.7">/home/donnie/Downloads/lynis/README
/home/donnie/Downloads/lynis/extras/README
/home/donnie/Downloads/lynis/plugins/README
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.283.1">If you append a </span><code class="inlineCode"><span class="koboSpan" id="kobo.284.1">2&gt;</span></code><span class="koboSpan" id="kobo.285.1"> redirector and a filename to this command, you can send the error messages to a text file so that you can just look at the good data on the screen. </span><span class="koboSpan" id="kobo.285.2">Here’s how that looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.286.1">[donnie@fedora ~]$ find / -name README 2&gt; find_error.txt
/home/donnie/.cache/go-build/README
/home/donnie/.local/share/containers/storage/overlay/994393dc58e7931862558d06e46aa2bb17487044f670f310dffe1d24e4d1eec7/diff/etc/profile.d/README
/home/donnie/.local/share/containers/storage/overlay/63ba8d57fba258ed8ccaec2ef1fd9e3e27e93f7f23d0683bd83687322a68ed29/diff/etc/fonts/conf.d/README
. </span><span class="koboSpan" id="kobo.286.2">. </span><span class="koboSpan" id="kobo.286.3">.
</span><span class="koboSpan" id="kobo.286.4">. </span><span class="koboSpan" id="kobo.286.5">. </span><span class="koboSpan" id="kobo.286.6">.
</span><span class="koboSpan" id="kobo.286.7">/home/donnie/Downloads/lynis/README
/home/donnie/Downloads/lynis/extras/README
/home/donnie/Downloads/lynis/plugins/README
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.287.1">You can combine redirectors to have </span><code class="inlineCode"><span class="koboSpan" id="kobo.288.1">stdout</span></code><span class="koboSpan" id="kobo.289.1"> sent to one text file, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.290.1">stderr</span></code><span class="koboSpan" id="kobo.291.1"> sent to another text file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.292.1">[donnie@fedora ~]$ find / -name README &gt; find_results.txt 2&gt; find_error.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.293.1">If you don’t want to see any error messages at all, just send </span><code class="inlineCode"><span class="koboSpan" id="kobo.294.1">stderr</span></code><span class="koboSpan" id="kobo.295.1"> to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.296.1">/dev/null</span></code><span class="koboSpan" id="kobo.297.1"> device, which is known in some circles</span><a id="_idIndexMarker168"/><span class="koboSpan" id="kobo.298.1"> as the infamous </span><em class="italic"><span class="koboSpan" id="kobo.299.1">bit bucket</span></em><span class="koboSpan" id="kobo.300.1">. </span><span class="koboSpan" id="kobo.300.2">Anything sent there will never see the light of day. </span><span class="koboSpan" id="kobo.300.3">Here’s how that looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.301.1">[donnie@fedora ~]$ find / -name README 2&gt; /dev/null
/home/donnie/.cache/go-build/README
/home/donnie/.local/share/containers/storage/overlay/994393dc58e7931862558d06e46aa2bb17487044f670f310dffe1d24e4d1eec7/diff/etc/profile.d/README
/home/donnie/.local/share/containers/storage/overlay/63ba8d57fba258ed8ccaec2ef1fd9e3e27e93f7f23d0683bd83687322a68ed29/diff/etc/fonts/conf.d/README
. </span><span class="koboSpan" id="kobo.301.2">. </span><span class="koboSpan" id="kobo.301.3">.
</span><span class="koboSpan" id="kobo.301.4">. </span><span class="koboSpan" id="kobo.301.5">. </span><span class="koboSpan" id="kobo.301.6">.
</span><span class="koboSpan" id="kobo.301.7">/home/donnie/Downloads/lynis/README
/home/donnie/Downloads/lynis/extras/README
/home/donnie/Downloads/lynis/plugins/README
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.302.1">If you want to send the good data to the bit bucket so that you’ll see nothing but error messages, you can use this command:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.303.1">[donnie@fedora ~]$ find / -name README &gt; /dev/null
find: '/boot/loader/entries': Permission denied
find: '/boot/lost+found': Permission denied
find: '/boot/efi': Permission denied
find: '/boot/grub2': Permission denied
. </span><span class="koboSpan" id="kobo.303.2">. </span><span class="koboSpan" id="kobo.303.3">.
</span><span class="koboSpan" id="kobo.303.4">. </span><span class="koboSpan" id="kobo.303.5">. </span><span class="koboSpan" id="kobo.303.6">.
</span><span class="koboSpan" id="kobo.303.7">find: '/var/tmp/systemd-private-075495f99a0e4571a4507a921ef61dab-chronyd.service-vVTD10': Permission denied
find: '/var/tmp/systemd-private-075495f99a0e4571a4507a921ef61dab-ModemManager.service-CG1GeZ': Permission denied
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.304.1">You can also append error messages to an existing file with the 2&gt;&gt; operator, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.305.1">[donnie@fedora ~]$ cd /far 2&gt; error.txt
[donnie@fedora ~]$ cat error.txt
bash: cd: /far: No such file or directory
[donnie@fedora ~]$ cd /fat 2&gt;&gt; error.txt
[donnie@fedora ~]$ cat error.txt
bash: cd: /far: No such file or directory
bash: cd: /fat: No such file or directory
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.306.1">So far, so good. </span><span class="koboSpan" id="kobo.306.2">Now, as promised, we’ll look</span><a id="_idIndexMarker169"/><span class="koboSpan" id="kobo.307.1"> at the part that can be a bit confusing. </span><span class="koboSpan" id="kobo.307.2">Well, actually, it’s not </span><em class="italic"><span class="koboSpan" id="kobo.308.1">that</span></em><span class="koboSpan" id="kobo.309.1"> confusing. </span><span class="koboSpan" id="kobo.309.2">It’s just that we’re going to use a bit of shorthand that takes a bit of getting used to.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.310.1">Let’s say that you want to send both </span><code class="inlineCode"><span class="koboSpan" id="kobo.311.1">stdout</span></code><span class="koboSpan" id="kobo.312.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.313.1">stderr</span></code><span class="koboSpan" id="kobo.314.1"> to the same place. </span><span class="koboSpan" id="kobo.314.2">Does that mean that you have to enter the destination twice, with two different redirectors? </span><span class="koboSpan" id="kobo.314.3">Thanks to this bit of shorthand, the answer is </span><em class="italic"><span class="koboSpan" id="kobo.315.1">No</span></em><span class="koboSpan" id="kobo.316.1">. </span><span class="koboSpan" id="kobo.316.2">Here’s how it works.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.317.1">If you want both </span><code class="inlineCode"><span class="koboSpan" id="kobo.318.1">stderr</span></code><span class="koboSpan" id="kobo.319.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.320.1">stdout</span></code><span class="koboSpan" id="kobo.321.1"> to go to the same text file, just enter your command with the regular </span><code class="inlineCode"><span class="koboSpan" id="kobo.322.1">stdout</span></code><span class="koboSpan" id="kobo.323.1"> operator and destination. </span><span class="koboSpan" id="kobo.323.2">Then, at the end, append </span><code class="inlineCode"><span class="koboSpan" id="kobo.324.1">2&gt;&amp;1</span></code><span class="koboSpan" id="kobo.325.1">. </span><span class="koboSpan" id="kobo.325.2">If you need a way to help understand this, just remember that </span><code class="inlineCode"><span class="koboSpan" id="kobo.326.1">stderr</span></code><span class="koboSpan" id="kobo.327.1"> is File Descriptor ID </span><code class="inlineCode"><span class="koboSpan" id="kobo.328.1">2</span></code><span class="koboSpan" id="kobo.329.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.330.1">stdout</span></code><span class="koboSpan" id="kobo.331.1"> is File Descriptor ID </span><code class="inlineCode"><span class="koboSpan" id="kobo.332.1">1</span></code><span class="koboSpan" id="kobo.333.1">. </span><span class="koboSpan" id="kobo.333.2">So, you can read this as, </span><code class="inlineCode"><span class="koboSpan" id="kobo.334.1">stderr</span></code><em class="italic"><span class="koboSpan" id="kobo.335.1"> (ID </span></em><code class="inlineCode"><span class="koboSpan" id="kobo.336.1">2</span></code><em class="italic"><span class="koboSpan" id="kobo.337.1">) goes to the same place as </span></em><code class="inlineCode"><span class="koboSpan" id="kobo.338.1">stdout</span></code><em class="italic"><span class="koboSpan" id="kobo.339.1"> (ID </span></em><code class="inlineCode"><span class="koboSpan" id="kobo.340.1">1</span></code><em class="italic"><span class="koboSpan" id="kobo.341.1">)</span></em><span class="koboSpan" id="kobo.342.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.343.1">To have both </span><code class="inlineCode"><span class="koboSpan" id="kobo.344.1">stderr</span></code><span class="koboSpan" id="kobo.345.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.346.1">stdout </span></code><span class="koboSpan" id="kobo.347.1">of a </span><code class="inlineCode"><span class="koboSpan" id="kobo.348.1">find</span></code><span class="koboSpan" id="kobo.349.1"> operation sent to the same text file, you can enter:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.350.1">[donnie@fedora ~]$ find / -name README &gt; find_results.txt 2&gt;&amp;1
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.351.1">There may be times when you wouldn’t want any output from either </span><code class="inlineCode"><span class="koboSpan" id="kobo.352.1">stderr</span></code><span class="koboSpan" id="kobo.353.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.354.1">stdout</span></code><span class="koboSpan" id="kobo.355.1">. </span><span class="koboSpan" id="kobo.355.2">For example, if you needed to run a backup job in the background, you wouldn’t want any screen output to mess up the text file that you’re editing in the foreground. </span><span class="koboSpan" id="kobo.355.3">(You also wouldn’t need to save any of the output to a text file.) For this, you can enter something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.356.1">[donnie@fedora ~]$ find \( -iname '*.txt' -mtime -1 \) -exec cp {} /backup/ \; &gt; /dev/null 2&gt;&amp;1
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.357.1">(Note that I’ve set the permissions on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.358.1">/backup/</span></code><span class="koboSpan" id="kobo.359.1"> directory so that I can write to it with my normal user privileges.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.360.1">I think that that about</span><a id="_idIndexMarker170"/><span class="koboSpan" id="kobo.361.1"> does it for </span><code class="inlineCode"><span class="koboSpan" id="kobo.362.1">stderr</span></code><span class="koboSpan" id="kobo.363.1">. </span><span class="koboSpan" id="kobo.363.2">And now, as a no-extra-cost bonus, I’ll show you how to send your output to both the screen and a text file at the same time.</span></p>
    <h1 id="_idParaDest-73" class="heading 1"><span class="koboSpan" id="kobo.364.1">Understanding tee</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.365.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.366.1">tee</span></code><span class="koboSpan" id="kobo.367.1"> command is rather </span><a id="_idIndexMarker171"/><span class="koboSpan" id="kobo.368.1">unique, because it’s not really a normal redirector. </span><span class="koboSpan" id="kobo.368.2">Rather, it’s a utility that can take output from a command and send it to both the screen and to a file at the same time. </span><span class="koboSpan" id="kobo.368.3">So, instead of using it with a redirector symbol as we’ve been doing, you’ll send it its input via a pipe.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.369.1">If you need to see a command’s output on the screen and also save it as a text file, pipe the output of the command through the </span><code class="inlineCode"><span class="koboSpan" id="kobo.370.1">tee</span></code><span class="koboSpan" id="kobo.371.1"> utility, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.372.1">[donnie@fedora ~]$ ps a | tee ps.txt
    PID TTY      STAT   TIME COMMAND
    972 tty1     Ss+    0:00 -bash
   1005 pts/0    Ss     0:00 -bash
   1076 pts/0    R+     0:00 ps a
   1077 pts/0    S+     0:00 tee ps.txt
[donnie@fedora ~]$ ls -l ps.txt
-rw-r--r--. </span><span class="koboSpan" id="kobo.372.2">1 donnie donnie 181 Aug 12 17:29 ps.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.373.1">Note that you don’t have to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.374.1">stdout</span></code><span class="koboSpan" id="kobo.375.1"> operator (</span><code class="inlineCode"><span class="koboSpan" id="kobo.376.1">&gt;</span></code><span class="koboSpan" id="kobo.377.1">) with this command. </span><span class="koboSpan" id="kobo.377.2">The name of the text file is used as the argument for </span><code class="inlineCode"><span class="koboSpan" id="kobo.378.1">tee</span></code><span class="koboSpan" id="kobo.379.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.380.1">If you run another command with the same filename, the first file that you created will get overwritten. </span><span class="koboSpan" id="kobo.380.2">(Of course, you can prevent that by setting the </span><code class="inlineCode"><span class="koboSpan" id="kobo.381.1">noclobber</span></code><span class="koboSpan" id="kobo.382.1"> option, as I showed you just a while ago.) If you want to append output to an existing file, you can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.383.1">-a</span></code><span class="koboSpan" id="kobo.384.1"> option, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.385.1">[donnie@fedora ~]$ ps a | tee -a ps.txt
    PID TTY      STAT   TIME COMMAND
    972 tty1     Ss+    0:00 -bash
   1005 pts/0    Ss     0:00 -bash
   1087 pts/0    R+     0:00 ps a
   1088 pts/0    S+     0:00 tee -a ps.txt
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.386.1">There’s another use for </span><code class="inlineCode"><span class="koboSpan" id="kobo.387.1">tee</span></code><span class="koboSpan" id="kobo.388.1"> that you definitely</span><a id="_idIndexMarker172"/><span class="koboSpan" id="kobo.389.1"> need to know about. </span><span class="koboSpan" id="kobo.389.2">It’s just that at times, you might have to create a shell script that will automatically create or update a configuration file in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.390.1">/etc/</span></code><span class="koboSpan" id="kobo.391.1"> directory. </span><span class="koboSpan" id="kobo.391.2">It seems logical that you would use </span><code class="inlineCode"><span class="koboSpan" id="kobo.392.1">echo</span></code><span class="koboSpan" id="kobo.393.1"> and either the </span><code class="inlineCode"><span class="koboSpan" id="kobo.394.1">&gt;</span></code><span class="koboSpan" id="kobo.395.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.396.1">&gt;&gt;</span></code><span class="koboSpan" id="kobo.397.1"> operator to accomplish that. </span><span class="koboSpan" id="kobo.397.2">But, look what happens when I try that:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.398.1">[donnie@fedora ~]$ sudo echo "This is a new setting." </span><span class="koboSpan" id="kobo.398.2">&gt; /etc/someconfig.cfg
-bash: /etc/someconfig.cfg: Permission denied
[donnie@fedora ~]$ sudo echo "This is a new setting." </span><span class="koboSpan" id="kobo.398.3">&gt;| /etc/someconfig.cfg
-bash: /etc/someconfig.cfg: Permission denied
[donnie@fedora ~]$ sudo echo "This is a new setting." </span><span class="koboSpan" id="kobo.398.4">&gt;&gt; /etc/someconfig.cfg
-bash: /etc/someconfig.cfg: Permission denied
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.399.1">As you see, the shell doesn’t allow me to redirect output into a file in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.400.1">/etc/</span></code><span class="koboSpan" id="kobo.401.1"> directory, even when I use </span><code class="inlineCode"><span class="koboSpan" id="kobo.402.1">sudo</span></code><span class="koboSpan" id="kobo.403.1"> privileges. </span><span class="koboSpan" id="kobo.403.2">(Okay, you can do this if you actually log into the root user’s shell, but let’s say that we don’t want to do that.) The solution is to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.404.1">tee</span></code><span class="koboSpan" id="kobo.405.1">, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.406.1">[donnie@fedora ~]$ echo "This is a new setting." </span><span class="koboSpan" id="kobo.406.2">| sudo tee /etc/someconfig.cfg
This is a new setting.
</span><span class="koboSpan" id="kobo.406.3">[donnie@fedora ~]$ ls -l /etc/someconfig.cfg
-rw-r--r--. </span><span class="koboSpan" id="kobo.406.4">1 root root 23 Aug 12 17:47 /etc/someconfig.cfg
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.407.1">When running this from the command-line, I have to precede the </span><code class="inlineCode"><span class="koboSpan" id="kobo.408.1">tee</span></code><span class="koboSpan" id="kobo.409.1"> command with </span><code class="inlineCode"><span class="koboSpan" id="kobo.410.1">sudo</span></code><span class="koboSpan" id="kobo.411.1">. </span><span class="koboSpan" id="kobo.411.2">If you put a command like this in a shell script, you’ll be able to omit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.412.1">sudo</span></code><span class="koboSpan" id="kobo.413.1">, because you’ll be running the entire script with </span><code class="inlineCode"><span class="koboSpan" id="kobo.414.1">sudo</span></code><span class="koboSpan" id="kobo.415.1"> privileges.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.416.1">Now, as cool as </span><code class="inlineCode"><span class="koboSpan" id="kobo.417.1">tee</span></code><span class="koboSpan" id="kobo.418.1"> sounds, there is one slight catch. </span><span class="koboSpan" id="kobo.418.2">That is, </span><code class="inlineCode"><span class="koboSpan" id="kobo.419.1">tee</span></code><span class="koboSpan" id="kobo.420.1"> always sends both good output and error messages to the screen, but it only sends good output to the designated file.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.421.1">So far, it’s been pretty easy for</span><a id="_idIndexMarker173"/><span class="koboSpan" id="kobo.422.1"> you to follow along in your own shell as I’ve explained things. </span><span class="koboSpan" id="kobo.422.2">Now that things are getting a bit more complex, let’s tie things together a bit by doing an actual hands-on lab.</span></p>
    <h1 id="_idParaDest-74" class="heading 1"><span class="koboSpan" id="kobo.423.1">Hands-on Lab – Pipes, Redirectors, and find</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.424.1">For this assignment, you’ll be working</span><a id="_idIndexMarker174"/><span class="koboSpan" id="kobo.425.1"> with pipes</span><a id="_idIndexMarker175"/><span class="koboSpan" id="kobo.426.1"> and redirectors. </span><span class="koboSpan" id="kobo.426.2">To see the full effect of this exercise, you’ll need to be logged in as a normal user, and </span><em class="italic"><span class="koboSpan" id="kobo.427.1">not</span></em><span class="koboSpan" id="kobo.428.1"> as root.</span></p>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.429.1">Enter the following, noting</span><a id="_idIndexMarker176"/><span class="koboSpan" id="kobo.430.1"> that you’re deliberately typing the name of a non-existent directory in order to generate an error message.
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.431.1">find /far -iname '*'
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.432.1">Note the output, and then enter:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.433.1">find /far -iname '*' 2&gt; error.txt
cat error.txt
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.434.1">Create a listing of files and see how many there are, by entering:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.435.1">find / -iname '*.txt' &gt; filelist.txt 2&gt; error_2.txt
find / -iname '*.txt' 2&gt; /dev/null | wc -l
less filelist.txt
less error_2.txt
</span></code></pre>
      </li>
    </ol>
    <div class="note one">
      <p class="normal"><span class="koboSpan" id="kobo.436.1">If you’re logged on as a normal user instead of as root, this should generate some error messages about the fact that you don’t have permission to look in certain directories. </span><span class="koboSpan" id="kobo.436.2">The list of </span><code class="inlineCode"><span class="koboSpan" id="kobo.437.1">.txt</span></code><span class="koboSpan" id="kobo.438.1"> files will be written to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.439.1">filelist.txt</span></code><span class="koboSpan" id="kobo.440.1"> file, and the error messages will be written to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.441.1">error_2.txt</span></code><span class="koboSpan" id="kobo.442.1"> file .</span></p>
    </div>
    <ol>
      <li class="numberedList" value="4"><span class="koboSpan" id="kobo.443.1">Search for README files by entering:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.444.1">find / -name README &gt; files_and_errors.txt 2&gt;&amp;1
less files_and_errors.txt
</span></code></pre>
      </li>
    </ol>
    <p class="normal one"><span class="koboSpan" id="kobo.445.1">This time, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.446.1">2&gt;&amp;1</span></code><span class="koboSpan" id="kobo.447.1"> that’s appended to the end of the command caused the error messages and the file list to both go to the same file.</span></p>
    <ol>
      <li class="numberedList" value="5"><span class="koboSpan" id="kobo.448.1">For the next operation, you’ll send</span><a id="_idIndexMarker177"/><span class="koboSpan" id="kobo.449.1"> the file list to both the screen and to a file. </span><span class="koboSpan" id="kobo.449.2">Enter:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.450.1">find / -name README | tee filelist_2.txt
less filelist_2.txt
</span></code></pre>
      </li>
    </ol>
    <p class="normal one"><span class="koboSpan" id="kobo.451.1">Note that both the file</span><a id="_idIndexMarker178"/><span class="koboSpan" id="kobo.452.1"> list and the error messages will print on the screen, but that only the file list will go to the file.</span></p>
    <ol>
      <li class="numberedList" value="6"><span class="koboSpan" id="kobo.453.1">Create a simulated backup directory, like so:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.454.1">sudo mkdir /backup
sudo chown your_user_name:your_user_name /backup
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.455.1">Copy all of the .txt files</span><a id="_idIndexMarker179"/><span class="koboSpan" id="kobo.456.1"> that you created within the last day to the</span><code class="inlineCode"><span class="koboSpan" id="kobo.457.1"> /backup/</span></code><span class="koboSpan" id="kobo.458.1"> directory, and send all screen output to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.459.1">/dev/null</span></code><span class="koboSpan" id="kobo.460.1"> device:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.461.1">find \( -iname '*.txt' -mtime -1 \) -exec cp {} /backup/ \; &gt; /dev/null 2&gt;&amp;1
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.462.1">View the</span><a id="_idIndexMarker180"/><span class="koboSpan" id="kobo.463.1"> files</span><a id="_idIndexMarker181"/><span class="koboSpan" id="kobo.464.1"> in</span><a id="_idIndexMarker182"/><span class="koboSpan" id="kobo.465.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.466.1">/backup/</span></code><span class="koboSpan" id="kobo.467.1"> directory:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.468.1">ls -l /backup
</span></code></pre>
      </li>
    </ol>
    <p class="normal"><span class="koboSpan" id="kobo.469.1">End of lab</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.470.1">Well, that’s pretty much it for this chapter. </span><span class="koboSpan" id="kobo.470.2">Let’s summarize and move on.</span></p>
    <h1 id="_idParaDest-75" class="heading 1"><span class="koboSpan" id="kobo.471.1">Summary</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.472.1">In this chapter, we looked at the concept of Input/Output redirection. </span><span class="koboSpan" id="kobo.472.2">It’s a simple concept, really. </span><span class="koboSpan" id="kobo.472.3">It just means that we either take input from somewhere other than the keyboard, or we send output to somewhere other than the terminal screen. </span><span class="koboSpan" id="kobo.472.4">We looked at the redirection operators, how to use them, and some of the pitfalls of using them incorrectly.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.473.1">In the next chapter, we’ll look at ways to modify your shell environment. </span><span class="koboSpan" id="kobo.473.2">I’ll see you there.</span></p>
    <h1 id="_idParaDest-76" class="heading 1"><span class="koboSpan" id="kobo.474.1">Questions</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.475.1">What is the file descriptor number for </span><code class="inlineCode"><span class="koboSpan" id="kobo.476.1">stdin</span></code><span class="koboSpan" id="kobo.477.1">?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.478.1">0</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.479.1">1</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.480.1">2</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.481.1">3</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.482.1">Which of the following operators is for </span><code class="inlineCode"><span class="koboSpan" id="kobo.483.1">stdin</span></code><span class="koboSpan" id="kobo.484.1">?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.485.1">&gt;</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.486.1">&gt;&gt;</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.487.1">&lt;</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.488.1">&lt;&lt;</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.489.1">What will happen if you run this command?
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.490.1">tr [:lower:] [:upper:] &lt; filelist.txt &gt; filelist.txt
</span></code></pre>
        <ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.491.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.492.1">filelist.txt</span></code><span class="koboSpan" id="kobo.493.1"> file will get overwritten with updated output.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.494.1">The output of </span><code class="inlineCode"><span class="koboSpan" id="kobo.495.1">tr</span></code><span class="koboSpan" id="kobo.496.1"> will be appended to the end of the file.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.497.1">You’ll receive a warning message.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.498.1">The contents of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.499.1">filelist.txt</span></code><span class="koboSpan" id="kobo.500.1"> file will be wiped out, and you’ll be left with just an empty file.</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.501.1">What is the default </span><code class="inlineCode"><span class="koboSpan" id="kobo.502.1">stdin</span></code><span class="koboSpan" id="kobo.503.1"> device?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.504.1">keyboard</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.505.1">terminal</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.506.1">mouse</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.507.1">a named pipe</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.508.1">Which of these operators would you use to send </span><code class="inlineCode"><span class="koboSpan" id="kobo.509.1">stderr</span></code><span class="koboSpan" id="kobo.510.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.511.1">stdout</span></code><span class="koboSpan" id="kobo.512.1"> to the same place?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.513.1">2&gt;1&amp;</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.514.1">2&gt;&amp;1</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.515.1">2&amp;1</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.516.1">2&gt;1</span></code></li>
        </ol>
      </li>
    </ol>
    <h1 id="_idParaDest-77" class="heading 1"><span class="koboSpan" id="kobo.517.1">Further Reading</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.518.1">Five ways to use redirect operators in Bash: </span><a href="https://www.redhat.com/sysadmin/redirect-operators-bash"><span class="url"><span class="koboSpan" id="kobo.519.1">https://www.redhat.com/sysadmin/redirect-operators-bash</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.520.1">How to manipulate files with with shell redirection and pipelines in Linux: </span><a href="https://www.redhat.com/sysadmin/linux-shell-redirection-pipelining"><span class="url"><span class="koboSpan" id="kobo.521.1">https://www.redhat.com/sysadmin/linux-shell-redirection-pipelining</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.522.1">How to redirect shell command output: </span><a href="https://www.redhat.com/sysadmin/redirect-shell-command-script-output"><span class="url"><span class="koboSpan" id="kobo.523.1">https://www.redhat.com/sysadmin/redirect-shell-command-script-output</span></span></a></li>
    </ul>
    <h1 id="_idParaDest-78" class="heading 1"><span class="koboSpan" id="kobo.524.1">Answers</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.525.1">a</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.526.1">c</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.527.1">d</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.528.1">a</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.529.1">b</span></li>
    </ol>
    <h1 id="_idParaDest-79" class="heading 1"><span class="koboSpan" id="kobo.530.1">Join our community on Discord!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.531.1">Read this book alongside other users, Linux experts, and the author himself. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.532.1">Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. </span><span class="koboSpan" id="kobo.532.2">Scan the QR code or visit the link to join the community.</span></p>
    <p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.533.1">https://packt.link/SecNet</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.534.1"><img src="../Images/QR_Code10596186092701843.png" alt=""/></span></p>
  </div>
</body></html>