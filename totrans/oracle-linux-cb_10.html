<html><head></head><body>
<div id="_idContainer284">
<h1 class="chapter-number" id="_idParaDest-221"><a id="_idTextAnchor304"/><span class="koboSpan" id="kobo.1.1">10</span></h1>
<h1 id="_idParaDest-222"><a id="_idTextAnchor305"/><span class="koboSpan" id="kobo.2.1">Revisiting Modules and AppStreams</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In this chapter, we’re going to learn more about </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">modules</span></strong><span class="koboSpan" id="kobo.5.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">application streams</span></strong><span class="koboSpan" id="kobo.7.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.8.1">AppStreams</span></strong><span class="koboSpan" id="kobo.9.1">). </span><span class="koboSpan" id="kobo.9.2">We went over the new organization of repositories and the concept of modularity in </span><a href="B18349_05.xhtml#_idTextAnchor135"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.10.1">Chapter 5</span></em></span></a><span class="koboSpan" id="kobo.11.1">, </span><em class="italic"><span class="koboSpan" id="kobo.12.1">Software Management with DNF</span></em><span class="koboSpan" id="kobo.13.1">, but now we’re going to be tapping into the true power of AppStreams with the </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">following recipes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.15.1">Searching and listing </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">AppStream modules</span></span></li>
<li><span class="koboSpan" id="kobo.17.1">Installing applications and development tools </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">via AppStream</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">Using AppStreams to install different versions </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">of software</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">Removing packages </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">via AppStream</span></span></li>
</ul>
<h1 id="_idParaDest-223"><a id="_idTextAnchor306"/><span class="koboSpan" id="kobo.23.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.24.1">The concept of AppStreams is new and was introduced in Oracle Linux 8. </span><span class="koboSpan" id="kobo.24.2">With that being said, as long as you are running Oracle Linux 8, you will have all that’s needed to follow along in </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">this chapter.</span></span></p>
<h1 id="_idParaDest-224"><a id="_idTextAnchor307"/><span class="koboSpan" id="kobo.26.1">Searching and listing AppStream modules</span></h1>
<p><span class="koboSpan" id="kobo.27.1">First things first, let’s review</span><a id="_idIndexMarker946"/><span class="koboSpan" id="kobo.28.1"> the list of commands that pertain</span><a id="_idIndexMarker947"/> <span class="No-Break"><span class="koboSpan" id="kobo.29.1">to modules:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.30.1">disable</span></strong><span class="koboSpan" id="kobo.31.1">: Disable a module with all </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">its streams</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.33.1">enable</span></strong><span class="koboSpan" id="kobo.34.1">: Enable a </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">module stream</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.36.1">info</span></strong><span class="koboSpan" id="kobo.37.1">: Print detailed information about </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">a module</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.39.1">install</span></strong><span class="koboSpan" id="kobo.40.1">: Install a module profile, including </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">its packages</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.42.1">list</span></strong><span class="koboSpan" id="kobo.43.1">: List all module streams, profiles, </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">and states</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.45.1">provides</span></strong><span class="koboSpan" id="kobo.46.1">: List </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">modular packages</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.48.1">remove</span></strong><span class="koboSpan" id="kobo.49.1">: Remove installed module profiles and </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">their packages</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.51.1">repoquery</span></strong><span class="koboSpan" id="kobo.52.1">: List packages belonging to </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">a module</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.54.1">reset</span></strong><span class="koboSpan" id="kobo.55.1">: Reset </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">a module</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.57.1">switch-to</span></strong><span class="koboSpan" id="kobo.58.1">: Switch a module to a stream and </span><em class="italic"><span class="koboSpan" id="kobo.59.1">distrosync</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.60.1">RPM packages</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.61.1">update</span></strong><span class="koboSpan" id="kobo.62.1">: Update packages associated with an </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">active stream</span></span></li>
</ul>
<h2 id="_idParaDest-225"><a id="_idTextAnchor308"/><span class="koboSpan" id="kobo.64.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.65.1">AppStreams are easy</span><a id="_idIndexMarker948"/><span class="koboSpan" id="kobo.66.1"> to use. </span><span class="koboSpan" id="kobo.66.2">To get started, it’s generally best to check for a list</span><a id="_idIndexMarker949"/><span class="koboSpan" id="kobo.67.1"> of available modules. </span><span class="koboSpan" id="kobo.67.2">This can be done by entering one simple command, </span><strong class="source-inline"><span class="koboSpan" id="kobo.68.1">dnf module list</span></strong><span class="koboSpan" id="kobo.69.1">, into </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">the Terminal/console:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer267">
<span class="koboSpan" id="kobo.71.1"><img alt="Figure 10.1 – Output of dnf module list" src="image/B18349_10_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.72.1">Figure 10.1 – Output of dnf module list</span></p>
<p><span class="koboSpan" id="kobo.73.1">The output continues with a rather long list of modules, and at the end, you will see a keymap of what the different </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">letters mean:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer268">
<span class="koboSpan" id="kobo.75.1"><img alt="Figure 10.2 – Module keymap via hints" src="image/B18349_10_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.76.1">Figure 10.2 – Module keymap via hints</span></p>
<p><span class="koboSpan" id="kobo.77.1">Here are several modules</span><a id="_idIndexMarker950"/><span class="koboSpan" id="kobo.78.1"> that immediately caught my eye: </span><strong class="source-inline"><span class="koboSpan" id="kobo.79.1">container-tools</span></strong><span class="koboSpan" id="kobo.80.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.81.1">gimp</span></strong><span class="koboSpan" id="kobo.82.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.83.1">go-tools</span></strong><span class="koboSpan" id="kobo.84.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.85.1">inkscape</span></strong><span class="koboSpan" id="kobo.86.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.87.1">mariadb</span></strong><span class="koboSpan" id="kobo.88.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.89.1">mysql</span></strong><span class="koboSpan" id="kobo.90.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.91.1">nginx</span></strong><span class="koboSpan" id="kobo.92.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.93.1">nodejs</span></strong><span class="koboSpan" id="kobo.94.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.95.1">python</span></strong><span class="koboSpan" id="kobo.96.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.97.1">php</span></strong><span class="koboSpan" id="kobo.98.1">. </span><span class="koboSpan" id="kobo.98.2">These are modules, but you will notice that each module</span><a id="_idIndexMarker951"/><span class="koboSpan" id="kobo.99.1"> has a stream, and each stream contains a profile. </span><span class="koboSpan" id="kobo.99.2">If we were to visualize this in a chart, it might look a bit </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer269">
<span class="koboSpan" id="kobo.101.1"><img alt="Figure 10.3 – Visualizing AppStreams" src="image/B18349_10_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.102.1">Figure 10.3 – Visualizing AppStreams</span></p>
<p><span class="koboSpan" id="kobo.103.1">Now, let’s say we want to get more information on a particular module. </span><span class="koboSpan" id="kobo.103.2">In this case, let’s take a look at </span><strong class="source-inline"><span class="koboSpan" id="kobo.104.1">nodejs</span></strong><span class="koboSpan" id="kobo.105.1">. </span><span class="koboSpan" id="kobo.105.2">First, we’re going to want to specify </span><strong class="source-inline"><span class="koboSpan" id="kobo.106.1">nodejs</span></strong><span class="koboSpan" id="kobo.107.1"> when we ask for the list. </span><span class="koboSpan" id="kobo.107.2">We can do this by adding the name of the module after the </span><strong class="source-inline"><span class="koboSpan" id="kobo.108.1">list</span></strong><span class="koboSpan" id="kobo.109.1"> command, </span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">like so:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer270">
<span class="koboSpan" id="kobo.111.1"><img alt="Figure 10.4 – Output of dnf module list nodejs" src="image/B18349_10_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.112.1">Figure 10.4 – Output of dnf module list nodejs</span></p>
<p><span class="koboSpan" id="kobo.113.1">At the bottom of the list, you will see </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.115.1">
Hint: [d]efault, [e]nabled, [x]disabled, [i]nstalled</span></pre> <p><span class="koboSpan" id="kobo.116.1">From this, we can see that stream </span><strong class="source-inline"><span class="koboSpan" id="kobo.117.1">10</span></strong><span class="koboSpan" id="kobo.118.1"> is labeled as default (</span><strong class="source-inline"><span class="koboSpan" id="kobo.119.1">d</span></strong><span class="koboSpan" id="kobo.120.1">) for </span><strong class="source-inline"><span class="koboSpan" id="kobo.121.1">nodejs</span></strong><span class="koboSpan" id="kobo.122.1">. </span><span class="koboSpan" id="kobo.122.2">What does this mean, exactly? </span><span class="koboSpan" id="kobo.122.3">Basically, if we were to run </span><strong class="source-inline"><span class="koboSpan" id="kobo.123.1">dnf module install nodejs</span></strong><span class="koboSpan" id="kobo.124.1">, we would end up with the latest version of Node.js in stream 10 (and yes, stream </span><strong class="source-inline"><span class="koboSpan" id="kobo.125.1">10</span></strong><span class="koboSpan" id="kobo.126.1"> correlates to </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">Node.js 10).</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.128.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.129.1">At the time of writing, the latest version of Node.js in the 10 series stream is </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.130.1">nodejs-1:10.24.0-1.module+el8.3.0+9671+154373c8.x86_64</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.132.1">We can dig deeper and learn more about this specific AppStream by typing </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.134.1">
# dnf module info nodejs:10</span></pre> <p><span class="koboSpan" id="kobo.135.1">The output of that command</span><a id="_idIndexMarker952"/><span class="koboSpan" id="kobo.136.1"> will show every available release</span><a id="_idIndexMarker953"/><span class="koboSpan" id="kobo.137.1"> of Node.js within the 10 series stream. </span><span class="koboSpan" id="kobo.137.2">There are several but, for the sake of brevity, I have pasted the last two from </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">the list:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer271">
<span class="koboSpan" id="kobo.139.1"><img alt="Figure 10.5 – Output of dnf module info nodejs:10" src="image/B18349_10_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.140.1">Figure 10.5 – Output of dnf module info nodejs:10</span></p>
<p><span class="koboSpan" id="kobo.141.1">The interesting thing</span><a id="_idIndexMarker954"/><span class="koboSpan" id="kobo.142.1"> here is that every stream</span><a id="_idIndexMarker955"/><span class="koboSpan" id="kobo.143.1"> within the 10 series is labeled </span><strong class="source-inline"><span class="koboSpan" id="kobo.144.1">[d][a]</span></strong><span class="koboSpan" id="kobo.145.1"> (default and active); that’s because the </span><strong class="source-inline"><span class="koboSpan" id="kobo.146.1">Stream</span></strong><span class="koboSpan" id="kobo.147.1"> entry is referring to the stream itself, and not any specific release within </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">the stream.</span></span></p>
<h1 id="_idParaDest-226"><a id="_idTextAnchor309"/><span class="koboSpan" id="kobo.149.1">Installing applications and development tools via AppStream</span></h1>
<p><span class="koboSpan" id="kobo.150.1">From the previous recipe, we’re familiar </span><a id="_idIndexMarker956"/><span class="koboSpan" id="kobo.151.1">with how to search</span><a id="_idIndexMarker957"/><span class="koboSpan" id="kobo.152.1"> for and list applications in AppStreams; let’s now dive</span><a id="_idIndexMarker958"/><span class="koboSpan" id="kobo.153.1"> into installing applications</span><a id="_idIndexMarker959"/><span class="koboSpan" id="kobo.154.1"> and development tools </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">via AppStream.</span></span></p>
<h2 id="_idParaDest-227"><a id="_idTextAnchor310"/><span class="koboSpan" id="kobo.156.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.157.1">Building from the last recipe, in which we examined </span><strong class="source-inline"><span class="koboSpan" id="kobo.158.1">nodejs</span></strong><span class="koboSpan" id="kobo.159.1">, let’s go ahead and install it. </span><span class="koboSpan" id="kobo.159.2">There’s more than one way to do this. </span><span class="koboSpan" id="kobo.159.3">You can enable the module and then use the standard </span><strong class="source-inline"><span class="koboSpan" id="kobo.160.1">dnf install [package(s)]</span></strong><span class="koboSpan" id="kobo.161.1"> command to install </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">the packages:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.163.1">
# dnf module enable nodejs
# dnf install nodejs npm</span></pre> <p><span class="koboSpan" id="kobo.164.1">You can also use the standard </span><strong class="source-inline"><span class="koboSpan" id="kobo.165.1">dnf</span></strong><span class="koboSpan" id="kobo.166.1"> commands without specifying modules and the default module will get enabled as part of </span><span class="No-Break"><span class="koboSpan" id="kobo.167.1">the transaction:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.168.1">
# dnf install nodejs npm</span></pre> <p><span class="koboSpan" id="kobo.169.1">Or, the preferred way is to tap directly into the new set of </span><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">dnf module</span></strong><span class="koboSpan" id="kobo.171.1"> commands and simply run </span><strong class="source-inline"><span class="koboSpan" id="kobo.172.1">dnf module install [</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">module name(s)]</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.174.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.175.1">
# dnf module install nodejs</span></pre> <p><span class="koboSpan" id="kobo.176.1">The output is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer272">
<span class="koboSpan" id="kobo.178.1"><img alt="Figure 10.6 – Output of dnf module install nodejs" src="image/B18349_10_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.179.1">Figure 10.6 – Output of dnf module install nodejs</span></p>
<p><span class="koboSpan" id="kobo.180.1">What you get is the latest</span><a id="_idIndexMarker960"/><span class="koboSpan" id="kobo.181.1"> in the default AppStream (if nothing is enabled), but if for some reason</span><a id="_idIndexMarker961"/><span class="koboSpan" id="kobo.182.1"> you wanted an older version</span><a id="_idIndexMarker962"/><span class="koboSpan" id="kobo.183.1"> in the stream, you can select</span><a id="_idIndexMarker963"/><span class="koboSpan" id="kobo.184.1"> that by appending a colon and the version to the end of the command. </span><span class="koboSpan" id="kobo.184.2">For example, if I didn’t want the latest and, instead, wanted the version before it, I would type </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.186.1">
# dnf module install nodejs:10:8030020210118191659</span></pre> <p><span class="koboSpan" id="kobo.187.1">The output is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer273">
<span class="koboSpan" id="kobo.189.1"><img alt="Figure 10.7 – Output of dnf module install nodejs:10:8030020210118191659" src="image/B18349_10_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.190.1">Figure 10.7 – Output of dnf module install nodejs:10:8030020210118191659</span></p>
<p><span class="koboSpan" id="kobo.191.1">This would instruct DNF to install the releases of Node.js (and related artifacts) that correlate to the </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">version specified.</span></span></p>
<p><span class="koboSpan" id="kobo.193.1">Another thing to notice</span><a id="_idIndexMarker964"/><span class="koboSpan" id="kobo.194.1"> is that, by default, only the </span><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">common</span></strong><span class="koboSpan" id="kobo.196.1"> profile</span><a id="_idIndexMarker965"/><span class="koboSpan" id="kobo.197.1"> will be installed. </span><span class="koboSpan" id="kobo.197.2">We can</span><a id="_idIndexMarker966"/><span class="koboSpan" id="kobo.198.1"> specify a different</span><a id="_idIndexMarker967"/><span class="koboSpan" id="kobo.199.1"> profile (for example, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">development</span></strong><span class="koboSpan" id="kobo.201.1"> profile), by appending a forward slash and a </span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">profile name:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.203.1">
# dnf module install nodejs:10/development</span></pre> <p><span class="koboSpan" id="kobo.204.1">The output is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.205.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer274">
<span class="koboSpan" id="kobo.206.1"><img alt="Figure 10.8 – Output of dnf module install nodejs:10/development" src="image/B18349_10_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.207.1">Figure 10.8 – Output of dnf module install nodejs:10/development</span></p>
<p><span class="koboSpan" id="kobo.208.1">You can</span><a id="_idIndexMarker968"/><span class="koboSpan" id="kobo.209.1"> even specify</span><a id="_idIndexMarker969"/><span class="koboSpan" id="kobo.210.1"> more than</span><a id="_idIndexMarker970"/><span class="koboSpan" id="kobo.211.1"> one profile, </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">like</span></span><span class="No-Break"><a id="_idIndexMarker971"/></span><span class="No-Break"><span class="koboSpan" id="kobo.213.1"> so:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.214.1">
# dnf module install nodejs:10/development nodejs:10/s2i</span></pre> <p><span class="koboSpan" id="kobo.215.1">The output is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer275">
<span class="koboSpan" id="kobo.217.1"><img alt="Figure 10.9 – Output of dnf module install nodejs:10/development nodejs:10/s2i" src="image/B18349_10_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.218.1">Figure 10.9 – Output of dnf module install nodejs:10/development nodejs:10/s2i</span></p>
<p><span class="koboSpan" id="kobo.219.1">Or, if you wish to install all the profiles, simply use an asterisk to indicate a </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">wildcard selection:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.221.1">
# dnf module install nodejs:10/*</span></pre> <p><span class="koboSpan" id="kobo.222.1">The output</span><a id="_idIndexMarker972"/><span class="koboSpan" id="kobo.223.1"> is shown</span><a id="_idIndexMarker973"/><span class="koboSpan" id="kobo.224.1"> in the</span><a id="_idIndexMarker974"/> <span class="No-Break"><span class="koboSpan" id="kobo.225.1">following</span></span><span class="No-Break"><a id="_idIndexMarker975"/></span><span class="No-Break"><span class="koboSpan" id="kobo.226.1"> screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer276">
<span class="koboSpan" id="kobo.227.1"><img alt="Figure 10.10 – Output of dnf module install nodejs:10/*" src="image/B18349_10_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.228.1">Figure 10.10 – Output of dnf module install nodejs:10/*</span></p>
<h1 id="_idParaDest-228"><a id="_idTextAnchor311"/><span class="koboSpan" id="kobo.229.1">Using AppStreams to install different versions of software</span></h1>
<p><span class="koboSpan" id="kobo.230.1">Now, we’re going to expand</span><a id="_idIndexMarker976"/><span class="koboSpan" id="kobo.231.1"> on what we know about AppStreams, and instead of installing an application from the default module stream, we’re going to specify a </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">different stream.</span></span></p>
<h2 id="_idParaDest-229"><a id="_idTextAnchor312"/><span class="koboSpan" id="kobo.233.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.234.1">There are multiple ways to do this: simply specifying the installation of a different stream will get the job done, or you can first manually enable a different version. </span><span class="koboSpan" id="kobo.234.2">My preference is to specify the version as I install it because, in that case, the AppStream will automatically enable </span><span class="No-Break"><span class="koboSpan" id="kobo.235.1">that version:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.236.1">
# dnf module install nodejs:16</span></pre> <p class="callout-heading"><span class="koboSpan" id="kobo.237.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.238.1">If you already installed some version of an AppStream, it is best to remove the old one before resetting and installing a different version. </span><span class="koboSpan" id="kobo.238.2">This will be </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">covered later.</span></span></p>
<p><span class="koboSpan" id="kobo.240.1">The output is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer277">
<span class="koboSpan" id="kobo.242.1"><img alt="Figure 10.11 – Output of dnf module install nodejs:16" src="image/B18349_10_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.243.1">Figure 10.11 – Output of dnf module install nodejs:16</span></p>
<p><span class="koboSpan" id="kobo.244.1">You’ll see from</span><a id="_idIndexMarker977"/><span class="koboSpan" id="kobo.245.1"> the printout that the module stream for </span><strong class="source-inline"><span class="koboSpan" id="kobo.246.1">nodejs</span></strong><span class="koboSpan" id="kobo.247.1"> 16 will be enabled. </span><span class="koboSpan" id="kobo.247.2">Now, if we list out the module stream for </span><strong class="source-inline"><span class="koboSpan" id="kobo.248.1">nodejs</span></strong><span class="koboSpan" id="kobo.249.1">, we’ll see </span><span class="No-Break"><span class="koboSpan" id="kobo.250.1">the following:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer278">
<span class="koboSpan" id="kobo.251.1"><img alt="Figure 10.12 – Output of dnf module list nodejs" src="image/B18349_10_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.252.1">Figure 10.12 – Output of dnf module list nodejs</span></p>
<p><span class="koboSpan" id="kobo.253.1">As you can see, </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">10</span></strong><span class="koboSpan" id="kobo.255.1"> is still the default, but </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">16</span></strong><span class="koboSpan" id="kobo.257.1"> is enabled (</span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">e</span></strong><span class="koboSpan" id="kobo.259.1">). </span><span class="koboSpan" id="kobo.259.2">AppStreams maintains a default stream to allow normal usage of </span><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">dnf</span></strong><span class="koboSpan" id="kobo.261.1"> to function without requiring the user to know anything about AppStreams. </span><span class="koboSpan" id="kobo.261.2">Additionally, if we were to reset the module, it would revert back to the original settings – that is, it would make </span><strong class="source-inline"><span class="koboSpan" id="kobo.262.1">10</span></strong><span class="koboSpan" id="kobo.263.1"> the only default and enabled version, and version </span><strong class="source-inline"><span class="koboSpan" id="kobo.264.1">16</span></strong><span class="koboSpan" id="kobo.265.1"> would no longer be enabled. </span><span class="koboSpan" id="kobo.265.2">Furthermore, it’s important to note that only one stream can be enabled at a time. </span><span class="koboSpan" id="kobo.265.3">To recap, a default stream is inherently</span><a id="_idIndexMarker978"/><span class="koboSpan" id="kobo.266.1"> enabled when no other stream is enabled. </span><span class="koboSpan" id="kobo.266.2">If you enable a different stream, it is the only one that can be installed from, but it’s easy to reset and switch to another. </span><span class="koboSpan" id="kobo.266.3">To do so, simply do </span><span class="No-Break"><span class="koboSpan" id="kobo.267.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.268.1">
# dnf module remove nodejs
# dnf module reset nodejs</span></pre> <p><span class="koboSpan" id="kobo.269.1">You will see confirmation about the module </span><span class="No-Break"><span class="koboSpan" id="kobo.270.1">being reset:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.271.1">
Disabling module profiles:
 nodejs/common
Resetting modules:
 nodejs</span></pre> <p><span class="koboSpan" id="kobo.272.1">At this point, we are cleared to install a different version. </span><span class="koboSpan" id="kobo.272.2">Let’s go with Node.js 14 this </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">time around:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.274.1">
# dnf module install nodejs:14</span></pre> <p><span class="koboSpan" id="kobo.275.1">You will see a confirmation about what the package manager plans </span><span class="No-Break"><span class="koboSpan" id="kobo.276.1">to do:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer279">
<span class="koboSpan" id="kobo.277.1"><img alt="Figure 10.13 – Output of dnf module install nodejs:14" src="image/B18349_10_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.278.1">Figure 10.13 – Output of dnf module install nodejs:14</span></p>
<p><span class="koboSpan" id="kobo.279.1">You may notice</span><a id="_idIndexMarker979"/><span class="koboSpan" id="kobo.280.1"> that you are downgrading. </span><span class="koboSpan" id="kobo.280.2">Just as you might suspect, if no module is installed, it will say </span><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">Installing</span></strong><span class="koboSpan" id="kobo.282.1">; if installing a number that is greater than the currently installed version, it will say </span><strong class="source-inline"><span class="koboSpan" id="kobo.283.1">Upgrading</span></strong><span class="koboSpan" id="kobo.284.1">; and if installing a number that is less than the currently installed version, it will say </span><strong class="source-inline"><span class="koboSpan" id="kobo.285.1">Downgrading</span></strong><span class="koboSpan" id="kobo.286.1">. </span><span class="koboSpan" id="kobo.286.2">Regardless of what the package manager says it is doing, you will be left with the version you requested – it’s as simple </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">as that.</span></span></p>
<p><span class="koboSpan" id="kobo.288.1">You should be aware there is another way to switch to a different stream. </span><span class="koboSpan" id="kobo.288.2">Rather than using </span><strong class="source-inline"><span class="koboSpan" id="kobo.289.1">remove</span></strong><span class="koboSpan" id="kobo.290.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.291.1">reset</span></strong><span class="koboSpan" id="kobo.292.1">, and then </span><strong class="source-inline"><span class="koboSpan" id="kobo.293.1">install</span></strong><span class="koboSpan" id="kobo.294.1">, you can achieve this with one step by </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">using </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.296.1">switch-to</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.297.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer280">
<span class="koboSpan" id="kobo.298.1"><img alt="Figure 10.14 – Output of dnf module switch-to nodejs:16" src="image/B18349_10_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.299.1">Figure 10.14 – Output of dnf module switch-to nodejs:16</span></p>
<p><span class="koboSpan" id="kobo.300.1">This is the recommended</span><a id="_idIndexMarker980"/><span class="koboSpan" id="kobo.301.1"> method of changing stream versions because it accomplishes the change in just one step, and it provides a very clear printout of the action taking place. </span><span class="koboSpan" id="kobo.301.2">Its status is </span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">Upgrading</span></strong><span class="koboSpan" id="kobo.303.1">, and it is going from </span><strong class="source-inline"><span class="koboSpan" id="kobo.304.1">14 -&gt; </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.305.1">16</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.307.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.308.1">There is actually another way to switch modules on the fly. </span><span class="koboSpan" id="kobo.308.2">If you set </span><strong class="source-inline"><span class="koboSpan" id="kobo.309.1">module_stream_switch</span></strong><span class="koboSpan" id="kobo.310.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.311.1">True</span></strong><span class="koboSpan" id="kobo.312.1"> in </span><strong class="source-inline"><span class="koboSpan" id="kobo.313.1">/etc/dnf/dnf.conf</span></strong><span class="koboSpan" id="kobo.314.1">, then you can install a different module without using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.315.1">switch-to</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.316.1"> syntax.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.317.1">Here is </span><span class="No-Break"><span class="koboSpan" id="kobo.318.1">an example:</span></span></p>
<p class="callout"><strong class="bold"><span class="koboSpan" id="kobo.319.1">echo “module_stream_switch=True” &gt;&gt; /</span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.320.1">etc/dnf/dnf.conf</span></strong></span></p>
<h3><span class="koboSpan" id="kobo.321.1">What about Python?</span></h3>
<p><span class="koboSpan" id="kobo.322.1">If you review the list </span><a id="_idIndexMarker981"/><span class="koboSpan" id="kobo.323.1">of modules, you may notice that Python consists of multiple modules rather than a single module with </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">multiple AppStreams:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.325.1">
# dnf module list python*</span></pre> <p><span class="koboSpan" id="kobo.326.1">The output can be seen in the </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer281">
<span class="koboSpan" id="kobo.328.1"><img alt="Figure 10.15 – Output of dnf module list python*" src="image/B18349_10_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.329.1">Figure 10.15 – Output of dnf module list python*</span></p>
<p><span class="koboSpan" id="kobo.330.1">This seems weird at first, but consider that Python is an integral part of the Oracle Linux operating system and that each Oracle Linux release comes with a platform Python version. </span><span class="koboSpan" id="kobo.330.2">The specific platform Python version may differ for each Oracle Linux release, and the respective platform Python version will be supported for the full lifespan of that version of Oracle Linux. </span><span class="koboSpan" id="kobo.330.3">For Oracle Linux 7, the platform Python version is 2.7 and is always installed, and for Oracle Linux 8, the platform Python version is 3.6. </span><span class="koboSpan" id="kobo.330.4">In other words, Python 2.7 is supported for the full lifespan of Oracle Linux 7, and Python 3.6 is supported for the full lifespan of Oracle Linux 8. </span><span class="koboSpan" id="kobo.330.5">On Oracle Linux 8, the platform Python is exclusively intended for use by system utilities such as Yum and DNF. </span><span class="koboSpan" id="kobo.330.6">Python for general purpose is not installed by default on Oracle Linux 8, and so this is where AppStream modules come </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">into play.</span></span></p>
<p><span class="koboSpan" id="kobo.332.1">You can install multiple versions of Python on Oracle Linux 8 by specifying the module correlating to the desired version of Python. </span><span class="koboSpan" id="kobo.332.2">All of the Python modules can be installed and used simultaneously on the same machine, and you can specify which installation you wish to use by typing out the version – for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">python3.6 --version</span></strong><span class="koboSpan" id="kobo.334.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">python3.8 --version</span></strong><span class="koboSpan" id="kobo.336.1">, and </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.338.1">By default, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">python3</span></strong><span class="koboSpan" id="kobo.340.1"> command is always aliased to Python 3.6 if it is installed on the system, and that is because Python 3.6 is the platform Python</span><a id="_idIndexMarker982"/><span class="koboSpan" id="kobo.341.1"> version on Oracle </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">Linux 8.</span></span></p>
<h1 id="_idParaDest-230"><a id="_idTextAnchor313"/><span class="koboSpan" id="kobo.343.1">Removing packages via AppStream</span></h1>
<p><span class="koboSpan" id="kobo.344.1">Removing packages</span><a id="_idIndexMarker983"/><span class="koboSpan" id="kobo.345.1"> via AppStream is straightforward. </span><span class="koboSpan" id="kobo.345.2">In general, all you need</span><a id="_idIndexMarker984"/><span class="koboSpan" id="kobo.346.1"> to do is instruct the package manager to remove instead of install. </span><span class="koboSpan" id="kobo.346.2">If the package manager finds a module that matches, it will proceed to remove the </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">related packages.</span></span></p>
<h2 id="_idParaDest-231"><a id="_idTextAnchor314"/><span class="koboSpan" id="kobo.348.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.349.1">Building off the examples in the previous recipe, let’s remove the Node.js module by running the </span><strong class="source-inline"><span class="koboSpan" id="kobo.350.1">dnf module remove </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">nodejs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.352.1"> command:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer282">
<span class="koboSpan" id="kobo.353.1"><img alt="Figure 10.16 – Output of dnf module remove nodejs" src="image/B18349_10_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.354.1">Figure 10.16 – Output of dnf module remove nodejs</span></p>
<p><span class="koboSpan" id="kobo.355.1">From this message, you can see that NPM will be uninstalled, but that isn’t quite what you would expect considering that the Node.js module installed more than just NPM. </span><span class="koboSpan" id="kobo.355.2">If you want to remove everything related to the module, you’ll need to pass in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.356.1">--all</span></strong><span class="koboSpan" id="kobo.357.1"> flag, </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">like so:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.359.1">
# dnf module remove nodejs --all</span></pre> <p><span class="koboSpan" id="kobo.360.1">This time, you will see that all associated packages are queued </span><span class="No-Break"><span class="koboSpan" id="kobo.361.1">for removal:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer283">
<span class="koboSpan" id="kobo.362.1"><img alt="Figure 10.17 – Output of dnf module remove nodejs --all" src="image/B18349_10_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.363.1">Figure 10.17 – Output of dnf module remove nodejs --all</span></p>
<p><span class="koboSpan" id="kobo.364.1">Now that’s more</span><a id="_idIndexMarker985"/><span class="koboSpan" id="kobo.365.1"> like it. </span><span class="koboSpan" id="kobo.365.2">Type </span><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">y</span></strong><span class="koboSpan" id="kobo.367.1"> and press </span><em class="italic"><span class="koboSpan" id="kobo.368.1">Enter</span></em><span class="koboSpan" id="kobo.369.1">, and the module</span><a id="_idIndexMarker986"/><span class="koboSpan" id="kobo.370.1"> will </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">be removed.</span></span></p>
<h2 id="_idParaDest-232"><a id="_idTextAnchor315"/><span class="koboSpan" id="kobo.372.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.373.1">So, now that we’ve gone over the usage of AppStreams, you might be asking yourself, “</span><em class="italic"><span class="koboSpan" id="kobo.374.1">Didn’t we already have a similar capability with Software Collections?</span></em><span class="koboSpan" id="kobo.375.1">” The answer is yes, but there is a big difference between Software Collections </span><span class="No-Break"><span class="koboSpan" id="kobo.376.1">and AppStreams.</span></span></p>
<p><span class="koboSpan" id="kobo.377.1">Where Software Collections provides Parallel Availability and Parallel Installability, AppStreams provides only </span><a id="_idIndexMarker987"/><span class="No-Break"><span class="koboSpan" id="kobo.378.1">Parallel Availability.</span></span></p>
<p><span class="koboSpan" id="kobo.379.1">According to the</span><a id="_idIndexMarker988"/><span class="koboSpan" id="kobo.380.1"> Fedora docs, “</span><em class="italic"><span class="koboSpan" id="kobo.381.1">Parallel Availability means that more than one major release of a popular software project is available for installation.”</span></em><span class="koboSpan" id="kobo.382.1"> And </span><em class="italic"><span class="koboSpan" id="kobo.383.1">“Parallel Installability means that more than one major release of a software project can be installed on the </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.384.1">same userspace.</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">”</span></span></p>
<p><span class="koboSpan" id="kobo.386.1">Now you might be asking, “</span><em class="italic"><span class="koboSpan" id="kobo.387.1">Wait, so you’re telling me that AppStreams is not as good as what we had before?</span></em><span class="koboSpan" id="kobo.388.1">” Well, not exactly. </span><span class="koboSpan" id="kobo.388.2">It turns out that Parallel Installability isn’t all it’s cracked up to be. </span><span class="koboSpan" id="kobo.388.3">Although it seems nice on the surface to have the ability to install multiple versions of software on the same system, in reality, it is plagued with complications of requiring users to know they need to do something extra in order to actually make use of the installed software and/or alternate version. </span><span class="koboSpan" id="kobo.388.4">For example, if you wanted to install multiple versions of Node.js, you would first need to enable the desired Software Collection for Node.js, and then you would also need to know where to look for and activate the specific version you want to use. </span><span class="koboSpan" id="kobo.388.5">In other words, you cannot simply use the alternate version of the software in the normal way because the packages would get installed in </span><span class="No-Break"><span class="koboSpan" id="kobo.389.1">non-standard locations.</span></span></p>
<p><span class="koboSpan" id="kobo.390.1">AppStreams solves this because it does not allow for Parallel Installability; instead, it provides the capability of Parallel Availability. </span><span class="koboSpan" id="kobo.390.2">In other words, you install one and only one package at a time, and you use it like you normally would. </span><span class="koboSpan" id="kobo.390.3">If you want a different version, well, you simply enable a </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">different stream.</span></span></p>
<p><span class="koboSpan" id="kobo.392.1">As a bonus, AppStreams is particularly useful when creating containers that are single-use by design. </span><span class="koboSpan" id="kobo.392.2">Having AppStreams means each container image is configured with the right version of the module, which is then globally available within the container. </span><span class="koboSpan" id="kobo.392.3">If you need multiple versions, just run </span><span class="No-Break"><span class="koboSpan" id="kobo.393.1">multiple containers.</span></span></p>
<p><span class="koboSpan" id="kobo.394.1">AppStreams makes it much easier to install different versions of software, and the best thing is, even if you know nothing about AppStreams, you can still use DNF the old-fashioned way and get your basic </span><span class="No-Break"><span class="koboSpan" id="kobo.395.1">applications installed.</span></span></p>
</div>
</body></html>