<html><head></head><body>
  <div id="_idContainer448" class="Basic-Text-Frame">
    <h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">23</span></h1>
    <h1 id="_idParaDest-490" class="chapterTitle"><span class="koboSpan" id="kobo.2.1">Using PowerShell on Linux</span></h1>
    <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.3.1">PowerShell</span></strong><span class="koboSpan" id="kobo.4.1"> started its life as a closed-source, proprietary product that could only be installed on Windows operating systems. </span><span class="koboSpan" id="kobo.4.2">Now though, it’s Free Open Source Software, and is freely available for use on Linux-based and macOS-based machines.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.5.1">I can’t give you a complete course on PowerShell in this chapter, because it’s something that would require an entire book. </span><span class="koboSpan" id="kobo.5.2">Instead, I’ll just give you a high-level overview of the PowerShell philosophy, show you how to install it, and provide some useful examples. </span><span class="koboSpan" id="kobo.5.3">I’ll also provide some rationale on why you, as a Linux or Mac administrator, might like to learn PowerShell. </span><span class="koboSpan" id="kobo.5.4">And of course, you’ll find plenty of PowerShell reference material links both throughout the chapter and in the </span><em class="chapterRef"><span class="koboSpan" id="kobo.6.1">Further Reading</span></em><span class="koboSpan" id="kobo.7.1"> section.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.8.1">Topics in this chapter include:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.9.1">Installing PowerShell on Linux and macOS</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.10.1">Reasons for Linux and Mac Admins to Learn PowerShell</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.11.1">Differences Between PowerShell Scripting and Traditional Linux/Unix Scripting</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.12.1">Viewing the Available PowerShell Commands</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.13.1">Getting Help with PowerShell Commands</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.14.1">Real-World Cross-Platform PowerShell Scripts</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.15.1">If you’re ready, let’s get started.</span></p>
    <h1 id="_idParaDest-491" class="heading 1"><span class="koboSpan" id="kobo.16.1">Technical Requirements</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.17.1">You can use a Fedora, Ubuntu, or Debian virtual machine for this. </span><span class="koboSpan" id="kobo.17.2">You won’t be using your FreeBSD or OpenIndiana virtual machines, because PowerShell isn’t available for them.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.18.1">As always, you can grab the scripts by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.19.1">git clone https://github.com/PacktPublishing/The-Ultimate-Linux-Shell-Scripting-Guide.git
</span></code></pre>
    <h1 id="_idParaDest-492" class="heading 1"><span class="koboSpan" id="kobo.20.1">Installing PowerShell on Linux and macOS</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.21.1">We’ll first look at the methods for installing PowerShell on Linux, and then look at how to install it on macOS.</span></p>
    <h2 id="_idParaDest-493" class="heading 2"><span class="koboSpan" id="kobo.22.1">Installing PowerShell on Linux via a snap Package</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.23.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.24.1">snapd</span></code><span class="koboSpan" id="kobo.25.1"> system is a </span><a id="_idIndexMarker1462"/><span class="koboSpan" id="kobo.26.1">universal software </span><a id="_idIndexMarker1463"/><span class="koboSpan" id="kobo.27.1">packaging system that was invented by the </span><a id="_idIndexMarker1464"/><span class="koboSpan" id="kobo.28.1">developers of Ubuntu. </span><span class="koboSpan" id="kobo.28.2">It comes installed by default on Ubuntu operating systems, and can be installed on most other Linux distros.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.29.1">If you’re setting up a new Ubuntu Server, you can choose to install a selection of snap packages, including PowerShell, from the Ubuntu installer. </span><span class="koboSpan" id="kobo.29.2">Here’s what that looks like:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.30.1"><img src="../Images/B21693_23_01.png" alt="B21693_23_1"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.31.1">Figure 23.1: Selecting the PowerShell snap package during Ubuntu installation</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.32.1">You can install </span><code class="inlineCode"><span class="koboSpan" id="kobo.33.1">snapd</span></code><span class="koboSpan" id="kobo.34.1"> on non-Ubuntu distros, but the installation instructions vary for different distros. </span><span class="koboSpan" id="kobo.34.2">You can find the installation instructions</span><a id="_idIndexMarker1465"/><span class="koboSpan" id="kobo.35.1"> here:</span></p>
      <p class="normal"><a href="https://snapcraft.io/docs/installing-snapd"><span class="url"><span class="koboSpan" id="kobo.36.1">https://snapcraft.io/docs/installing-snapd</span></span></a></p>
      <p class="normal"><span class="koboSpan" id="kobo.37.1">Once you’ve installed </span><code class="inlineCode"><span class="koboSpan" id="kobo.38.1">snapd</span></code><span class="koboSpan" id="kobo.39.1">, you can install PowerShell by doing:</span></p>
      <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.40.1">sudo snap install powershell --classic
</span></code></pre>
    </div>
    <h2 id="_idParaDest-494" class="heading 2"><span class="koboSpan" id="kobo.41.1">Installing PowerShell on Fedora</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.42.1">On a</span><a id="_idIndexMarker1466"/><span class="koboSpan" id="kobo.43.1"> Fedora system, you can use any of several methods</span><a id="_idIndexMarker1467"/><span class="koboSpan" id="kobo.44.1"> for installing PowerShell. </span><span class="koboSpan" id="kobo.44.2">For example, you can install it either via a </span><code class="inlineCode"><span class="koboSpan" id="kobo.45.1">.rpm</span></code><span class="koboSpan" id="kobo.46.1"> package, or via a Docker container. </span><span class="koboSpan" id="kobo.46.2">You’ll find detailed</span><a id="_idIndexMarker1468"/><span class="koboSpan" id="kobo.47.1"> instructions for each of these methods, along with a few more, here:</span></p>
    <p class="normal"><a href="https://fedoramagazine.org/install-powershell-on-fedora-linux/"><span class="url"><span class="koboSpan" id="kobo.48.1">https://fedoramagazine.org/install-powershell-on-fedora-linux/</span></span></a></p>
    <h2 id="_idParaDest-495" class="heading 2"><span class="koboSpan" id="kobo.49.1">Installing PowerShell on macOS</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.50.1">You can install </span><a id="_idIndexMarker1469"/><span class="koboSpan" id="kobo.51.1">PowerShell on a Mac via the Homebrew</span><a id="_idIndexMarker1470"/><span class="koboSpan" id="kobo.52.1"> system. </span><span class="koboSpan" id="kobo.52.2">You’ll find detailed instructions</span><a id="_idIndexMarker1471"/><span class="koboSpan" id="kobo.53.1"> for that here:</span></p>
    <p class="normal"><a href="https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-macos?view=powershell-7.4"><span class="url"><span class="koboSpan" id="kobo.54.1">https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-macos?view=powershell-7.4</span></span></a></p>
    <h2 id="_idParaDest-496" class="heading 2"><span class="koboSpan" id="kobo.55.1">Invoking PowerShell</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.56.1">Once</span><a id="_idIndexMarker1472"/><span class="koboSpan" id="kobo.57.1"> PowerShell is installed, invoke it by entering the </span><code class="inlineCode"><span class="koboSpan" id="kobo.58.1">pwsh</span></code><span class="koboSpan" id="kobo.59.1"> command. </span><span class="koboSpan" id="kobo.59.2">Your command-prompt will then look something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.60.1">PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.61.1">Now, before I show you any demos, let’s address the burning question of the day. </span><span class="koboSpan" id="kobo.61.2">Why should a Linux or Mac person such as yourself learn a scripting language that was invented at Microsoft?</span></p>
    <h1 id="_idParaDest-497" class="heading 1"><span class="koboSpan" id="kobo.62.1">Reasons for Linux and Mac Admins to Learn PowerShell</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.63.1">Scripting in PowerShell is a somewhat different experience from scripting in the traditional Linux and Unix shells. </span><span class="koboSpan" id="kobo.63.2">But, it’s not hard, and you might even like it once you get used to it. </span><span class="koboSpan" id="kobo.63.3">At any rate, there are some valid reasons why a Linux administrator might like to learn PowerShell. </span><span class="koboSpan" id="kobo.63.4">Let’s take a look at some of those reasons.</span></p>
    <h2 id="_idParaDest-498" class="heading 2"><span class="koboSpan" id="kobo.64.1">Working with Mixed Operating System Environments</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.65.1">The first reason is </span><a id="_idIndexMarker1473"/><span class="koboSpan" id="kobo.66.1">simply one of both convenience and flexibility. </span><span class="koboSpan" id="kobo.66.2">A lot of enterprises and organizations run a mixed bag of Linux and Windows servers, and usually run Windows on their workstations. </span><span class="koboSpan" id="kobo.66.3">It might be helpful if you could run one common scripting language across your Windows and Linux platforms. </span><span class="koboSpan" id="kobo.66.4">And, if you’re a Windows administrator who now needs to learn Linux administration, you might find it easier to do it with PowerShell, which you’ll likely already know. </span><span class="koboSpan" id="kobo.66.5">In fact, let me tell you a story about my own reason for learning PowerShell.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.67.1">Throughout the years 2010 and 2011, I worked with a client who had taken on the Nagios company as one of his clients. </span><span class="koboSpan" id="kobo.67.2">The Nagios company produces the Nagios network monitoring system, which can monitor pretty much every type of network device. </span><span class="koboSpan" id="kobo.67.3">(This includes servers that run either Linux or Windows, as well as various types of networking equipment.) My client’s job was threefold. </span><span class="koboSpan" id="kobo.67.4">He was to produce training documentation, conduct Nagios training classes, and fly around the country to set up Nagios monitoring systems for clients of the Nagios company. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.68.1">Anyway, every time my client needed to do anything with Windows servers, he would turn to me, because I knew Windows Server and he didn’t.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.69.1">Okay, I’ve been guarding a dark secret, and I hope you won’t think badly of me. </span><span class="koboSpan" id="kobo.69.2">It’s just that back in 2006, before I got involved with Linux, I obtained my Microsoft Certified Systems Engineer (MCSE) certification for Windows Server 2003. </span><span class="koboSpan" id="kobo.69.3">When I first got into Linux, I thought that I would never use my MSCE training. </span><span class="koboSpan" id="kobo.69.4">Boy, was I wrong.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.70.1">Unfortunately, my MCSE training didn’t include anything about PowerShell, because it hadn’t yet been invented. </span><span class="koboSpan" id="kobo.70.2">So, in order to come up with Windows Server monitoring solutions for my client, I had to give myself a crash course on PowerShell scripting.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.71.1">The bottom</span><a id="_idIndexMarker1474"/><span class="koboSpan" id="kobo.72.1"> line here is that if you’re involved with setting up any kind of network monitoring solution, even if you’re a Linux admin, learning PowerShell could be useful.</span></p>
    <h2 id="_idParaDest-499" class="heading 2"><span class="koboSpan" id="kobo.73.1">PowerShell Commands Can Be Simpler</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.74.1">The second reason is that in </span><a id="_idIndexMarker1475"/><span class="koboSpan" id="kobo.75.1">some cases, PowerShell is just easier to deal with. </span><span class="koboSpan" id="kobo.75.2">You’ve seen how in the traditional Linux/Unix shell languages, commands to perform a certain task can become quite long and convoluted. </span><span class="koboSpan" id="kobo.75.3">For example, let’s say that you want to view all of the system processes that are using 200 Megabytes or more of the machine’s Random Access Memory (RAM), and you want to see only certain fields of the output. </span><span class="koboSpan" id="kobo.75.4">The traditional Linux/Unix way of doing this would involve using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.76.1">ps</span></code><span class="koboSpan" id="kobo.77.1"> command with the proper option switches, and then piping the </span><code class="inlineCode"><span class="koboSpan" id="kobo.78.1">ps</span></code><span class="koboSpan" id="kobo.79.1"> output into </span><code class="inlineCode"><span class="koboSpan" id="kobo.80.1">awk</span></code><span class="koboSpan" id="kobo.81.1">, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.82.1">donnie@fedora:~$ ps -eO rss | awk -F' ' '{ if($2 &gt;= (1024*200)) {printf("%s\t%s\t%s\n",$1,$2,$6);}}'
PID	       RSS	 COMMAND
3215	338896	 /usr/lib64/chromium-browser/chromium-browser
3339	247596	 /usr/lib64/chromium-browser/chromium-browser
. </span><span class="koboSpan" id="kobo.82.2">. </span><span class="koboSpan" id="kobo.82.3">.
</span><span class="koboSpan" id="kobo.82.4">. </span><span class="koboSpan" id="kobo.82.5">. </span><span class="koboSpan" id="kobo.82.6">.
</span><span class="koboSpan" id="kobo.82.7">21502	614792	 /usr/lib64/firefox/firefox
23451	369392	 /usr/lib64/firefox/firefox
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.83.1">So, what’s the problem with this? </span><span class="koboSpan" id="kobo.83.2">Well first, you need to be familiar with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.84.1">ps</span></code><span class="koboSpan" id="kobo.85.1"> option switches, as well as with the various </span><code class="inlineCode"><span class="koboSpan" id="kobo.86.1">ps</span></code><span class="koboSpan" id="kobo.87.1"> output fields. </span><span class="koboSpan" id="kobo.87.2">In this case, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.88.1">ps -e</span></code><span class="koboSpan" id="kobo.89.1"> command shows us something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.90.1">donnie@fedora:~$ ps -e
    PID      TTY          TIME         CMD
      1        ?          </span><span class="koboSpan" id="kobo.90.2">00:00:04     systemd
      2        ?          </span><span class="koboSpan" id="kobo.90.3">00:00:00     kthreadd
      3        ?          </span><span class="koboSpan" id="kobo.90.4">00:00:00     pool_workqueue_release
. </span><span class="koboSpan" id="kobo.90.5">. </span><span class="koboSpan" id="kobo.90.6">.
</span><span class="koboSpan" id="kobo.90.7">. </span><span class="koboSpan" id="kobo.90.8">. </span><span class="koboSpan" id="kobo.90.9">.
    </span><span class="koboSpan" id="kobo.90.10">28122  ?              </span><span class="koboSpan" id="kobo.90.11">00:00:00     Web Content
    28229  ?              </span><span class="koboSpan" id="kobo.90.12">00:00:00     kworker/7:0
    28267  pts/1          00:00:00     ps
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.91.1">But, that doesn’t show the </span><code class="inlineCode"><span class="koboSpan" id="kobo.92.1">RSS</span></code><span class="koboSpan" id="kobo.93.1"> field, which contains the memory use data that we want to see. </span><span class="koboSpan" id="kobo.93.2">So, I’ll add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.94.1">O rss</span></code><span class="koboSpan" id="kobo.95.1"> option, so that the final </span><code class="inlineCode"><span class="koboSpan" id="kobo.96.1">ps</span></code><span class="koboSpan" id="kobo.97.1"> command will be </span><code class="inlineCode"><span class="koboSpan" id="kobo.98.1">ps -eO rss</span></code><span class="koboSpan" id="kobo.99.1">. </span><span class="koboSpan" id="kobo.99.2">It should </span><a id="_idIndexMarker1476"/><span class="koboSpan" id="kobo.100.1">now show something that looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.101.1">PID     RSS   S TTY      TIME      COMMAND
 1      29628 S ?        </span><span class="koboSpan" id="kobo.101.2">00:00:04  /usr/lib/systemd/systemd --switched-root --sys
 2      0     S ?        </span><span class="koboSpan" id="kobo.101.3">00:00:00  [kthreadd]
 3      0     S ?        </span><span class="koboSpan" id="kobo.101.4">00:00:00  [pool_workqueue_release]
. </span><span class="koboSpan" id="kobo.101.5">. </span><span class="koboSpan" id="kobo.101.6">.
</span><span class="koboSpan" id="kobo.101.7">. </span><span class="koboSpan" id="kobo.101.8">. </span><span class="koboSpan" id="kobo.101.9">.
 </span><span class="koboSpan" id="kobo.101.10">27199  0     I ?        </span><span class="koboSpan" id="kobo.101.11">00:00:00  [kworker/8:2]
 27262  62216 S ?        </span><span class="koboSpan" id="kobo.101.12">00:00:00  /usr/lib64/firefox/firefox -contentproc -child
 27300  5060  R pts/1    00:00:00  ps -eO rss
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.102.1">The problem now is that that’s more than we want to see. </span><span class="koboSpan" id="kobo.102.2">Piping this output into </span><code class="inlineCode"><span class="koboSpan" id="kobo.103.1">awk</span></code><span class="koboSpan" id="kobo.104.1"> will filter out all of the unwanted stuff. </span><span class="koboSpan" id="kobo.104.2">But, to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.105.1">awk</span></code><span class="koboSpan" id="kobo.106.1">, you’ll need to know what’s in every field of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.107.1">ps</span></code><span class="koboSpan" id="kobo.108.1"> output, so that you’ll know what fields to list in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.109.1">awk</span></code><span class="koboSpan" id="kobo.110.1"> command. </span><span class="koboSpan" id="kobo.110.2">In this case, we want to see the </span><code class="inlineCode"><span class="koboSpan" id="kobo.111.1">PID</span></code><span class="koboSpan" id="kobo.112.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.113.1">RSS</span></code><span class="koboSpan" id="kobo.114.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.115.1">COMMAND</span></code><span class="koboSpan" id="kobo.116.1"> fields, which are fields 1, 2, and 6. </span><span class="koboSpan" id="kobo.116.2">We want to see all processes for which field 2 has a number that’s greater than 200 Megabytes, which we’re expressing here as </span><code class="inlineCode"><span class="koboSpan" id="kobo.117.1">(1024*200)</span></code><span class="koboSpan" id="kobo.118.1">.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.119.1">Remember that the true definition of a Megabytes is 1024 Kilobytes. </span><span class="koboSpan" id="kobo.119.2">Since </span><code class="inlineCode"><span class="koboSpan" id="kobo.120.1">awk</span></code><span class="koboSpan" id="kobo.121.1"> doesn’t understand measurements in Bytes, Kilobytes, Megabytes, and so forth, you’ll have to express your memory measurements as either a math formula or a normal integer. </span><span class="koboSpan" id="kobo.121.2">(The integer product of 1024*200 is 204800.)</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.122.1">Finally, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.123.1">printf</span></code><span class="koboSpan" id="kobo.124.1"> command will print out just the fields that we want to see, with the proper formatting options.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.125.1">Okay, that’s doable. </span><span class="koboSpan" id="kobo.125.2">But, can </span><a id="_idIndexMarker1477"/><span class="koboSpan" id="kobo.126.1">we simplify that with PowerShell? </span><span class="koboSpan" id="kobo.126.2">Let’s see.</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.127.1">PS /home/donnie&gt; Get-Process | Where-Object WorkingSet -ge 200MB
 NPM(K)    PM(M)      WS(M)     CPU(s)    Id  SI ProcessName
 ------    -----      -----     ------      --  -- -----------
      0     0.00     331.27      40.27    3215 …10 chromium-browser --enable-n…
      0     0.00     227.35      11.00    3674 …10 chromium-browser --type=ren…
      0     0.00     221.48      15.93    3369 …10 chromium-browser --type=ren…
      0     0.00     228.37      19.19    3588 …10 chromium-browser --type=ren…
. </span><span class="koboSpan" id="kobo.127.2">. </span><span class="koboSpan" id="kobo.127.3">.
</span><span class="koboSpan" id="kobo.127.4">. </span><span class="koboSpan" id="kobo.127.5">. </span><span class="koboSpan" id="kobo.127.6">.
      </span><span class="koboSpan" id="kobo.127.7">0     0.00     402.61     271.87    8737 …10 soffice.bin
      0     0.00     971.86   1,004.20    5869 …12 VirtualBoxVM
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.128.1">Yeah, I’m thinking that that’s a lot easier. </span><span class="koboSpan" id="kobo.128.2">It’s a lot shorter, which will make it less prone to error. </span><span class="koboSpan" id="kobo.128.3">The only field name you need to know is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.129.1">WorkingSet (WS)</span></code><span class="koboSpan" id="kobo.130.1"> field, which is equivalent to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.131.1">RSS</span></code><span class="koboSpan" id="kobo.132.1"> field in </span><code class="inlineCode"><span class="koboSpan" id="kobo.133.1">ps</span></code><span class="koboSpan" id="kobo.134.1">. </span><span class="koboSpan" id="kobo.134.2">Also, you see that we can pipe the output of one command (</span><code class="inlineCode"><span class="koboSpan" id="kobo.135.1">Get-Process</span></code><span class="koboSpan" id="kobo.136.1">) into another command (</span><code class="inlineCode"><span class="koboSpan" id="kobo.137.1">Where-Object</span></code><span class="koboSpan" id="kobo.138.1">), similarly to how we pipe the output of a Linux/Unix utility into another one. </span><span class="koboSpan" id="kobo.138.2">The best part is that this command is so intuitive, that I think you can figure out what it’s doing without me</span><a id="_idIndexMarker1478"/><span class="koboSpan" id="kobo.139.1"> even explaining it.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.140.1">All right, let’s move on to the next reason for learning PowerShell.</span></p>
    <h2 id="_idParaDest-500" class="heading 2"><span class="koboSpan" id="kobo.141.1">Enhanced Builtin Math Capabilities</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.142.1">If you need to create</span><a id="_idIndexMarker1479"/><span class="koboSpan" id="kobo.143.1"> scripts that are heavy on math, PowerShell might be just what you need. </span><span class="koboSpan" id="kobo.143.2">You can do floating point math without loading any external program, and a function library is available for advanced math functions. </span><span class="koboSpan" id="kobo.143.3">Let’s look at some examples.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.144.1">First, let’s do a simple division operation, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.145.1">PS /home/donnie&gt; 5 / 2
2.5
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.146.1">As you see, PowerShell does floating point math by default, without having to invoke any special tricks. </span><span class="koboSpan" id="kobo.146.2">Now, let’s put some different math problems into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.147.1">math1.ps1</span></code><span class="koboSpan" id="kobo.148.1"> script, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.149.1">param([Float]$number1 = "" , [Float]$number2 = "")
$sum = $number1 + $number2
Write-Host "The sum of these numbers is: " $sum
Write-Host "***********"
$divideresult= $number1 / $number2
Write-Host "Division of these two numbers results in: "$divideresult
Write-Host "***********"
$multiplyresult = $number1 * $number2
Write-Host "Multiplying these two numbers results in: " $multiplyresult
Write-Host "***********"
$modulo = $number1 % $number2
Write-Host "The remainder from dividing these two numbers is: " $modulo
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.150.1">The first thing to note here is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.151.1">param</span></code><span class="koboSpan" id="kobo.152.1"> line at the top. </span><span class="koboSpan" id="kobo.152.2">This is the directive that creates the positional parameters that I’ll use to pass arguments into the script. </span><span class="koboSpan" id="kobo.152.3">Instead of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.153.1">$1</span></code><span class="koboSpan" id="kobo.154.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.155.1">$2</span></code><span class="koboSpan" id="kobo.156.1"> as positional parameters, I’m using </span><code class="inlineCode"><span class="koboSpan" id="kobo.157.1">param</span></code><span class="koboSpan" id="kobo.158.1"> to create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.159.1">$number1</span></code><span class="koboSpan" id="kobo.160.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.161.1">$number2</span></code><span class="koboSpan" id="kobo.162.1"> positional parameters. </span><span class="koboSpan" id="kobo.162.2">Note how I need to create both positional parameters with just one </span><code class="inlineCode"><span class="koboSpan" id="kobo.163.1">param</span></code><span class="koboSpan" id="kobo.164.1"> directive. </span><span class="koboSpan" id="kobo.164.2">If I use two separate </span><code class="inlineCode"><span class="koboSpan" id="kobo.165.1">param</span></code><span class="koboSpan" id="kobo.166.1"> lines, the script will error out, because it won’t recognize the second </span><code class="inlineCode"><span class="koboSpan" id="kobo.167.1">param</span></code><span class="koboSpan" id="kobo.168.1"> line. </span><span class="koboSpan" id="kobo.168.2">Also, I’ve specified that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.169.1">number1</span></code><span class="koboSpan" id="kobo.170.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.171.1">number2</span></code><span class="koboSpan" id="kobo.172.1"> variables that I’m using for the positional parameters will be of the floating point number type.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.173.1">The rest of the script is</span><a id="_idIndexMarker1480"/><span class="koboSpan" id="kobo.174.1"> a straightforward demonstration of how to do addition, division, multiplication, and modulo operations. </span><span class="koboSpan" id="kobo.174.2">Instead of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.175.1">echo</span></code><span class="koboSpan" id="kobo.176.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.177.1">printf</span></code><span class="koboSpan" id="kobo.178.1"> statements, I’m using PowerShell’s native </span><code class="inlineCode"><span class="koboSpan" id="kobo.179.1">Write-Host</span></code><span class="koboSpan" id="kobo.180.1"> command. </span><span class="koboSpan" id="kobo.180.2">Also, note how variable names will always be preceded by a </span><code class="inlineCode"><span class="koboSpan" id="kobo.181.1">$</span></code><span class="koboSpan" id="kobo.182.1">, whether you’re defining them or calling back their values. </span><span class="koboSpan" id="kobo.182.2">Now, let’s run the script with 5 and 2 as our arguments:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.183.1">PS /home/donnie&gt; ./math1.ps1 5 2
The sum of these numbers is:  7
***********
Division of these two numbers results in:  2.5
***********
Multiplying these two numbers results in:  10
***********
The remainder from dividing these two numbers is:  1
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.184.1">Easy enough, right? </span><span class="koboSpan" id="kobo.184.2">Well, doing more advanced math in PowerShell is just as easy. </span><span class="koboSpan" id="kobo.184.3">To demonstrate, let’s create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.185.1">math2.ps1</span></code><span class="koboSpan" id="kobo.186.1"> script, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.187.1">param([Float]$number1 = "")
$tangent = [math]::Tan($number1/180*[math]::PI)
Write-Host "The tangent of $number1 degrees is:  $tangent."
</span><span class="koboSpan" id="kobo.187.2">Write-Host "***********"
$cosine = [math]::Cos($number1/180*[math]::PI)
Write-Host "The cosine of $number1 degrees is: "$cosine
Write-Host "***********"
$squareroot = [math]::Sqrt($number1)
Write-Host "The square root of $number1 is: " $squareroot
Write-Host "***********"
$logarithm = [math]::Log10($number1)
Write-Host "The base 10 logarithm of $number1 is: " $logarithm
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.188.1">Here, you see how I’m using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.189.1">[math]::</span></code><span class="koboSpan" id="kobo.190.1"> construct to call in the functions that calculate the tangent, cosine, square root, and logarithm of my specified number. </span><span class="koboSpan" id="kobo.190.2">The only slight catch is that the tangent and cosine functions work with radians by default. </span><span class="koboSpan" id="kobo.190.3">To make it work with degrees, I had to divide the number of degrees that I input by 180, and then multiply that by the value of pi (π). </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.191.1">Now, let’s run this with 45 as my argument:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.192.1">PS /home/donnie&gt; ./math2.ps1 45
The tangent of  45  degrees is:  1.
</span><span class="koboSpan" id="kobo.192.2">***********
The cosine of 45 degrees is:  0.7071067811865476
***********
The square root of 45 is:  6.708203932499369
***********
The base 10 logarithm of 45 is:  1.6532125137753437
PS /home/donnie&gt; vim
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.193.1">Oh yeah, looking</span><a id="_idIndexMarker1481"/><span class="koboSpan" id="kobo.194.1"> good.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.195.1">You can read more about </span><a id="_idIndexMarker1482"/><span class="koboSpan" id="kobo.196.1">PowerShell math, including a more complete list of its math functions, here:</span></p>
      <p class="normal"><a href="https://ss64.com/ps/syntax-math.html"><span class="url"><span class="koboSpan" id="kobo.197.1">https://ss64.com/ps/syntax-math.html</span></span></a></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.198.1">Next, let’s look at some fundamental differences between PowerShell and the more traditional shells.</span></p>
    <h1 id="_idParaDest-501" class="heading 1"><span class="koboSpan" id="kobo.199.1">Differences Between PowerShell Scripting and Traditional Linux/Unix Scripting</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.200.1">PowerShell still uses many of the same programming constructs as other scripting languages use, such as functions, loops, </span><code class="inlineCode"><span class="koboSpan" id="kobo.201.1">if</span></code><span class="koboSpan" id="kobo.202.1"> constructs, and so forth. </span><span class="koboSpan" id="kobo.202.2">But, as you’ve already seen there are also some differences in the basic design of PowerShell that set it apart from traditional Linux/Unix shell scripting. </span><span class="koboSpan" id="kobo.202.3">Let’s look at a few examples.</span></p>
    <h2 id="_idParaDest-502" class="heading 2"><span class="koboSpan" id="kobo.203.1">Using Filename Extensions and the Executable Permission</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.204.1">Throughout this book, you’ve seen me create normal Linux/Unix scripts with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.205.1">.sh</span></code><span class="koboSpan" id="kobo.206.1"> extensions</span><a id="_idIndexMarker1483"/><span class="koboSpan" id="kobo.207.1"> on their filenames. </span><span class="koboSpan" id="kobo.207.2">In reality, you don’t have to use any filename extension on normal Linux/Unix scripts. </span><span class="koboSpan" id="kobo.207.3">This means that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.208.1">somescript.sh</span></code><span class="koboSpan" id="kobo.209.1"> script would work just as well if the its filename were just </span><code class="inlineCode"><span class="koboSpan" id="kobo.210.1">somescript</span></code><span class="koboSpan" id="kobo.211.1">. </span><span class="koboSpan" id="kobo.211.2">With PowerShell, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.212.1">.ps1</span></code><span class="koboSpan" id="kobo.213.1"> filename extension is mandatory for all PowerShell scripts. </span><span class="koboSpan" id="kobo.213.2">Without it, your PowerShell script just won’t run.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.214.1">On the other hand, it’s not necessary to set the executable permission</span><a id="_idIndexMarker1484"/><span class="koboSpan" id="kobo.215.1"> on PowerShell scripts, as it is for traditional Linux/Unix scripts. </span><span class="koboSpan" id="kobo.215.2">As long as the script file has </span><code class="inlineCode"><span class="koboSpan" id="kobo.216.1">.ps1</span></code><span class="koboSpan" id="kobo.217.1"> at the end of its filename, and as long as you’re in the PowerShell environment, the script will run.</span></p>
    <h2 id="_idParaDest-503" class="heading 2"><span class="koboSpan" id="kobo.218.1">PowerShell is Object-oriented</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.219.1">The traditional Linux and</span><a id="_idIndexMarker1485"/><span class="koboSpan" id="kobo.220.1"> Unix shell scripting languages are</span><a id="_idIndexMarker1486"/><span class="koboSpan" id="kobo.221.1"> strictly </span><strong class="keyWord"><span class="koboSpan" id="kobo.222.1">procedural languages</span></strong><span class="koboSpan" id="kobo.223.1">. </span><span class="koboSpan" id="kobo.223.2">This means that the commands in the program or script that you create will work on data from some external source. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.224.1">That source could be the keyboard, a file, a database, or even a </span><em class="italic"><span class="koboSpan" id="kobo.225.1">here</span></em><span class="koboSpan" id="kobo.226.1"> document that’s embedded within the script or program. </span><span class="koboSpan" id="kobo.226.2">Understand that the data and the commands that work on them are completely separate entities.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.227.1">With </span><strong class="keyWord"><span class="koboSpan" id="kobo.228.1">object-oriented programming</span></strong><span class="koboSpan" id="kobo.229.1">, which you’ll sometimes see referred to as </span><strong class="keyWord"><span class="koboSpan" id="kobo.230.1">OOP</span></strong><span class="koboSpan" id="kobo.231.1">, the data and </span><a id="_idIndexMarker1487"/><span class="koboSpan" id="kobo.232.1">the procedures that operate on the data are packaged together in an </span><strong class="keyWord"><span class="koboSpan" id="kobo.233.1">object</span></strong><span class="koboSpan" id="kobo.234.1">. </span><span class="koboSpan" id="kobo.234.2">This allows you to do cool things, like telling a numerical object to double itself. </span><span class="koboSpan" id="kobo.234.3">It also allows you to create other objects that </span><a id="_idIndexMarker1488"/><span class="koboSpan" id="kobo.235.1">inherit characteristics from their parent objects.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.236.1">I know that this is a simplified explanation of object-oriented programming. </span><span class="koboSpan" id="kobo.236.2">But, a detailed explanation is way beyond the scope of this book. </span><span class="koboSpan" id="kobo.236.3">Of course, if you’ve ever programmed in languages like C++ or Java, you’ll know what I’m talking about.</span></p>
    </div>
    <h2 id="_idParaDest-504" class="heading 2"><span class="koboSpan" id="kobo.237.1">PowerShell Uses Cmdlets</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.238.1">Most PowerShell commands are actually </span><a id="_idIndexMarker1489"/><span class="koboSpan" id="kobo.239.1">referred to as </span><strong class="keyWord"><span class="koboSpan" id="kobo.240.1">Cmdlets</span></strong><span class="koboSpan" id="kobo.241.1">, which you’ll pronounce as </span><em class="italic"><span class="koboSpan" id="kobo.242.1">command-lets</span></em><span class="koboSpan" id="kobo.243.1">, while others are either aliases or functions. </span><span class="koboSpan" id="kobo.243.2">Each Cmdlet</span><a id="_idIndexMarker1490"/><span class="koboSpan" id="kobo.244.1"> takes the form of a verb and a noun separated by a hyphen, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.245.1">Get-Content</span></code><span class="koboSpan" id="kobo.246.1">, which gets (reads) from a file, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.247.1">Set-Content</span></code><span class="koboSpan" id="kobo.248.1">, which writes to a file. </span><span class="koboSpan" id="kobo.248.2">The way this works on Windows machines is that every Windows subsystem has its own set of Cmdlets. </span><span class="koboSpan" id="kobo.248.3">For example, a Windows machine that acts as a </span><strong class="keyWord"><span class="koboSpan" id="kobo.249.1">Domain Name System</span></strong><span class="koboSpan" id="kobo.250.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.251.1">DNS</span></strong><span class="koboSpan" id="kobo.252.1">) server</span><a id="_idIndexMarker1491"/><span class="koboSpan" id="kobo.253.1"> would have a set of Cmdlets to work with DNS, and a </span><strong class="keyWord"><span class="koboSpan" id="kobo.254.1">Microsoft Exchange</span></strong><span class="koboSpan" id="kobo.255.1"> server</span><a id="_idIndexMarker1492"/><span class="koboSpan" id="kobo.256.1"> would have Cmdlets for working with Exchange.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.257.1">The Linux and Mac versions of PowerShell have far fewer sets of Cmdlets, because all of the Windows-specific stuff has been stripped out. </span><span class="koboSpan" id="kobo.257.2">You’ll find what you need to work with Linux or macOS, but nothing else.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.258.1">As you see, these Cmdlets are a lot different from the commands that Linux/Unix admins are used to using. </span><span class="koboSpan" id="kobo.258.2">For that reason, you might consider using aliases to help ease the transition to PowerShell. </span><span class="koboSpan" id="kobo.258.3">Let’s check that out next.</span></p>
    <h2 id="_idParaDest-505" class="heading 2"><span class="koboSpan" id="kobo.259.1">Using Aliases on PowerShell</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.260.1">On Windows machines, PowerShell has aliases</span><a id="_idIndexMarker1493"/><span class="koboSpan" id="kobo.261.1"> already set up that allow you to use Linux/Unix commands </span><a id="_idIndexMarker1494"/><span class="koboSpan" id="kobo.262.1">in place of PowerShell commands. </span><span class="koboSpan" id="kobo.262.2">(Microsoft did this on purpose to make it easier for Linux/Unix admins to learn PowerShell.) For example, here’s how to list files in your current directory on PowerShell for Linux:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.263.1">PS /home/donnie&gt; Get-ChildItem
    Directory: /home/donnie
UnixMode         User Group    LastWriteTime       Size Name
--------         ---- -----    -------------       ---- ----
drwxr-xr-x     donnie donnie   6/29/2024 21:10     4096 bashlib-0.4
drwx------     donnie donnie   7/4/2024 23:59      4096 demo_files
. </span><span class="koboSpan" id="kobo.263.2">. </span><span class="koboSpan" id="kobo.263.3">.
</span><span class="koboSpan" id="kobo.263.4">. </span><span class="koboSpan" id="kobo.263.5">. </span><span class="koboSpan" id="kobo.263.6">.
</span><span class="koboSpan" id="kobo.263.7">-rw-rw-r--     donnie donnie   9/3/2024 22:26      67 zsh_fruits.txt
-rwxrw-r--     donnie donnie   9/4/2024 18:17      141 zsh_time.sh
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.264.1">You see that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.265.1">Get-ChildItem</span></code><span class="koboSpan" id="kobo.266.1"> command does pretty much the same job as an </span><code class="inlineCode"><span class="koboSpan" id="kobo.267.1">ls -l</span></code><span class="koboSpan" id="kobo.268.1"> command. </span><span class="koboSpan" id="kobo.268.2">On a Windows machine, there will already be a PowerShell alias that allows you to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.269.1">ls</span></code><span class="koboSpan" id="kobo.270.1"> command to run the </span><code class="inlineCode"><span class="koboSpan" id="kobo.271.1">Get-ChildItem</span></code><span class="koboSpan" id="kobo.272.1"> command. </span><span class="koboSpan" id="kobo.272.2">Here’s how that looks on one of my Windows machines:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.273.1"><img src="../Images/B21693_23_02.png" alt="B21693_23_2"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.274.1">Figure 23.2: Using the ls PowerShell alias on Windows</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.275.1">So yeah, this looks just like the </span><code class="inlineCode"><span class="koboSpan" id="kobo.276.1">Get-ChildItem</span></code><span class="koboSpan" id="kobo.277.1"> command. </span><span class="koboSpan" id="kobo.277.2">But, if you open a PowerShell session on Linux </span><a id="_idIndexMarker1495"/><span class="koboSpan" id="kobo.278.1">or Mac and run the </span><code class="inlineCode"><span class="koboSpan" id="kobo.279.1">ls</span></code><span class="koboSpan" id="kobo.280.1"> command, you won’t invoke the alias, because </span><a id="_idIndexMarker1496"/><span class="koboSpan" id="kobo.281.1">no aliases are set up by default. </span><span class="koboSpan" id="kobo.281.2">Instead, you’ll invoke the actual </span><code class="inlineCode"><span class="koboSpan" id="kobo.282.1">ls</span></code><span class="koboSpan" id="kobo.283.1"> command from your Linux or Mac operating system. </span><span class="koboSpan" id="kobo.283.2">Here’s how that looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.284.1">PS /home/donnie&gt; ls
acl_demo.sh		   rootlock_1.sh
bashlib-0.4		   rootlock_2.sh
date_time.sh		   rsync_password.sh
. </span><span class="koboSpan" id="kobo.284.2">. </span><span class="koboSpan" id="kobo.284.3">.
</span><span class="koboSpan" id="kobo.284.4">. </span><span class="koboSpan" id="kobo.284.5">. </span><span class="koboSpan" id="kobo.284.6">.
</span><span class="koboSpan" id="kobo.284.7">hello.sh		   zsh_fruits.txt
My_Files		   zsh_time.sh
rootlock_1a.sh
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.285.1">You see that this looks nothing like </span><code class="inlineCode"><span class="koboSpan" id="kobo.286.1">Get-ChildItem</span></code><span class="koboSpan" id="kobo.287.1">. </span><span class="koboSpan" id="kobo.287.2">In fact, it’s just the normal output from your normal </span><code class="inlineCode"><span class="koboSpan" id="kobo.288.1">ls</span></code><span class="koboSpan" id="kobo.289.1"> command.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.290.1">Fortunately though, you</span><a id="_idIndexMarker1497"/><span class="koboSpan" id="kobo.291.1"> can create your own aliases on PowerShell, which can</span><a id="_idIndexMarker1498"/><span class="koboSpan" id="kobo.292.1"> make typing PowerShell commands much easier. </span><span class="koboSpan" id="kobo.292.2">You can create aliases with either the </span><code class="inlineCode"><span class="koboSpan" id="kobo.293.1">Set-Alias</span></code><span class="koboSpan" id="kobo.294.1"> or the </span><code class="inlineCode"><span class="koboSpan" id="kobo.295.1">New-Alias</span></code><span class="koboSpan" id="kobo.296.1"> Cmdlets. </span><span class="koboSpan" id="kobo.296.2">Let’s first create the alias that will make </span><code class="inlineCode"><span class="koboSpan" id="kobo.297.1">ls</span></code><span class="koboSpan" id="kobo.298.1"> run the </span><code class="inlineCode"><span class="koboSpan" id="kobo.299.1">Get-ChildItem</span></code><span class="koboSpan" id="kobo.300.1"> command, using </span><code class="inlineCode"><span class="koboSpan" id="kobo.301.1">Set-Alias</span></code><span class="koboSpan" id="kobo.302.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.303.1">PS /home/donnie&gt; Set-Alias -Name ls -Value Get-ChildItem
PS /home/donnie&gt; ls
    Directory: /home/donnie
UnixMode         User Group         LastWriteTime         Size Name
--------         ---- -----         -------------         ---- ----
drwxr-xr-x     donnie donnie      6/29/2024 21:10         4096 bashlib-0.4
drwx------     donnie donnie       7/4/2024 23:59         4096 demo_files
. </span><span class="koboSpan" id="kobo.303.2">. </span><span class="koboSpan" id="kobo.303.3">.
</span><span class="koboSpan" id="kobo.303.4">. </span><span class="koboSpan" id="kobo.303.5">. </span><span class="koboSpan" id="kobo.303.6">.
</span><span class="koboSpan" id="kobo.303.7">-rw-rw-r--     donnie donnie       9/3/2024 22:26           67 zsh_fruits.txt
-rwxrw-r--     donnie donnie       9/4/2024 18:17          141 zsh_time.sh
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.304.1">The other way is to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.305.1">New-Alias</span></code><span class="koboSpan" id="kobo.306.1">, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.307.1">PS /home/donnie&gt; New-Alias ls Get-ChildItem
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.308.1">Either way works equally well, but it’s only a temporary fix. </span><span class="koboSpan" id="kobo.308.2">Once you close your PowerShell session, you’ll lose the alias. </span><span class="koboSpan" id="kobo.308.3">To make your aliases permanent, you’ll need to edit your PowerShell profile file. </span><span class="koboSpan" id="kobo.308.4">You can find where it’s supposed to be by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.309.1">PS /home/donnie&gt; echo $profile
/home/donnie/.config/powershell/Microsoft.PowerShell_profile.ps1
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.310.1">The only problem is that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.311.1">.config/</span></code><span class="koboSpan" id="kobo.312.1"> directory is there, but neither the </span><code class="inlineCode"><span class="koboSpan" id="kobo.313.1">powershell/</span></code><span class="koboSpan" id="kobo.314.1"> subdirectory nor the </span><code class="inlineCode"><span class="koboSpan" id="kobo.315.1">Microsoft.PowerShell_profile.ps1</span></code><span class="koboSpan" id="kobo.316.1"> file is. </span><span class="koboSpan" id="kobo.316.2">So, you’ll need to create them. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.317.1">You can just use your normal Linux/Mac command to create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.318.1">powershell/</span></code><span class="koboSpan" id="kobo.319.1"> subdirectory, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.320.1">PS /home/donnie&gt; mkdir .config/powershell
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.321.1">Then, use your </span><a id="_idIndexMarker1499"/><span class="koboSpan" id="kobo.322.1">favorite text editor to create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.323.1">Microsoft.PowerShell_profile.ps1</span></code><span class="koboSpan" id="kobo.324.1"> file within that new </span><code class="inlineCode"><span class="koboSpan" id="kobo.325.1">powershell/</span></code><span class="koboSpan" id="kobo.326.1"> subdirectory. </span><span class="koboSpan" id="kobo.326.2">Add this line to create</span><a id="_idIndexMarker1500"/><span class="koboSpan" id="kobo.327.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.328.1">ls</span></code><span class="koboSpan" id="kobo.329.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.330.1">Get-ChildItem</span></code><span class="koboSpan" id="kobo.331.1"> alias:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.332.1">New-Alias ls Get-ChildItem
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.333.1">You can add as many aliases to this file as you like. </span><span class="koboSpan" id="kobo.333.2">Just remember to log out of your PowerShell session, and then log back in to ensure that the new profile takes effect.</span></p>
    <div class="note">
      <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.334.1">Important</span></strong><span class="koboSpan" id="kobo.335.1">: If you intend to create PowerShell scripts that will run on multiple machines, be aware that the aliases that you’ve created might not be available on some of them. </span><span class="koboSpan" id="kobo.335.2">Your best bet in that case will be to forget about using your own aliases, and just use the native PowerShell commands.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.336.1">Next, let’s see how to view the available PowerShell Commands.</span></p>
    <h1 id="_idParaDest-506" class="heading 1"><span class="koboSpan" id="kobo.337.1">Viewing the Available PowerShell Commands</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.338.1">To see what </span><a id="_idIndexMarker1501"/><span class="koboSpan" id="kobo.339.1">commands are available to you, just do:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.340.1">PS /home/donnie&gt; Get-Command     
CommandType     Name               Version    S
                                                                        					                           o
                                                                           					                           u
                                                                        					                           r
                                                                        					                           c
                                                                        					                           e
-----------     ----               -------    -
Alias           Get-PSResource     1.0.4.1    M
Function        cd..                                                        
</span><span class="koboSpan" id="kobo.340.2">Function        cd\                                                         
Function        cd~                                                         
Function        Clear-Host                                                  
Function        Compress-Archive   1.2.5      M
. </span><span class="koboSpan" id="kobo.340.3">. </span><span class="koboSpan" id="kobo.340.4">.
</span><span class="koboSpan" id="kobo.340.5">. </span><span class="koboSpan" id="kobo.340.6">. </span><span class="koboSpan" id="kobo.340.7">.
</span><span class="koboSpan" id="kobo.340.8">Cmdlet          Write-Verbose      7.0.0.0    M
Cmdlet          Write-Warning      7.0.0.0    M
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.341.1">Under </span><code class="inlineCode"><span class="koboSpan" id="kobo.342.1">CommandType</span></code><span class="koboSpan" id="kobo.343.1">, you see that we have aliases, functions, and Cmdlets. </span><span class="koboSpan" id="kobo.343.2">Under the </span><code class="inlineCode"><span class="koboSpan" id="kobo.344.1">Source</span></code><span class="koboSpan" id="kobo.345.1"> column, you see the letter </span><code class="inlineCode"><span class="koboSpan" id="kobo.346.1">M</span></code><span class="koboSpan" id="kobo.347.1">, which means that these commands are all stored in some PowerShell module.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.348.1">Of course, there aren’t nearly as many PowerShell commands for Linux as there are for Windows. </span><span class="koboSpan" id="kobo.348.2">To see how many there are, just do this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.349.1">PS /home/donnie&gt; Get-Command | Measure-Object | Select-Object -Property Count
Count
-----
  293
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.350.1">Here, we begin</span><a id="_idIndexMarker1502"/><span class="koboSpan" id="kobo.351.1"> by piping the output of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.352.1">Get-Command </span></code><span class="koboSpan" id="kobo.353.1">Cmdlet into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.354.1">Measure-Object</span></code><span class="koboSpan" id="kobo.355.1"> Cmdlet. </span><span class="koboSpan" id="kobo.355.2">The official explanation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.356.1">Measure-Object</span></code><span class="koboSpan" id="kobo.357.1">, according to the help file, is that it calculates the property values of certain types of objects. </span><span class="koboSpan" id="kobo.357.2">In this case, we only want to see one of those calculations, which shows us how many commands there are. </span><span class="koboSpan" id="kobo.357.3">We’ll do that by piping the </span><code class="inlineCode"><span class="koboSpan" id="kobo.358.1">Measure-Object</span></code><span class="koboSpan" id="kobo.359.1"> output into </span><code class="inlineCode"><span class="koboSpan" id="kobo.360.1">Select-Object -Property Count</span></code><span class="koboSpan" id="kobo.361.1">, which works the same as the Linux/Unix </span><code class="inlineCode"><span class="koboSpan" id="kobo.362.1">wc -l</span></code><span class="koboSpan" id="kobo.363.1"> command. </span><span class="koboSpan" id="kobo.363.2">After all that, we see that there are 293 PowerShell commands available on this Linux machine.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.364.1">As I’ve mentioned a few pages back in the </span><em class="chapterRef"><span class="koboSpan" id="kobo.365.1">PowerShell Uses Cmdlets</span></em><span class="koboSpan" id="kobo.366.1"> section, all Cmdlets are in the </span><em class="italic"><span class="koboSpan" id="kobo.367.1">Verb-Noun</span></em><span class="koboSpan" id="kobo.368.1"> format. </span><span class="koboSpan" id="kobo.368.2">You can use </span><code class="inlineCode"><span class="koboSpan" id="kobo.369.1">Get-Command</span></code><span class="koboSpan" id="kobo.370.1"> with either the </span><code class="inlineCode"><span class="koboSpan" id="kobo.371.1">-Verb</span></code><span class="koboSpan" id="kobo.372.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.373.1">-Noun</span></code><span class="koboSpan" id="kobo.374.1"> options to see all of the commands for a particular verb or noun. </span><span class="koboSpan" id="kobo.374.2">For example, let’s see all of the available commands for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.375.1">Date</span></code><span class="koboSpan" id="kobo.376.1"> noun:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.377.1">PS /home/donnie&gt; Get-Command -Noun 'Date'
CommandType     Name          Version    S
                                         o
                                         u
                                         r
                                         c
                                         e
-----------     ----          ----    -
Cmdlet          Get-Date      7.0.0.0    M
Cmdlet          Set-Date      7.0.0.0    M
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.378.1">We see that there </span><a id="_idIndexMarker1503"/><span class="koboSpan" id="kobo.379.1">are only two Cmdlets for </span><code class="inlineCode"><span class="koboSpan" id="kobo.380.1">Date</span></code><span class="koboSpan" id="kobo.381.1">. </span><span class="koboSpan" id="kobo.381.2">Let’s see how many there are for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.382.1">Set</span></code><span class="koboSpan" id="kobo.383.1"> verb:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.384.1">PS /home/donnie&gt; Get-Command -Verb 'Set'
CommandType     Name                 Version    S
                                                o
                                                u
                                                r
                                                c
                                                e
-----------     ----                 -------    -
Function        Set-HostnameMapping  1.0.1      H
Function        Set-PSRepository     2.2.5      P
Cmdlet          Set-Alias            7.0.0.0    M
Cmdlet          Set-Clipboard        7.0.0.0    M
. </span><span class="koboSpan" id="kobo.384.2">. </span><span class="koboSpan" id="kobo.384.3">.
</span><span class="koboSpan" id="kobo.384.4">. </span><span class="koboSpan" id="kobo.384.5">. </span><span class="koboSpan" id="kobo.384.6">.
</span><span class="koboSpan" id="kobo.384.7">Cmdlet          Set-StrictMode       7.4.5.500  M
Cmdlet          Set-TraceSource      7.0.0.0    M
Cmdlet          Set-Variable         7.0.0.0    M
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.385.1">Now, you’re wondering how to find out what all of these PowerShell commands do. </span><span class="koboSpan" id="kobo.385.2">Well, let’s look at that next.</span></p>
    <h1 id="_idParaDest-507" class="heading 1"><span class="koboSpan" id="kobo.386.1">Getting Help with PowerShell Commands</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.387.1">This one is easy. </span><span class="koboSpan" id="kobo.387.2">Just</span><a id="_idIndexMarker1504"/><span class="koboSpan" id="kobo.388.1"> use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.389.1">Get-Help</span></code><span class="koboSpan" id="kobo.390.1"> Cmdlet, followed by the name of the command for which you need information. </span><span class="koboSpan" id="kobo.390.2">For example, you can see information about the </span><code class="inlineCode"><span class="koboSpan" id="kobo.391.1">Get-Module</span></code><span class="koboSpan" id="kobo.392.1"> Cmdlet like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.393.1">PS /home/donnie&gt; Get-Help Get-Module
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.394.1">What you’ll see will resemble a normal Linux/Unix man page.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.395.1">At the bottom of every </span><code class="inlineCode"><span class="koboSpan" id="kobo.396.1">Get-Help</span></code><span class="koboSpan" id="kobo.397.1"> screen, you’ll see commands that will show you how to see even more information. </span><span class="koboSpan" id="kobo.397.2">For example, if you need to see examples of how to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.398.1">Get-Module </span></code><span class="koboSpan" id="kobo.399.1">Cmdlet, do this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.400.1">PS /home/donnie&gt; Get-Help Get-Module -Examples
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.401.1">Sometimes, the help page for the command that you need to learn about isn’t available. </span><span class="koboSpan" id="kobo.401.2">In those cases, either run the </span><code class="inlineCode"><span class="koboSpan" id="kobo.402.1">Update-Help</span></code><span class="koboSpan" id="kobo.403.1"> Cmdlet, or append the </span><code class="inlineCode"><span class="koboSpan" id="kobo.404.1">-Online</span></code><span class="koboSpan" id="kobo.405.1"> option to the end of your </span><code class="inlineCode"><span class="koboSpan" id="kobo.406.1">Get-Help</span></code><span class="koboSpan" id="kobo.407.1"> command.</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.408.1">Another great resource is the PowerShell Commands page, which you can find here: </span><a href="https://ss64.com/ps/"><span class="url"><span class="koboSpan" id="kobo.409.1">https://ss64.com/ps/</span></span></a></p>
      <p class="normal"><span class="koboSpan" id="kobo.410.1">(Of course, a lot of the listed commands are Windows-specific, but you’ll also find quite a few that are cross-platform.)</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.411.1">Okay, I think</span><a id="_idIndexMarker1505"/><span class="koboSpan" id="kobo.412.1"> that this does it for the PowerShell theory. </span><span class="koboSpan" id="kobo.412.2">Let’s look at a couple of real-world examples of PowerShell scripts.</span></p>
    <h1 id="_idParaDest-508" class="heading 1"><span class="koboSpan" id="kobo.413.1">Real-World Cross-Platform PowerShell Scripts</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.414.1">To come up with some real-world examples of cross-platform PowerShell scripts, I did a DuckDuckGo </span><a id="_idIndexMarker1506"/><span class="koboSpan" id="kobo.415.1">search for the </span><em class="italic"><span class="koboSpan" id="kobo.416.1">PowerShell script examples Linux</span></em><span class="koboSpan" id="kobo.417.1"> text string. </span><span class="koboSpan" id="kobo.417.2">The coolest thing I found is the </span><em class="italic"><span class="koboSpan" id="kobo.418.1">Mega Collection of PowerShell Scripts</span></em><span class="koboSpan" id="kobo.419.1"> on Github. </span><span class="koboSpan" id="kobo.419.2">You can use </span><code class="inlineCode"><span class="koboSpan" id="kobo.420.1">git</span></code><span class="koboSpan" id="kobo.421.1"> to download it by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.422.1">git clone https://github.com/fleschutz/PowerShell.git
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.423.1">Once it’s downloaded, </span><code class="inlineCode"><span class="koboSpan" id="kobo.424.1">cd</span></code><span class="koboSpan" id="kobo.425.1"> into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.426.1">PowerShell/scripts/</span></code><span class="koboSpan" id="kobo.427.1"> directory, and take a look at what’s there. </span><span class="koboSpan" id="kobo.427.2">For our first example, let’s look at something simple that will run on all platforms.</span></p>
    <h2 id="_idParaDest-509" class="heading 2"><span class="koboSpan" id="kobo.428.1">The write-marquee.ps1 Script</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.429.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.430.1">write-marquee.ps1</span></code><span class="koboSpan" id="kobo.431.1"> script</span><a id="_idIndexMarker1507"/><span class="koboSpan" id="kobo.432.1"> is truly cross-platform, because</span><a id="_idIndexMarker1508"/><span class="koboSpan" id="kobo.433.1"> it doesn’t use any commands that are specific to any particular operating system. </span><span class="koboSpan" id="kobo.433.2">All it does is create a marquee message that flows across on your screen. </span><span class="koboSpan" id="kobo.433.3">I can’t show the entire script here, but you can look at your own local copy. </span><span class="koboSpan" id="kobo.433.4">So, let’s just look at the individual parts of it to see how it’s set up.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.434.1">At the top, you see the comment section, which is surrounded by </span><code class="inlineCode"><span class="koboSpan" id="kobo.435.1">&lt;#</span></code><span class="koboSpan" id="kobo.436.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.437.1">#&gt;</span></code><span class="koboSpan" id="kobo.438.1">. </span><span class="koboSpan" id="kobo.438.2">Actually, these are more than just comments. </span><span class="koboSpan" id="kobo.438.3">If you do </span><code class="inlineCode"><span class="koboSpan" id="kobo.439.1">Get-Help ./write-marquee.ps1</span></code><span class="koboSpan" id="kobo.440.1">, you’ll see that everything that’s within the </span><code class="inlineCode"><span class="koboSpan" id="kobo.441.1">&lt;#</span></code><span class="koboSpan" id="kobo.442.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.443.1">#&gt;</span></code><span class="koboSpan" id="kobo.444.1"> will come up as a help screen, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.445.1">PS /home/donnie/PowerShell/scripts&gt; Get-Help ./write-marquee.ps1
NAME
    /home/donnie/PowerShell/scripts/write-marquee.ps1
SYNOPSIS
    Writes text as marquee
. </span><span class="koboSpan" id="kobo.445.2">. </span><span class="koboSpan" id="kobo.445.3">.
</span><span class="koboSpan" id="kobo.445.4">. </span><span class="koboSpan" id="kobo.445.5">. </span><span class="koboSpan" id="kobo.445.6">.
</span><span class="koboSpan" id="kobo.445.7">REMARKS
    To see the examples, type: "Get-Help /home/donnie/PowerShell/scripts/write-marquee.ps1 -Examples"
    For more information, type: "Get-Help /home/donnie/PowerShell/scripts/write-marquee.ps1 -Detailed"
    For technical information, type: "Get-Help /home/donnie/PowerShell/scripts/write-marquee.ps1 -Full"
    For online help, type: "Get-Help /home/donnie/PowerShell/scripts/write-marquee.ps1 -Online"
PS /home/donnie/PowerShell/scripts&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.446.1">Next, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.447.1">param([string]$Text =</span></code><span class="koboSpan" id="kobo.448.1"> line creates the string-type variable that contains the marquee message. </span><span class="koboSpan" id="kobo.448.2">It looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.449.1">param([string]$Text = "PowerShell is powerful - fully control your computer! </span><span class="koboSpan" id="kobo.449.2">PowerShell is cross-platform - available for Linux, Mac OS and Windows! </span><span class="koboSpan" id="kobo.449.3">PowerShell is open-source and free - see the GitHub repository at github.com/PowerShell/PowerShell! </span><span class="koboSpan" id="kobo.449.4">PowerShell is easy to learn - see the tutorial for beginners at guru99.com/powershell-tutorial.html! </span><span class="koboSpan" id="kobo.449.5">Powershell is fully documented - see the official PowerShell documentation at docs.microsoft.com/en-us/powershell", [int]$Speed = 60) # 60 ms pause
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.450.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.451.1">[int]$Speed = 60) # 60 ms pause</span></code><span class="koboSpan" id="kobo.452.1"> part at the end of the variable definition determines the speed at which the marquee message will flow across the screen.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.453.1">Next up </span><a id="_idIndexMarker1509"/><span class="koboSpan" id="kobo.454.1">is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.455.1">StartMarquee</span></code><span class="koboSpan" id="kobo.456.1"> function, which</span><a id="_idIndexMarker1510"/><span class="koboSpan" id="kobo.457.1"> looks like this:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.458.1"><img src="../Images/B21693_23_03.png" alt="B21693_23_3"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.459.1">Figure 23.3: The StartMarquee function</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.460.1">After drawing the marquee box and using </span><code class="inlineCode"><span class="koboSpan" id="kobo.461.1">$LinePos</span></code><span class="koboSpan" id="kobo.462.1"> lines to ensure that everything gets properly positioned, you see the </span><code class="inlineCode"><span class="koboSpan" id="kobo.463.1">foreach</span></code><span class="koboSpan" id="kobo.464.1"> loop that prints the message out to the screen, one letter at a time.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.465.1">Finally, after the function definition, you see the function call:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.466.1">StartMarquee "                                                                                    +++ $Text +++ $Text +++ $Text +++ $Text +++ $Text +++ $Text +++ $Text +++ $Text +++ $Text +++ $Text +++ $Text +++ $Text +++                                                                                         
"
exit 0 # success
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.467.1">The</span><a id="_idIndexMarker1511"/><span class="koboSpan" id="kobo.468.1"> function call passes the </span><code class="inlineCode"><span class="koboSpan" id="kobo.469.1">$Text</span></code><span class="koboSpan" id="kobo.470.1"> variable, which contains the marquee message, into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.471.1">StartMarquee</span></code><span class="koboSpan" id="kobo.472.1"> function. </span><span class="koboSpan" id="kobo.472.2">In between each iteration of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.473.1">$Text</span></code><span class="koboSpan" id="kobo.474.1"> message, there will be three plus signs (</span><code class="inlineCode"><span class="koboSpan" id="kobo.475.1">+++</span></code><span class="koboSpan" id="kobo.476.1">). </span><span class="koboSpan" id="kobo.476.2">The script will keep running until it’s gone through all</span><a id="_idIndexMarker1512"/><span class="koboSpan" id="kobo.477.1"> iterations of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.478.1">$Text</span></code><span class="koboSpan" id="kobo.479.1"> message. </span><span class="koboSpan" id="kobo.479.2">Anyway, here’s how it looks when I run it on my Ubuntu Server virtual machine:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.480.1"><img src="../Images/B21693_23_04.png" alt="B21693_23_4"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.481.1">Figure 23.4: Running the write-marquee.ps1 script</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.482.1">Pretty cool, eh? </span><span class="koboSpan" id="kobo.482.2">Now, let’s look at something that’s even more cool.</span></p>
    <h2 id="_idParaDest-510" class="heading 2"><span class="koboSpan" id="kobo.483.1">The check-cpu.ps1 Script</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.484.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.485.1">check-cpu.ps1</span></code><span class="koboSpan" id="kobo.486.1"> script</span><a id="_idIndexMarker1513"/><span class="koboSpan" id="kobo.487.1"> attempts to retrieve the model number and name of</span><a id="_idIndexMarker1514"/><span class="koboSpan" id="kobo.488.1"> your machine’s CPU, along with the CPU temperature.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.489.1">If you want to see the CPU temperature, you’ll need to run this directly on a host Linux machine, instead of in a virtual machine. </span><span class="koboSpan" id="kobo.489.2">Running this in a virtual machine won’t allow the script to access the host machine’s temperature sensors.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.490.1">I say </span><em class="italic"><span class="koboSpan" id="kobo.491.1">attempt</span></em><span class="koboSpan" id="kobo.492.1">, because when I run this script on my Fedora workstation, I get this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.493.1">PS /home/donnie/PowerShell/scripts&gt; ./check-cpu.ps1
✅ 64-bit CPU (16 cores, ) - 48°C OK                                                                                  
PS /home/donnie/PowerShell/scripts&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.494.1">So, all it shows me is that I’m running some sort of 64-bit CPU with 16 cores. </span><span class="koboSpan" id="kobo.494.2">The actual truth is that this machine is running an Intel(R) Xeon(R) CPU E5-2670, with eight cores and hyperthreading enabled. </span><span class="koboSpan" id="kobo.494.3">But, if I run this same script on a Windows 10 machine, I’ll get this:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.495.1"><img src="../Images/B21693_23_05.png" alt="B21693_23_5"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.496.1">Figure 23.5: The check-cpu.ps1 script on a Windows machine</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.497.1">On this </span><a id="_idIndexMarker1515"/><span class="koboSpan" id="kobo.498.1">ancient (circa 2008) Dell that’s running Windows 10 Pro, the </span><a id="_idIndexMarker1516"/><span class="koboSpan" id="kobo.499.1">script properly reports that the CPU is an old-school Core 2 Quad, model number Q9550. </span><span class="koboSpan" id="kobo.499.2">On the other hand, the script properly reported the CPU temperature on the Linux machine, but not on the Windows machine. </span><span class="koboSpan" id="kobo.499.3">That part is easy to explain. </span><span class="koboSpan" id="kobo.499.4">It’s just that some computer motherboards, especially older ones, have temperature sensors that aren’t compatible with modern operating systems. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.500.1">As far as getting the CPU model right, it seems that the PowerShell command for Linux can’t do that, but the command for Windows can. </span><span class="koboSpan" id="kobo.500.2">Let’s take a look at the script to see what’s going on with that.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.501.1">Toward the top of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.502.1">check-cpu.ps1</span></code><span class="koboSpan" id="kobo.503.1"> script, you see the </span><code class="inlineCode"><span class="koboSpan" id="kobo.504.1">GetCPUArchitecture</span></code><span class="koboSpan" id="kobo.505.1"> function, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.506.1">function GetCPUArchitecture {
        if ("$env:PROCESSOR_ARCHITECTURE" -ne "") { return "$env:PROCESSOR_ARCHITECTURE" }
        if ($IsLinux) {
                $Name = $PSVersionTable.OS
                if ($Name -like "*-generic *") {
                        if ([System.Environment]::Is64BitOperatingSystem) { return "x64" } else { return "x86" }
                } elseif ($Name -like "*-raspi *") {
                        if ([System.Environment]::Is64BitOperatingSystem) { return "ARM64" } else { return "ARM32" }
                } elseif ([System.Environment]::Is64BitOperatingSystem) { return "64-bit" } else { return "32-bit" }
        }
}
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.507.1">As you see, there’s a bit of difference in the syntax from what you’re used to in normal Linux/Unix scripting. </span><span class="koboSpan" id="kobo.507.2">One difference is that instead of surrounding a test condition with square brackets, PowerShell uses parentheses. </span><span class="koboSpan" id="kobo.507.3">Like this, for example:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.508.1">if ("$env:PROCESSOR_ARCHITECTURE" -ne "") { return "$env:PROCESSOR_ARCHITECTURE" }
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.509.1">All this line does is to return the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.510.1">PROCESSOR_ARCHITECTURE</span></code><span class="koboSpan" id="kobo.511.1"> environmental variable, if one exists. </span><span class="koboSpan" id="kobo.511.2">The rest of this function is specifically for Linux, as evidenced by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.512.1">if (IsLinux)</span></code><span class="koboSpan" id="kobo.513.1"> stanza. </span><span class="koboSpan" id="kobo.513.2">You see here that it detects whether the CPU is x86, x86_64, or ARM. </span><span class="koboSpan" id="kobo.513.3">For ARM, it detects whether it’s a 32-bit or 64-bit version.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.514.1">The only part of </span><a id="_idIndexMarker1517"/><span class="koboSpan" id="kobo.515.1">this function that Windows uses is the first</span><a id="_idIndexMarker1518"/><span class="koboSpan" id="kobo.516.1"> line, which is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.517.1">if ("$env:PROCESSOR_ARCHITECTURE" -ne "") { return "$env:PROCESSOR_ARCHITECTURE" }</span></code><span class="koboSpan" id="kobo.518.1"> line. </span><span class="koboSpan" id="kobo.518.2">And, the only thing that this does on my Windows 10 machine is to insert the “AMD64” string into the information that you see in the above graphic. </span><span class="koboSpan" id="kobo.518.3">On Windows, all other CPU information is obtained from </span><a id="_idIndexMarker1519"/><span class="koboSpan" id="kobo.519.1">the </span><strong class="keyWord"><span class="koboSpan" id="kobo.520.1">Windows Management Instrumentation</span></strong><span class="koboSpan" id="kobo.521.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.522.1">WMI</span></strong><span class="koboSpan" id="kobo.523.1">) interface. </span><span class="koboSpan" id="kobo.523.2">The code for that is in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.524.1">else</span></code><span class="koboSpan" id="kobo.525.1"> clause of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.526.1">try</span></code><span class="koboSpan" id="kobo.527.1"> stanza, which begins on line 44. </span><span class="koboSpan" id="kobo.527.2">(The </span><code class="inlineCode"><span class="koboSpan" id="kobo.528.1">else</span></code><span class="koboSpan" id="kobo.529.1"> clause begins on line 54.) Here’s how it looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.530.1">try {
        Write-Progress "Querying CPU status..."
        </span><span class="koboSpan" id="kobo.530.2">$status = "✅"
        $arch = GetCPUArchitecture
        if ($IsLinux) {
                $cpuName = "$arch CPU"
                $arch = ""
                $deviceID = ""
                $speed = ""
                $socket = ""
        } else {
                $details = Get-WmiObject -Class Win32_Processor
                $cpuName = $details.Name.trim()
                $arch = "$arch, "
                $deviceID = "$($details.DeviceID), "
                $speed = "$($details.MaxClockSpeed)MHz, "
                $socket = "$($details.SocketDesignation) socket"
        }
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.531.1">You see in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.532.1">if..else</span></code><span class="koboSpan" id="kobo.533.1"> construct that if the machine is running Linux, it will call the </span><code class="inlineCode"><span class="koboSpan" id="kobo.534.1">GetCPUArchitecture</span></code><span class="koboSpan" id="kobo.535.1"> function, and retrieve the CPU information from it. </span><span class="koboSpan" id="kobo.535.2">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.536.1">else</span></code><span class="koboSpan" id="kobo.537.1"> section, you</span><a id="_idIndexMarker1520"/><span class="koboSpan" id="kobo.538.1"> see the code for Windows. </span><span class="koboSpan" id="kobo.538.2">Although the script </span><a id="_idIndexMarker1521"/><span class="koboSpan" id="kobo.539.1">does obtain one piece of information for Windows from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.540.1">PROCESSOR_ARCHITECTURE</span></code><span class="koboSpan" id="kobo.541.1"> environmental variable, it obtains most of the CPU information from </span><a id="_idIndexMarker1522"/><span class="koboSpan" id="kobo.542.1">the </span><strong class="keyWord"><span class="koboSpan" id="kobo.543.1">Windows Management Instrumentation</span></strong><span class="koboSpan" id="kobo.544.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.545.1">WMI</span></strong><span class="koboSpan" id="kobo.546.1">) subsystem. </span><span class="koboSpan" id="kobo.546.2">As it happens, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.547.1">PROCESSOR_ARCHITECTURE</span></code><span class="koboSpan" id="kobo.548.1"> variable doesn’t contain any information for this particular Fedora workstation. </span><span class="koboSpan" id="kobo.548.2">So, all I get on this machine is just the generic message about whether I’m running a 32-bit or 64-bit machine, and whether it’s an x86 or an ARM machine. </span><span class="koboSpan" id="kobo.548.3">That’s okay though, because I can modify the script to fix that.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.549.1">Open the </span><code class="inlineCode"><span class="koboSpan" id="kobo.550.1">check-cpu.ps1</span></code><span class="koboSpan" id="kobo.551.1"> script in your editor, and scroll down until you see this line in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.552.1">try</span></code><span class="koboSpan" id="kobo.553.1"> stanza, which should be line 47:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.554.1">$arch = GetCPUArchitecture
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.555.1">We’re going to leave that line alone, because Windows also uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.556.1">GetCPUArchitecture</span></code><span class="koboSpan" id="kobo.557.1"> function. </span><span class="koboSpan" id="kobo.557.2">Instead, we’re going to add the following line after the </span><code class="inlineCode"><span class="koboSpan" id="kobo.558.1">if ($IsLinux) {</span></code><span class="koboSpan" id="kobo.559.1"> line, which is line 48:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.560.1">$arch = Get-Content /proc/cpuinfo | Select-String "model name" | Select-Object -Unique
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.561.1">Instead of</span><a id="_idIndexMarker1523"/><span class="koboSpan" id="kobo.562.1"> obtaining its value from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.563.1">GetCPUArchitecture</span></code><span class="koboSpan" id="kobo.564.1"> function, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.565.1">arch</span></code><span class="koboSpan" id="kobo.566.1"> variable </span><a id="_idIndexMarker1524"/><span class="koboSpan" id="kobo.567.1">now gets its value from a command substitution construct.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.568.1">We see here a couple of other ways in which PowerShell scripting is different.</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.569.1">First, anytime you work with a PowerShell variable, you need to precede the variable name with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.570.1">$</span></code><span class="koboSpan" id="kobo.571.1">. </span><span class="koboSpan" id="kobo.571.2">This means that whether you’re defining a variable or calling back its value, you need that </span><code class="inlineCode"><span class="koboSpan" id="kobo.572.1">$</span></code><span class="koboSpan" id="kobo.573.1">. </span><span class="koboSpan" id="kobo.573.2">Secondly, you see that in PowerShell, you don’t surround the command substitution construct with </span><code class="inlineCode"><span class="koboSpan" id="kobo.574.1">$( )</span></code><span class="koboSpan" id="kobo.575.1">. </span><span class="koboSpan" id="kobo.575.2">Instead, just write the command as you normally would.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.576.1">Okay, let’s break this line down.</span></p>
    <ul>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.577.1">Get-Content</span></code><span class="koboSpan" id="kobo.578.1">: This does the same job as the Linux/Unix </span><code class="inlineCode"><span class="koboSpan" id="kobo.579.1">cat</span></code><span class="koboSpan" id="kobo.580.1"> command.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.581.1">Select-String</span></code><span class="koboSpan" id="kobo.582.1">: This does the same job as the Linux/Unix </span><code class="inlineCode"><span class="koboSpan" id="kobo.583.1">grep</span></code><span class="koboSpan" id="kobo.584.1"> command.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.585.1">Select-Object -Unique</span></code><span class="koboSpan" id="kobo.586.1">: This does the same job as the Linux/Unix </span><code class="inlineCode"><span class="koboSpan" id="kobo.587.1">uniq</span></code><span class="koboSpan" id="kobo.588.1"> command. </span><span class="koboSpan" id="kobo.588.2">We need it here because my machine has 16 virtual cores, and I only want to see the information for one of them.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.589.1">Running the modified script on my Fedora workstation looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.590.1">PS /home/donnie&gt; ./check-cpu.ps1
⚠️model name    : Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz CPU (16 cores, ) - 57°C HOT                                
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.591.1">That’s much better, but it’s not quite perfect. </span><span class="koboSpan" id="kobo.591.2">I really want to get rid of the “model name” text string at the start of the output. </span><span class="koboSpan" id="kobo.591.3">So, let’s make one more slight edit to the script, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.592.1">$longarch = Get-Content /proc/cpuinfo | Select-String "model name" | Select-Object -Unique
$arch = $longarch -replace "model name\t: ", ""
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.593.1">All I did here was to change the </span><code class="inlineCode"><span class="koboSpan" id="kobo.594.1">$arch</span></code><span class="koboSpan" id="kobo.595.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.596.1">$longarch</span></code><span class="koboSpan" id="kobo.597.1"> in the original </span><code class="inlineCode"><span class="koboSpan" id="kobo.598.1">$arch</span></code><span class="koboSpan" id="kobo.599.1"> line. </span><span class="koboSpan" id="kobo.599.2">I’ll use that as my intermediate variable. </span><span class="koboSpan" id="kobo.599.3">Then, I added a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.600.1">$arch</span></code><span class="koboSpan" id="kobo.601.1"> line that uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.602.1">-replace "model name\t: ", ""</span></code><span class="koboSpan" id="kobo.603.1"> command to delete the “model name” string, along with the following tab character, colon, and blank space. </span><span class="koboSpan" id="kobo.603.2">In this case, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.604.1">-replace</span></code><span class="koboSpan" id="kobo.605.1"> command is doing the same job as the Linux/Unix </span><code class="inlineCode"><span class="koboSpan" id="kobo.606.1">sed</span></code><span class="koboSpan" id="kobo.607.1"> command. </span><span class="koboSpan" id="kobo.607.2">To put this into context, here’s </span><a id="_idIndexMarker1525"/><span class="koboSpan" id="kobo.608.1">how the</span><a id="_idIndexMarker1526"/><span class="koboSpan" id="kobo.609.1"> relevant portion of the modified </span><code class="inlineCode"><span class="koboSpan" id="kobo.610.1">try</span></code><span class="koboSpan" id="kobo.611.1"> stanza now looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.612.1">try {
        Write-Progress "Querying CPU status..."
        </span><span class="koboSpan" id="kobo.612.2">$status = "✅"
        $arch = GetCPUArchitecture
        if ($IsLinux) {
                $longarch = Get-Content /proc/cpuinfo | Select-String "model name" | Select-Object -Unique
                $arch = $longarch -replace "model name\t: ", ""
                $cpuName = "$arch CPU"
                $arch = ""
                $deviceID = ""
                $speed = ""
                $socket = ""
        }
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.613.1">Here’s what running the new script looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.614.1">PS /home/donnie&gt; ./check-cpu.ps1
⚠ Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz CPU (16 cores, ) - 62°C HOT                                                
PS /home/donnie&gt;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.615.1">Perfect. </span><span class="koboSpan" id="kobo.615.2">This is exactly what I want to see, other than the fact that my workstation is running a bit hot for some reason. </span><span class="koboSpan" id="kobo.615.3">(Tomorrow, I’ll open it up to see if I need to blow out any dust bunnies.) The best part is that this is still a cross-platform script, because I didn’t do anything that would affect how it runs on Windows.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.616.1">Okay, I think that does it for our introduction to the mysteries of PowerShell. </span><span class="koboSpan" id="kobo.616.2">Let’s summarize and then wrap things up.</span></p>
    <h1 id="_idParaDest-511" class="heading 1"><span class="koboSpan" id="kobo.617.1">Summary</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.618.1">In this final chapter, I’ve shown you a bit about scripting in PowerShell on a Linux machine. </span><span class="koboSpan" id="kobo.618.2">I started by showing you a bit of history, and then showed you the philosophy of scripting on PowerShell and how it differs from scripting in traditional Linux/Unix shells. </span><span class="koboSpan" id="kobo.618.3">You also saw the basics about how to use PowerShell commands, and how to obtain help for the commands. </span><span class="koboSpan" id="kobo.618.4">Finally, I showed you some real world examples of actual PowerShell scripts that work on either Windows or Linux. </span><span class="koboSpan" id="kobo.618.5">But, as I’ve said before, all I can do in just one chapter is to present a high-level overview of PowerShell scripting. </span><span class="koboSpan" id="kobo.618.6">If you need to learn more about it, there are plenty of resources both on-line and in books.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.619.1">Oh, I almost forgot the most important thing. </span><span class="koboSpan" id="kobo.619.2">I also showed you some reasons about why you, as a Linux or Mac administrator, might want to consider scripting in PowerShell. </span><span class="koboSpan" id="kobo.619.3">Yeah, it’s different and takes a bit of getting used to. </span><span class="koboSpan" id="kobo.619.4">But, there are some definite benefits, especially if you need to work in a mixed environment of Linux, macOS, and Windows computers.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.620.1">This wraps up not only </span><em class="chapterRef"><span class="koboSpan" id="kobo.621.1">Chapter 23</span></em><span class="koboSpan" id="kobo.622.1">, but also the book. </span><span class="koboSpan" id="kobo.622.2">Along the way, you went from a command-line beginner to a shell-scripting guru. </span><span class="koboSpan" id="kobo.622.3">Of course, you might not be able to remember everything off the top of your head, and that’s okay. </span><span class="koboSpan" id="kobo.622.4">Just use this book, and any other resources you can find, as ready-references if you ever need help in creating an awesome script.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.623.1">Anyway, it’s been a long journey, but I’ve enjoyed it, and hope that you have as well. </span><span class="koboSpan" id="kobo.623.2">Take care, and maybe we’ll meet up again some time.</span></p>
    <h1 id="_idParaDest-512" class="heading 1"><span class="koboSpan" id="kobo.624.1">Further Reading</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.625.1">PowerShell Core for Linux Administrators Cookbook: </span><a href="https://www.packtpub.com/en-us/product/powershell-core-for-linux-administrators-cookbook-9781789137231"><span class="url"><span class="koboSpan" id="kobo.626.1">https://www.packtpub.com/en-us/product/powershell-core-for-linux-administrators-cookbook-9781789137231</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.627.1">I switched from bash to PowerShell, and it’s going great!: </span><a href="https://www.starkandwayne.com/blog/i-switched-from-bash-to-powershell-and-its-going-great/index.html"><span class="url"><span class="koboSpan" id="kobo.628.1">https://www.starkandwayne.com/blog/i-switched-from-bash-to-powershell-and-its-going-great/index.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.629.1">Install PowerShell on Fedora Linux: </span><a href="https://fedoramagazine.org/install-powershell-on-fedora-linux/"><span class="url"><span class="koboSpan" id="kobo.630.1">https://fedoramagazine.org/install-powershell-on-fedora-linux/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.631.1">PowerShell equivalents for common Linux/Bash commands: </span><a href="https://mathieubuisson.github.io/powershell-linux-bash/ "><span class="url"><span class="koboSpan" id="kobo.632.1">https://mathieubuisson.github.io/powershell-linux-bash/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.633.1">Bash vs. </span><span class="koboSpan" id="kobo.633.2">PowerShell: Comparing Scripting Shells: </span><a href="https://smartscripter.com/bash-vs-powershell-choosing-the-right-scripting-shell/"><span class="url"><span class="koboSpan" id="kobo.634.1">https://smartscripter.com/bash-vs-powershell-choosing-the-right-scripting-shell/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.635.1">PowerShell differences on non-Windows platforms: </span><a href="https://learn.microsoft.com/en-us/powershell/scripting/whats-new/unix-support?view=powershell-7.4"><span class="url"><span class="koboSpan" id="kobo.636.1">https://learn.microsoft.com/en-us/powershell/scripting/whats-new/unix-support?view=powershell-7.4</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.637.1">PowerShell’s Equvalent to Linux’s ls -al: An In-depth Guide: </span><a href="https://thelinuxcode.com/equivalent-of-linux-ls-al-in-powershell/"><span class="url"><span class="koboSpan" id="kobo.638.1">https://thelinuxcode.com/equivalent-of-linux-ls-al-in-powershell/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.639.1">Bash vs PowerShell Cheat Sheet: </span><a href="https://blog.ironmansoftware.com/daily-powershell/bash-powershell-cheatsheet/  "><span class="url"><span class="koboSpan" id="kobo.640.1">https://blog.ironmansoftware.com/daily-powershell/bash-powershell-cheatsheet/</span></span></a></li>
    </ul>
    <p class="normal"><a href="https://blog.ironmansoftware.com/daily-powershell/bash-powershell-cheatsheet/  "/></p>
    
<h1 id="_idParaDest-4" class="heading 1"><span class="koboSpan" id="kobo.641.1">Leave a Review!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.642.1">Thank you for purchasing this book from Packt Publishing—we hope you enjoyed it! </span><span class="koboSpan" id="kobo.642.2">Your feedback is invaluable and helps us improve and grow. </span><span class="koboSpan" id="kobo.642.3">Please take a moment to leave an </span><a href="https://packt.link/r/1835463576"><span class="koboSpan" id="kobo.643.1">Amazon review</span></a><span class="koboSpan" id="kobo.644.1">; it will only take a minute, but it makes a big difference for readers like you.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.645.1">Scan the QR code below to receive a free ebook of your choice.</span></p>
    <p class="normal"><a href="https://packt.link/NzOWQ"><span class="url"><span class="koboSpan" id="kobo.646.1">https://packt.link/NzOWQ</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.647.1"><img src="../Images/review.png" alt=""/></span></p>
  </div>


  <div id="_idContainer452">
    <p class="BM packtLogo"><span class="koboSpan" id="kobo.1.1"><img src="../Images/New_Packt_Logo1.png" alt=""/></span></p>
    <p class="normal"><a href="http://packt.com"><span class="url"><span class="koboSpan" id="kobo.2.1">packt.com</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.3.1">Subscribe to our online digital library for full access to over 7,000 books and videos, as well as industry leading tools to help you plan your personal development and advance your career. </span><span class="koboSpan" id="kobo.3.2">For more information, please visit our website.</span></p>
    <h1 id="_idParaDest-514" class="heading 1"><span class="koboSpan" id="kobo.4.1">Why subscribe?</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.5.1">Spend less time learning and more time coding with practical eBooks and Videos from over 4,000 industry professionals</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.6.1">Improve your learning with Skill Plans built especially for you</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.7.1">Get a free eBook or video every month</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.8.1">Fully searchable for easy access to vital information</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.9.1">Copy and paste, print, and bookmark content</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.10.1">At </span><a href="http://www.packt.com"><span class="url"><span class="koboSpan" id="kobo.11.1">www.packt.com</span></span></a><span class="koboSpan" id="kobo.12.1">, you can also read a collection of free technical articles, sign up for a range of free newsletters, and receive exclusive discounts and offers on Packt books and eBooks.</span></p>
    <p class="eop"/>
    <h1 id="_idParaDest-515" class="mainHeading"><span class="koboSpan" id="kobo.13.1">Other Books You May Enjoy</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.14.1">If you enjoyed this book, you may be interested in these other books by Packt:</span></p>
    <p class="normal"><a href="https://www.packtpub.com/en-in/product/linux-kernel-programming-9781803232225"><span class="koboSpan" id="kobo.15.1"><img src="../Images/9781803232225.jpg" alt=""/></span></a></p>
    <p class="BM bookCover"><strong class="keyWord"><span class="koboSpan" id="kobo.16.1">Linux Kernel Programming</span></strong></p>
    <p class="BM bookCover"><span class="koboSpan" id="kobo.17.1">Kaiwan N. </span><span class="koboSpan" id="kobo.17.2">Billimoria</span></p>
    <p class="BM bookCover"><span class="koboSpan" id="kobo.18.1">ISBN: 9781803232225</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.19.1">Configure and build the 6.1 LTS kernel from source</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.20.1">Write high-quality modular kernel code (LKM framework) for 6.x kernels</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.21.1">Explore modern Linux kernel architecture</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.22.1">Get to grips with key internals details regarding memory management within the kernel</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.23.1">Understand and work with various dynamic kernel memory alloc/dealloc APIs</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.24.1">Discover key internals aspects regarding CPU scheduling within the kernel, including cgroups v2</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.25.1">Gain a deeper understanding of kernel concurrency issues</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.26.1">Learn how to work with key kernel synchronization primitives</span></li>
    </ul>
    <p class="normal"><a href="https://www.packtpub.com/en-in/product/the-software-developers-guide-to-linux-9781804616925"><span class="koboSpan" id="kobo.27.1"><img src="../Images/9781804616925.png" alt=""/></span></a></p>
    <p class="BM bookCover"><strong class="keyWord"><span class="koboSpan" id="kobo.28.1">The Software Developer’s Guide to Linux</span></strong></p>
    <p class="BM bookCover"><span class="koboSpan" id="kobo.29.1">David Cohen, Christian Sturm</span></p>
    <p class="BM bookCover"><span class="koboSpan" id="kobo.30.1">ISBN: 9781804616925</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.31.1">Learn useful command-line tricks and tools that make software development, testing, and troubleshooting easy</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.32.1">Understand how Linux and command line environments actually work</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.33.1">Create powerful, customized tools and save thousands of lines of code with developer-centric Linux utilities</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.34.1">Gain hands-on experience with Docker, SSH, and Shell scripting tasks that make you a more effective developer</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.35.1">Get comfortable searching logs and troubleshooting problems on Linux servers</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.36.1">Handle common command-line situations that stump other developers</span></li>
    </ul>
    <h1 id="_idParaDest-516" class="heading 1"><span class="koboSpan" id="kobo.37.1">Packt is searching for authors like you</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.38.1">If you’re interested in becoming an author for Packt, please visit </span><a href="http://authors.packtpub.com"><span class="url"><span class="koboSpan" id="kobo.39.1">authors.packtpub.com</span></span></a><span class="koboSpan" id="kobo.40.1"> and apply today. </span><span class="koboSpan" id="kobo.40.2">We have worked with thousands of developers and tech professionals, just like you, to help them share their insight with the global tech community. </span><span class="koboSpan" id="kobo.40.3">You can make a general application, apply for a specific hot topic that we are recruiting an author for, or submit your own idea.</span></p>
  </div>
  <div id="_idContainer453">
   <h1 id="_idParaDest-513" class="heading 1"><span class="koboSpan" id="kobo.41.1">Join our community on Discord!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.42.1">Read this book alongside other users, Linux experts, and the author himself. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.43.1">Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. </span><span class="koboSpan" id="kobo.43.2">Scan the QR code or visit the link to join the community.</span></p>
    <p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.44.1">https://packt.link/SecNet</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.45.1"><img src="../Images/QR_Code10596186092701843.png" alt=""/></span></p>
  </div>
</body></html>