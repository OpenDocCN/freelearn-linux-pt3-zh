<html><head></head><body>
  <div id="_idContainer156" class="Basic-Text-Frame">
    <h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">11</span></h1>
    <h1 id="_idParaDest-262" class="chapterTitle"><span class="koboSpan" id="kobo.2.1">Performing Mathematical Operations</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.3.1">The various operating system shells all have means of performing mathematical operations either from the command-line, or from within a shell script. </span><span class="koboSpan" id="kobo.3.2">In this chapter, we’ll look at how to perform operations with both integer and floating point math.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.4.1">Topics in this chapter include:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.5.1">Performing integer math with expressions</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.6.1">Performing integer math with integer variables</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.7.1">Performing floating point math with </span><code class="inlineCode"><span class="koboSpan" id="kobo.8.1">bc</span></code></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.9.1">If you’re ready, let’s get started.</span></p>
    <h1 id="_idParaDest-263" class="heading 1"><span class="koboSpan" id="kobo.10.1">Technical Requirements</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.11.1">Use any of your Linux virtual machines for this. </span><span class="koboSpan" id="kobo.11.2">And, as always, you can download the scripts by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.12.1">git clone https://github.com/PacktPublishing/The-Ultimate-Linux-Shell-Scripting-Guide.git
</span></code></pre>
    <h1 id="_idParaDest-264" class="heading 1"><span class="koboSpan" id="kobo.13.1">Performing Integer Math with Expressions</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.14.1">You can do integer math directly in </span><code class="inlineCode"><span class="koboSpan" id="kobo.15.1">bash</span></code><span class="koboSpan" id="kobo.16.1">, which is sometimes handy. </span><span class="koboSpan" id="kobo.16.2">But, </span><code class="inlineCode"><span class="koboSpan" id="kobo.17.1">bash</span></code><span class="koboSpan" id="kobo.18.1"> doesn’t have the capability of doing floating point math. </span><span class="koboSpan" id="kobo.18.2">For that, you’ll need to use a separate utility, which</span><a id="_idIndexMarker731"/><span class="koboSpan" id="kobo.19.1"> we’ll look at later.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.20.1">If you ever try to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.21.1">echo</span></code><span class="koboSpan" id="kobo.22.1"> to</span><a id="_idIndexMarker732"/><span class="koboSpan" id="kobo.23.1"> perform math on the command-line, you’ll find that it doesn’t work. </span><span class="koboSpan" id="kobo.23.2">What you’ll get will look something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.24.1">[donnie@fedora ~]$ echo 1+1
1+1
[donnie@fedora ~]$ echo 1 + 1
1 + 1
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.25.1">This is because </span><code class="inlineCode"><span class="koboSpan" id="kobo.26.1">echo</span></code><span class="koboSpan" id="kobo.27.1"> treats your math problem as just a normal text string. </span><span class="koboSpan" id="kobo.27.2">So, you’ll need some other way to solve your math problems. </span><span class="koboSpan" id="kobo.27.3">Fortunately, there are a few different ways to do this.</span></p>
    <h2 id="_idParaDest-265" class="heading 2"><span class="koboSpan" id="kobo.28.1">Using the expr Command</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.29.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.30.1">expr</span></code><span class="koboSpan" id="kobo.31.1"> command is for evaluating expressions. </span><span class="koboSpan" id="kobo.31.2">These expressions can be normal text strings, regular</span><a id="_idIndexMarker733"/><span class="koboSpan" id="kobo.32.1"> expressions, or mathematical expressions. </span><span class="koboSpan" id="kobo.32.2">For now, I’ll just talk about using it to evaluate math expressions. </span><span class="koboSpan" id="kobo.32.3">Here’s an example of its basic usage:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.33.1">[donnie@fedora ~]$ expr 1 + 1
2
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.34.1">Note that you need a blank</span><a id="_idIndexMarker734"/><span class="koboSpan" id="kobo.35.1"> space between the operator and each operand, or else you’ll get this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.36.1">[donnie@fedora ~]$ expr 1+1
1+1
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.37.1">Without the blank spaces, </span><code class="inlineCode"><span class="koboSpan" id="kobo.38.1">expr</span></code><span class="koboSpan" id="kobo.39.1"> just echos back whatever you type in.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.40.1">You can use </span><code class="inlineCode"><span class="koboSpan" id="kobo.41.1">expr</span></code><span class="koboSpan" id="kobo.42.1"> with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.43.1">+</span></code><span class="koboSpan" id="kobo.44.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.45.1">-</span></code><span class="koboSpan" id="kobo.46.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.47.1">/</span></code><span class="koboSpan" id="kobo.48.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.49.1">*</span></code><span class="koboSpan" id="kobo.50.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.51.1">%</span></code><span class="koboSpan" id="kobo.52.1"> operators to perform addition, subtraction, division, multiplication, or modulus operations. </span><span class="koboSpan" id="kobo.52.2">(Modulus operations show you the remainder after a division operation.) Special care is needed for using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.53.1">*</span></code><span class="koboSpan" id="kobo.54.1"> operator, because a shell will interpret it as a wild card. </span><span class="koboSpan" id="kobo.54.2">So, when performing multiplication, you’ll </span><a id="_idIndexMarker735"/><span class="koboSpan" id="kobo.55.1">need to escape the </span><code class="inlineCode"><span class="koboSpan" id="kobo.56.1">*</span></code><span class="koboSpan" id="kobo.57.1"> with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.58.1">\</span></code><span class="koboSpan" id="kobo.59.1">, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.60.1">[donnie@fedora ~]$ expr 3 \* 3
9
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.61.1">Without the backslash in</span><a id="_idIndexMarker736"/><span class="koboSpan" id="kobo.62.1"> front of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.63.1">*</span></code><span class="koboSpan" id="kobo.64.1">, you will receive an error, which will look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.65.1">donnie@fedora:~$ expr 3 * 3
expr: syntax error: unexpected argument '15827_zip.zip'
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.66.1">For more complex problems, the normal rules of math apply, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.67.1">[donnie@fedora ~]$ expr 1 + 2 \* 3
7
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.68.1">The laws of math dictate that division and multiplication always take precedence over subtraction and addition. </span><span class="koboSpan" id="kobo.68.2">So, you see here that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.69.1">2 \* 3</span></code><span class="koboSpan" id="kobo.70.1"> operation gets performed before adding </span><code class="inlineCode"><span class="koboSpan" id="kobo.71.1">1</span></code><span class="koboSpan" id="kobo.72.1">. </span><span class="koboSpan" id="kobo.72.2">But, just as in normal math, you can change the order in which operations are performed by placing a pair of parentheses around the operation that you want to perform first. </span><span class="koboSpan" id="kobo.72.3">Here’s what that looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.73.1">[donnie@fedora ~]$ expr \( 1 + 2 \) \* 3
9
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.74.1">Notice how I had to escape each parenthesis symbol with a backslash, and leave a blank space between the </span><code class="inlineCode"><span class="koboSpan" id="kobo.75.1">(</span></code><span class="koboSpan" id="kobo.76.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.77.1">1</span></code><span class="koboSpan" id="kobo.78.1">, and between the </span><code class="inlineCode"><span class="koboSpan" id="kobo.79.1">2</span></code><span class="koboSpan" id="kobo.80.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.81.1">\</span></code><span class="koboSpan" id="kobo.82.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.83.1">You can also use </span><code class="inlineCode"><span class="koboSpan" id="kobo.84.1">expr</span></code><span class="koboSpan" id="kobo.85.1"> with variables. </span><span class="koboSpan" id="kobo.85.2">To demo that, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.86.1">math1.sh</span></code><span class="koboSpan" id="kobo.87.1"> script, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.88.1">#!/bin/bash
val1=$1
val2=$2
echo "val1 + val2 = " ; expr $val1 + $val2
echo
echo "val1 - val2 = " ; expr $val1 - $val2
echo
echo "val1 / val2 = " ; expr $val1 / $val2
echo
echo "val1 * val2 = " ; expr $val1 \* $val2
echo
echo "val1 % val2 = " ; expr $val1 % $val2
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.89.1">Running the script with </span><a id="_idIndexMarker737"/><span class="koboSpan" id="kobo.90.1">88 and 23 as</span><a id="_idIndexMarker738"/><span class="koboSpan" id="kobo.91.1"> the input values looks something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.92.1">[donnie@fedora ~]$ ./math1.sh 88 23
val1 + val2 =
111
val1 - val2 =
65
val1 / val2 =
3
val1 * val2 =
2024
val1 % val2 =
19
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.93.1">Remember that </span><code class="inlineCode"><span class="koboSpan" id="kobo.94.1">expr</span></code><span class="koboSpan" id="kobo.95.1"> can only work with integers. </span><span class="koboSpan" id="kobo.95.2">So, any results that involve a decimal get rounded up or down to the nearest integer.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.96.1">And of course, you can also use </span><code class="inlineCode"><span class="koboSpan" id="kobo.97.1">expr</span></code><span class="koboSpan" id="kobo.98.1"> with command substitution, as you see here in this </span><code class="inlineCode"><span class="koboSpan" id="kobo.99.1">math2.sh</span></code><span class="koboSpan" id="kobo.100.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.101.1">#/bin/bash
result1=$(expr 20 \* 8)
result2=$(expr \( 20 + 4 \) / 8)
echo $result1
echo $result2
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.102.1">That’s all there is to</span><a id="_idIndexMarker739"/><span class="koboSpan" id="kobo.103.1"> it for </span><code class="inlineCode"><span class="koboSpan" id="kobo.104.1">expr</span></code><span class="koboSpan" id="kobo.105.1">. </span><span class="koboSpan" id="kobo.105.2">Next, let’s</span><a id="_idIndexMarker740"/><span class="koboSpan" id="kobo.106.1"> take another look at </span><code class="inlineCode"><span class="koboSpan" id="kobo.107.1">echo</span></code><span class="koboSpan" id="kobo.108.1">.</span></p>
    <h2 id="_idParaDest-266" class="heading 2"><span class="koboSpan" id="kobo.109.1">Using echo with Math Expressions</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.110.1">I know, I just told you that you</span><a id="_idIndexMarker741"/><span class="koboSpan" id="kobo.111.1"> can’t use </span><code class="inlineCode"><span class="koboSpan" id="kobo.112.1">echo</span></code><span class="koboSpan" id="kobo.113.1"> to perform math. </span><span class="koboSpan" id="kobo.113.2">Well, you actually can, but there’s a special way to do it. </span><span class="koboSpan" id="kobo.113.3">You’ll just </span><a id="_idIndexMarker742"/><span class="koboSpan" id="kobo.114.1">have to place your math problem within either a </span><code class="inlineCode"><span class="koboSpan" id="kobo.115.1">$(( ))</span></code><span class="koboSpan" id="kobo.116.1"> construct or a </span><code class="inlineCode"><span class="koboSpan" id="kobo.117.1">$[ ]</span></code><span class="koboSpan" id="kobo.118.1"> construct, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.119.1">[donnie@fedora ~]$ echo $((2+2))
4
[donnie@fedora ~]$ echo $[2+2]
4
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.120.1">Both constructs give the same results, so—on </span><code class="inlineCode"><span class="koboSpan" id="kobo.121.1">bash</span></code><span class="koboSpan" id="kobo.122.1"> at least—whichever you use is a matter of personal preference.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.123.1">A very cool thing about these two constructs is that you don’t have to use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.124.1">$</span></code><span class="koboSpan" id="kobo.125.1"> to call back the values of any variables that are within them. </span><span class="koboSpan" id="kobo.125.2">Likewise, you don’t have to escape the </span><code class="inlineCode"><span class="koboSpan" id="kobo.126.1">*</span></code><span class="koboSpan" id="kobo.127.1"> character with a backslash. </span><span class="koboSpan" id="kobo.127.2">Here’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.128.1">math3.sh</span></code><span class="koboSpan" id="kobo.129.1"> script to show you that:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.130.1">#!/bin/bash
val1=$1
val2=$2
val3=$3
echo "Without grouping: " $((val1+val2*val3))
echo "With grouping: "  $(((val1+val2)*val3))
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.131.1">You also see that in the second </span><code class="inlineCode"><span class="koboSpan" id="kobo.132.1">echo</span></code><span class="koboSpan" id="kobo.133.1"> command, I surrounded </span><code class="inlineCode"><span class="koboSpan" id="kobo.134.1">val1+val2</span></code><span class="koboSpan" id="kobo.135.1"> with its own set of parentheses in order to give</span><a id="_idIndexMarker743"/><span class="koboSpan" id="kobo.136.1"> the addition operation precedence over the multiplication operation. </span><span class="koboSpan" id="kobo.136.2">Anyway, here’s what happens when I run the script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.137.1">[donnie@fedora ~]$ ./math3.sh 4 8 3
Without grouping:  28
With grouping:  36
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.138.1">If you find the use of nested </span><a id="_idIndexMarker744"/><span class="koboSpan" id="kobo.139.1">parentheses too confusing, you might want to use the square bracket construct instead, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.140.1">#!/bin/bash
val1=$1
val2=$2
val3=$3
echo "Without grouping: " $[val1+val2*val3]
echo "With grouping: "  $[(val1+val2)*val3]
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.141.1">Either way, you’ll get the same results.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.142.1">There is a catch to this, though. </span><span class="koboSpan" id="kobo.142.2">It’s just that the square bracket construct doesn’t work on certain other shells, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.143.1">/bin/sh</span></code><span class="koboSpan" id="kobo.144.1"> on FreeBSD and OpenIndiana, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.145.1">/bin/dash</span></code><span class="koboSpan" id="kobo.146.1"> on Debian and its derivatives. </span><span class="koboSpan" id="kobo.146.2">So, to make your scripts more portable, you’ll need to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.147.1">((..))</span></code><span class="koboSpan" id="kobo.148.1"> construct for your math problems, even though it can get a bit confusing.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.149.1">Here’s a more practical example of using parentheses to change the precedence of operations. </span><span class="koboSpan" id="kobo.149.2">In this </span><code class="inlineCode"><span class="koboSpan" id="kobo.150.1">new_year.sh</span></code><span class="koboSpan" id="kobo.151.1"> script, I’m calculating the number of weeks left until the New Year. </span><span class="koboSpan" id="kobo.151.2">I start by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.152.1">date +%j</span></code><span class="koboSpan" id="kobo.153.1"> command to calculate the numbered day of the year. </span><span class="koboSpan" id="kobo.153.2">Here’s the output of that command:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.154.1">[donnie@fedora ~]$ date +%j
304
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.155.1">I’m writing this on 31 October, which is the 304</span><sup class="superscript"><span class="koboSpan" id="kobo.156.1">th</span></sup><span class="koboSpan" id="kobo.157.1"> day of the year 2023. </span><span class="koboSpan" id="kobo.157.2">I’ll then subtract that result from the number of days in a year, and divide that by 7 to give me the final answer. </span><span class="koboSpan" id="kobo.157.3">Here’s what the script looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.158.1">#!/bin/bash
echo "There are $[(365-$(date +%j)) / 7 ] weeks left until the New Year."
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.159.1">You see that I used the</span><a id="_idIndexMarker745"/><span class="koboSpan" id="kobo.160.1"> square bracket construct in order to avoid the confusion of having so many nested</span><a id="_idIndexMarker746"/><span class="koboSpan" id="kobo.161.1"> parentheses. </span><span class="koboSpan" id="kobo.161.2">But, as I said before, that won’t work on certain other non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.162.1">bash</span></code><span class="koboSpan" id="kobo.163.1"> shells.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.164.1">Here’s what I get when I run the script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.165.1">[donnie@fedora ~]$ ./new_year.sh
There are 8 weeks left until the New Year.
</span><span class="koboSpan" id="kobo.165.2">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.166.1">Of course, you might be reading this in 2024, 2028, or even 2032, which are all leap years with 366 days, but that’s okay. </span><span class="koboSpan" id="kobo.166.2">That extra day won’t matter with this particular math problem.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.167.1">Okay, how about one more example of a script with math expressions? </span><span class="koboSpan" id="kobo.167.2">Create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.168.1">math4.sh</span></code><span class="koboSpan" id="kobo.169.1"> script, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.170.1">#!/bin/bash
start=0
limit=10
while [ "$start" -le "$limit" ]; do
  echo "$start... </span><span class="koboSpan" id="kobo.170.2">"
  start=$["$start"+1]
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.171.1">This script begins with the number 0 as the initial value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.172.1">start</span></code><span class="koboSpan" id="kobo.173.1">. </span><span class="koboSpan" id="kobo.173.2">It then prints out the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.174.1">start</span></code><span class="koboSpan" id="kobo.175.1">, increments it by 1, and then prints the next value. </span><span class="koboSpan" id="kobo.175.2">The loop continues until the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.176.1">limit</span></code><span class="koboSpan" id="kobo.177.1"> is reached. </span><span class="koboSpan" id="kobo.177.2">Here’s what that looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.178.1">[donnie@fedora ~]$ ./math4.sh
0...
</span><span class="koboSpan" id="kobo.178.2">1...
</span><span class="koboSpan" id="kobo.178.3">2...
</span><span class="koboSpan" id="kobo.178.4">3...
</span><span class="koboSpan" id="kobo.178.5">4...
</span><span class="koboSpan" id="kobo.178.6">5...
</span><span class="koboSpan" id="kobo.178.7">6...
</span><span class="koboSpan" id="kobo.178.8">7...
</span><span class="koboSpan" id="kobo.178.9">8...
</span><span class="koboSpan" id="kobo.178.10">9...
</span><span class="koboSpan" id="kobo.178.11">10...
</span><span class="koboSpan" id="kobo.178.12">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.179.1">This pretty much covers it for </span><a id="_idIndexMarker747"/><span class="koboSpan" id="kobo.180.1">using math </span><a id="_idIndexMarker748"/><span class="koboSpan" id="kobo.181.1">expressions. </span><span class="koboSpan" id="kobo.181.2">Let’s now see about using a new type of variable.</span></p>
    <h1 id="_idParaDest-267" class="heading 1"><span class="koboSpan" id="kobo.182.1">Performing Integer Math with Integer Variables</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.183.1">Instead of using mathematical expressions, you can use </span><strong class="keyWord"><span class="koboSpan" id="kobo.184.1">integer variables</span></strong><span class="koboSpan" id="kobo.185.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.186.1">You’ve already seen the kind of thing</span><a id="_idIndexMarker749"/><span class="koboSpan" id="kobo.187.1"> that doesn’t work, which</span><a id="_idIndexMarker750"/><span class="koboSpan" id="kobo.188.1"> looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.189.1">[donnie@fedora ~]$ a=1
[donnie@fedora ~]$ b=2
[donnie@fedora ~]$ echo $a + $b
1 + 2
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.190.1">That’s because by default, the values of variables are text strings, rather than numbers. </span><span class="koboSpan" id="kobo.190.2">To make this work, use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.191.1">declare -i</span></code><span class="koboSpan" id="kobo.192.1"> command to create integer variables, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.193.1">[donnie@fedora ~]$ declare -i a=1
[donnie@fedora ~]$ declare -i b=2
[donnie@fedora ~]$ declare -i result=a+b
[donnie@fedora ~]$ echo $result
3
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.194.1">Here’s how it look in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.195.1">math5.sh</span></code><span class="koboSpan" id="kobo.196.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.197.1">#!/bin/bash
declare -i val1=$1
declare -i val2=$2
declare -i result1=val1+val2
declare -i result2=val1/val2
declare -i result3=val1*val2
declare -i result4=val1-val2
declare -i result5=val1%val2
echo "Addition: $result1"
echo "Division: $result2"
echo "Multiplication: $result3"
echo "Subtraction: $result4"
echo "Modulus: $result5"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.198.1">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.199.1">declare -i</span></code><span class="koboSpan" id="kobo.200.1"> commands, you don’t need to precede variable names with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.201.1">$</span></code><span class="koboSpan" id="kobo.202.1"> to call their values. </span><span class="koboSpan" id="kobo.202.2">You also</span><a id="_idIndexMarker751"/><span class="koboSpan" id="kobo.203.1"> don’t need</span><a id="_idIndexMarker752"/><span class="koboSpan" id="kobo.204.1"> to use command substitution to assign the results of a math operation to a variable. </span><span class="koboSpan" id="kobo.204.2">Anyway, here’s how it looks when I run it:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.205.1">[donnie@fedora ~]$ ./math5.sh 38 3
Addition: 41
Division: 12
Multiplication: 114
Subtraction: 35
Modulus: 2
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.206.1">And, since this is integer math, any results that contain a decimal get rounded up or down to the nearest integer.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.207.1">Sometimes, integer math is all you need. </span><span class="koboSpan" id="kobo.207.2">But, what if you need more? </span><span class="koboSpan" id="kobo.207.3">That’s in the next section, so stay tuned.</span></p>
    <h1 id="_idParaDest-268" class="heading 1"><span class="koboSpan" id="kobo.208.1">Performing Floating Point Math with bc</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.209.1">The methods you’ve just seen for performing math operations from the shell all have two limitations. </span><span class="koboSpan" id="kobo.209.2">First, these</span><a id="_idIndexMarker753"/><span class="koboSpan" id="kobo.210.1"> methods can only work with integers. </span><span class="koboSpan" id="kobo.210.2">Secondly, when using these methods, you’re limited to just basic</span><a id="_idIndexMarker754"/><span class="koboSpan" id="kobo.211.1"> math. </span><span class="koboSpan" id="kobo.211.2">Fortunately, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.212.1">bc</span></code><span class="koboSpan" id="kobo.213.1"> utility solves both of those problems. </span><span class="koboSpan" id="kobo.213.2">In fact, you’d need to be an expert mathematician to take full advantage of </span><code class="inlineCode"><span class="koboSpan" id="kobo.214.1">bc</span></code><span class="koboSpan" id="kobo.215.1">'s features. </span><span class="koboSpan" id="kobo.215.2">(I don’t fall into that category, but I can still show you the basics of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.216.1">bc</span></code><span class="koboSpan" id="kobo.217.1">.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.218.1">You should find that </span><code class="inlineCode"><span class="koboSpan" id="kobo.219.1">bc</span></code><span class="koboSpan" id="kobo.220.1"> is already installed on your Linux or Unix system, so you likely won’t have to mess around with installing it.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.221.1">There are three ways to </span><a id="_idIndexMarker755"/><span class="koboSpan" id="kobo.222.1">use </span><code class="inlineCode"><span class="koboSpan" id="kobo.223.1">bc</span></code><span class="koboSpan" id="kobo.224.1">, which are:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.225.1">Interactive mode: You’ll just open </span><code class="inlineCode"><span class="koboSpan" id="kobo.226.1">bc</span></code><span class="koboSpan" id="kobo.227.1">, and enter math commands on its own command-line.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.228.1">Program files: Create programs in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.229.1">bc</span></code><span class="koboSpan" id="kobo.230.1"> language, and use </span><code class="inlineCode"><span class="koboSpan" id="kobo.231.1">bc</span></code><span class="koboSpan" id="kobo.232.1"> to execute them.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.233.1">Pipe math problems into bc: You can do this either from the shell command-line, or from within shell scripts.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.234.1">Let’s look at</span><a id="_idIndexMarker756"/><span class="koboSpan" id="kobo.235.1"> interactive mode first.</span></p>
    <h2 id="_idParaDest-269" class="heading 2"><span class="koboSpan" id="kobo.236.1">Using bc in Interactive Mode</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.237.1">You can start </span><code class="inlineCode"><span class="koboSpan" id="kobo.238.1">bc</span></code><span class="koboSpan" id="kobo.239.1"> in interactive mode by </span><a id="_idIndexMarker757"/><span class="koboSpan" id="kobo.240.1">entering </span><code class="inlineCode"><span class="koboSpan" id="kobo.241.1">bc</span></code><span class="koboSpan" id="kobo.242.1"> at the command-line, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.243.1">[donnie@fedora ~]$ bc
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.243.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.243.3">For details type `warranty'.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.244.1">Now, you just type a math problem at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.245.1">bc</span></code><span class="koboSpan" id="kobo.246.1"> command prompt. </span><span class="koboSpan" id="kobo.246.2">Let’s start by dividing 3 by 4, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.247.1">3/4
0
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.248.1">You see that this gives us 0 as the result. </span><span class="koboSpan" id="kobo.248.2">But wait, isn’t </span><code class="inlineCode"><span class="koboSpan" id="kobo.249.1">bc</span></code><span class="koboSpan" id="kobo.250.1"> supposed to be floating point-capable? </span><span class="koboSpan" id="kobo.250.2">Well, it is, but</span><a id="_idIndexMarker758"/><span class="koboSpan" id="kobo.251.1"> you have to start it with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.252.1">-l</span></code><span class="koboSpan" id="kobo.253.1"> option to bring in the optional math libraries. </span><span class="koboSpan" id="kobo.253.2">So, let’s type </span><code class="inlineCode"><span class="koboSpan" id="kobo.254.1">quit</span></code><span class="koboSpan" id="kobo.255.1"> to shut it down and start over, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.256.1">[donnie@fedora ~]$ bc -l
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.256.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.256.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.256.4">3/4
.75000000000000000000
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.257.1">If you don’t want to see this many decimal places, use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.258.1">scale</span></code><span class="koboSpan" id="kobo.259.1"> command. </span><span class="koboSpan" id="kobo.259.2">Let’s say that you only want to see two decimal places. </span><span class="koboSpan" id="kobo.259.3">Just set it like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.260.1">[donnie@fedora ~]$ bc -l
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.260.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.260.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.260.4">scale=2
3/4
.75
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.261.1">Now, let’s do something a bit more practical, by solving some geometry problems. </span><span class="koboSpan" id="kobo.261.2">As you likely know, a triangle has three angles, and the number of degrees in all three angles always adds up to 180 degrees, as you see here:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.262.1"><img src="../Images/B21693_11_01.png" alt=""/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.263.1">Figure 11.1: A triangle with three 60-degree angles</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.264.1">So, for example, you could have a triangle with a 40-degree angle, a 50-degree angle, and a 90-degree angle. </span><span class="koboSpan" id="kobo.264.2">At times though, you might only know the number of degrees in two of</span><a id="_idIndexMarker759"/><span class="koboSpan" id="kobo.265.1"> the angles, and will want to find the number of degrees for the third angle. </span><span class="koboSpan" id="kobo.265.2">You can do that by adding together the number of degrees for the two known angles, and subtracting the sum from 180. </span><span class="koboSpan" id="kobo.265.3">Here’s what it looks like in </span><code class="inlineCode"><span class="koboSpan" id="kobo.266.1">bc</span></code><span class="koboSpan" id="kobo.267.1"> interactive mode:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.268.1">[donnie@fedora ~]$ bc -l
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.268.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.268.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.268.4">a=40
b=50
180-(a+b)
90
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.269.1">This also demonstrates how you can use variables in </span><code class="inlineCode"><span class="koboSpan" id="kobo.270.1">bc</span></code><span class="koboSpan" id="kobo.271.1">. </span><span class="koboSpan" id="kobo.271.2">This is handy, because if I want to run the calculation again on another set of values, I only have to type in the new variable assignments. </span><span class="koboSpan" id="kobo.271.3">Then, I’ll just use the up-arrow key on the keyboard to get back to the formula.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.272.1">Next, we’ll look at a circle with a diameter of 25 and a radius of 12.5. </span><span class="koboSpan" id="kobo.272.2">(The unit-of-measure doesn’t matter. </span><span class="koboSpan" id="kobo.272.3">It </span><a id="_idIndexMarker760"/><span class="koboSpan" id="kobo.273.1">could be inches, centimeters, miles, or kilometers. </span><span class="koboSpan" id="kobo.273.2">It really doesn’t matter.) To calculate the circumference of a circle, we need to multiply the circle’s diameter by the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.274.1">pi</span></code><span class="koboSpan" id="kobo.275.1"> (Π), like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.276.1">[donnie@fedora ~]$ bc -l
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.276.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.276.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.276.4">pi=3.14159265358979323846
diameter=25
circumference=pi*diameter
print circumference
78.53981633974483096150
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.277.1">To calculate the area of a circle, multiply П by the squared value of the radius, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.278.1">radius=12.5
area=pi*(radius^2)
print area
490.87385212340519350937
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.279.1">You see here that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.280.1">^</span></code><span class="koboSpan" id="kobo.281.1"> is used to denote an exponent, which in this case is 2. </span><span class="koboSpan" id="kobo.281.2">You also see that there’s no </span><code class="inlineCode"><span class="koboSpan" id="kobo.282.1">echo</span></code><span class="koboSpan" id="kobo.283.1"> command in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.284.1">bc</span></code><span class="koboSpan" id="kobo.285.1"> language. </span><span class="koboSpan" id="kobo.285.2">Instead, you’ll use </span><code class="inlineCode"><span class="koboSpan" id="kobo.286.1">print</span></code><span class="koboSpan" id="kobo.287.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.288.1">You’ll find many useful functions in the optional libraries, besides just the ability to deal with floating point math. </span><span class="koboSpan" id="kobo.288.2">For example, you can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.289.1">ibase</span></code><span class="koboSpan" id="kobo.290.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.291.1">obase</span></code><span class="koboSpan" id="kobo.292.1"> functions to convert numbers from one number system to another. </span><span class="koboSpan" id="kobo.292.2">Here, you see me converting a decimal number to a hexadecimal number:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.293.1">[donnie@fedora ~]$ bc -l
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.293.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.293.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.293.4">obase=16
10
A
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.294.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.295.1">obase=16</span></code><span class="koboSpan" id="kobo.296.1"> line tells </span><code class="inlineCode"><span class="koboSpan" id="kobo.297.1">bc</span></code><span class="koboSpan" id="kobo.298.1"> that I want all numbers to be output in hexadecimal format. </span><span class="koboSpan" id="kobo.298.2">I don’t have to use an </span><code class="inlineCode"><span class="koboSpan" id="kobo.299.1">ibase</span></code><span class="koboSpan" id="kobo.300.1"> line to specify the input number system, because it already defaults to decimal. </span><span class="koboSpan" id="kobo.300.2">When I entered 10 as the number to convert, I got A as a result, which</span><a id="_idIndexMarker761"/><span class="koboSpan" id="kobo.301.1"> is the hexadecimal equivalent of decimal number 10. </span><span class="koboSpan" id="kobo.301.2">I can also convert from hexadecimal back to decimal, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.302.1">[donnie@fedora ~]$ bc -l
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.302.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.302.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.302.4">ibase=16
A
10
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.303.1">Again, since decimal is the default, I didn’t have to specify it for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.304.1">obase</span></code><span class="koboSpan" id="kobo.305.1">. </span><span class="koboSpan" id="kobo.305.2">(Well, I would have had to, if I hadn’t closed and reopened </span><code class="inlineCode"><span class="koboSpan" id="kobo.306.1">bc</span></code><span class="koboSpan" id="kobo.307.1"> after setting the </span><code class="inlineCode"><span class="koboSpan" id="kobo.308.1">obase</span></code><span class="koboSpan" id="kobo.309.1"> to 16 for the previous example.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.310.1">Here’s an example of setting both the </span><code class="inlineCode"><span class="koboSpan" id="kobo.311.1">ibase</span></code><span class="koboSpan" id="kobo.312.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.313.1">obase</span></code><span class="koboSpan" id="kobo.314.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.315.1">[donnie@fedora ~]$ bc -l
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.315.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.315.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.315.4">ibase=2
obase=16
1011101
10110
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.316.1">In this one, I chose to convert a binary number to hexadecimal.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.317.1">You can also set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.318.1">ibase</span></code><span class="koboSpan" id="kobo.319.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.320.1">obase</span></code><span class="koboSpan" id="kobo.321.1"> to the same value in order to perform math in a different number</span><a id="_idIndexMarker762"/><span class="koboSpan" id="kobo.322.1"> system. </span><span class="koboSpan" id="kobo.322.2">Here’s an example of how to perform binary math:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.323.1">[donnie@fedora ~]$ bc -l
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.323.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.323.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.323.4">ibase=2
obase=2
101-1
100
101+101
1010
101/101
1.000000000000000000000000000000000000000000000000000000000000000000\
0
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.324.1">Yeah, I wish that I would have had this back in the 1980s, when I had to learn binary math in my early computer classes. </span><span class="koboSpan" id="kobo.324.2">It would have made things so much easier. </span><span class="koboSpan" id="kobo.324.3">But seriously, note that in the division command, there are so many trailing zeros that a </span><code class="inlineCode"><span class="koboSpan" id="kobo.325.1">\</span></code><span class="koboSpan" id="kobo.326.1"> was used to continue them on the next line. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.327.1">You can use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.328.1">scale=</span></code><span class="koboSpan" id="kobo.329.1"> command to change that, but you’ll get some rather surprising results when using it in binary mode. </span><span class="koboSpan" id="kobo.329.2">Here’s what I mean:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.330.1">scale=2
101/101
1.0000000
scale=1
101/101
1.0000
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.331.1">I don’t know why that is, but</span><a id="_idIndexMarker763"/><span class="koboSpan" id="kobo.332.1"> that’s okay.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.333.1">Tip</span></p>
    <div class="packt_tip">
      <p class="normal"><span class="koboSpan" id="kobo.334.1">Be aware that if you decide to convert a hexadecimal number to another format, the digits A through F must be typed in upper-case.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.335.1">Other functions in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.336.1">bc</span></code><span class="koboSpan" id="kobo.337.1"> libraries include:</span></p>
    <ul>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.338.1">s (x)</span></code><span class="koboSpan" id="kobo.339.1">: The sine of x, in radians.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.340.1">c (x)</span></code><span class="koboSpan" id="kobo.341.1">: The cosine of x, in radians.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.342.1">a (x)</span></code><span class="koboSpan" id="kobo.343.1">: The arctangent of x, in radians.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.344.1">l (x)</span></code><span class="koboSpan" id="kobo.345.1">: The natural logarithm of x.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.346.1">e (x)</span></code><span class="koboSpan" id="kobo.347.1">: The exponential function of raising e to the value x.</span></li>
      <li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.348.1">j (n,x)</span></code><span class="koboSpan" id="kobo.349.1">: The Bessel function of integer order n of x.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.350.1">For example, let’s say that you need to find the natural logarithm of the number 80. </span><span class="koboSpan" id="kobo.350.2">Just do it like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.351.1">[donnie@fedora ~]$ bc -l
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.351.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.351.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.351.4">l(80)
4.38202663467388161226
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.352.1">Okay, I think that that should cover it for interactive mode. </span><span class="koboSpan" id="kobo.352.2">Let’s now look some </span><code class="inlineCode"><span class="koboSpan" id="kobo.353.1">bc</span></code><span class="koboSpan" id="kobo.354.1"> programs.</span></p>
    <h2 id="_idParaDest-270" class="heading 2"><span class="koboSpan" id="kobo.355.1">Using bc Program Files</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.356.1">The main problem with using interactive mode is that as soon as you shut down </span><code class="inlineCode"><span class="koboSpan" id="kobo.357.1">bc</span></code><span class="koboSpan" id="kobo.358.1">, all of your work will disappear. </span><span class="koboSpan" id="kobo.358.2">One</span><a id="_idIndexMarker764"/><span class="koboSpan" id="kobo.359.1"> way to make your work permanent is to create a program file. </span><span class="koboSpan" id="kobo.359.2">Let’s begin by creating the </span><code class="inlineCode"><span class="koboSpan" id="kobo.360.1">geometry1.txt</span></code><span class="koboSpan" id="kobo.361.1"> file, which will look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.362.1">print "\nGeometry!\n"
print "Let's say that you want to calculate the area of a circle.\n"
print "Enter the radius of the circle: "; radius = read()
pi=3.14159265358979323846
area=pi*(radius^2)
print "The area of this circle is: \n"
print area
print "\n"
quit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.363.1">You’ve already seen how to do the math, so I won’t go over that again. </span><span class="koboSpan" id="kobo.363.2">But, I do want you to notice that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.364.1">print</span></code><span class="koboSpan" id="kobo.365.1"> command doesn’t automatically insert a newline character at the end of lines. </span><span class="koboSpan" id="kobo.365.2">So, you’ll have to do that yourself by adding a </span><code class="inlineCode"><span class="koboSpan" id="kobo.366.1">\n</span></code><span class="koboSpan" id="kobo.367.1"> sequence at the end of your </span><code class="inlineCode"><span class="koboSpan" id="kobo.368.1">print</span></code><span class="koboSpan" id="kobo.369.1"> commands. </span><span class="koboSpan" id="kobo.369.2">Also, notice on line 3 how I used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.370.1">read()</span></code><span class="koboSpan" id="kobo.371.1"> function to take the user’s input and assign it to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.372.1">radius</span></code><span class="koboSpan" id="kobo.373.1"> variable. </span><span class="koboSpan" id="kobo.373.2">The last command must be </span><code class="inlineCode"><span class="koboSpan" id="kobo.374.1">quit</span></code><span class="koboSpan" id="kobo.375.1">, or else the program won’t exit. </span><span class="koboSpan" id="kobo.375.2">To run this program, just type </span><code class="inlineCode"><span class="koboSpan" id="kobo.376.1">bc -l</span></code><span class="koboSpan" id="kobo.377.1">, followed by the name of the program file, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.378.1">[donnie@fedora ~]$ bc -l geometry1.txt
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.378.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.378.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.378.4">Geometry!
</span><span class="koboSpan" id="kobo.378.5">Let's say that you want to calculate the area of a circle.
</span><span class="koboSpan" id="kobo.378.6">Enter the radius of the circle: 20
The area of this circle is:
1256.63706143591729538400
[donnie@fedora ~]$
</span></code></pre>
    <div class="packt_tip">
      <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.379.1">Tip</span></strong></p>
      <p class="normal"><span class="koboSpan" id="kobo.380.1">I cheated a bit here, by copying the value of П from a website where it had already been calculated. </span><span class="koboSpan" id="kobo.380.2">If you’d rather calculate the value of П yourself, you can do it with this formula:</span></p>
      <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.381.1">pi=4*a(1)
</span></code></pre>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.382.1">The next example is a</span><a id="_idIndexMarker765"/><span class="koboSpan" id="kobo.383.1"> checkbook balancing program that I borrowed from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.384.1">bc</span></code><span class="koboSpan" id="kobo.385.1"> documentation page. </span><span class="koboSpan" id="kobo.385.2">Here’s what it looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.386.1">scale=2
print "\nCheck book program\n!"
</span><span class="koboSpan" id="kobo.386.2">print "  Remember, deposits are negative transactions.\n"
print "  Exit by a 0 transaction.\n\n"
print "Initial balance? </span><span class="koboSpan" id="kobo.386.3">"; bal = read()
bal /= 1
print "\n"
while (1) {
  "current balance = "; bal
  "transaction? </span><span class="koboSpan" id="kobo.386.4">"; trans = read()
  if (trans == 0) break;
  bal -= trans
  bal /= 1
}
quit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.387.1">Here, you see that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.388.1">bc</span></code><span class="koboSpan" id="kobo.389.1"> language has the same programming constructs that you’ve already seen in normal shell scripting. </span><span class="koboSpan" id="kobo.389.2">(In this case, you see a </span><code class="inlineCode"><span class="koboSpan" id="kobo.390.1">while</span></code><span class="koboSpan" id="kobo.391.1"> loop.) The </span><code class="inlineCode"><span class="koboSpan" id="kobo.392.1">bc</span></code><span class="koboSpan" id="kobo.393.1"> language implements them a bit differently, but that’s okay. </span><span class="koboSpan" id="kobo.393.2">The next things to note are the </span><code class="inlineCode"><span class="koboSpan" id="kobo.394.1">scale=2</span></code><span class="koboSpan" id="kobo.395.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.396.1">bal /= 1</span></code><span class="koboSpan" id="kobo.397.1"> lines. </span><span class="koboSpan" id="kobo.397.2">These two commands ensure that the program’s output will always have two digits after the decimal point, even when you only enter an integer without any decimals. </span><span class="koboSpan" id="kobo.397.3">To show what I mean, open </span><code class="inlineCode"><span class="koboSpan" id="kobo.398.1">bc</span></code><span class="koboSpan" id="kobo.399.1"> in interactive mode and type in these commands:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.400.1">[donnie@fedora ~]$ bc
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.400.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.400.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.400.4">scale=2
bal=1000
print bal
1000
bal /= 1
print bal
1000.00
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.401.1">You see that before I invoked the </span><code class="inlineCode"><span class="koboSpan" id="kobo.402.1">bal /= 1</span></code><span class="koboSpan" id="kobo.403.1"> command, </span><code class="inlineCode"><span class="koboSpan" id="kobo.404.1">print bal</span></code><span class="koboSpan" id="kobo.405.1"> only shows 1000, without any decimals. </span><span class="koboSpan" id="kobo.405.2">So, why does this work? </span><span class="koboSpan" id="kobo.405.3">Well, it’s just that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.406.1">bal /= 1</span></code><span class="koboSpan" id="kobo.407.1"> command is just a shorthand way of expressing a division by 1. </span><span class="koboSpan" id="kobo.407.2">In other words, it does the same thing that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.408.1">bal=(bal/1)</span></code><span class="koboSpan" id="kobo.409.1"> command does, except with less typing. </span><span class="koboSpan" id="kobo.409.2">In this case, we’re dividing 1000 by 1, which still gives us 1000. </span><span class="koboSpan" id="kobo.409.3">But, because we set the scale to 2, printing any number that’s a result of a math operation will now</span><a id="_idIndexMarker766"/><span class="koboSpan" id="kobo.410.1"> always show two decimal places.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.411.1">The next thing to note in the program file is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.412.1">bal -= trans</span></code><span class="koboSpan" id="kobo.413.1"> line. </span><span class="koboSpan" id="kobo.413.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.414.1">-=</span></code><span class="koboSpan" id="kobo.415.1"> operator causes the balance to decrement by the amount of the financial transaction that’s represented by </span><code class="inlineCode"><span class="koboSpan" id="kobo.416.1">trans</span></code><span class="koboSpan" id="kobo.417.1">. </span><span class="koboSpan" id="kobo.417.2">Now, I really don’t know why the program’s author did this, because it means that the user has to enter a positive number to reduce the balance, and a negative number to add to the balance. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.418.1">Changing the line to </span><code class="inlineCode"><span class="koboSpan" id="kobo.419.1">bal +=</span></code><span class="koboSpan" id="kobo.420.1"> trans would make much more sense. </span><span class="koboSpan" id="kobo.420.2">That way a negative number would represent a debit, a positive number would represent a deposit, and all would be right with the world. </span><span class="koboSpan" id="kobo.420.3">Anyway, I digress.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.421.1">Running the program looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.422.1">[donnie@fedora ~]$ bc checkbook_bc
bc 1.07.1
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.
</span><span class="koboSpan" id="kobo.422.2">This is free software with ABSOLUTELY NO WARRANTY.
</span><span class="koboSpan" id="kobo.422.3">For details type `warranty'.
</span><span class="koboSpan" id="kobo.422.4">Check book program
!  </span><span class="koboSpan" id="kobo.422.5">Remember, deposits are negative transactions.
  </span><span class="koboSpan" id="kobo.422.6">Exit by a 0 transaction.
</span><span class="koboSpan" id="kobo.422.7">Initial balance? </span><span class="koboSpan" id="kobo.422.8">1000
current balance = 1000.00
transaction?
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.423.1">Now, just enter your transactions, and then enter 0 to quit.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.424.1">There’s a lot more that </span><a id="_idIndexMarker767"/><span class="koboSpan" id="kobo.425.1">you can do with </span><code class="inlineCode"><span class="koboSpan" id="kobo.426.1">bc</span></code><span class="koboSpan" id="kobo.427.1"> program files, but I think you get the overall idea. </span><span class="koboSpan" id="kobo.427.2">Let’s now look at using </span><code class="inlineCode"><span class="koboSpan" id="kobo.428.1">bc</span></code><span class="koboSpan" id="kobo.429.1"> in normal shell scripts.</span></p>
    <h2 id="_idParaDest-271" class="heading 2"><span class="koboSpan" id="kobo.430.1">Using bc in Shell Scripts</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.431.1">The third and final way to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.432.1">bc</span></code><span class="koboSpan" id="kobo.433.1"> is to run </span><code class="inlineCode"><span class="koboSpan" id="kobo.434.1">bc</span></code><span class="koboSpan" id="kobo.435.1"> commands from a normal shell environment. </span><span class="koboSpan" id="kobo.435.2">So, you can either</span><a id="_idIndexMarker768"/><span class="koboSpan" id="kobo.436.1"> run </span><code class="inlineCode"><span class="koboSpan" id="kobo.437.1">bc</span></code><span class="koboSpan" id="kobo.438.1"> commands from the shell command-line, or place them into normal shell scripts. </span><span class="koboSpan" id="kobo.438.2">Here’s an example:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.439.1">[donnie@fedora ~]$ pi=$(echo "scale=10; 4*a(1)" | bc -l)
[donnie@fedora ~]$ echo $pi
3.1415926532
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.440.1">Here, I’m using command substitution to assign a value to </span><code class="inlineCode"><span class="koboSpan" id="kobo.441.1">pi</span></code><span class="koboSpan" id="kobo.442.1">. </span><span class="koboSpan" id="kobo.442.2">Within the command substitution construct, I’m echoing a </span><code class="inlineCode"><span class="koboSpan" id="kobo.443.1">bc</span></code><span class="koboSpan" id="kobo.444.1">-style math formula into </span><code class="inlineCode"><span class="koboSpan" id="kobo.445.1">bc</span></code><span class="koboSpan" id="kobo.446.1">. </span><span class="koboSpan" id="kobo.446.2">The first thing you see is that I’ve set the scale to 10. </span><span class="koboSpan" id="kobo.446.3">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.447.1">4*a(1)</span></code><span class="koboSpan" id="kobo.448.1"> means that I’m taking the arctangent of 1 and multiplying it by 4, which is one of the many formulas that you can use to approximate the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.449.1">pi </span></code><span class="koboSpan" id="kobo.450.1">(П). </span><span class="koboSpan" id="kobo.450.2">(Remember that П is an irrational number, which means that you will never find its exact value.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.451.1">Now, let’s put this into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.452.1">pi_bc.sh</span></code><span class="koboSpan" id="kobo.453.1"> shell script, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.454.1">#!/bin/bash
if [ -z $1 ]; then
        echo "Usage:"
        echo "./pi_bc.sh scale_value"
else
        pi=$(echo "scale=$1; 4*a(1)" | bc -l)
        echo $pi
fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.455.1">I’ve fancied things up a bit, by allowing you to specify your own scaling value when you invoke the script. </span><span class="koboSpan" id="kobo.455.2">You see that if you don’t enter a scaling value, it will return a message that tells </span><a id="_idIndexMarker769"/><span class="koboSpan" id="kobo.456.1">you to do so. </span><span class="koboSpan" id="kobo.456.2">Running the script looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.457.1">[donnie@fedora ~]$ ./pi_bc.sh 20
3.14159265358979323844
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.458.1">Of course, you can enter even larger scaling values if you’d like.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.459.1">You can also use </span><code class="inlineCode"><span class="koboSpan" id="kobo.460.1">bc</span></code><span class="koboSpan" id="kobo.461.1"> to create your own function libraries. </span><span class="koboSpan" id="kobo.461.2">For example, check out this </span><code class="inlineCode"><span class="koboSpan" id="kobo.462.1">baseconv.lib</span></code><span class="koboSpan" id="kobo.463.1"> library file that I created in my </span><code class="inlineCode"><span class="koboSpan" id="kobo.464.1">/usr/local/lib/</span></code><span class="koboSpan" id="kobo.465.1"> directory:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.466.1">       h2d() {
           h2dnum=$(echo "ibase=16; $input_num" | bc)
           }
       d2h() {
           d2hnum=$(echo "obase=16; $input_num" | bc)
           }
       o2h() {
           o2hnum=$(echo "obase=16; ibase=8; $input_num" | bc)
           }
       h2o() {
           h2onum=$(echo "obase=8; ibase=16; $input_num" | bc)
           }
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.467.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.468.1">bc-func_demo.sh</span></code><span class="koboSpan" id="kobo.469.1"> script that uses this library is too long to show here in its entirety. </span><span class="koboSpan" id="kobo.469.2">But, you can download it from the GitHub repository. </span><span class="koboSpan" id="kobo.469.3">For now, I’ll just show you a few snippets and provide some explanation.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.470.1">The top part of the script looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.471.1">#!/bin/bash
. </span><span class="koboSpan" id="kobo.471.2">/usr/local/lib/baseconv.lib
until [ "$choice" = "q" ]; do
        echo "Choose your desired function from the following list: "
        echo "For hex to decimal, press \"1\"."
        </span><span class="koboSpan" id="kobo.471.3">echo "For decimal to hex, press \"2\"."
        </span><span class="koboSpan" id="kobo.471.4">echo "For octal to hex, press \"3\"."
        </span><span class="koboSpan" id="kobo.471.5">echo "For hex to octal, press \"4\"."
        </span><span class="koboSpan" id="kobo.471.6">echo "To quit, press \"q\"."
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.472.1">The first thing you see is that I’m sourcing the library file with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.473.1">. </span><span class="koboSpan" id="kobo.473.2">/usr/local/lib/baseconv.lib</span></code><span class="koboSpan" id="kobo.474.1"> command. </span><span class="koboSpan" id="kobo.474.2">After that, you see a construct that I’ve neglected to show you before. </span><span class="koboSpan" id="kobo.474.3">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.475.1">until. </span><span class="koboSpan" id="kobo.475.2">.do</span></code><span class="koboSpan" id="kobo.476.1"> construct will keep showing you a menu until you hit the </span><em class="keystroke"><span class="koboSpan" id="kobo.477.1">q</span></em><span class="koboSpan" id="kobo.478.1"> key. </span><span class="koboSpan" id="kobo.478.2">I mean, if you make any of the other choices, you’ll be prompted to enter a </span><a id="_idIndexMarker770"/><span class="koboSpan" id="kobo.479.1">number that you want to convert. </span><span class="koboSpan" id="kobo.479.2">When the conversion is done, the menu will pop right back up, and will stay there until you hit the </span><em class="keystroke"><span class="koboSpan" id="kobo.480.1">q</span></em><span class="koboSpan" id="kobo.481.1">. </span><span class="koboSpan" id="kobo.481.2">The next bit of code is a </span><code class="inlineCode"><span class="koboSpan" id="kobo.482.1">case. </span><span class="koboSpan" id="kobo.482.2">.esac</span></code><span class="koboSpan" id="kobo.483.1"> construct, which performs the task that you choose from the menu. </span><span class="koboSpan" id="kobo.483.2">Here’s the first part of that:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.484.1">read choice
        case $choice in
                1) echo "Enter the hex number that you would like to convert. </span><span class="koboSpan" id="kobo.484.2">"
                        read input_num
                        h2d
                        echo $h2dnum
                        echo
                        echo
                        ;;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.485.1">Running the script looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.486.1">[donnie@fedora ~]$ ./bc-func_demo.sh
Choose your desired function from the following list:
For hex to decimal, press "1".
</span><span class="koboSpan" id="kobo.486.2">For decimal to hex, press "2".
</span><span class="koboSpan" id="kobo.486.3">For octal to hex, press "3".
</span><span class="koboSpan" id="kobo.486.4">For hex to octal, press "4".
</span><span class="koboSpan" id="kobo.486.5">To quit, press "q".
</span><span class="koboSpan" id="kobo.486.6">2
Enter the decimal number that you would like to convert.
</span><span class="koboSpan" id="kobo.486.7">10
A
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.487.1">Below this, which is beyond the point where I can show you here, the menu re-appears, waiting for your next response.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.488.1">Now, this does work, but it uses global variables to pass values from the functions back to the main script. </span><span class="koboSpan" id="kobo.488.2">I’ve already told you that this isn’t the safest way of doing business, and that it’s </span><a id="_idIndexMarker771"/><span class="koboSpan" id="kobo.489.1">better to use a combination of local variables and command substitution. </span><span class="koboSpan" id="kobo.489.2">The modified library file is also too long to show here in its entirety, but here’s a snippet:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.490.1">       h2d() {
           local h2dnum=$(echo "ibase=16; $input_num" | bc)
           echo $h2dnum
           }
       d2h() {
           local d2hnum=$(echo "obase=16; $input_num" | bc)
           echo $d2hnum
           }
       o2h() {
           local o2hnum=$(echo "obase=16; ibase=8; $input_num" | bc)
           echo $o2hnum
           }
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.491.1">You can download this entire </span><code class="inlineCode"><span class="koboSpan" id="kobo.492.1">baseconv_local.lib</span></code><span class="koboSpan" id="kobo.493.1"> file, as well as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.494.1">bc-func_local_demo.sh</span></code><span class="koboSpan" id="kobo.495.1"> script that uses it, from Github. </span><span class="koboSpan" id="kobo.495.2">The script is mostly the same as the previous one, except for the code in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.496.1">case. </span><span class="koboSpan" id="kobo.496.2">.esac</span></code><span class="koboSpan" id="kobo.497.1"> construct that invokes the functions. </span><span class="koboSpan" id="kobo.497.2">Here’s a snippet:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.498.1">read choice
        case $choice in
                1) echo "Enter the hex number that you would like to convert. </span><span class="koboSpan" id="kobo.498.2">"
                        read input_num
                        result=$(h2d)
                        echo $result
                        echo
                        echo
                        ;;
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.499.1">I’ve already explained this construction in </span><em class="chapterRef"><span class="koboSpan" id="kobo.500.1">Chapter 10--Understanding Functions</span></em><span class="koboSpan" id="kobo.501.1">, so I won’t say anything more about it here.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.502.1">The final example I’ll show you uses one of the many text stream filters that you thought you’d never use. </span><span class="koboSpan" id="kobo.502.2">This involves using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.503.1">paste</span></code><span class="koboSpan" id="kobo.504.1"> command to help calculate the total </span><a id="_idIndexMarker772"/><span class="koboSpan" id="kobo.505.1">combined market share for the various versions of the Windows operating system. </span><span class="koboSpan" id="kobo.505.2">To see what I mean, take a look at this </span><code class="inlineCode"><span class="koboSpan" id="kobo.506.1">os_combined-ww-monthly-202209-202309-bar.csv</span></code><span class="koboSpan" id="kobo.507.1"> file that you can download from Github:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.508.1">"OS","Market Share Perc. </span><span class="koboSpan" id="kobo.508.2">(Sept 2022 - Oct 2023)"
"Windows 11",17.21
"Windows 10",45.62
"Windows 7",3.5
"Windows 8.1",1.5
"Windows 8",1.3
"Windows XP",0.6
"OS X",17.66
"Unknown",6.55
"Chrome OS",3.15
"Linux",2.89
"Other",0.01
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.509.1">These market share stats are for the various desktop operating systems, as reported by the </span><em class="italic"><span class="koboSpan" id="kobo.510.1">Statcounter Global Stats</span></em><span class="koboSpan" id="kobo.511.1"> site. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.512.1">Well, kind of. </span><span class="koboSpan" id="kobo.512.2">That’s because many years ago when I first created this demo for a shell scripting class that I was teaching, the Statcounter people broke down the Windows share by its different versions, as you see here. </span><span class="koboSpan" id="kobo.512.3">Now though, they only list the overall Windows market share in this combined report, and break down the market share for the various versions of Windows in a separate Windows-only report. </span><span class="koboSpan" id="kobo.512.4">So, I had to doctor up this file a bit to recreate how the report used to be so that the demo can work. </span><span class="koboSpan" id="kobo.512.5">(But hey, whatever works, right?) The demo script for this is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.513.1">report_os.sh</span></code><span class="koboSpan" id="kobo.514.1"> script, which you can also download from Github.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.515.1">The first </span><code class="inlineCode"><span class="koboSpan" id="kobo.516.1">echo</span></code><span class="koboSpan" id="kobo.517.1"> command in the script is what adds the market share for all of the various versions of Windows together, in order to calculate the total combined market share for Windows. </span><span class="koboSpan" id="kobo.517.2">Here’s how that looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.518.1">echo "The market share for Windows is $(grep 'Win' $file | cut -d, -f2 | paste -s -d+ | bc)%." </span><span class="koboSpan" id="kobo.518.2">&gt; report_for_$(date +%F).txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.519.1">So, after I cut the</span><a id="_idIndexMarker773"/><span class="koboSpan" id="kobo.520.1"> second field out of all of the Windows lines, I use </span><code class="inlineCode"><span class="koboSpan" id="kobo.521.1">paste</span></code><span class="koboSpan" id="kobo.522.1"> in serial mode, with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.523.1">+</span></code><span class="koboSpan" id="kobo.524.1"> as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.525.1">paste</span></code><span class="koboSpan" id="kobo.526.1"> field delimiter. </span><span class="koboSpan" id="kobo.526.2">I’ll pipe all that into </span><code class="inlineCode"><span class="koboSpan" id="kobo.527.1">bc</span></code><span class="koboSpan" id="kobo.528.1"> and then redirect the output to a text file with today’s date in the filename.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.529.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.530.1">echo</span></code><span class="koboSpan" id="kobo.531.1"> commands for the rest of the operating systems are more straightforward, since they don’t require any math calculations. </span><span class="koboSpan" id="kobo.531.2">Here’s the one for macOS:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.532.1">echo "The market share for macOS is $(grep 'OS X' $file | cut -d, -f2)%." </span><span class="koboSpan" id="kobo.532.2">&gt;&gt; report_for_$(date +%F).txt
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.533.1">Yes, I do know that Apple changed the name of their operating system to macOS. </span><span class="koboSpan" id="kobo.533.2">But, the Statcounter people still list it as OS X, so that’s what I need for the search term in the script. </span><span class="koboSpan" id="kobo.533.3">Anyway, running the script looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.534.1">[donnie@fedora ~]$ ./report_os.sh os_combined-ww-monthly-202209-202309-bar.csv
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.535.1">The resultant report file looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.536.1">The market share for Windows is 69.73%.
</span><span class="koboSpan" id="kobo.536.2">The market share for macOS is 17.66%.
</span><span class="koboSpan" id="kobo.536.3">The market share for Linux is 2.89%.
</span><span class="koboSpan" id="kobo.536.4">The market share for Chrome is 3.15%.
</span><span class="koboSpan" id="kobo.536.5">The market share for Unknown is 6.55%.
</span><span class="koboSpan" id="kobo.536.6">The market share for Others is 0.01%.
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.537.1">When I doctored the input file to have it list the various versions of Windows, I took care to ensure that the total Windows share still adds up to what it’s supposed to be. </span><span class="koboSpan" id="kobo.537.2">So yes, as I’m writing this in October 2023, the total Windows market share really is 69.73%.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.538.1">By the way, if you’re interested in seeing more statistics about operating system usage, check out the Statcounter Global Stats site here: </span><a href="https://gs.statcounter.com/"><span class="url"><span class="koboSpan" id="kobo.539.1">https://gs.statcounter.com/</span></span></a></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.540.1">I do believe</span><a id="_idIndexMarker774"/><span class="koboSpan" id="kobo.541.1"> that this about covers it for shell scripting math. </span><span class="koboSpan" id="kobo.541.2">Let’s summarize and move on.</span></p>
    <h1 id="_idParaDest-272" class="heading 1"><span class="koboSpan" id="kobo.542.1">Summary</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.543.1">In this chapter, I’ve shown you several ways to perform math operations in </span><code class="inlineCode"><span class="koboSpan" id="kobo.544.1">bash</span></code><span class="koboSpan" id="kobo.545.1">, and even provided a couple of tips on how to ensure that your math scripts can run on non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.546.1">bash</span></code><span class="koboSpan" id="kobo.547.1"> shells. </span><span class="koboSpan" id="kobo.547.2">I started with the various methods of performing integer math, and then showed you various ways to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.548.1">bc</span></code><span class="koboSpan" id="kobo.549.1"> to perform floating point math. </span><span class="koboSpan" id="kobo.549.2">As I said before, you’d need to be a math expert to take full advantage of all of </span><code class="inlineCode"><span class="koboSpan" id="kobo.550.1">bc</span></code><span class="koboSpan" id="kobo.551.1">'s features. </span><span class="koboSpan" id="kobo.551.2">But, even if you aren’t, there’s still a lot you can do with it. </span><span class="koboSpan" id="kobo.551.3">And, there are plenty of math tutorials online that can help. </span><span class="koboSpan" id="kobo.551.4">Just use your favorite search engine to find them.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.552.1">In the next chapter, I’ll show you how to use here documents. </span><span class="koboSpan" id="kobo.552.2">I’ll see you there.</span></p>
    <h1 id="_idParaDest-273" class="heading 1"><span class="koboSpan" id="kobo.553.1">Questions</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.554.1">Which of the following methods would you used to perform integer math from the command-line?</span><ol>
          <li class="alphabeticList level 2" value="1"> <code class="inlineCode"><span class="koboSpan" id="kobo.555.1">echo 1+1</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.556.1">echo 1 + 1</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.557.1">echo $(bc 1+1)</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.558.1">expr 1+1</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.559.1">expr 1 + 1</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.560.1">You want to ensure that your shell script works on </span><code class="inlineCode"><span class="koboSpan" id="kobo.561.1">bash</span></code><span class="koboSpan" id="kobo.562.1">, as well as on non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.563.1">bash</span></code><span class="koboSpan" id="kobo.564.1"> shells. </span><span class="koboSpan" id="kobo.564.2">Which of the following commands could you use in your script?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.565.1">echo $((1+2+3+4))</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.566.1">echo $[1+2+3+4]</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.567.1">echo $[[1+2+3+4]]</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.568.1">echo $(1+2+3+4)</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.569.1">You want to perform floating point math. </span><span class="koboSpan" id="kobo.569.2">Which of the following commands would you use?</span><ol>
          <li class="alphabeticList level 2" value="1"> <code class="inlineCode"><span class="koboSpan" id="kobo.570.1">bc</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.571.1">bc -f</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.572.1">bc -l</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.573.1">bc --float</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.574.1">You need to find the natural logarithm of 8. </span><span class="koboSpan" id="kobo.574.2">How would you do it?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.575.1">expr log(8)</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.576.1">echo [log(8)]</span></code></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.577.1">Use </span><code class="inlineCode"><span class="koboSpan" id="kobo.578.1">l(8)</span></code><span class="koboSpan" id="kobo.579.1"> with </span><code class="inlineCode"><span class="koboSpan" id="kobo.580.1">bc</span></code></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.581.1">Use </span><code class="inlineCode"><span class="koboSpan" id="kobo.582.1">log(8)</span></code><span class="koboSpan" id="kobo.583.1"> with </span><code class="inlineCode"><span class="koboSpan" id="kobo.584.1">bc</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.585.1">Which of these commands would you use to find the approximate value of П?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.586.1">pi=$("scale=10; 4*a(1)" | bc -l)</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.587.1">pi=$(echo "scale=10; 4*a(1)" | bc -l)</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.588.1">pi=$(bc -l "scale=10; 4*a(1)" )</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.589.1">pi=$(echo "scale=10; 4*arc(1)" | bc -l)</span></code></li>
        </ol>
      </li>
    </ol>
    <h1 id="_idParaDest-274" class="heading 1"><span class="koboSpan" id="kobo.590.1">Further Reading</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.591.1">Bash Math Operations (Bash Arithmetic) Explained: </span><a href="https://phoenixnap.com/kb/bash-math"><span class="url"><span class="koboSpan" id="kobo.592.1">https://phoenixnap.com/kb/bash-math</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.593.1">bc Command Manual: </span><a href="https://www.gnu.org/software/bc/manual/html_mono/bc.html"><span class="url"><span class="koboSpan" id="kobo.594.1">https://www.gnu.org/software/bc/manual/html_mono/bc.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.595.1">What is a good command-line calculator on Linux: </span><a href="https://www.xmodulo.com/command-line-calculator-linux.html"><span class="url"><span class="koboSpan" id="kobo.596.1">https://www.xmodulo.com/command-line-calculator-linux.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.597.1">Geometry Cheat Sheet: </span><a href="https://s3-us-west-1.amazonaws.com/math-salamanders/Geometry/Geometry-Information-Pages/Geometry-Cheat-Sheets/geometry-cheat-sheet-4-2d-shapes-formulas.pdf"><span class="url"><span class="koboSpan" id="kobo.598.1">https://s3-us-west-1.amazonaws.com/math-salamanders/Geometry/Geometry-Information-Pages/Geometry-Cheat-Sheets/geometry-cheat-sheet-4-2d-shapes-formulas.pdf</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.599.1">Mathematics LibreTexts: </span><a href="https://math.libretexts.org/"><span class="url"><span class="koboSpan" id="kobo.600.1">https://math.libretexts.org/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.601.1">Statcounter Global Stats: </span><a href="https://gs.statcounter.com/"><span class="url"><span class="koboSpan" id="kobo.602.1">https://gs.statcounter.com/</span></span></a></li>
    </ul>
    <h1 id="_idParaDest-275" class="heading 1"><span class="koboSpan" id="kobo.603.1">Answers</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.604.1">e</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.605.1">a</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.606.1">c</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.607.1">c</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.608.1">b</span></li>
    </ol>
    <h1 id="_idParaDest-276" class="heading 1"><span class="koboSpan" id="kobo.609.1">Join our community on Discord!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.610.1">Read this book alongside other users, Linux experts, and the author himself. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.611.1">Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. </span><span class="koboSpan" id="kobo.611.2">Scan the QR code or visit the link to join the community.</span></p>
    <p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.612.1">https://packt.link/SecNet</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.613.1"><img src="../Images/QR_Code10596186092701843.png" alt=""/></span></p>
  </div>
</body></html>