<html><head></head><body>
<div id="_idContainer203">
<h1 class="chapter-number" id="_idParaDest-155"><a id="_idTextAnchor189"/><a id="_idTextAnchor190"/><span class="koboSpan" id="kobo.1.1">7</span></h1>
<h1 id="_idParaDest-156"><a id="_idTextAnchor191"/><span class="koboSpan" id="kobo.2.1">Oracle Linux 8 – Patching Doesn’t Have to Mean Rebooting</span></h1>
<p><span class="koboSpan" id="kobo.3.1">I’ve rebooted when patching for my entire life, why </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">change now?</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">Since Linux was released back in 1991, when the kernel was patched, you had to reboot the system. </span><span class="koboSpan" id="kobo.5.2">At the time, even the IBM mainframes that dominated corporate IT needed to be rebooted when patched, so it was considered normal for all other systems to be rebooted when patched. </span><span class="koboSpan" id="kobo.5.3">This process appeared to work fine for almost the next 20 years, but the seeds of change were planted in 2005 when a </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">Massachusetts Institute of Technology</span></strong><span class="koboSpan" id="kobo.7.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.8.1">MIT</span></strong><span class="koboSpan" id="kobo.9.1">) student came up with a simple question. </span><em class="italic"><span class="koboSpan" id="kobo.10.1">What if you could patch without rebooting the system?</span></em><span class="koboSpan" id="kobo.11.1"> His team came up with an answer in 2009 when Ksplice was released, enabling the ability to patch a Linux kernel while the system </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">was running.</span></span></p>
<p><span class="koboSpan" id="kobo.13.1">In this chapter, we will cover why you should start using Ksplice and how it is used to improve the security of </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">your system.</span></span></p>
<p><span class="koboSpan" id="kobo.15.1">This chapter contains the </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">following recipes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.17.1">Setting up Ksplice with </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">internet access</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">Using Ksplice with no </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">internet access</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">Installing and enabling Known </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">Exploit Detection</span></span></li>
</ul>
<h1 id="_idParaDest-157"><a id="_idTextAnchor192"/><span class="koboSpan" id="kobo.23.1">Setting up Ksplice with internet access</span></h1>
<p><span class="koboSpan" id="kobo.24.1">Before we get into the recipe, let’s understand what’s all the fuss </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">around Ksplice.</span></span></p>
<h2 id="_idParaDest-158"><a id="_idTextAnchor193"/><span class="koboSpan" id="kobo.26.1">What’s all the fuss about Ksplice?</span></h2>
<p><span class="koboSpan" id="kobo.27.1">The first question</span><a id="_idIndexMarker635"/><span class="koboSpan" id="kobo.28.1"> is, </span><em class="italic"><span class="koboSpan" id="kobo.29.1">Why is this important to IT, and more importantly, to defending the applications running on the servers?</span></em><span class="koboSpan" id="kobo.30.1"> Before we get to that, you first need to understand the process that hackers use to </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">compromise systems.</span></span></p>
<p><span class="koboSpan" id="kobo.32.1">The basic process includes three main stages: reconnaissance, gaining access, and then maintaining access. </span><span class="koboSpan" id="kobo.32.2">Once a system is compromised, the process is repeated on other systems on </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">the network:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer183">
<span class="koboSpan" id="kobo.34.1"><img alt="Figure 7.1 – Security life cycle" src="image/B18349_07_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.35.1">Figure 7.1 – Security life cycle</span></p>
<p><span class="koboSpan" id="kobo.36.1">In the first phase, </span><strong class="bold"><span class="koboSpan" id="kobo.37.1">reconnaissance</span></strong><span class="koboSpan" id="kobo.38.1">, hackers</span><a id="_idIndexMarker636"/><span class="koboSpan" id="kobo.39.1"> use a variety of methods to scan the system for vulnerabilities. </span><span class="koboSpan" id="kobo.39.2">Often, this attacking phase against servers starts after hackers have gained access to a low-level</span><a id="_idIndexMarker637"/><span class="koboSpan" id="kobo.40.1"> support account that has access to the server. </span><span class="koboSpan" id="kobo.40.2">Once there, it is a trivial task to look at the kernel version and identify what vulnerabilities the kernel is susceptible to. </span><span class="koboSpan" id="kobo.40.3">Oracle offers a free site (</span><a href="https://ksplice.oracle.com/inspector"><span class="koboSpan" id="kobo.41.1">https://ksplice.oracle.com/inspector</span></a><span class="koboSpan" id="kobo.42.1">) that lets </span><a id="_idIndexMarker638"/><span class="koboSpan" id="kobo.43.1">you easily check the vulnerabilities of the kernel. </span><span class="koboSpan" id="kobo.43.2">The results of such a check are shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.44.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.45.1">.2</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.46.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer184">
<span class="koboSpan" id="kobo.47.1"><img alt="Figure 7.2 – Ksplice Inspector" src="image/B18349_07_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.48.1">Figure 7.2 – Ksplice Inspector</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.49.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.50.1">The MITRE Corporation is a </span><a id="_idIndexMarker639"/><span class="koboSpan" id="kobo.51.1">non-profit company funded by the US federal government that researches ways to improve safety across multiple industries, including aviation, healthcare, homeland security, defense, and cybersecurity. </span><span class="koboSpan" id="kobo.51.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.52.1">Common Vulnerabilities and Exposures</span></strong><span class="koboSpan" id="kobo.53.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.54.1">CVE</span></strong><span class="koboSpan" id="kobo.55.1">) program was launched in 1999 and quickly </span><a id="_idIndexMarker640"/><span class="koboSpan" id="kobo.56.1">became the go-to location to track cybersecurity vulnerabilities. </span><span class="koboSpan" id="kobo.56.2">More information about the CVE program can be found </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">at </span></span><a href="https://cve.org"><span class="No-Break"><span class="koboSpan" id="kobo.58.1">https://cve.org</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.59.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.60.1">Not only will the system identify the CVE that the kernel is susceptible to but it also links to the MITRE site with the CVE details. </span><span class="koboSpan" id="kobo.60.2">In the example report, you can see the kernel is susceptible to several CVEs, including a few that would allow the attacker to gain root access. </span><span class="koboSpan" id="kobo.60.3">Surprisingly, unlike other similar technologies, Ksplice also helps defend against this phase with its ability to detect attacks against the running kernel, seeking to gain privileged escalation</span><a id="_idIndexMarker641"/><span class="koboSpan" id="kobo.61.1"> using the </span><strong class="bold"><span class="koboSpan" id="kobo.62.1">Known Exploit Detection</span></strong><span class="koboSpan" id="kobo.63.1"> technology. </span><span class="koboSpan" id="kobo.63.2">This effectively turns every system using Ksplice into a free intrusion detection system for </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">the kernel.</span></span></p>
<p><span class="koboSpan" id="kobo.65.1">In the next phase, gaining access, the hacker exploits the vulnerability, gaining access to the data. </span><span class="koboSpan" id="kobo.65.2">This is often done weeks after the initial discovery phase. </span><span class="koboSpan" id="kobo.65.3">Hackers take their time; they do this to run under the radar, and they know that most environments are only patched on a quarterly basis at best. </span><span class="koboSpan" id="kobo.65.4">Additionally, many attacks come from inside the organization, from people who have limited access to systems as part of their normal role. </span><span class="koboSpan" id="kobo.65.5">Ksplice disrupts this pattern, enabling the system admin to easily patch daily, closing the window of opportunity for </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">the hacker.</span></span></p>
<p><span class="koboSpan" id="kobo.67.1">In the last phase, the hackers work to maintain access, often using the same vulnerability to continually mine the system for data. </span><span class="koboSpan" id="kobo.67.2">Ksplice allows this to also be shut down, as it closes the vulnerability not only for exploits post-patch but also shuts down the exploit for the attack while in progress. </span><span class="koboSpan" id="kobo.67.3">This is an important feature of Ksplice: the ability to patch the kernel and close the exploit while the exploit is being used. </span><span class="koboSpan" id="kobo.67.4">This shuts down the exploit mid-flight, significantly enhancing the </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">system’s security.</span></span></p>
<p><span class="koboSpan" id="kobo.69.1">Now, about that patching effort – once a quarter at best? </span><span class="koboSpan" id="kobo.69.2">Kernel patches are released almost daily, yet systems can remain unpatched for almost a quarter of the year or more. </span><span class="koboSpan" id="kobo.69.3">This gives attackers a huge window of opportunity to compromise your systems. </span><span class="koboSpan" id="kobo.69.4">Not only is scheduling the patch a challenge for most mission-critical systems but the patch process itself is very time- and labor-intensive. </span><span class="koboSpan" id="kobo.69.5">Let’s look at why this is the case. </span><span class="koboSpan" id="kobo.69.6">As seen in the following diagram, there are many steps required to patch </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">a server:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer185">
<span class="koboSpan" id="kobo.71.1"><img alt="Figure 7.3 – Legacy patch process" src="image/B18349_07_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.72.1">Figure 7.3 – Legacy patch process</span></p>
<p><span class="koboSpan" id="kobo.73.1">The following list provides a short description of </span><a id="_idIndexMarker642"/><span class="koboSpan" id="kobo.74.1">each of </span><span class="No-Break"><span class="koboSpan" id="kobo.75.1">these steps:</span></span></p>
<ol>
<li><strong class="bold"><span class="koboSpan" id="kobo.76.1">Block users from accessing the application</span></strong><span class="koboSpan" id="kobo.77.1">: Disable load balancers or disable user logins to the application so users do not accidentally </span><span class="No-Break"><span class="koboSpan" id="kobo.78.1">corrupt data.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.79.1">Shut down the application</span></strong><span class="koboSpan" id="kobo.80.1">: Shut down the databases, application servers, schedulers, load balancers, and so on. </span><span class="koboSpan" id="kobo.80.2">This is to prepare for the operating </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">system reboot.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.82.1">Sanity reboot the servers</span></strong><span class="koboSpan" id="kobo.83.1">: Perform a reboot of the servers, with no other changes made. </span><span class="koboSpan" id="kobo.83.2">This is to verify that the servers can perform a clean reboot. </span><span class="koboSpan" id="kobo.83.3">Often in this step, a snapshot is made of the </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">app servers.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.85.1">Restart the application</span></strong><span class="koboSpan" id="kobo.86.1">: Start the application back up to verify that it is working. </span><span class="koboSpan" id="kobo.86.2">This is to verify the </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">sanity reboot.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.88.1">Test post sanity reboot</span></strong><span class="koboSpan" id="kobo.89.1">: Often, some changes get made to the application and/or its infrastructure that can cause issues with the application. </span><span class="koboSpan" id="kobo.89.2">This step verifies that there is a good system before the patches </span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">are applied.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.91.1">Shut down the application</span></strong><span class="koboSpan" id="kobo.92.1">: Shut everything down again to prepare for </span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">the patching.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.94.1">Patch the servers</span></strong><span class="koboSpan" id="kobo.95.1">: Apply the operating </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">system patches.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.97.1">Reboot post patch</span></strong><span class="koboSpan" id="kobo.98.1">: Reboot so the patches </span><span class="No-Break"><span class="koboSpan" id="kobo.99.1">take effect.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.100.1">Restart the application</span></strong><span class="koboSpan" id="kobo.101.1">: Restart the </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">application again.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.103.1">Test the application</span></strong><span class="koboSpan" id="kobo.104.1">: Test the</span><a id="_idIndexMarker643"/><span class="koboSpan" id="kobo.105.1"> application, and verify all </span><span class="No-Break"><span class="koboSpan" id="kobo.106.1">is good.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.107.1">Let users back in</span></strong><span class="koboSpan" id="kobo.108.1">: Allow users back into </span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">the application.</span></span></li>
</ol>
<p class="callout-heading"><span class="koboSpan" id="kobo.110.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.111.1">Not every organization follows the full path process, skipping steps to save some time. </span><span class="koboSpan" id="kobo.111.2">While this can save some time in the short term, all it takes is one bad patch cycle where changes were made to the application and/or its infrastructure between patch cycles to make for a very bad, long night, or worse, </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">long days.</span></span></p>
<p><span class="koboSpan" id="kobo.113.1">As you can see, properly patching takes a lot of time, and the more complex the application, the more people and time are required for each patch cycle. </span><span class="koboSpan" id="kobo.113.2">Most of this time and effort is caused due to the </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">reboots required.</span></span></p>
<p><span class="koboSpan" id="kobo.115.1">When you avoid the reboot, the patch process is significantly simplified; as shown in the following diagram, there are only </span><span class="No-Break"><span class="koboSpan" id="kobo.116.1">two steps!</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer186">
<span class="koboSpan" id="kobo.117.1"><img alt="Figure 7.4 – Ksplice patching process" src="image/B18349_07_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.118.1">Figure 7.4 – Ksplice patching process</span></p>
<p><span class="koboSpan" id="kobo.119.1">The following list provides a short description of these </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">two steps:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.121.1">Ksplice the servers</span></strong><span class="koboSpan" id="kobo.122.1">: Apply</span><a id="_idIndexMarker644"/><span class="koboSpan" id="kobo.123.1"> the kernel and user space patches </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">with ksplice.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.125.1">Testing</span></strong><span class="koboSpan" id="kobo.126.1">: Test </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">the application</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.128.1">By using Ksplice, your team can save a ton of time, reduce late nights, and improve security. </span><span class="koboSpan" id="kobo.128.2">Best of all, it’s easy to set up </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">and use!</span></span></p>
<h3><span class="koboSpan" id="kobo.130.1">Discovering Ksplice</span></h3>
<p><span class="koboSpan" id="kobo.131.1">Ksplice is easy to configure. </span><span class="koboSpan" id="kobo.131.2">There are a few concepts and points you need to understand before </span><a id="_idIndexMarker645"/><span class="koboSpan" id="kobo.132.1">Ksplicing </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">your servers:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.134.1">If your servers are running on </span><strong class="bold"><span class="koboSpan" id="kobo.135.1">Oracle Cloud Infrastructure</span></strong><span class="koboSpan" id="kobo.136.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.137.1">OCI</span></strong><span class="koboSpan" id="kobo.138.1">), using Oracle’s default </span><a id="_idIndexMarker646"/><span class="koboSpan" id="kobo.139.1">platform images, all the Ksplice preparation work and access to the Ksplice repo is already performed to support online Ksplice usage. </span><span class="koboSpan" id="kobo.139.2">Systems will also need a route (usually done with a NAT gateway) to the Ksplice endpoint. </span><span class="koboSpan" id="kobo.139.3">This is automatically set up when using</span><a id="_idIndexMarker647"/><span class="koboSpan" id="kobo.140.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.141.1">Virtual Cloud Network</span></strong><span class="koboSpan" id="kobo.142.1"> (</span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.143.1">VCN</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.144.1">) wizard.</span></span></li>
<li><span class="koboSpan" id="kobo.145.1">If you are using Autonomous Linux on OCI, your systems are already being </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">Kspliced automatically.</span></span></li>
<li><span class="koboSpan" id="kobo.147.1">There are two Ksplice clients: the legacy Uptrack client and the </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">Enhanced client.</span></span></li>
<li><span class="koboSpan" id="kobo.149.1">You do not need internet access to use Ksplice; you can use specially built Ksplice </span><strong class="source-inline"><span class="koboSpan" id="kobo.150.1">.rpm</span></strong><span class="koboSpan" id="kobo.151.1"> files using the offline mode. </span><span class="koboSpan" id="kobo.151.2">This will require that you mirror the ULN Ksplice repos on a local YUM server. </span><span class="koboSpan" id="kobo.151.3">This was covered in </span><a href="B18349_05.xhtml#_idTextAnchor135"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.152.1">Chapter 5</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.153.1">.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.154.1">Both the Enhanced client and the Uptrack client allow you to Ksplice the kernel, but the Enhanced client also offers the ability to Ksplice user space libraries, KVM hypervisors, and Arm-based systems and offers Known Exploit Detection on x86_64 platforms. </span><span class="koboSpan" id="kobo.154.2">Most new users should use the </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">Enhanced client.</span></span></p>
<p><span class="koboSpan" id="kobo.156.1">The older Uptrack client does not offer the advantages the Enhanced client offers, but it does support the ability to patch some non-Oracle </span><span class="No-Break"><span class="koboSpan" id="kobo.157.1">Linux systems.</span></span></p>
<p><span class="koboSpan" id="kobo.158.1">Ksplice offers two different modes: the online mode and the offline mode. </span><span class="koboSpan" id="kobo.158.2">The online mode requires that each system registers to the Oracle ULN but offers a Ksplice web interface, the Ksplice Uptrack API, for advanced automation and the ability to patch a Xen hypervisor. </span><span class="koboSpan" id="kobo.158.3">However, since this requires every system to not only register with ULN but also for internet access, many system administrators use the </span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">offline mode.</span></span></p>
<p><span class="koboSpan" id="kobo.160.1">The offline mode allows the</span><a id="_idIndexMarker648"/><span class="koboSpan" id="kobo.161.1"> system to use Ksplice without internet access. </span><span class="koboSpan" id="kobo.161.2">This is most often used by Enterprise and Government environments where all servers do not have internet access. </span><span class="koboSpan" id="kobo.161.3">In these use cases, the most common method is to set up a ULN mirror, giving that system access to the internet, and the local Oracle Linux servers will pull from that mirror to </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">use Ksplice:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer187">
<span class="koboSpan" id="kobo.163.1"><img alt="Figure 7.5 – Ksplice offline mode using RPMs" src="image/B18349_07_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.164.1">Figure 7.5 – Ksplice offline mode using RPMs</span></p>
<p><span class="koboSpan" id="kobo.165.1">With the offline mode, only the local ULN mirror needs to be able to access the Oracle ULN, via the HTTPS protocol. </span><span class="koboSpan" id="kobo.165.2">This can be done via a basic firewall rule or a more advanced proxy server. </span><span class="koboSpan" id="kobo.165.3">Once the ULN mirror is registered and synced from the ULN, the servers behind the firewall can pull their RPMs via HTTP/HTTPS from the ULN mirror. </span><span class="koboSpan" id="kobo.165.4">There are a couple of advantages to the offline mode: less bandwidth is used for the internet and not every client needs to be registered. </span><span class="koboSpan" id="kobo.165.5">Of course, having no API, there are some limitations with more </span><a id="_idIndexMarker649"/><span class="No-Break"><span class="koboSpan" id="kobo.166.1">advanced automation.</span></span></p>
<p><span class="koboSpan" id="kobo.167.1">Regardless of what mode is used, the clients must have access to a few specific Ksplice channels. </span><span class="koboSpan" id="kobo.167.2">The following table describes the channels that are available for Ksplice in </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">Oracle Linux:</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-7">
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<thead>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.169.1">Channel Name</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold"><span class="koboSpan" id="kobo.170.1">Enhanced </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.171.1">Client</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.172.1">Channel Label</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.173.1">Description</span></strong></span></p>
</td>
</tr>
</thead>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.174.1">Ksplice for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">7 (x86_64)</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.176.1">Optional</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">ol7_x86_64_ksplice</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.178.1">Ksplice RPMs for Oracle Linux 7 on </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">x86_64 systems</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.180.1">Ksplice for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">7 (aarch64)</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.182.1">Optional</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.183.1">ol7_aarch64_ksplice</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.184.1">Ksplice RPMs for Oracle Linux 7 on </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">aarch64 systems</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.186.1">Ksplice for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">8 (x86_64)</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.188.1">Optional</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">ol8_x86_64_ksplice</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.190.1">Ksplice RPMs for Oracle Linux 8 on </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">x86_64 systems</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.192.1">Ksplice for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.193.1">8 (aarch64)</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.194.1">Optional</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">ol8_aarch64_ksplice</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.196.1">Ksplice RPMs for Linux 8 on </span><span class="No-Break"><span class="koboSpan" id="kobo.197.1">aarch64 systems</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.198.1">Ksplice-aware user space packages for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">7 (x86_64)</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.200.1">Required</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.201.1">ol7_x86_64_userspace_ksplice</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.202.1">Latest RPMs for Ksplice-aware user space packages for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">7 (x86_64)</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.204.1">Ksplice-aware user space packages for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.205.1">7 (aarch64)</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.206.1">Required</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">ol7_aarch64_userspace_ksplice</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.208.1">Latest RPMs for Ksplice-aware user </span><a id="_idIndexMarker650"/><span class="koboSpan" id="kobo.209.1">space packages for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">7 (aarch64)</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.211.1">Ksplice-aware user space packages for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">8 (x86_64)</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.213.1">Required</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">ol8_x86_64_userspace_ksplice</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.215.1">Latest RPMs for Ksplice-aware user space packages for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">8 (x86_64)</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.217.1">Ksplice-aware user space packages for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.218.1">8 (aarch64)</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.219.1">Optional</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">ol8_aarch64_userspace_ksplice</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.221.1">Latest RPMs for Ksplice-aware user space packages for Oracle Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">8 (aarch64)</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.223.1">Table 7.1 – Ksplice channels</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.224.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.225.1">If </span><strong class="source-inline"><span class="koboSpan" id="kobo.226.1">prelink</span></strong><span class="koboSpan" id="kobo.227.1"> is installed, revert the pre-linked binaries to their original state (</span><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">prelink -au</span></strong><span class="koboSpan" id="kobo.229.1">) and then uninstall </span><strong class="source-inline"><span class="koboSpan" id="kobo.230.1">prelink</span></strong><span class="koboSpan" id="kobo.231.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.232.1">dnf remove prelink -y</span></strong><span class="koboSpan" id="kobo.233.1">). </span><span class="koboSpan" id="kobo.233.2">While not often used, </span><strong class="source-inline"><span class="koboSpan" id="kobo.234.1">prelink</span></strong><span class="koboSpan" id="kobo.235.1"> is not compatible </span><span class="No-Break"><span class="koboSpan" id="kobo.236.1">with Ksplice.</span></span></p>
<p><span class="koboSpan" id="kobo.237.1">Now that you have an</span><a id="_idIndexMarker651"/><span class="koboSpan" id="kobo.238.1"> understanding of why you need to use Ksplice and the basics of how it works, let’s get to </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">the recipe.</span></span></p>
<p><span class="koboSpan" id="kobo.240.1">The easiest way to use Ksplice is to allow each system to access the Oracle Ksplice service directly. </span><span class="koboSpan" id="kobo.240.2">This is called online mode. </span><span class="koboSpan" id="kobo.240.3">This can </span><a id="_idIndexMarker652"/><span class="koboSpan" id="kobo.241.1">be done via an internet proxy, direct access, or by running the systems </span><span class="No-Break"><span class="koboSpan" id="kobo.242.1">in OCI.</span></span></p>
<h2 id="_idParaDest-159"><a id="_idTextAnchor194"/><span class="koboSpan" id="kobo.243.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.244.1">To do this, you will need a test system, running Oracle Linux 8, with access to </span><span class="No-Break"><span class="koboSpan" id="kobo.245.1">the internet.</span></span></p>
<h2 id="_idParaDest-160"><a id="_idTextAnchor195"/><span class="koboSpan" id="kobo.246.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.247.1">When using Ksplice, make sure you match each system for both the operating system version, and the user-space libraries. </span><span class="koboSpan" id="kobo.247.2">Do not use an Oracle Linux 9 repo for an Oracle Linux 8 system. </span><span class="koboSpan" id="kobo.247.3">An example </span><a id="_idIndexMarker653"/><span class="koboSpan" id="kobo.248.1">of what a system should look like can be seen in the </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">following screenshot:</span></span></p>
<p class="IMG---Figure"><a id="_idTextAnchor196"/></p>
<div>
<div class="IMG---Figure" id="_idContainer188">
<span class="koboSpan" id="kobo.250.1"><img alt="Figure 7.6 – Required channels" src="image/B18349_07_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.251.1">Figure 7.6 – Required channels</span></p>
<p><span class="koboSpan" id="kobo.252.1">If you are using an internet proxy server, you will need to export some environmental variables to set the </span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">proxy servers:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.254.1">
sudo http_proxy=http://proxy_server_URL:http_port
sudo https_proxy=http://proxy_server_URL:https_port
sudo export http_proxy https_proxy</span></pre> <p><span class="koboSpan" id="kobo.255.1">Set </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">proxy_server_URL</span></strong><span class="koboSpan" id="kobo.257.1"> to the proxy server, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">http_port</span></strong><span class="koboSpan" id="kobo.259.1"> to the port the proxy </span><span class="No-Break"><span class="koboSpan" id="kobo.260.1">server uses.</span></span></p>
<p><span class="koboSpan" id="kobo.261.1">Next, Ksplice will be installed </span><a id="_idIndexMarker654"/><span class="koboSpan" id="kobo.262.1">using </span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">dnf</span></strong><span class="koboSpan" id="kobo.264.1">. </span><span class="koboSpan" id="kobo.264.2">Both the </span><strong class="source-inline"><span class="koboSpan" id="kobo.265.1">ksplice</span></strong><span class="koboSpan" id="kobo.266.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">uptrack</span></strong><span class="koboSpan" id="kobo.268.1"> packages </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">are needed:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.270.1">
dnf install -y ksplice uptrack</span></pre> <p><span class="koboSpan" id="kobo.271.1">When the installation</span><a id="_idIndexMarker655"/><span class="koboSpan" id="kobo.272.1"> is complete, please verify that your system is seen in the ULN and that an access key has been populated </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.274.1">/etc/uptrack/uptrack.conf</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.276.1">The access key should be in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.277.1">[Auth]</span></strong><span class="koboSpan" id="kobo.278.1"> section and should look similar </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">to this:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.280.1">
[Auth]
accesskey = b3ag33k1746d141edb377f6f643344e23ad9638ae4d896ead4dcdddbb350a058b</span></pre> <p><span class="koboSpan" id="kobo.281.1">Once done, perform a normal </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">dnf update</span></strong><span class="koboSpan" id="kobo.283.1"> and then reboot the system. </span><span class="koboSpan" id="kobo.283.2">This </span><strong class="source-inline"><span class="koboSpan" id="kobo.284.1">dnf update</span></strong><span class="koboSpan" id="kobo.285.1"> is required so the Ksplice-aware user space libraries are loaded; it is only required the first time Ksplice </span><span class="No-Break"><span class="koboSpan" id="kobo.286.1">is used.</span></span></p>
<p><span class="koboSpan" id="kobo.287.1">Once the server is rebooted, Ksplice can now be used to patch user space libraries and </span><span class="No-Break"><span class="koboSpan" id="kobo.288.1">the kernel.</span></span></p>
<p><span class="koboSpan" id="kobo.289.1">To see what updates are available for the kernel, you can run the Ksplice </span><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">kernel upgrade</span></strong><span class="koboSpan" id="kobo.291.1"> command, passing </span><strong class="source-inline"><span class="koboSpan" id="kobo.292.1">-n</span></strong><span class="koboSpan" id="kobo.293.1"> for </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">no action:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.295.1">
ksplice -n kernel upgrade</span></pre> <p><span class="koboSpan" id="kobo.296.1">The output from this command is seen in the </span><span class="No-Break"><span class="koboSpan" id="kobo.297.1">following screenshot:</span></span><a id="_idTextAnchor197"/></p>
<div>
<div class="IMG---Figure" id="_idContainer189">
<span class="koboSpan" id="kobo.298.1"><img alt="Figure 7.7 – Ksplice available upgrades" src="image/B18349_07_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.299.1">Figure 7.7 – Ksplice available upgrades</span></p>
<p><span class="koboSpan" id="kobo.300.1">In this system, only one</span><a id="_idIndexMarker656"/><span class="koboSpan" id="kobo.301.1"> update is available, patching </span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">CVE-2021-4034</span></strong><span class="koboSpan" id="kobo.303.1">. </span><span class="koboSpan" id="kobo.303.2">To splice the system, run the same command, replacing </span><strong class="source-inline"><span class="koboSpan" id="kobo.304.1">-n</span></strong><span class="koboSpan" id="kobo.305.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.306.1">-y</span></strong><span class="koboSpan" id="kobo.307.1"> to say yes to applying the </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">kernel path:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer190">
<span class="koboSpan" id="kobo.309.1"><img alt="Figure 7.8 – Ksplice updating the kernel" src="image/B18349_07_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.310.1">Figure 7.8 – Ksplice updating the kernel</span></p>
<p><span class="koboSpan" id="kobo.311.1">From here, you can see that the CVE patch has now taken place without </span><span class="No-Break"><span class="koboSpan" id="kobo.312.1">a reboot!</span></span></p>
<p><span class="koboSpan" id="kobo.313.1">The kernel that has been patched is referred to as the effective kernel. </span><span class="koboSpan" id="kobo.313.2">When you use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.314.1">ksplice kernel uname -r</span></strong><span class="koboSpan" id="kobo.315.1"> command in Ksplice, it displays the effective kernel version, which indicates the current security status of the kernel based on the applied patches. </span><span class="koboSpan" id="kobo.315.2">This version typically varies from the initially booted kernel version and is meant to reflect the present condition of the kernel regarding any potential security threats or </span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">major issues.</span></span></p>
<p><span class="koboSpan" id="kobo.317.1">You can now validate what your effective kernel is by using the following </span><span class="No-Break"><span class="koboSpan" id="kobo.318.1">Ksplice command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.319.1">
ksplice kernel show</span></pre> <p><span class="koboSpan" id="kobo.320.1">Note that the version of the running kernel and the installed kernel will not match! </span><span class="koboSpan" id="kobo.320.2">This is because when Ksplice splices the kernel, it splices the RAM of the running kernel with the new code. </span><span class="koboSpan" id="kobo.320.3">This patches the kernel (and selected user space libraries) but has the effect of </span><strong class="source-inline"><span class="koboSpan" id="kobo.321.1">uname</span></strong><span class="koboSpan" id="kobo.322.1"> no longer matching the </span><span class="No-Break"><span class="koboSpan" id="kobo.323.1">effective kernel:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer191">
<span class="koboSpan" id="kobo.324.1"><img alt="Figure 7.9 – Ksplice uname" src="image/B18349_07_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.325.1">Figure 7.9 – Ksplice uname</span></p>
<p><span class="koboSpan" id="kobo.326.1">Here, the installed kernel is </span><strong class="source-inline"><span class="koboSpan" id="kobo.327.1">5.4.17-2136.302.7.2.1.el8uek.aarch64</span></strong><span class="koboSpan" id="kobo.328.1">, but the effective kernel that has been Kspliced is a newer kernel at version </span><strong class="source-inline"><span class="koboSpan" id="kobo.329.1">5.4.17-2136.306.1.3.el8uek</span></strong><span class="koboSpan" id="kobo.330.1">. </span><span class="koboSpan" id="kobo.330.2">This is normal behavior </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">with Ksplice.</span></span></p>
<p><span class="koboSpan" id="kobo.332.1">User space libraries can be patched in the same way, replacing the kernel with the user. </span><span class="koboSpan" id="kobo.332.2">As a note, if the Ksplice user </span><a id="_idIndexMarker657"/><span class="koboSpan" id="kobo.333.1">space libraries are </span><em class="italic"><span class="koboSpan" id="kobo.334.1">not</span></em><span class="koboSpan" id="kobo.335.1"> installed, the first time the command is run, you will be prompted to upgrade the user libraries to a </span><span class="No-Break"><span class="koboSpan" id="kobo.336.1">Ksplice-compatible version:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer192">
<span class="koboSpan" id="kobo.337.1"><img alt="Figure 7.10 – Installing Ksplice user libraries for the first time" src="image/B18349_07_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.338.1">Figure 7.10 – Installing Ksplice user libraries for the first time</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.339.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.340.1">You can also check user space available packages to Ksplice with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.341.1">ksplice user show --available</span></strong><span class="koboSpan" id="kobo.342.1"> command but if you did not install the Ksplice-aware packages, you will get </span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">this error:</span></span><a id="_idTextAnchor198"/></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.344.1">No active user-space </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">Ksplice targets</span></strong></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.346.1">Have you installed Ksplice-aware libraries </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.347.1">and rebooted?</span></strong></span></p>
<p><span class="koboSpan" id="kobo.348.1">You can also check what user space targets are currently running and can be patched. </span><span class="koboSpan" id="kobo.348.2">This is done with the </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.350.1">
ksplice all list-targets</span></pre> <p><span class="koboSpan" id="kobo.351.1">The sample output is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.352.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer193">
<span class="koboSpan" id="kobo.353.1"><img alt="Figure 7.11 – Ksplice targets" src="image/B18349_07_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.354.1">Figure 7.11 – Ksplice targets</span></p>
<p><span class="koboSpan" id="kobo.355.1">The Ksplice</span><a id="_idIndexMarker658"/><span class="koboSpan" id="kobo.356.1"> command can also be used to roll back a splice. </span><span class="koboSpan" id="kobo.356.2">By using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.357.1">ksplice kernel show</span></strong><span class="koboSpan" id="kobo.358.1"> command, you can see all the splices </span><span class="No-Break"><span class="koboSpan" id="kobo.359.1">currently installed:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer194">
<span class="koboSpan" id="kobo.360.1"><img alt="Figure 7.12 – Installed kernel patches" src="image/B18349_07_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.361.1">Figure 7.12 – Installed kernel patches</span></p>
<p><span class="koboSpan" id="kobo.362.1">Each Ksplice patch has a</span><a id="_idIndexMarker659"/><span class="koboSpan" id="kobo.363.1"> unique </span><strong class="bold"><span class="koboSpan" id="kobo.364.1">Ksplice identifier</span></strong><span class="koboSpan" id="kobo.365.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.366.1">KID</span></strong><span class="koboSpan" id="kobo.367.1">). </span><span class="koboSpan" id="kobo.367.2">The KID is also unique to the specific kernel build and patch, so when comparing KIDs across different kernels, be careful. </span><span class="koboSpan" id="kobo.367.3">If using automation to leverage the KID, make sure that you limit the automation to systems with the same kernel build </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">and architecture.</span></span></p>
<p><span class="koboSpan" id="kobo.369.1">This is the first </span><a id="_idIndexMarker660"/><span class="koboSpan" id="kobo.370.1">column in the list of installed patches. </span><span class="koboSpan" id="kobo.370.2">If you need to uninstall a specific patch, it is possible. </span><span class="koboSpan" id="kobo.370.3">In this example, KID </span><strong class="source-inline"><span class="koboSpan" id="kobo.371.1">qd1g4vxd</span></strong><span class="koboSpan" id="kobo.372.1"> (CVE-2021-4149: denial-of-service in the BTRFS filesystem) will be uninstalled using the Ksplice </span><strong class="source-inline"><span class="koboSpan" id="kobo.373.1">undo</span></strong><span class="koboSpan" id="kobo.374.1"> command, passing the specific KID. </span><span class="koboSpan" id="kobo.374.2">You can also pass </span><strong class="source-inline"><span class="koboSpan" id="kobo.375.1">-v</span></strong><span class="koboSpan" id="kobo.376.1"> for verbose. </span><span class="koboSpan" id="kobo.376.2">Once uninstalled, check the list of installed KIDs to verify the removal of the </span><span class="No-Break"><span class="koboSpan" id="kobo.377.1">single KID:</span></span></p>
<p class="IMG---Figure"><a id="_idTextAnchor199"/></p>
<div>
<div class="IMG---Figure" id="_idContainer195">
<span class="koboSpan" id="kobo.378.1"><img alt="Figure 7.13 – Ksplice undo" src="image/B18349_07_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.379.1">Figure 7.13 – Ksplice undo</span></p>
<p><span class="koboSpan" id="kobo.380.1">Optionally, all installed KIDs</span><a id="_idIndexMarker661"/><span class="koboSpan" id="kobo.381.1"> can be removed from a running system by using the </span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">following </span></span><span class="No-Break"><a id="_idIndexMarker662"/></span><span class="No-Break"><span class="koboSpan" id="kobo.383.1">command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.384.1">
ksplice kernel remove --all</span></pre> <p><span class="koboSpan" id="kobo.385.1">This will remove all the KIDs from the running kernel </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">in memory:</span></span><a id="_idTextAnchor200"/></p>
<div>
<div class="IMG---Figure" id="_idContainer196">
<span class="koboSpan" id="kobo.387.1"><img alt="Figure 7.14 – Ksplice remove" src="image/B18349_07_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.388.1">Figure 7.14 – Ksplice remove</span></p>
<p><span class="koboSpan" id="kobo.389.1">Ksplice also allows for </span><a id="_idIndexMarker663"/><span class="koboSpan" id="kobo.390.1">automatic updates. </span><span class="koboSpan" id="kobo.390.2">They can be enabled or disabled by simply touching a file, or </span><a id="_idIndexMarker664"/><span class="koboSpan" id="kobo.391.1">removing a file. </span><span class="koboSpan" id="kobo.391.2">If the </span><strong class="source-inline"><span class="koboSpan" id="kobo.392.1">/etc/uptrack/disable</span></strong><span class="koboSpan" id="kobo.393.1"> file exists, Ksplice will not automatically update the system when you reboot. </span><span class="koboSpan" id="kobo.393.2">If the file is not there, then Ksplice will check on reboot for any new KIDs and apply them. </span><span class="koboSpan" id="kobo.393.3">You can also modify this behavior by updating the </span><strong class="source-inline"><span class="koboSpan" id="kobo.394.1">uptrack.conf</span></strong><span class="koboSpan" id="kobo.395.1"> file. </span><span class="koboSpan" id="kobo.395.2">This is covered later in </span><span class="No-Break"><span class="koboSpan" id="kobo.396.1">this chapter.</span></span></p>
<h2 id="_idParaDest-161"><a id="_idTextAnchor201"/><span class="koboSpan" id="kobo.397.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.398.1">When you are using Ksplice with internet access, the Ksplice client connects to the Oracle ULN Ksplice system, and downloads and applies the </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">required splices.</span></span></p>
<h1 id="_idParaDest-162"><a id="_idTextAnchor202"/><span class="koboSpan" id="kobo.400.1">Using Ksplice with no internet access</span></h1>
<p><span class="koboSpan" id="kobo.401.1">Not all systems have</span><a id="_idIndexMarker665"/><span class="koboSpan" id="kobo.402.1"> internet access. </span><span class="koboSpan" id="kobo.402.2">That is fine, as it’s possible to use Ksplice against a local </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">patch repository.</span></span></p>
<h2 id="_idParaDest-163"><a id="_idTextAnchor203"/><span class="koboSpan" id="kobo.404.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.405.1">To do this, you will need a test system running Oracle Linux 8, with access to a local YUM repository on </span><span class="No-Break"><span class="koboSpan" id="kobo.406.1">the network.</span></span></p>
<h2 id="_idParaDest-164"><a id="_idTextAnchor204"/><span class="koboSpan" id="kobo.407.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.408.1">To install the client, make sure that your server is using an RPM repo that is mirrored locally. </span><span class="koboSpan" id="kobo.408.2">To install Ksplice, you must decide on either the online or offline client. </span><span class="koboSpan" id="kobo.408.3">As a reminder, the online client requires that the system be registered with ULN, and the offline client will use a local </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">RPM repository.</span></span></p>
<p><span class="koboSpan" id="kobo.410.1">To install the online client, run the </span><span class="No-Break"><span class="koboSpan" id="kobo.411.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.412.1">
dnf install -y ksplice uptrack</span></pre> <p><span class="koboSpan" id="kobo.413.1">To install the offline client, run the </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.415.1">
dnf install -y ksplice ksplice-offline uptrack-offline</span></pre> <p><span class="koboSpan" id="kobo.416.1">The output from this command is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.417.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer197">
<span class="koboSpan" id="kobo.418.1"><img alt="Figure 7.15 – Offline Ksplice installation" src="image/B18349_07_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.419.1">Figure 7.15 – Offline Ksplice installation</span></p>
<p><span class="koboSpan" id="kobo.420.1">Once Ksplice is installed, you</span><a id="_idIndexMarker666"/><span class="koboSpan" id="kobo.421.1"> can now splice </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">the server.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.423.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.424.1">Since the Uptrack client has no advantages over the new client with Oracle Linux 8 (or Oracle Linux 7 for that matter), we will focus on the Enhanced client. </span><span class="koboSpan" id="kobo.424.2">If you are using an older operating system, you may need to use the older </span><span class="No-Break"><span class="koboSpan" id="kobo.425.1">Uptrack client.</span></span></p>
<p><span class="koboSpan" id="kobo.426.1">Ksplice with the offline method is really easy; simply use </span><strong class="source-inline"><span class="koboSpan" id="kobo.427.1">dnf</span></strong><span class="koboSpan" id="kobo.428.1"> to patch </span><span class="No-Break"><span class="koboSpan" id="kobo.429.1">the system:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.430.1">
dnf -y update</span></pre> <p><span class="koboSpan" id="kobo.431.1">This will patch in both the</span><a id="_idIndexMarker667"/><span class="koboSpan" id="kobo.432.1"> normal way and then with Ksplice for the kernel and user libraries. </span><span class="koboSpan" id="kobo.432.2">If you want to disable this behavior, you can set </span><strong class="source-inline"><span class="koboSpan" id="kobo.433.1">skip_apply_after_pkg_install</span></strong><span class="koboSpan" id="kobo.434.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.435.1">true</span></strong><span class="koboSpan" id="kobo.436.1"> in </span><strong class="source-inline"><span class="koboSpan" id="kobo.437.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">etc/uptrack/uptrack.conf</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.439.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.440.1">Before you patch, make sure you have added a Ksplice entry in </span><strong class="source-inline"><span class="koboSpan" id="kobo.441.1">/etc/yum.repos.d</span></strong><span class="koboSpan" id="kobo.442.1">. </span><span class="koboSpan" id="kobo.442.2">A sample Ksplice entry may look like </span><span class="No-Break"><span class="koboSpan" id="kobo.443.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.444.1">
[root@ol8 ~]# more /etc/yum.repos.d/Ksplice.repo
[Ksplice_ol8_local]
name=Ksplice for OL8
baseurl=http://yum.m57.local/yum/OracleLinux/OL8/Ksplice/x86_64/ol8_x86_64_Ksplice/
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY
gpgcheck=1
enabled=1
[Ksplice_ol8_userspace]
name=Ksplice OL8 userspace
baseurl=http://yum.m57.local/yum/OracleLinux/OL8/userspace/Ksplice/x86_64/ol8_x86_64_userspace_Ksplice/
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY
gpgcheck=1
enabled=1</span></pre> <h2 id="_idParaDest-165"><a id="_idTextAnchor205"/><span class="koboSpan" id="kobo.445.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.446.1">Ksplice is a tool that allows Linux systems to stay current with security fixes and vital updates without requiring system reboots. </span><span class="koboSpan" id="kobo.446.2">This is especially beneficial for servers and settings that need to stay up </span><a id="_idIndexMarker668"/><span class="koboSpan" id="kobo.447.1">and running with little downtime. </span><span class="koboSpan" id="kobo.447.2">It’s worth noting that while Ksplice can handle many patches, some changes may be too intricate to apply in a live environment and will require a traditional </span><span class="No-Break"><span class="koboSpan" id="kobo.448.1">reboot-based update.</span></span></p>
<h1 id="_idParaDest-166"><a id="_idTextAnchor206"/><span class="koboSpan" id="kobo.449.1">Installing and enabling Known Exploit Detection</span></h1>
<p><span class="koboSpan" id="kobo.450.1">One of the most critical things to do to secure your system (and, more importantly, the data in the system) is to implement the ability to detect when the bad guys are trying to break in. </span><span class="koboSpan" id="kobo.450.2">Ksplice has a unique feature</span><a id="_idIndexMarker669"/><span class="koboSpan" id="kobo.451.1"> called </span><strong class="bold"><span class="koboSpan" id="kobo.452.1">Known Exploit Detection</span></strong><span class="koboSpan" id="kobo.453.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.454.1">KED</span></strong><span class="koboSpan" id="kobo.455.1">) that will report on known attacks against the kernel. </span><span class="koboSpan" id="kobo.455.2">Normally, only exploits that allow the hacker to access additional privileges are instrumented for KED and, for these to trigger, the kernel should already have been spliced for </span><span class="No-Break"><span class="koboSpan" id="kobo.456.1">the vulnerability.</span></span></p>
<h2 id="_idParaDest-167"><a id="_idTextAnchor207"/><span class="koboSpan" id="kobo.457.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.458.1">To do this, you will need a test system running Oracle Linux 8, with Ksplice </span><span class="No-Break"><span class="koboSpan" id="kobo.459.1">set up.</span></span></p>
<h2 id="_idParaDest-168"><a id="_idTextAnchor208"/><span class="koboSpan" id="kobo.460.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.461.1">This is done via tripwire</span><a id="_idIndexMarker670"/><span class="koboSpan" id="kobo.462.1"> code, which is triggered when specific events are detected. </span><span class="koboSpan" id="kobo.462.2">Normally, only events that enable the attacker to gain privileged access are monitored. </span><span class="koboSpan" id="kobo.462.3">This package is available on both x86 and </span><span class="No-Break"><span class="koboSpan" id="kobo.463.1">ARM systems.</span></span></p>
<p><span class="koboSpan" id="kobo.464.1">To enable this, the pack must first be installed by using the </span><span class="No-Break"><span class="koboSpan" id="kobo.465.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.466.1">
dnf install -y ksplice-known-exploit-detection</span></pre> <p><span class="koboSpan" id="kobo.467.1">Regardless of whether the installation is on an ARM or x64 server, the installation is almost identical, with the major differences being more about the software already installed on each system. </span><span class="koboSpan" id="kobo.467.2">This brings a point to mind: regardless of whether ARM or x64, the admin tasks are </span><span class="No-Break"><span class="koboSpan" id="kobo.468.1">the same.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.469.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.470.1">When KED is installed, </span><strong class="source-inline"><span class="koboSpan" id="kobo.471.1">postfix</span></strong><span class="koboSpan" id="kobo.472.1"> is also installed to enable sending emails as part of the </span><span class="No-Break"><span class="koboSpan" id="kobo.473.1">notification system.</span></span></p>
<p><span class="koboSpan" id="kobo.474.1">The output from installing </span><a id="_idIndexMarker671"/><span class="koboSpan" id="kobo.475.1">this on an ARM-based system is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.476.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer198">
<span class="koboSpan" id="kobo.477.1"><img alt="Figure 7.16 – KED installation on ARM" src="image/B18349_07_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.478.1">Figure 7.16 – KED installation on ARM</span></p>
<p><span class="koboSpan" id="kobo.479.1">The output from installing this on an x86_64-based system is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer199">
<span class="koboSpan" id="kobo.481.1"><img alt="Figure 7.17 – KED installation on x64" src="image/B18349_07_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.482.1">Figure 7.17 – KED installation on x64</span></p>
<p><span class="koboSpan" id="kobo.483.1">Once KED is installed, the</span><a id="_idIndexMarker672"/><span class="koboSpan" id="kobo.484.1"> feature needs to be enabled. </span><span class="koboSpan" id="kobo.484.2">This is done by adding the following lines to </span><strong class="source-inline"><span class="koboSpan" id="kobo.485.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.486.1">etc/uptrack/uptrack.conf</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.487.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.488.1">
[Known-Exploit-Detection]
enabled = yes</span></pre> <p><span class="koboSpan" id="kobo.489.1">Next, you will need to Ksplice the kernel to enable the feature in the </span><span class="No-Break"><span class="koboSpan" id="kobo.490.1">running kernel:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.491.1">
ksplice --yes  kernel upgrade</span></pre> <p><span class="koboSpan" id="kobo.492.1">The output for this is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.493.1">following scree</span><a id="_idTextAnchor209"/><span class="koboSpan" id="kobo.494.1">nsho</span><a id="_idTextAnchor210"/><span class="koboSpan" id="kobo.495.1">t:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer200">
<span class="koboSpan" id="kobo.496.1"><img alt="Figure 7.18 – Enabling KED in a running kernel" src="image/B18349_07_18.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.497.1">Figure 7.18 – Enabling KED in a running kernel</span></p>
<p><span class="koboSpan" id="kobo.498.1">As a note, if no Ksplice patches are available, you will get a notification that the kernel is up to date, as shown in the preceding</span><a id="_idIndexMarker673"/><span class="koboSpan" id="kobo.499.1"> screenshot. </span><span class="koboSpan" id="kobo.499.2">But if the system requires patches, Ksplice will patch the kernel at this time while </span><span class="No-Break"><span class="koboSpan" id="kobo.500.1">enabling KED.</span></span></p>
<p><span class="koboSpan" id="kobo.501.1">To verify that KED is enabled, </span><strong class="source-inline"><span class="koboSpan" id="kobo.502.1">cat /proc/sys/kernel/known_exploit_detection</span></strong><span class="koboSpan" id="kobo.503.1"> and look for an output of </span><strong class="source-inline"><span class="koboSpan" id="kobo.504.1">1</span></strong><span class="koboSpan" id="kobo.505.1">. </span><span class="koboSpan" id="kobo.505.2">If the file is missing or there is a zero there, KED is not enabled so won’t be monitoring </span><span class="No-Break"><span class="koboSpan" id="kobo.506.1">your system:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer201">
<span class="koboSpan" id="kobo.507.1"><img alt="Figure 7.19 – Checking whether KED is enabled" src="image/B18349_07_19.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.508.1">Figure 7.19 – Checking whether KED is enabled</span></p>
<p><span class="koboSpan" id="kobo.509.1">Notifications from KED are controlled from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">/etc/log-known-exploit.conf</span></strong><span class="koboSpan" id="kobo.511.1"> configuration file. </span><span class="koboSpan" id="kobo.511.2">A sample configuration file is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.512.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer202">
<span class="koboSpan" id="kobo.513.1"><img alt="Figure 7.20 – KED notifications configuration" src="image/B18349_07_20.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.514.1">Figure 7.20 – KED notifications configuration</span></p>
<p><span class="koboSpan" id="kobo.515.1">In the config file, you can control the </span><span class="No-Break"><span class="koboSpan" id="kobo.516.1">following actions:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.517.1">[syslog]</span></strong><span class="koboSpan" id="kobo.518.1">: Most</span><a id="_idIndexMarker674"/><span class="koboSpan" id="kobo.519.1"> admins log events to syslog for capture and analysis using log analytics tools such as OCI Log Analytics or Splunk. </span><span class="koboSpan" id="kobo.519.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.520.1">enabled: 0</span></strong><span class="koboSpan" id="kobo.521.1"> setting will disable logging </span><span class="No-Break"><span class="koboSpan" id="kobo.522.1">to syslog.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">[email]</span></strong><span class="koboSpan" id="kobo.524.1">: This section allows you to enable emails to be sent when a tripwire is triggered. </span><span class="koboSpan" id="kobo.524.2">Add email addresses for recipients as needed. </span><span class="koboSpan" id="kobo.524.3">This will also require that the system can send emails, either</span><a id="_idIndexMarker675"/><span class="koboSpan" id="kobo.525.1"> through a cloud service such as the OCI Email Delivery Service or your own </span><strong class="bold"><span class="koboSpan" id="kobo.526.1">Simple Mail Transport Protocol</span></strong><span class="koboSpan" id="kobo.527.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.528.1">SMTP</span></strong><span class="koboSpan" id="kobo.529.1">)  </span><span class="No-Break"><span class="koboSpan" id="kobo.530.1">relay.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">[actions]</span></strong><span class="koboSpan" id="kobo.532.1">: You can specifically disable notifications for a specific CVE. </span><span class="koboSpan" id="kobo.532.2">This is helpful if you have an accidental false positive on a system. </span><span class="koboSpan" id="kobo.532.3">To disable a CVE, add a line with the CVE and </span><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">ignore</span></strong><span class="koboSpan" id="kobo.534.1">. </span><span class="koboSpan" id="kobo.534.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.535.1">default:</span></strong><span class="koboSpan" id="kobo.536.1"> parameter sets the default behavior for </span><span class="No-Break"><span class="koboSpan" id="kobo.537.1">all CVE.</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.538.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.539.1">If you enable email notification, make sure your email subsystem is configured before enabling emails </span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">from KED.</span></span></p>
<p><span class="koboSpan" id="kobo.541.1">You can also test the system with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.542.1">log-known-exploit</span></strong><span class="koboSpan" id="kobo.543.1"> command. </span><span class="koboSpan" id="kobo.543.2">This will log a test message in </span><span class="No-Break"><span class="koboSpan" id="kobo.544.1">the kernel:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.545.1">
/usr/sbin/log-known-exploit -f -d ; tail /var/log/messages</span></pre> <p><span class="koboSpan" id="kobo.546.1">The test event will look like the </span><a id="_idIndexMarker676"/><span class="koboSpan" id="kobo.547.1">following </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.549.1">/var/log/messages</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.550.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.551.1">
Apr 22 23:01:02 ol8splice2 /log-known-exploit[4192]: exploit attempt detected; id=CVE-2012-1234 pid=1337 uid=1000 comm=./dummy-exploit lost=0</span></pre> <p><span class="koboSpan" id="kobo.552.1">In the log, you will see the time, the CVE that was triggered, and </span><a id="_idIndexMarker677"/><span class="koboSpan" id="kobo.553.1">also the </span><strong class="bold"><span class="koboSpan" id="kobo.554.1">Process ID </span></strong><span class="koboSpan" id="kobo.555.1">(</span><strong class="bold"><span class="koboSpan" id="kobo.556.1">PID</span></strong><span class="koboSpan" id="kobo.557.1">) and </span><strong class="bold"><span class="koboSpan" id="kobo.558.1">User ID</span></strong><span class="koboSpan" id="kobo.559.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.560.1">UID</span></strong><span class="koboSpan" id="kobo.561.1">) of the process and user that triggered</span><a id="_idIndexMarker678"/> <span class="No-Break"><span class="koboSpan" id="kobo.562.1">the event.</span></span></p>
<h2 id="_idParaDest-169"><a id="_idTextAnchor211"/><span class="koboSpan" id="kobo.563.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.564.1">Ksplice installs a piece of tripwire code in the kernel for specific exploits, detecting when something tries to exploit the exploit. </span><span class="koboSpan" id="kobo.564.2">These triggers then kick off the notification subsystem, letting you know when an </span><span class="No-Break"><span class="koboSpan" id="kobo.565.1">attack happens.</span></span></p>
</div>
</body></html>