<html><head></head><body>
<div id="_idContainer146">
<h1 class="chapter-number" id="_idParaDest-112"><a id="_idTextAnchor140"/><span class="koboSpan" id="kobo.1.1">11</span></h1>
<h1 id="_idParaDest-113"><a id="_idTextAnchor141"/><span class="koboSpan" id="kobo.2.1">Exploring External Layers</span></h1>
<p><span class="koboSpan" id="kobo.3.1">One of the most charming features of Poky is the flexibility of using external layers. </span><span class="koboSpan" id="kobo.3.2">In this chapter, we will examine why this is a vital capability and how we can take advantage of it. </span><span class="koboSpan" id="kobo.3.3">We will also look at the different types of layers and their directory trees layout. </span><span class="koboSpan" id="kobo.3.4">Finally, at the end of this chapter, we will learn to include a new layer in </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">our project.</span></span></p>
<h1 id="_idParaDest-114"><a id="_idTextAnchor142"/><span class="koboSpan" id="kobo.5.1">Powering flexibility with layers</span></h1>
<p><span class="koboSpan" id="kobo.6.1">Poky</span><a id="_idIndexMarker341"/><span class="koboSpan" id="kobo.7.1"> contains metadata spread over configuration definition files such as machine and distro files, classes, and recipes, covering everything from simple applications to full graphical stacks and frameworks. </span><span class="koboSpan" id="kobo.7.2">There are multiple places that BitBake can load metadata collection from, which are known as </span><a id="_idIndexMarker342"/><span class="No-Break"><span class="koboSpan" id="kobo.8.1">metadata layers.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">The biggest strength of using layers is the ability to split metadata into logical units, which enables users to pick only the metadata collection needed for </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">a project.</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">Using </span><a id="_idIndexMarker343"/><span class="koboSpan" id="kobo.12.1">metadata layers enables us to do </span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.14.1">Improve </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">code reuse</span></span></li>
<li><span class="koboSpan" id="kobo.16.1">Share and scale work across different teams, communities, </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">and vendors</span></span></li>
<li><span class="koboSpan" id="kobo.18.1">Increase the Yocto Project community’s code quality, as multiple developers and users focus together on a particular metadata layer that is of interest </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">to them</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.20.1">We can configure the system for different reasons, such as the need to enable/disable a feature or change build flags to enable architecture-specific optimizations. </span><span class="koboSpan" id="kobo.20.2">These are examples of customizations that can be done </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">using layers.</span></span></p>
<p><span class="koboSpan" id="kobo.22.1">In addition, we should organize metadata in different layers instead of creating our custom project environment, changing recipes, and modifying files in the Poky layer. </span><span class="koboSpan" id="kobo.22.2">The more separated an organization is, the easier it is to reuse the layers in future projects, as the Poky source code is split into different layers as well. </span><span class="koboSpan" id="kobo.22.3">It contains three layers by default, as we can see in the output of the following </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">command line:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer137">
<span class="koboSpan" id="kobo.24.1"><img alt="Figure 11.1 – The result of bitbake-layers show-layers" src="image/Figure_11.1_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.25.1">Figure 11.1 – The result of bitbake-layers show-layers</span></p>
<p><span class="koboSpan" id="kobo.26.1">The</span><a id="_idIndexMarker344"/><span class="koboSpan" id="kobo.27.1"> command-line output shows the following three essential properties of </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">any layer:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.29.1">Name</span></strong><span class="koboSpan" id="kobo.30.1">: This </span><a id="_idIndexMarker345"/><span class="koboSpan" id="kobo.31.1">usually starts with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.32.1">meta</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.33.1"> string.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.34.1">Path</span></strong><span class="koboSpan" id="kobo.35.1">: This is important when we want to add a layer in our project that is appended to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.36.1">BBPATH</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.37.1"> variable.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.38.1">Priority</span></strong><span class="koboSpan" id="kobo.39.1">: This is the value used by BitBake to decide which recipe to use and the order in which the </span><strong class="source-inline"><span class="koboSpan" id="kobo.40.1">.bbappend</span></strong><span class="koboSpan" id="kobo.41.1"> files should be concatenated. </span><span class="koboSpan" id="kobo.41.2">It means that if two layers include the same recipe file (</span><strong class="source-inline"><span class="koboSpan" id="kobo.42.1">.bb</span></strong><span class="koboSpan" id="kobo.43.1">), the one with the highest priority is used. </span><span class="koboSpan" id="kobo.43.2">In the case of </span><strong class="source-inline"><span class="koboSpan" id="kobo.44.1">.bbappend</span></strong><span class="koboSpan" id="kobo.45.1">, every </span><strong class="source-inline"><span class="koboSpan" id="kobo.46.1">.bbappend</span></strong><span class="koboSpan" id="kobo.47.1"> file is included in the original recipe. </span><span class="koboSpan" id="kobo.47.2">The layer priority determines the order of inclusion, so the </span><strong class="source-inline"><span class="koboSpan" id="kobo.48.1">.bbappend</span></strong><span class="koboSpan" id="kobo.49.1"> files within the highest priority layers are appended first, followed by </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">the others.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.51.1">Taking Poky as an example, it has three central individual layers. </span><span class="koboSpan" id="kobo.51.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.52.1">meta-yocto-bsp</span></strong><span class="koboSpan" id="kobo.53.1"> layer</span><a id="_idIndexMarker346"/><span class="koboSpan" id="kobo.54.1"> is the </span><a id="_idIndexMarker347"/><span class="koboSpan" id="kobo.55.1">Poky reference </span><strong class="bold"><span class="koboSpan" id="kobo.56.1">Board Support Package</span></strong><span class="koboSpan" id="kobo.57.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.58.1">BSP</span></strong><span class="koboSpan" id="kobo.59.1">) layer. </span><span class="koboSpan" id="kobo.59.2">It contains machine configuration files and recipes to configure packages for the machines. </span><span class="koboSpan" id="kobo.59.3">As it is a reference BSP layer, it can be used as </span><span class="No-Break"><span class="koboSpan" id="kobo.60.1">an example.</span></span></p>
<p><span class="koboSpan" id="kobo.61.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.62.1">meta-poky</span></strong><span class="koboSpan" id="kobo.63.1"> layer</span><a id="_idIndexMarker348"/><span class="koboSpan" id="kobo.64.1"> is the Poky reference distribution layer. </span><span class="koboSpan" id="kobo.64.2">It contains a distribution configuration used in Yocto Project by default. </span><span class="koboSpan" id="kobo.64.3">This default distribution is described in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.65.1">poky.conf</span></strong><span class="koboSpan" id="kobo.66.1"> file, and it is widely used for testing products. </span><span class="koboSpan" id="kobo.66.2">It can be used as a starting point when designing your </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">own distribution.</span></span></p>
<p><span class="koboSpan" id="kobo.68.1">Another</span><a id="_idIndexMarker349"/><span class="koboSpan" id="kobo.69.1"> kind of layer is the software layer, which includes only applications or configuration files for applications and can be used on any architecture. </span><span class="koboSpan" id="kobo.69.2">There is a massive list of software layers. </span><span class="koboSpan" id="kobo.69.3">To name only a few, we have </span><strong class="source-inline"><span class="koboSpan" id="kobo.70.1">meta-java</span></strong><span class="koboSpan" id="kobo.71.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.72.1">meta-qt5</span></strong><span class="koboSpan" id="kobo.73.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.74.1">meta-browser</span></strong><span class="koboSpan" id="kobo.75.1">. </span><span class="koboSpan" id="kobo.75.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.76.1">meta-java</span></strong><span class="koboSpan" id="kobo.77.1"> layer</span><a id="_idIndexMarker350"/><span class="koboSpan" id="kobo.78.1"> provides Java </span><a id="_idIndexMarker351"/><span class="koboSpan" id="kobo.79.1">runtime and SDK support, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.80.1">meta-qt5</span></strong><span class="koboSpan" id="kobo.81.1"> layer includes Qt5 support, and</span><a id="_idIndexMarker352"/> <strong class="source-inline"><span class="koboSpan" id="kobo.82.1">meta-browser</span></strong><span class="koboSpan" id="kobo.83.1"> supports web browsers such as Firefox </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">and Chrome.</span></span></p>
<p><span class="koboSpan" id="kobo.85.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.86.1">meta</span></strong><span class="koboSpan" id="kobo.87.1"> layer is the </span><a id="_idIndexMarker353"/><span class="koboSpan" id="kobo.88.1">OpenEmbedded Core metadata, which contains the recipes, classes, and the QEMU machine configuration files. </span><span class="koboSpan" id="kobo.88.2">It can be considered a mixed layer type, as it has software collection, BSP definition, and the distribution used by Yocto Project as </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">the baseline.</span></span></p>
<p><span class="koboSpan" id="kobo.90.1">Sometimes, your product may have special requirements, and changes in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.91.1">build/conf/local.conf</span></strong><span class="koboSpan" id="kobo.92.1"> file will need to be made as required. </span><span class="koboSpan" id="kobo.92.2">The most adequate and maintainable solution is to create a distribution layer to place the distribution </span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">definition file.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.94.1">Tip</span></p>
<p class="callout"><span class="koboSpan" id="kobo.95.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">build/conf/local.conf</span></strong><span class="koboSpan" id="kobo.97.1"> file is a volatile file that is not supposed to be tracked </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">by Git.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.99.1">We should not rely on it to set package versions, providers, and the system features for products but use it instead just as a shortcut for testing purposes </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">during development.</span></span></p>
<p><span class="koboSpan" id="kobo.101.1">Avoiding </span><a id="_idIndexMarker354"/><span class="koboSpan" id="kobo.102.1">adding custom settings in </span><strong class="source-inline"><span class="koboSpan" id="kobo.103.1">build/conf/local.conf</span></strong><span class="koboSpan" id="kobo.104.1"> helps to make our builds </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">reproducible afterward.</span></span></p>
<h1 id="_idParaDest-115"><a id="_idTextAnchor143"/><span class="koboSpan" id="kobo.106.1">Detailing a layer’s source code</span></h1>
<p><span class="koboSpan" id="kobo.107.1">Usually, a layer has a </span><a id="_idIndexMarker355"/><span class="koboSpan" id="kobo.108.1">directory tree, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer138">
<span class="koboSpan" id="kobo.110.1"><img alt="Figure 11.2 – The standard layer layout" src="image/Figure_11.2_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.111.1">Figure 11.2 – The standard layer layout</span></p>
<p><span class="koboSpan" id="kobo.112.1">Inside this</span><a id="_idIndexMarker356"/><span class="koboSpan" id="kobo.113.1"> directory are two files, </span><strong class="source-inline"><span class="koboSpan" id="kobo.114.1">&lt;layer&gt;/COPYING</span></strong><span class="koboSpan" id="kobo.115.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.116.1">&lt;layer&gt;/README</span></strong><span class="koboSpan" id="kobo.117.1">, a license and a message to a user respectively. </span><span class="koboSpan" id="kobo.117.2">In </span><strong class="source-inline"><span class="koboSpan" id="kobo.118.1">&lt;layer&gt;/README</span></strong><span class="koboSpan" id="kobo.119.1">, we must specify any other dependency and information that the layer’s users need to know. </span><span class="koboSpan" id="kobo.119.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.120.1">meta-</span></strong><span class="koboSpan" id="kobo.121.1"> prefix for the layer is not a requirement but a commonly used </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">naming convention.</span></span></p>
<p><span class="koboSpan" id="kobo.123.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">classes</span></strong><span class="koboSpan" id="kobo.125.1"> folder should hold the classes specific to that layer (the </span><strong class="source-inline"><span class="koboSpan" id="kobo.126.1">.bbclass</span></strong><span class="koboSpan" id="kobo.127.1"> files). </span><span class="koboSpan" id="kobo.127.2">It is an </span><span class="No-Break"><span class="koboSpan" id="kobo.128.1">optional directory.</span></span></p>
<p><span class="koboSpan" id="kobo.129.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.130.1">&lt;layer&gt;/conf</span></strong><span class="koboSpan" id="kobo.131.1"> folder is mandatory and should provide the configuration files (the </span><strong class="source-inline"><span class="koboSpan" id="kobo.132.1">.conf</span></strong><span class="koboSpan" id="kobo.133.1"> files). </span><span class="koboSpan" id="kobo.133.2">The layer configuration file, </span><strong class="source-inline"><span class="koboSpan" id="kobo.134.1">&lt;layer&gt;/conf/layer.conf</span></strong><span class="koboSpan" id="kobo.135.1">, which will be covered in detail in the next chapter, is the file with the </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">layer definition.</span></span></p>
<p><span class="koboSpan" id="kobo.137.1">An example of the directory layout of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.138.1">&lt;layer&gt;/conf</span></strong><span class="koboSpan" id="kobo.139.1"> folder is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.140.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.141.1">.2</span></em><span class="koboSpan" id="kobo.142.1">, where </span><strong class="bold"><span class="koboSpan" id="kobo.143.1">(a)</span></strong><span class="koboSpan" id="kobo.144.1"> shows the structure for a BSP layer and </span><strong class="bold"><span class="koboSpan" id="kobo.145.1">(b)</span></strong><span class="koboSpan" id="kobo.146.1"> shows the structure for a </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">distribution layer:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer139">
<span class="koboSpan" id="kobo.148.1"><img alt="Figure 11.3 – The &lt;layer&gt;/conf layout for BSP and distribution layers" src="image/Figure_11.3_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.149.1">Figure 11.3 – The &lt;layer&gt;/conf layout for BSP and distribution layers</span></p>
<p><span class="koboSpan" id="kobo.150.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">recipe-*</span></strong><span class="koboSpan" id="kobo.152.1"> folder</span><a id="_idIndexMarker357"/><span class="koboSpan" id="kobo.153.1"> is a cluster of recipes separated by category – for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.154.1">recipes-core</span></strong><span class="koboSpan" id="kobo.155.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.156.1">recipes-bsp</span></strong><span class="koboSpan" id="kobo.157.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.158.1">recipes-graphic</span></strong><span class="koboSpan" id="kobo.159.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.160.1">recipes-multimedia</span></strong><span class="koboSpan" id="kobo.161.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.162.1">recipes-kernel</span></strong><span class="koboSpan" id="kobo.163.1">. </span><span class="koboSpan" id="kobo.163.2">Inside each folder, starting with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.164.1">recipes-</span></strong><span class="koboSpan" id="kobo.165.1"> prefix, there is a directory with the recipe name or a group of recipes. </span><span class="koboSpan" id="kobo.165.2">Inside it, the recipe files are placed, whose names end with </span><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">.bb</span></strong><span class="koboSpan" id="kobo.167.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">.bbappend</span></strong><span class="koboSpan" id="kobo.169.1">. </span><span class="koboSpan" id="kobo.169.2">For example, we can find the following screenshot from </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">meta</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.171.1"> layer:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer140">
<span class="koboSpan" id="kobo.172.1"><img alt="Figure 11.4 – An example of the recipes-* layout" src="image/Figure_11.4_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.173.1">Figure 11.4 – An example of the recipes-* layout</span></p>
<h1 id="_idParaDest-116"><a id="_idTextAnchor144"/><span class="koboSpan" id="kobo.174.1">Adding meta layers</span></h1>
<p><span class="koboSpan" id="kobo.175.1">We can find the most of </span><a id="_idIndexMarker358"/><span class="koboSpan" id="kobo.176.1">available meta layers at </span><a href="http://layers.openembedded.org"><span class="koboSpan" id="kobo.177.1">http://layers.openembedded.org</span></a><span class="koboSpan" id="kobo.178.1">. </span><span class="koboSpan" id="kobo.178.2">There are hundreds of meta layers from the Yocto Project, OpenEmbedded, communities, and companies that can be manually cloned inside the project </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">source directory.</span></span></p>
<p><span class="koboSpan" id="kobo.180.1">To include, for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.181.1">meta-oe</span></strong><span class="koboSpan" id="kobo.182.1"> (one of the several meta layers inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.183.1">meta-openembedded</span></strong><span class="koboSpan" id="kobo.184.1"> repository) in our project, we can change the content of the configuration files or use BitBake command lines. </span><span class="koboSpan" id="kobo.184.2">However, we first need to fetch the layer’s source code. </span><span class="koboSpan" id="kobo.184.3">Run the following command from your Poky </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">source directory:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer141">
<span class="koboSpan" id="kobo.186.1"><img alt="Figure 11.5 – Cloning the meta-openembedded layer" src="image/Figure_11.5_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.187.1">Figure 11.5 – Cloning the meta-openembedded layer</span></p>
<p><span class="koboSpan" id="kobo.188.1">We</span><a id="_idIndexMarker359"/><span class="koboSpan" id="kobo.189.1"> need to modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.190.1">build/conf/bblayer.conf</span></strong><span class="koboSpan" id="kobo.191.1"> file to add the layer location, using its absolute path. </span><span class="koboSpan" id="kobo.191.2">See </span><strong class="bold"><span class="koboSpan" id="kobo.192.1">line 12</span></strong><span class="koboSpan" id="kobo.193.1"> in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.194.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.195.1">.6</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.196.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer142">
<span class="koboSpan" id="kobo.197.1"><img alt="Figure 11.6 – The content of build/conf/bblayers.conf after including the meta-openembedded layer" src="image/Figure_11.6_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.198.1">Figure 11.6 – The content of build/conf/bblayers.conf after including the meta-openembedded layer</span></p>
<p><span class="koboSpan" id="kobo.199.1">Alternatively, we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">bitbake-layers</span></strong><span class="koboSpan" id="kobo.201.1"> tool</span><a id="_idIndexMarker360"/><span class="koboSpan" id="kobo.202.1"> to perform the inclusion for us. </span><span class="koboSpan" id="kobo.202.2">This can be done using the following command from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.203.1">build</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.204.1"> directory:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer143">
<span class="koboSpan" id="kobo.205.1"><img alt="Figure 11.7 – The command line to add the layer location" src="image/Figure_11.7_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.206.1">Figure 11.7 – The command line to add the layer location</span></p>
<h1 id="_idParaDest-117"><a id="_idTextAnchor145"/><span class="koboSpan" id="kobo.207.1">The Yocto Project layer ecosystem</span></h1>
<p><span class="koboSpan" id="kobo.208.1">It is convenient to create a layer. </span><span class="koboSpan" id="kobo.208.2">To</span><a id="_idIndexMarker361"/><span class="koboSpan" id="kobo.209.1"> make all the available layers easier to access, the OpenEmbedded community</span><a id="_idIndexMarker362"/><span class="koboSpan" id="kobo.210.1"> has developed an index, available at http://layers.openembedded.org, where most of them can be found. </span><span class="koboSpan" id="kobo.210.2">An example of its </span><strong class="bold"><span class="koboSpan" id="kobo.211.1">Layers</span></strong><span class="koboSpan" id="kobo.212.1"> tab is shown </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer144">
<span class="koboSpan" id="kobo.214.1"><img alt="Figure 11.8 – The OpenEmbedded Layer Index for Kirkstone" src="image/Figure_11.8_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.215.1">Figure 11.8 – The OpenEmbedded Layer Index for Kirkstone</span></p>
<p><span class="koboSpan" id="kobo.216.1">Another convenient use</span><a id="_idIndexMarker363"/><span class="koboSpan" id="kobo.217.1"> case for the OpenEmbedded Layer Index website is to search for a specific software type or recipe. </span><span class="koboSpan" id="kobo.217.2">The OpenEmbedded Layer Index can save the day by allowing us to search for </span><span class="No-Break"><span class="koboSpan" id="kobo.218.1">the following:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.219.1">Machines</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.220.1">Distributions</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.221.1">Layers</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.222.1">Recipes</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.223.1">Classes</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.224.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.225.1">bitbake-layers</span></strong><span class="koboSpan" id="kobo.226.1"> tool also </span><a id="_idIndexMarker364"/><span class="koboSpan" id="kobo.227.1">supports the use of the OpenEmbedded Layer Index. </span><span class="koboSpan" id="kobo.227.2">For example, to add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">meta-oe</span></strong><span class="koboSpan" id="kobo.229.1"> layer, we can use the </span><span class="No-Break"><span class="koboSpan" id="kobo.230.1">following command:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer145">
<span class="koboSpan" id="kobo.231.1"><img alt="Figure 11.9 – Fetching a layer from the OpenEmbedded Layer index" src="image/Figure_11.9_B19361.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.232.1">Figure 11.9 – Fetching a layer from the OpenEmbedded Layer index</span></p>
<h1 id="_idParaDest-118"><a id="_idTextAnchor146"/><span class="koboSpan" id="kobo.233.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.234.1">In this chapter, we introduced the concept of layering. </span><span class="koboSpan" id="kobo.234.2">We learned about the directory structure in detail and the content in each layer type. </span><span class="koboSpan" id="kobo.234.3">In addition, we saw how to add an external layer to our project manually or by using the BitBake command line, as well as how to use the OpenEmbedded Layer index to find the available layers we </span><span class="No-Break"><span class="koboSpan" id="kobo.235.1">need easily.</span></span></p>
<p><span class="koboSpan" id="kobo.236.1">In the next chapter, we will learn more about why we need to create new layers and what the common metadata included in them is (such as machine definition files, recipes, and images). </span><span class="koboSpan" id="kobo.236.2">We will wrap it all up with an example of </span><span class="No-Break"><span class="koboSpan" id="kobo.237.1">distribution customization.</span></span></p>
</div>
<div>
<div class="IMG---Figure" id="_idContainer147">
</div>
</div>
</body></html>