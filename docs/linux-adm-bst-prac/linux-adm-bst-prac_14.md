# *第十一章*：故障排除

在系统管理中，**故障排除**是最具挑战性的任务之一，尤其是在问题出现时。故障排除即使在最理想的情况下也很困难，但作为系统管理员，我们的工作几乎总是需要排除一个系统中的问题，系统要么正在生产环境中运行并且必须在我们尝试修复某个方面时保持正常运行，要么系统已经宕机，我们必须尽快让它恢复生产环境中的运行。通常我们并没有足够的能力在不让业务因此丧失收入的情况下进行修复，即使有，这也是例外而非常态。故障排除既困难，又至关重要，还充满压力。

故障排除不仅仅是解决明显的技术问题，应用商业逻辑同样至关重要。我们必须在更大的工作负载和业务背景下理解我们的故障排除，并应用不仅仅是简单的技术知识。既有解决问题的方式，也有解决工作负载的方式，还有评估工作流需求的方式，最终的目标是保持业务的可行性。

在本章中，我们将讨论以下主题：

+   避免灾难的高成本

+   初步评估技能与员工

+   逻辑性故障排除方法

+   调查与修复

# 避免灾难的高成本

在本章中，我们将详细讨论灾难发生后该做些什么。在本书中，我们考虑了如何避免灾难的方法。一个容易被忽视的事实是，保护工作负载免受故障的过程中是有成本的，我们必须将这一点与故障本身的成本以及灾难发生的可能性进行权衡。

我们常常被告知，或者暗示灾难必须不惜一切代价避免。这是荒谬的，绝不应当如此。避免灾难是有成本的，而且这个成本可能相当高。灾难本身也会带来成本，虽然这个成本可能相当高，但并不总是如此。

我们所面临的风险是，避免灾难的成本有时会超过灾难本身的成本。曾经有一段时间，公司常常花费数万美元购买容错解决方案，以保护那些常见故障场景只会造成少部分损失的工作负载。灾难本身实际上比避免灾难的成本更低！而且灾难避免是一个确定的成本，而灾难只是一个潜在的成本。如果我们将两者视作成本进行比较，我们可以简化评估为一个简单的问题：*今天损失 50,000 美元，还是明天可能损失 10,000 美元，哪个更好？* 这样比其他方式要简单得多，并且能去除大部分情绪化反应。

我喜欢用一句话来形容在灾难避免上过度消费，那就是：今天为了避免明天可能的头痛而对自己开枪。

永远不要将灾难防范计划中的灾难视为必然发生，它并非必然发生。它只有可能发生。评估并运用数学方法。

在本章中，我们将深入探讨支持在企业中的运作方式，如何改善 IT 组织的支持姿态，了解急救需求，讨论如何找到合适的人来组成故障排除团队，然后深入讨论何时调查问题，何时解决问题。

这是我们要覆盖的一些最困难、最模糊且最终最重要的内容。

# 解决方案的来源

作为系统管理员，我们从哪里获得解决问题的方法呢？我想通过我自己的职业故事来开始这段话题，因为我认为每个人对 IT 支持在广义上的运作方式有非常不同的看法，理解这些不同的视角在我们开始定义“好的支持”是什么之前是非常重要的。

当我刚开始从事 IT 工作时，尤其是在前近二十年，大家普遍认为任何和所有问题都应由 IT 部门来解决。当然，也有一些情况需要应用厂商的补丁、更新或修复，但获取这些补丁、测试它们、应用它们等工作总是由 IT 员工全权处理。甚至认为可以请求厂商提供帮助、指导或建议的想法也显得陌生，更别提实际去做了。联系厂商寻求支持被认为是绝对的最后手段，只在认为硬件或软件中存在未知且尚未解决的缺陷时才会使用，这时将问题交给厂商修复，然后再由 IT 部门应用更新或修复（如果有的话）。

在这个时代，IT，尤其是系统管理员，预计能够全面了解系统的运作，能够解决可能出现的任何问题，坦率地说，还要弄清楚需要做什么。没有如果，没有但是，当然没有“也许”。如果你不知道一个系统如何工作或可能出现什么问题，那么你就需要依靠知识和逻辑去找出问题的根源。对系统的工作原理有透彻的理解，即使有时缺乏具体的细节，良好的逻辑通常也能让你解决问题。

直到 2000 年代末，我才首次遇到那些依赖供应商和经销商来提供某些方面支持的 IT 部门。公司和其 IT 组织（无论是内部的还是外部的，都不重要）无法安装、配置和支持的系统，这个概念对我和我多年来在行业中的大多数同事来说都是完全陌生的。如果你偶尔需要供应商的支持，为什么你不需要全天候的支持呢？如果 IT 团队不具备实施和运营他们负责的系统所需的知识，那它们的存在有什么意义？你需要更多的知识来规划和考虑所有解决方案选项，而不仅仅是修复你最终部署的那个单一方案。如果你需要供应商来处理日常任务，那显然你缺乏进行更为重要的高层决策所需的技能和经验，而这是供应商无法提供帮助的。遗憾的是，许多组织最终在解决方案规划方面完全缺乏能力，这也解释了为什么那么多明显无法满足业务需求的糟糕解决方案会被部署。

今天，似乎大家都将焦点放在了来自销售组织和供应商的支持上，而不是来自 IT 部门，但这带来了两个关键问题。首先，如果 IT 不在关键的支持路径上，它到底是做什么的呢？它们真的有必要存在吗？其次，当供应商仅仅支持他们自己生产的产品时，怎么可能具备满足内部 IT 需求的所有技能呢？这里的脱节是相当显著的。

## 并没有魔法支持

经常会有一种不言而喻的信念，通常是在管理者中间，甚至有时是 IT 人员中，也会认为有一些神奇的公司，在技术领域内可以提供类似于无限的支持，而这种支持是内部 IT 无法提供的。我猜想，大家可能以为这些公司并非由人类组成，或者认为服务器、存储和操作系统的供应商拥有一些不公开的秘密手册，里面充满了那些不公开的信息，包括秘密代码，可以让失常的系统重新开始工作。

在现实世界中，硬件和软件供应商基本上不知道他们的客户不了解的事情，至少在设备操作方面是如此。这和你打电话给福特或丰田，问他们如何驾驶一辆赛车是一样的，而不是去问赛车手。当然，汽车公司会有一些员工对赛车在性能条件下如何驾驶有一定了解，但他们没有任何人比实际的赛车手掌握更多的知识，他们显然也不会比正在赛道上绕圈的车手有更多的实践经验。

硬件和软件供应商只是一些由 IT 人才组成的团队，和任何其他公司从相同的人才库中招聘的人一样，事实上，如果你在行业中工作了一段时间，你会发现你认识的人可能会从现场工作转到供应商公司，反之亦然，而且很有可能这种情况也会发生在你自己身上。我自己曾在至少六家大型供应商公司担任过工程师，在这些公司中，没有任何特殊的“秘密”知识被隐藏起来。我们所有的客户支持甚至内部支持知识，获取方式和客户一样。有时候，客户实际上比我们还更能接触到我们的文档！

如果供应商知道如何让他们的产品在现场工作得比目前好得多，他们会尽一切可能将这些信息传递出去。几乎所有主要供应商都有广泛的文档、培训、认证和其他项目，希望现场的 IT 工作人员能够独立完成工作，且不出现任何问题，尽可能自己解决问题。供应商并不希望人们说产品无法正常工作，供应商必须介入修复问题。供应商迫切希望 IT 能够在没有供应商介入的情况下，正确地部署、配置和维护产品。这对市场营销有好处，也能带来最大化的利润。同时，这也有助于建立与 IT 的最佳关系，而 IT 大体上是硬件和软件采购的最大推广者和最大门槛守卫者。

也许有人误以为，最优秀的 IT 人员会自动被供应商吸纳，剩下的领域只会留下那些无法胜任的人。这听起来可能有些道理，但实际上完全不是这样。首先，很少有供应商像人们想象的那样有雄厚的资金，而且往往有些客户比供应商更愿意支付并吸引顶尖人才。其次，供应商的支持工作通常与普通 IT 工作有很大的不同，很多人进入 IT 行业时并不喜欢这些工作，因为技术和商业方面的差异，虽然这两个职位高度相关，但也存在显著的区别，因此并没有形成自动的流动。第三，任何供应商提供的支持工作都没有 IT 职位那样技术性强。供应商的职位通常涉及销售和客户管理、遵循详细的规则和流程，并按照预定的方式实施，目的是为了适应销售流程，而非 IT 流程。总的来说，最优秀的 IT 人员很少愿意进入供应商工作，而那些愿意的人往往并不是因为供应商的工作更符合他们的 IT 理想，而是因为他们看到了一个利用自己专业知识的机会，同时离开了 IT 领域。许多供应商根本没有真正的 IT 支持。

记住，供应商生产产品，而不是*提供 IT 服务*。因此，供应商通常能提供的支持与 IT 部门在其组织中应做的事情有很大不同。即使他们的员工拥有强大的 IT 资源，这些资源也不太可能被允许为客户提供真正的 IT 支持。供应商通常只希望并且往往只能在*按预期操作其产品*的非常狭窄范围内提供支持。IT 组织知道的关于供应商产品的知识，甚至如何最好地实施这些产品，往往与供应商知道的一样多或更多，这并不罕见。供应商根本没有必要掌握这些知识。比如，制锤工并不可能像木匠那样了解如何使用他们的锤子钉钉子。丰田的工程师也不太可能像职业赛车手那样驾驶他们自己的车。Canonical 相比你们的内部系统管理员，不太可能知道在你们的组织中如何最佳地部署 Ubuntu。

供应商的技能，主要是硬件工程或软件工程（或者两者兼有），与 IT 技能不同，即便是最优秀的供应商也没有特别的理由在 IT 任务上表现出色。那根本不是他们的擅长领域，他们为什么要具备这些技能呢？这不是他们业务的一部分。对于我们这些从事 IT 工作的人来说，这才是我们的业务。

供应商应该擅长的，并且通常也擅长的，是了解他们的产品。他们知道什么时候有缺陷需要修复，他们知道大多数公司在如何使用他们的产品方面的趋势，他们知道未来会有哪些变动（但可能无法向客户透露这些信息）。供应商是一个宝贵的资源，但前提是要在合适的逻辑框架下使用他们。

因为供应商卖的不是 IT 服务，而是产品，所以没有理由在任何规模上，甚至完全没有，保持高度专业化的 IT 资源。即便他们能够做到内部 IT 所能做的任何事情，这种想法也是相当荒谬的，根本没有意义。供应商在提供一定量的 IT 帮助时，通常会聘用中级和初级人员，因为没有必要聘用更昂贵的资源。来找供应商寻求 IT 资源的客户不可能把 IT 当作优先事项或做出合乎逻辑的选择，因此也没有理由为他们提供昂贵的资源——这些资源他们并没有准备好利用：销售低成本服务的利润远大于高成本服务。而那些足够成熟，真正需要高端 IT 资源的客户，通常知道不应该向供应商寻求这种帮助。

所以，没有什么魔法。供应商并不知道我们不知道的事情。通常，他们知道的内容要少得多，至少在我们环境中重要的东西，他们知道得更少。他们几乎没有获取必要的业务知识来做出合理的 IT 决策的权限。他们不能以跨行业的广泛技能和产品来处理问题或解决方案，而只能依赖他们提供的产品、互补产品以及鼓励更多使用其产品的流程。他们与 IT 的价值观没有对接，并且在财务上鼓励他们为自己的利益工作，而不是为你的利益工作。没有捷径，IT 资源应该提供的支持水平是无与伦比的，没有任何其他组织能够像你的 IT（通常应包括来自非供应商的外部 IT 资源）那样支持你的组织。

支持我们系统的方式本质上有三种。首先，我们有内部 IT 员工。根据本书的背景，这指的是系统管理员或团队。第二，我们有来自付费 IT 公司的外部 IT 资源，这些公司提供外部 IT 服务，而非销售服务，且他们为扩展内部 IT 团队而收费，可以是临时性的，也可以是长期的。第三，我们有供应商和增值经销商（供应商代表）。

我们必须记住，IT 不是一个特殊的例外，产品销售商也不是我们的商业顾问。就像房地产中的销售代理不能代表买方，买方代理也不能代表卖方一样，IT 领域也存在利益冲突和对立的代理关系。内部 IT 部门和任何外部 IT 服务提供商的职责是代表企业的需求，他们在法律和道德上都有义务这样做。另一方面，供应商和经销商通过销售利润或佣金获得报酬，代表供应商的需求，他们在法律上有义务这样做，从道德上讲，他们对供应商负责，而不是对客户负责。当然，这并不意味着供应商和经销商不能友好、有用、重要或专业，他们当然可以，也应该这样做。这仅仅意味着他们是产品销售商的代表，而我们作为 IT 专业人士，则是我们所服务企业的代表。

我们可以合作，最好的方式是理解彼此的角色和职责。在其他行业中，我们很少觉得销售人员或产品代表是为我们的最佳利益着想，而不是试图推广他们的商品，但在 IT 领域，这却是一个常见的混淆点。

当然，供应商及其经销商代表（准确来说称为 VARs，但常常以 MSPs 的身份出现，但要小心不要将真正的 IT 服务公司与那些只希望客户不质疑其名称的经销商混淆）可以是宝贵的盟友，我们不应完全忽视他们。他们可以成为我们解决方案的一部分，尤其是在获取特殊工具、测试版组件、补丁、发布信息、错误修复、更换硬件以及其他来自工程团队的组件（而不是 IT 处理的部分）时。

## 形象化 IT 负责的部分和工程负责的部分

即便作为 IT 专业人员，有时理解什么属于 IT 范畴，什么属于供应商工程（或软件工程部门）范畴，也可能令人困惑。但这里的答案应该非常简单。

作为 IT 专业人员，我们使用他人制作的产品，并将这些产品组装成完整的解决方案。我们不制作 Linux，我们不创建新的数据库引擎，我们不编写企业运行的应用程序。我们也不制造钣金，不运营芯片厂，或以其他方式制造计算机硬件组件，但在少数情况下，我们可能会购买部件并将其组装成计算机（就像机械师可能组装汽车零部件，但不实际铸造金属做零件一样）。

供应商负责制造 IT 部门负责使用和操作的工具和产品。供应商编写操作系统，我们在 IT 部门安装它们。供应商制作应用程序，我们安装它们。供应商参与的是产品的制造，而不是解决方案的创造。IT 解决的是组织性挑战，而不是生产产品。

如果我们谈论的是汽车，也许会更清楚。汽车供应商制造汽车。顾客乘坐汽车。这两者显然有着重要的相互关系，但显然，设计和制造汽车是一个非常不同的任务，而不是规划路线并开车到目的地。我们显然可以看到供应商为我们制造工具，而我们是使用这些工具来解决交通运输问题的汽车买家。将这种逻辑应用到 IT 领域，便能一目了然。

真正的支持，最重要的支持，始终来自我们自己的 IT 团队（这其中通常也包括外部 IT 工作人员）。我们自己的 IT 团队不仅具备做出关键支持决策所需的广泛业务知识，而且还拥有解决供应商限制的潜在解决方案范围。解决方案通常是一个单一产品供应商无法单独处理的。

举个例子，如果你是一家物流公司，需要将一个集装箱从纽约运送到洛杉矶，而你的卡车坏了，当然你可能会向卡车制造商咨询修理信息，但你不会就此止步。你会考虑更换卡车、租用卡车、寻找其他卡车供应商，考虑在维修期间使用其他物流伙伴为你运输，或考虑改用铁路或海运！在所有这些选择中，只有修理或许更换你的初始卡车，才可能是卡车制造商的支持范围，甚至从他们那里修理它的范围也远远不如你从修理工那里得到的帮助。一个熟练的修理工可能会提出部分功能的恢复、第三方配件，或者一些原厂供应商无法提供或批准的替代修理方案。原厂供应商在这里有其价值，重要的价值，但只是整体部门价值的一个小小部分。

处理大多数灾难需要更广泛的范围。我们很少愿意坐等供应商判断问题是否属于他们，然后再决定是否有有效的支持，再决定他们如何处理这个问题。即使是优秀的供应商，拥有出色的支持，相比于 IT 员工应该做的事情，他们的能力也是受到极大限制的。IT 部门拥有或应该拥有足够的权限，做任何必要的事情来保护公司。这可能涉及与现有供应商合作，或者可能需要绕过供应商，或者仅仅是协调多个供应商的工作。即使需要供应商介入，IT 部门也应当负责监督这些供应商。

## IT 供应商管理

与其他 IT 部门相比，系统管理部门更常与供应商互动，也更需要直接监督这些供应商。同时，系统管理部门也是最可能没有任何供应商的部门，至少在传统意义上是如此。

供应商不应被视为一个部门，而更像是一个特定的工具。一个需要监督并在适当时使用的工具，但使用权和决定权在 IT 部门。单独的供应商缺乏方向和控制。

管理 IT 部门的硬件、软件和服务供应商应当是该部门的日常任务。这个层级的供应商关系非常重要，因为这是技术知识应当交换的层级。对于我们 Linux 系统管理员来说，这意味着与像 IBM Red Hat 和 Canonical 这样的供应商的操作系统供应商对接，他们可以让我们及时了解补丁、即将发布的更改、发布日期、安全警报等，有时也可能成为我们依赖的专门技术资源。

系统管理可能还涉及许多其他类型的供应商。我们可能需要与服务器硬件、存储、数据库，甚至应用程序供应商合作。供应商众多，强调了 IT 管理供应商的重要性。没有 IT 的监督，这些供应商之间没有协调，也没有要求他们进行合作或朝着共同目标努力。此时，推动业务发展的责任完全在于 IT。只有 IT 才能确保在适当的情况下，利用供应商资源为业务发展提供帮助，而不是让其成为供应商的销售行为。

最佳实践是支持应当来自内部。根本上，所有的核心内容应该是，我们应将 IT 团队（包括内部和外部工作人员）视为解决方案团队，不仅是为了前期设计解决方案，也是为了在出现问题时处理它们。当供应商需要参与解决方案过程时，他们应当由 IT 团队进行协调、管理和监督，并且作为另一种资源进行管理。

# 分类技能和人员

大多数公司在灾难发生时会遭遇严重失败，因为分类流程要么不存在，要么非常不完善。日常运营所需的技能与危机中实时决策所需的决策过程是不同的：几乎没有时间开会，几乎没有与不同方协商的能力，规划根本不可能进行。在这种模式下，我们需要的是一个值得信赖、能应对压力且更倾向于观察而非规划的人——一个能快速决策、且不需要提前规划事件的人。规划固然重要，合理的规划应尽可能提前完成，但从初级 IT 人员到高级管理人员，每个人都应该明白，真正的紧急情况是无法充分预见的，现实生活中会有很多未知情况需要即时评估。

当发生灾难时，我们的第一个过程就是进入分类模式。我们需要准确知道什么地方出了问题，发生了什么，影响是什么——基本上，我们需要知道一切的状态。我们认为这能在几分钟内解决吗？需要进行调查吗？人们受到了什么影响？我们在失去金钱、生产力或客户吗？

灾难可能会对我们产生多种影响。能够迅速掌握业务影响，了解各个部门在大局中的作用，哪些团队能正常运作，哪些团队处于停滞状态，哪些团队能运作但在艰难维持，等等，都是至关重要的。这一点可能意味着从大家都站在那里不知所措到一个分类经理迅速解决问题的巨大差异。我们需要状态信息，并且需要大量的信息，且非常迅速地获得。

在大多数情况下，我们真正用于解决技术问题的时间竟出乎意料地少。这可能是因为只是硬件故障，我们只需要等待替换硬件到达。或者可能是完全的软故障，我们只需重建系统。有时候，深入的技术调查是有价值的，而且确实需要很多专业知识来查找问题的根源，但这并非大多数情况。我们更可能遇到相对快速的修复，至少在管理员需要投入的时间上是相对快速的。当修复时间很长时，通常是因为需要等待第三方的支持。

通常，我们会将注意力集中在停机的技术方面。停机的其他方面通常更为重要。一些组织拥有操作分诊专家，他们介入并处理停机的这些方面，使我们作为系统管理员能够专注于我们职责范围内的技术问题。然而，对于大多数企业而言，处理 IT 灾难从头到尾都需要 IT 的监督。在大多数情况下，我们希望帮助 IT 解决问题并管理操作环境分诊的团队，反而成为了寻找解决方案的障碍，而不是解决方案的一部分。

## 我可以提供状态更新，或者我可以解决问题。

每个曾经处理过任何形式的停机、灾难或其他影响企业的事件的人都知道，预期的反应不是让高管和管理层冲进来，开始寻找保护企业的方式，或在你突然被指派处理问题时提供帮助，而是我们依赖的那些人，应该创造一个最小化影响的环境并让我们有效工作，但几乎普遍会转而要求我们提供解释、状态报告、更新、估算、承诺和奇迹，所有这些充其量是无用的，最坏的情况是完全破坏了业务。

即使在理想情况下，报告、状态更新、测量等也有成本，并且这些成本通常会从生产力中扣除，哪怕是极小的部分。在灾难发生时，除了那些在最关键岗位上试图减轻和解决灾难的人，很少有人能提供状态更新。所以，最常见的情况是，所有人都会集中在那些少数关键岗位上，要求状态更新。

这里有几个问题，对于我们这些从事这些职位的人来说，这些问题显而易见，但对于那些现在正在经历生产力受影响的人来说，往往是无法察觉的。我们有两种工具可以帮助解决这个问题。第一，把这本书展示给管理层，让他们花时间理解情况。第二是规划。确保在灾难规划和准备过程中，管理层有相关培训，以及政策和程序计划，明确如何提供状态更新、谁可以索取这些更新，以及从谁那里获取。考虑指定 IT（及其他部门）的官方发言人，他们可以将所有时间用于提供更新，因为他们不参与灾难恢复工作的其他方面。也许他们会亲自主持一个战情室，或者维护一个电子邮件消息组，管理一个聊天室，或者主持一个电话会议，其他人可以根据需要拨入。

然后，任何现有的更新可以主动传递给这些指定的报告人员，他们可以为组织维持这一状态。整个组织应当理解设立一个指定报告点的重要性，这样，真正试图解决问题并让公司恢复正常运作的团队，可以将时间用于拯救公司，而不是报告公司的失败。显然，企业有一些业务需求，需要尽可能多地了解发生的事情。更具影响力的是内部的政治问题，管理者会觉得他们也必须提供他们无法获得的状态，而组织中的多个层级往往会有情绪化的人，他们可能会故意造成重大的财务损失，希望看起来更关心，或只是为了满足自己想要知道更多信息的欲望。

在培训管理层时，解释为什么 IT（及其他部门）不能提供详尽的更新，我们需要他们理解，作为试图解决问题的人，我们不能花时间提供状态更新。

我们没有任何信息可以提供。基本上，这是这个问题的最大难点。虽然我们可能会有一个简单的答案，比如*替换部件计划明天到达*，但通常我们对修复需要多长时间一无所知。IT 中的大多数问题在我们知道是什么问题时，本质上就已经解决了。直到完全修复，我们通常只是从假设中工作。向我们索要信息，实际上就等同于要求我们故意提供虚假的信息，因为我们没有其他可以提供的东西。这就像是在折磨一个不知道任何信息的囚犯，如果你折磨他们，他们很可能会编造些东西，只是希望折磨能停止。

我们都很忙。如果事情还没有解决，很可能我们正在全力以赴地试图解决它们。用来提供状态更新的时间必须从解决问题的时间中挤出。这不仅仅是浪费时间，它还会造成中断，打击那些在解决问题的人士的士气。它传递了一个巨大的组织信息，那就是问题并不那么重要，而且解决问题的努力没有得到应有的重视。这会让 IT 部门产生*如果管理层都不优先解决问题，我们为什么要做？*的想法。

*政治风险*。在试图让所有想要获得灾难信息以便做出*规划*的人能够从那些正在解决问题的人那里获取信息时，他们通常处于一个非常困难的境地，需要大胆猜测最终问题何时能解决。大多数组织都会对这种无法避免的不确定性采取非常消极的态度。故意提供错误信息往往会得到奖励，而诚实则常常受到惩罚。将信息提供者置于可能不得不*只告诉人们他们想听的*或*提供不准确的信息以保护自己政治利益*的位置，意味着公司可能会用错误的数据运营，从而导致不必要的额外财务损失。在这个时候推动错误的数据而不是没有数据是非常糟糕的，但这正是最有可能发生的时刻。

优先事项。如果组织开始从管理层开始优先考虑那些报告、状态会议、电话和其他无法解决问题的事情，而这些事情并不能帮助公司恢复正常运转，那么这将自然而然地，也应该绝对改变 IT 或任何其他部门处理问题的方式。如果任何问题都是如此琐碎，以至于我们开会讨论时间表而不是修复系统，那么随着时间的推移，加班、重新安排家庭活动，甚至跳过午餐，都会成为显然对公司没有价值的 IT 牺牲。我们绝不会仅仅为了某个会议而做这些事情，如果那个会议比找到解决方案更重要，那我们就有了相对价值评估，能够帮助我们找到行动的方向。

那么管理层应该如何行动呢？管理层需要做完全相反的事情。如果状态更新重要，我们理解它通常确实很重要，那么就让那些没有参与修复工作的人来处理这些沟通。保持优先事项清晰。指定团队来进行干预，避免所有打扰到正在修复系统的团队成员。让人们为他们送餐、饮料、咖啡，或者做些杂务，无论需要什么——让他们感到重要，而不是暗示他们不重要。不要因为传递坏消息而惩罚信息传递者，要奖励他们的诚实。站在他们的立场，考虑对公司最有利的结果。

这些都是容易说却难以做到的事情，尤其是在灾难发生时。提前规划，进行这些讨论，制定计划，在事情发生之前获得高层批准。制定一个行动计划，明确谁负责，事情如何进行，等等。

我们的首个分诊阶段是评估。我们是否有一个快速恢复在线的计划？我们需要了解当前的情况，然后需要以某种方式将这些信息传达给管理层。从这里开始，情况变得复杂。由于变量太多，教学分诊并非易事。擅长分诊的人需要能够评估现有的情况，找出解决当前问题的方法、可行的替代方案，并且在许多情况下，如何调整组织以便更好地应对。

这的确是一个*跳出框架思考*的情景。此时我们需要从大局出发，找出如何最好地保持企业的财务运转。这看起来可能像是管理层的任务，理想情况下确实是如此，但 IT 部门也应发挥作用，因为我们具备一些其他部门可能缺乏的见解。

除了技术修复外，应对策略会根据业务类型、影响类型等因素有很大差异。我们是不是应该让大家去喝咖啡？也许计划一个长时间的午餐？现在就让大家去休假，以节省保险费用，因为可能要过一段时间才会有人重新变得高效？也许可以让大家从纸质工作转到即时消息，而不是继续使用电子邮件？利用一种任务的空闲时间来集中精力做其他任务。也许在大家有空的时候，我们可以进行一次彻底的办公室清洁——拔掉那些电缆，真正把地方清理干净。

大规模紧急情况也可能带来大机会。我曾多次看到公司将灾难性停机当作机会，执行本来需要长时间审批或会导致大规模停机的重大更新和变更，但这些操作可以在反正已经发生的停机事件中顺利进行。有一次，我甚至遇到一个 ISP 故障，预计会持续很长时间，结果一个团队从纽约开车赶往华盛顿 D.C.，将一排服务器装入卡车，赶到纽约一个准备好的新地点，成功地执行了一个本因必需停机而被*无限期搁置*的数据中心迁移，并在 ISP 恢复华盛顿 D.C.服务之前，将工作负载从纽约恢复上线。一次看似小规模的停机，反而变成了部门的巨大*胜利*。一个大项目在艰难地等待安排和审批时，恰巧作为意外的好处被成功执行，同时团队通过迁移到备用数据中心，克服了原始地点由 ISP 租用线路所带来的限制，实现了一个重要的*修复*。

**急救**很难，因为它要求我们具备创造性、开放的思维、避免恐慌、广泛地思考并跳出常规框架，并且通常没有太多的规划或准备。如果你的组织没有一个合适的人来担任这个角色，而实际上很少有人适合，那么这应该是你外包的工作，但系统管理员是最有可能胜任此角色的人，因为系统管理员的技能和素质往往更适合急救和灾难恢复，而非工程和规划。

在许多情况下，停机不仅仅意味着一个工作负载无法访问，还需要在技术领域进行优先级排序。你的急救人员或团队需要深入了解各个工作负载之间的相互关系，哪些依赖于其他工作负载，哪些可以绕过，哪些可以跳过，以及这些工作负载如何与业务本身相关。只有了解技术范围和业务的关系，才能为修复顺序、优先级排序以及业务如何潜在应对提供有价值的见解。

我希望我们能够提供具体的指导，告诉大家如何在灾难中生存，但我们做不到。灾难有各种形式和大小，我们应对它们的方法也更多。最好的方法是学习如何思考、如何反应，并尽可能为任何可能的情况做好准备。

## 急救人员的招聘：感知者

我曾经有幸在一个大型 IT 部门工作，在那里，深度心理分析是管理过程的一部分。这听起来可能是件可怕的事，但这种方法非常优秀，公司运用了适当的心理分析来了解人们的工作方式、他们如何一起工作、谁在不同领域可能是强者或弱者，以及如何最好地组合人员以取得最佳结果。

我不想详细讨论这些技巧在何种情况下有帮助或可能有帮助，但我想提到的一个具体概念是迈尔斯-布里格斯性格测试中的“评判者”和“感知者”量表。我不是心理学家，所以我建议你自行研究这个测试及其解释，并理解像所有心理学一样，它的有效性既被广泛接受，也受到激烈争议。我在这里不会辩论赞成或反对，只是想说理解“评判”与“感知”偏好对的确非常有价值。

我通常将评判者描述为一个*计划者*，喜欢在事件发生前整理和安排事物。感知者则更像是一个*反应者*或*应答者*，喜欢按部就班地接受世界的挑战，并在当下做出反应。

在我们的世界里，工程师和大多数经理人都是判断型人格（Judgers）。他们的角色和价值在于提前思考，并组织业务或技术，以便完成需要做的事情。知觉型人格（Perceivers）则往往更擅长做管理员，而不是工程师，他们正是你在灾难发生时所需要的人。知觉型的人格是处理紧急情况、临场应变的自然候选人。人类天生是多样的，彼此互补，共同应对生活的多个方面，这正是这一点的典型例证。

成为合适的人选或团队成员，远不止是符合某项能力测试中的个性类型。迈尔斯-布里格斯评估仅仅是一个工具，用来识别哪些人可能在不同职位上表现得强或弱，并解释人们通常如何思考和感受。对我而言，发现自己是一个强项知觉型和弱项判断型的人，帮助我深刻理解自己，也让我学会如何将我的特点传达给他人。它还为我提供了工具，帮助我理解生活中的其他人，以便更好地沟通，并在他们的行为与我不同的时候，设定更好的期望。

无论你的公司是否使用正式的流程，还是你仅仅通过在线调查来了解自己，我都推荐使用迈尔斯-布里格斯（Myers-Briggs）等工具，至少可以帮助你更好地了解自己。你越了解自己，就越能在擅长的领域做好准备，并在薄弱的地方寻求帮助。如果你是团队领导或经理，这类信息对于帮助你更好地理解团队成员以及他们如何协作以变得更强大也很有帮助。

不要过度解读心理学工具或试图将它们广泛应用。总的来说，这些工具在应用于自己时最有效，当你以开放和诚实的态度，带着学习自己弱点的愿望，而非仅仅是发现自己的优点时，使用这些工具能起到自我提升的作用。记住，这类测试并不是关于结果的比较，某个结果并不比另一个更好或更差；每个人都处于不同的维度中，维度的两端或中间都没有好与坏之分。然而，强大的团队通常由多种不同的能力和个性的组合组成，以满足多方面的需求。

我希望我刚才所说的能让你充满信心和灵感，让你能够将分诊过程提升到一个新的水平，而不是让你对处理灾难的复杂性和不确定性感到恐慌——这不是你应该从中学到的重点。把现在的恐慌当作动力，立即开始你的计划和文档工作，并与管理层展开对话，争取利益相关者的支持。把这作为优先事项，你可以迅速从没有准备好转变为在几乎任何情况下都能最佳响应的领先企业。

不要觉得必须由你来处理分诊工作。也许你是做这项工作的最佳人选，也许你不是。很少有人拥有合适的个性，而分诊是一项非常特殊的能力。重要的是要确定你的分诊人员或团队，不管他们是谁。每个人都有自己的角色，找到你的定位，并找到合适的人来填补你需要的角色。

关于人员配置的最佳实践是，在灾难发生之前就确定你的分诊人员，并确保他们的角色已被文档化并随时可以接管，且有足够的权限在时机成熟时接管。不要等到停机时钟开始倒计时时才开始寻找具备分诊能力的人，也不要让政治成为焦点，而不是解决方案，因为时间至关重要。

# 故障排除的逻辑方法

作为系统管理员，可能最困难的事情就是故障排除。能够最初部署一个系统是一回事，但当问题出现时，能够排除故障则完全是另一回事。在系统管理中，我们有太多地方可能出问题；我们坐落于众多技术和无数可能性交汇的地方，追踪问题的源头可能非常具有挑战性。

毫不奇怪，经验使得这一切变得比任何事情都容易。你在维护和管理系统上经验越丰富，就越能快速地*感知*一个系统，并且通常能够在情况变得复杂时就能感觉到可能出问题的地方。没有什么比真正了解一个系统在正常情况下的反应以及根据其行为感知问题更有价值了。资深的诊断专家通常正是因这一点而被召集。通过足够的经验，你往往能直觉地感觉到是索引、缓存、磁盘或内存不足的问题。

除了纯粹的经验，我们的下一个最佳工具是深入理解我们自己的系统及其相互作用、对适用于我们情况的技术基础知识的深入了解，以及逻辑性的故障排除方法。

当然，在许多情况下，故障是迅速且明显的。停电了，硬盘坏了，关键的数据库被删除了。没有什么需要追踪的，只有需要解决的事情。但在其他时候，我们会遇到一些复杂的问题，可能由几乎任何因素引起，我们可能需要追踪到一个真正难以定位的问题。

让我吃惊的是，我经常被叫来协助故障排除，但发现已经做过的工作往往是杂乱无章的，而且通常存在冗余。当然，有时候，一些对容易测试的故障点的猜测，或者对已知常见故障点的早期测试，确实能加速发现问题，但我们必须小心，不能迷失方向，而是要从我们测试的内容中系统性地学习。

## 故障排除的故事

作为作者的一个好处就是我可以和你分享我自己的故障排除历史故事，而且没有人会翻白眼或者打断我，你也不能在感到无聊时就离开。所以，来吧。

有一次，我被叫去处理一个用于超低延迟应用的系统，团队发现应用在接收其他系统响应时会偶尔出现问题。问题是在每隔几分钟后，响应会比预期晚几纳秒到达。没错，纳秒！没有任何崩溃，结果也没有错误，只是有一个非常微小的延迟，且并不常发生。

经过大量研究，我们最终通过研究和系统理解的结合找到了问题。最终，通过数小时盯着 top 命令的监视器，观察在延迟发生时活跃的进程，我们成功地找出了问题。

最终，经过缩小可能的过程范围，发现内核中一个很快被废弃的内存垃圾回收过程在其默认设置下消耗了过多的系统资源，并导致系统在处理内存清理时暂停几纳秒。

我通过将垃圾回收过程设置为每次清理部分内存，使其运行得更快，从而解决了这个问题。之所以会出现这个问题，是因为服务器上有大量物理内存，导致垃圾回收过程占用了可测量的时间，而这通常是意料之外的。

在这种情况下，良好的研究和耐心无疑是重要的。能够基于测量工具*感觉*到系统中的延迟（没有人能真正感觉到如此短的延迟），然后运用逻辑推理来判断进行内存垃圾回收的过程如何以及为什么会影响这种性质的进程，所有这些必须结合起来才能使故障排除成为可能。如果没有对系统运行机制的深入理解，这是不可能做到的。

在进行故障排除时，我发现有两个关键技巧我总是反复告诉大家使用。第一个是要有条理，工作时从一端或另一端开始。避免四处跳跃或随意测试。例如，如果你在测试网络连接，可以从网络栈的近端开始，并基于测试逐步建立知识基础。

在网络故障排除的例子中，我们可以从检查网络连接是否正常开始：它是否有 IP 地址？能否 ping 通网关？ISP？公共 IP？是否能够解析 DNS？是否能访问它应该连接的系统？是否能够访问正确的端口？是否得到了合适的响应？

与其四处跳跃进行不同的测试，不如从最近的点开始，逐步探索，这样有助于我们准确地了解问题在哪一刻发生了故障，并迅速给出反馈。

另一个我总是教给大家的关键技巧是*从已知的事实开始工作*。基本上，要先确认事实。你可能有很多不知道的事情，但不能因此而担忧。这些未知总是存在的。然而，总是有一些你可以确认的事实，我们必须从这些已知的事实开始，利用它们来逐步建立更大的知识体系，找到越来越多我们能确定的事情。

例如，如果你能 ping 通远程服务器，那么你就知道你的网络连接、路由工作正常，且你和远程服务器之间的所有设备都在正常工作。或者，如果你知道某个特定的数据库正在运行并且一切正常，那么你也知道它的操作系统在正常运行，承载它的虚拟化管理程序也在正常运行，而虚拟化管理程序所安装的裸金属服务器也在正常运行。

让我感到惊讶的是，在故障排除过程中，人们总是会花时间确认事实，但之后又质疑这些事实。在上面的例子中，他们可能会觉得看到一个问题后，可能是虚拟化管理程序出现了故障，然后再次去检查它，尽管他们刚刚已经证明它依然在正常工作。或者在网络问题中，他们可能会说服自己需要检查一个路由器的状态，而他们之前刚刚用这个路由器验证过网络是否能正常通过。

深入“兔子洞”并让自己（或团队）一遍又一遍地证明你已经知道的事情是否正常，是在浪费时间，最好的情况下，这会非常令人沮丧。一旦你开始反复确认自己已经确定的事实，而不是去探寻新的信息，你很可能会一直这样做。很容易将注意力集中在这些事情上，从而忽略了扩展与当前问题相关的知识体系。

我发现，将我们知道的事实写下来，无论是作为起点还是从调查中得出，都是一个很好的工具。如果我们觉得必须再次测试我们已经证明的某个事情，那我们就有问题了。为什么我们不信任已经证明的事实？如果现在我们怀疑它，那当初为什么觉得它已经证明了？如果我们不打算相信测试结果，那测试又有什么意义呢？

如果我们测试、证明，然后又在原地打转，那就是无意义的时间浪费，而在系统停机期间我们是无法承受这些浪费的。我们要么需要以不同的方式看待我们认为是事实的事情，要么就需要信任这个评估。通过建立可信的事实，我们可以利用它们来缩小可能的问题范围。

故障排除之所以困难，一方面是因为它非常技术性，许多因素可能未知，另一方面也因为在压力甚至是恐慌的情况下进行的操作带有情绪性。通常，这种情况还会被我们组织的额外需求和压力加剧。保持清醒的头脑是关键。深呼吸，集中精力，喝点咖啡，把问题说出来，发布到技术同行评审社区和论坛，甚至可以与供应商沟通。把你的资源写下来，因为在紧张时容易忘记步骤。

## 技术社交媒体在问题解决中的作用

超过二十年来，我处理严重问题的一个最强大的资源竟然是技术社交媒体。我并不是指传统的社交媒体平台，而是专门为技术思想交流建立的论坛。当面临设计挑战或更重要的，系统故障需要修复时，我发现对我和我的团队来说，将这些问题发布到论坛上是非常宝贵的。

这一点之所以如此重要，原因并不总是显而易见的。最明显的好处是，许多经验丰富的专业人士愿意为你的问题提供新的视角，可能轻松发现你忽略的某个细节，或者提供一些见解或建议一些你之前不知道的工具。

然而，真正的好处在于请求帮助的过程。往往，必须写出问题所在、需要清晰表达并记录我所采取的步骤的行为本身，会让我在别人回应我之前，自己就能发现问题所在。将步骤写下来鼓励我更加有条理，也让我考虑到别人可能会问的显而易见的问题，这促使我尝试填补空白，遵循良好的流程，并记录比我平时为自己做的更多的内容。

我也会将这个公开评审的过程用于我的团队，并要求其他人也这么做。当然，有些细节不能公开发布，有时候即使没有可识别的细节，整个过程也过于敏感，不适合公开，但通常至少有一定程度的灾难可以公开供他人协助审查。使用这种方式在团队内部进行沟通非常有效，并且鼓励大家认真思考已做的工作，尝试不同的方式解释问题，并迫使团队成员之间对故障排除过程的文档进行更清晰的记录，因为即使是文档过程也会在实时中公开审查。

这个相同的过程随后提供了故障排除的文档和自动时间线，用于事后分析。我经常也邀请事后分析的审查，通常是通过相同的机制进行非正式的审查。人们总是乐于批评决策。你必须准备好接受一些严厉的评价。

没有人比我更支持在专注的环境中进行公共同行评审的价值了。我从 1990 年代末开始倡导这一运动，并在这些社区中通过公共平台度过了我的职业生涯。它教会了我很多我从未接触过的东西，并且迫使我以不同的方式工作，因为我知道我所做的一切都将被审查、评估和质疑。准备好解释每一个决策，捍卫每一个结果，依靠逻辑和数学来支持你的决策，无论是赞成还是反对，因为你的论点将永久记录供审查，这会促使你重新思考自己的话语，我相信，这也促使你在所有工作中变得更加优秀。因为当你认为没有人会质疑你，或者没有人会注意时，很容易做出不合理的论点。

故障排除的最佳实践很简单：要有条理，记录一切，并在需要依赖资源之前将其准备好。

接下来，我们将探讨何时开始执行这个过程是合理的，或者我们是否应该直接从头开始。

# 调查与修复

当我们开始处理宕机、数据丢失或其他灾难时，最自然的倾向是集中精力找出根本原因，修复这个根本原因，然后将系统恢复到正常状态。这是合乎逻辑的，是显而易见的事件进程，且情感上也令人满足。

这个过程的问题在于它基于一些错误的信念。这是一种源于像汽车或房屋在受损或发生事故后进行维修的做法。其基本原则是，相关的物体或系统非常昂贵，而修复相对便宜。

它还侧重于确定发生某些问题的原因的价值，胜过让系统重新运行的价值。假设如果某件事发生过一次，它很可能会再次发生，通过了解发生了什么和为什么发生，我们可以避免未来几乎不可避免的重复故障。

当然，在 IT 和商业系统中，通常构建的成本低于修复的成本。更重要的是，构建的成本比修复更具可预测性。如果我们进行了良好的规划和文档记录，我们应该能够在已知的时间内，以极高的可靠性实现新系统。修复问题可能很快，也可能不快，它代表着许多未知因素。修复可能需要很长时间，而且修复可能不可靠。根本原因分析可能是耗时且不可靠的。

在大多数情况下，尽快让系统恢复运行具有很大的价值，而确定问题发生的原因并找到未来避免它的潜在方法的价值较小。商业基础设施在硬件、软件和系统设计等各个方面经历着巨大的变化。今天发生的硬件故障不太可能以相同的方式重复发生。软件可能会被快速修补、更新和修改，虽然担心旧的 bug 会重现是可能的，但这并不是值得过多关注的情形。

如果我们处理的是汽车、房屋、道路、桥梁或其他此类大型物体，故障可能会随着时间的推移在系统几乎没有变化的情况下再次发生。我们需要确定故障点，评估重复发生的风险，并找到防护措施。很难摆脱这种思维方式。

我们必须评估对业务的价值。让系统恢复运行的价值是什么？找到根本原因的价值是什么？我们需要比较这些价值，通常情况下，我们会发现解决方案优于调查。

当我们拥有更现代化的基础设施，包括镜像系统、状态机和基础设施即代码时，修复与调查的决策将越来越偏向修复。我们的自动化质量越高，重建系统的速度越快、成本越低，调查问题的价值就越低。

我们还必须考虑到，凭借合适的基础设施，我们可以重建一个镜像系统，用于必要时的诊断。我们可以创建一个初步重建来让系统重新运行，并在有意义的情况下创建一个镜像，以便用来尝试重现故障，并确定是否有方法或原因来防止未来的类似故障。在停机期间，花费时间尝试识别原因并修复问题，可能并不是实现这一目标的最佳方式，即使它被认为是必要的。

这完全是成本分析，但必须非常迅速地完成。这里的未知因素是非常困难的难点，因为确定根本原因的时间完全不可知，可能需要几分钟，也可能需要几天。

这种从头开始的逻辑不仅适用于桌面，也适用于服务器。即使是最终用户工作站，也有机会做到可互换，并设计成能够快速重新部署的方式。如果我们使用镜像、自动化软件安装和其他自动化方式，那么桌面、笔记本或任何我们为最终用户使用的设备，都能在几分钟内进行新的部署。全新的部署不仅仅是让这些系统以最大效率恢复运行，它还提供了一个全新安装的机会，作为额外的福利。任何可能发生在机器上的冗余、恶意软件、损坏或类似问题都会被清除，最终用户将像机器刚从生产线下线一样全新地开始。通过这种方式，我们得到了一个银色的边际：一个全新的重建过程，我们通常很难安排，但理想情况下，我们应该定期进行。

可重建的系统，无论是桌面、服务器还是云实例，都意味着我们只需要可用的硬件就能从大多数灾难中恢复并继续前进。这也意味着，假设我们的备份存储在某个在线或异地的位置，我们有能力进入一个新的站点，并在那儿重建整个公司。这种灵活性和舒适感是一个改变游戏规则的因素——几年前，几乎没有公司能考虑到这一点。知道从 *头开始* 重新开始始终是可能的，让我们在灾难恢复中完全不同地看待我们所做的一切。

根据我的经验，即使是在十五年前，在我们拥有今天这种自动化和复杂环境之前，我们几乎完全被迫 *仅仅快速恢复，只有在恢复上线后才进行检查*，而实现这一点的能力从那时起就一直在增强。今天，在几乎所有情况下，我们应该把从头重建作为默认的假设起点，只有在情况要求时才 resort 更复杂的恢复方式；我们还应该仔细评估今天为什么会有这样的需求。这并不意味着重建应该是我们工具箱中唯一的工具，重建是大多数情况并不意味着它是唯一正确的解决方案，只是它最有可能是正确的。

传统上，重建存在某种污名化，好像这意味着我们放弃了或是力不从心。我们必须抗拒这种不正确的情绪反应。恢复环境的正确方法是创造对整个组织最有利的局面。就像我们做的所有事情一样，情感在这里不起作用。这只是一个财务和风险计算的问题。我们做的是对公司最有利的事，仅此而已。

**最佳实践**：

+   评估每种情况，但在低谷时，应倾向于彻底重建。没有一种方法适合所有情况，但在大多数情况下，重建应该是更好的选择。

+   设计系统时要确保它们能够快速、轻松、自动地重建。

# 概要

灾难恢复、紧急分类、为紧急情况配备适当的人员、组织准备工作、在灾难情境下的管理过程监督，以及应对关键故障场景的其他各个方面都是困难、令人恐惧且压力重重的。公司如何处理这些时刻，往往决定了哪些公司能生存下来，哪些公司会失败。我们必须确保有合适的人在岗，尽可能多的组织流程和程序，出色的文档，深入的系统知识，以及应对困难时期所需的灵活性，以使公司度过难关，取得真正的成功。

每个公司都在与这些问题作斗争。这些不是我们能一夜之间就能应用的简单战术。它需要组织利益相关者的支持，需要专业精神和规划，不仅在事件发生之前，而且在压力使几乎每个人都可能做出非理性行为的恐慌时刻，也要维持这些流程和专业精神。从一方面来看，我们可以将此视为充满压力和困难，但从另一方面来看，我们可以认识到它的本质：这是几乎所有组织都在挣扎的地方，大多数组织失败，而这是我们闪耀的最大机会。

灾难规划和灾难恢复无疑是你承担系统管理角色并将其发展为比原本角色更大，甚至通常比 IT 部门本身更大的机会。你无法仅将灾难准备工作局限于 IT 部门；它需要跨部门的合作。系统管理可以领先，而不是跟随，使 IT 成为应有的核心业务单元。

我意识到，对于许多人来说，IT 部门的能力和范围深受政治因素的影响，难以轻易变得灵活。挑战自己，至少要评估并考虑一下，推动组织朝新的方向发展需要什么。没有任何组织应该强迫 IT 戴上销售帽，仅仅为了说服组织做对自己有利的事，但在现实世界中，我们推销自己、我们的部门和我们的想法的能力，往往决定了我们是否会被誉为公司的救世主，或者只是被忽视。

记住，解决方案来自于你，而不是供应商。牢记供应商及其范围，并记住，虽然灾难是你挽救组织的绝佳机会，它们也是供应商在恐惧和情绪主导下找到新销售机会的巨大机会，此时周全的规划几乎不存在。重新思考你如何看待供应商，把支持关系的背景放在心中最重要的位置。时刻了解谁代表了你的利益，谁在寻找你为他们提供服务的最佳机会。

## 事后分析

在总结中加一个边栏可能显得不合适，但我认为事后分析本身就像是灾难的总结。那么为什么不在这里讨论一下呢？

大多数公司跳过了执行事后分析这一极为重要的任务。事后分析不是为了归咎于谁，如果公司想要用它来做这种事情，那么最好避免进行事后分析，但在健康的组织中，它们作为一个多层次的关键学习工具。

一次好的事后分析将揭示系统设计、文档、规划、政策、流程以及我们系统的几乎所有其他方面的错误。它还应该帮助我们识别在危机期间表现强或弱的人员。我们应该通过事后分析过程来发现我们在哪里存在弱点，如何改进，或者有可能决定不做任何更改。

事后分析还应允许我们评估导致我们今天处境的决策过程。这几乎是普遍被忽视的，而实际上这才是事后分析真正的价值所在。改变个别计划或决策的结果是好的，但通常只是微小的，但发现整个决策过程的失败则为我们提供了一个机会，能够对所有未来的决策产生影响并进行改变。

学会做决策很重要，但很少有组织或个人关注决策过程的质量，更少的公司跟踪并试图随着时间的推移改善这一过程。这是一个巨大的失误。决策是一个不断发生的过程。定期做出更好的决策比修正个别决策更为重要。

事后分析需要深入探讨*我们为什么做出当初的决定*，然后评估这个决定是否正确，但我们不能陷入用当前的知识来评判过去的决定的陷阱。*如果我们早知道的话*这种推测游戏是非常危险的。我们必须评估当时我们能知道什么，并确定是否做了足够的调研、是否充分考虑了、是否应用了真正的商业目标等等。

在事后很容易做出推测并说*看，事情失败了，我们损失了钱，这是某人的错*。从情感上看，这似乎是必须正确的，但实际上并非如此。它可能是对的，但这通常不是一个有生产力的判断。坏事发生了，风险是商业的一部分，并非总有某个人在背后导致这些坏事的发生。在 IT 行业，我们每天都在处理经过计算的风险。在事后分析中，我们需要知道的是我们是否做出了正确的计算并抓住了正确的机会。

一个关于良好风险的好例子是我们需要从纽约旅行到洛杉矶。我们可以乘飞机，也可以开车。如果我们主要关注旅行中的安全，飞行会让人感到害怕，而开车则似乎一点也不可怕。然而，在这么长的距离下，发生车祸的死亡几率远远高于飞机失事的风险。如果我们坐飞机，而飞机确实发生了坠机事故，我们可能会用这次飞行即将坠毁的知识来判断，正确的决定是应该开车，但那是错误的。飞行依然是正确的决定。这两种方式都有风险，而飞行的风险明显较低。我们之所以会用这次飞行会坠毁的知识，是因为在事前无法知道这一点。我们是在规避风险，做出了正确的决定；但没有任何选项是没有风险的，而因为做出了正确选择而惩罚别人，是一种糟糕的结果。

人们需要因做出艰难决策而获得奖励，尤其是在他们做出了正确的艰难决策时。如果我们寻求归咎于某人，就有可能因为某人做出了任何决定而惩罚他们。如果我们这样做，就会推动他们避免那些有助于保护业务的决策，以避免成为错误指责的对象。当然，如果做出了真正糟糕的决策，我们是希望能够发现的。保持专注于组织和个人改进，而不是将事后分析用来寻找替罪羊或推卸责任，确实是一个非常困难的任务。

如果正确使用，事后分析是一个强大的工具。如果使用不当，它会浪费时间，甚至可能更糟。即使组织没有能力进行良好的事后分析，也可以仅在 IT 部门内部进行。如果 IT 部门本身存在让这种分析不可能的政治因素，也可以仅在系统管理层内部进行。即使没有其他人参与，也要为自己进行事后分析。

记录你的事后分析。人们倾向于消极地记住灾难，并情绪化地归咎于并不存在或不应承担责任的人。保持事后分析的文档，因为它通常在以后为保护个人、团队或流程提供帮助。即使是事后，良好的文档依然是一个强大的工具。

记住，事后分析不仅需要问*我们是否能够避免这场灾难*，还需要问*即便我们能，是否应该避免？*通常，避免灾难的成本往往大于灾难发生的风险成本。事后分析应当涵盖决策过程、决策本身以及对灾难的应对。

我希望本章中的思想和概念能帮助你打破传统角色的思维定势，拆除*框架*，让你在灾难恢复方面的方式体现出你和你的组织所能展现的最佳能力。

在关于 Linux 的书籍中，显然缺少对 Docker 和其他现代容器技术的讨论。这并非偶然，而是经过设计的。其原因在于，Docker 及其同类技术是应用容器技术，它们利用了我们已经讨论过的其他技术，而它们的实践则是它们自己的问题。从系统管理员的角度来看，应用容器只是另一种工作负载——它恰好使用了 Type-C 虚拟化并管理自己的依赖关系和更新。Docker 或其他应用容器管理超出了本书以及一般系统管理的范围。

在大多数情况下，系统管理员负责管理这些技术，但它们并不是特殊的案例。工作负载与我们在本书中讨论的其他工作负载相同。尽管它们可能有自己的名称、机制和管理工具，但所有这些仍然受到我们作为系统管理员应当已经掌握的一般情况准则和规则的约束。如果你打算与这些技术打交道，且如果你现在是系统管理员，几乎肯定会这样做，你将需要学习许多与应用容器平台及其管理工具特定相关的知识，并将这些知识应用到我们已经学到的内容上。

最佳实践专注于学习一般情况，即总是适用的规则，然后弄清楚不同的技术、技术方法和产品如何符合这些一般情况。
