<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer045" class="_idGenObjectStyleOverride-1">&#13;
			<p id="_idParaDest-28" class="Chapter-Title" lang="en-US" xml:lang="en-US"><span class="ChapterMarker">4. </span><a id="_idTextAnchor046"/>Dual Booting CentOS 8 with Windows</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">CentOS 8<a id="_idIndexMarker046"/>, just like most Linux distributions, will happily co-exist on a hard disk drive with just about any version of Windows up to and including Windows 10. This is a concept known as dual-booting. Essentially, when you power up the system, you will be presented with a menu providing the option to boot either your CentOS 8 installation or Windows. Obviously you can only run one operating system at a time, but it is worth noting that the files on the Windows partition of your disk drive will be available to you from CentOS 8 regardless of whether your Windows partition was formatted using <a id="_idIndexMarker047"/>NTFS,<a id="_idIndexMarker048"/> FAT16 or <a id="_idIndexMarker049"/>FAT32.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">This installation method involves shrinking the size of the existing Windows partitions and then installing CentOS 8 into the reclaimed space. This chapter will assume that CentOS 8 is being installed on a system currently running Windows 10.</p>&#13;
			<p id="_idParaDest-29" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">4.1 </span><a id="_idTextAnchor047"/>Partition Resizing</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">In order to accommodate CentOS on a disk drive that already contains a Windows installation, the first step involves shrinking the Windows partition to make some room. The recommended course of action is to use the Windows Disk Management interface to reduce the size of the partition before attempting to install CentOS 8. </p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><a id="_idIndexMarker050"/>To access Disk Management on <a id="_idIndexMarker051"/>Windows 10, right-click on the Start menu and select <span class="My-Italic _idGenCharOverride-1">Disk Management</span> from the resulting menu as highlighted in <a href="../Text/Installation_Dual_Boot.xhtml#_idTextAnchor048">Figure 4-1</a>:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US" xml:lang="en-US"><img class="_idGenObjectAttribute-1" src="Images/rhel_8_win_10_disk_management_start.png" alt="" width="473" height="604"/></p>&#13;
			<p class="Figure-Caption" lang="en-US" xml:lang="en-US"><span class="FigureCaptionMarker">Figure 4-1</span><a id="_idTextAnchor048"/></p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Once loaded, the Disk Management tool will display a graphical representation of the disk drives detected on the system:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US" xml:lang="en-US"><img class="_idGenObjectAttribute-2" src="Images/rhel_8_win_10_disk_management_main.png" alt="" width="771" height="483"/></p>&#13;
			<p class="Figure-Caption" lang="en-US" xml:lang="en-US"><span class="FigureCaptionMarker">Figure 4-2</span></p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Right-click on the partition you wish to reduce in size and select <span class="My-Italic _idGenCharOverride-1">Shrink Volume... </span>from the popup menu. The tool will calculate the maximum amount by which the volume size can be reduced without data loss (a process that can take several minutes depending on the overall size of the partition). Once this analysis is complete, a dialog similar to the one in <a href="../Text/Installation_Dual_Boot.xhtml#_idTextAnchor049">Figure 4-3</a> below will appear:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US" xml:lang="en-US"><img class="_idGenObjectAttribute-3" src="Images/rhel_8_win_10_disk_management_shrink.png" alt="" width="461" height="306"/></p>&#13;
			<p class="Figure-Caption" lang="en-US" xml:lang="en-US"><span class="FigureCaptionMarker">Figure 4-3</span><a id="_idTextAnchor049"/></p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Specify a value in the <span class="My-Italic _idGenCharOverride-1">Enter amount of space to shrink in MB</span> field and click on the <span class="My-Italic _idGenCharOverride-1">Shrink</span> button to proceed. Once the resizing operation is complete, reboot using the CentOS 8 installation media (as outlined in <a href="../Text/Installation_Clean_Disk.xhtml#_idTextAnchor017"><span class="My-Italic _idGenCharOverride-1">“Installing CentOS 8 on a Clean Disk Drive”</span></a>) and proceed with the installation making use of the new free space.</p>&#13;
			<p id="_idParaDest-30" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">4.2 </span><a id="_idTextAnchor050"/>Editing the CentOS 8 <a id="_idIndexMarker052"/>Boot Menu </p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Once installation of CentOS onto the disk is complete and the system has restarted, the standard CentOS boot menu will appear:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US" xml:lang="en-US"><img class="_idGenObjectAttribute-4" src="Images/centos_8_boot_screen.png" alt="" width="1300" height="723"/></p>&#13;
			<p class="Figure-Caption" lang="en-US" xml:lang="en-US"><span class="FigureCaptionMarker">Figure 4-4</span></p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">At this point, the boot menu only provides the option to boot the CentOS 8 system. Clearly an option also needs to be added so that the Windows system is still accessible. These steps will need to be taken from within the CentOS 8 system, so start the system and log in as root.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">The first step is to identify the Windows boot partition on the disk drive using the <span class="My-Italic _idGenCharOverride-1">fdisk</span> command as follows:</p>&#13;
			<p class="Code"># fdisk -l</p>&#13;
			<p class="Code">.</p>&#13;
			<p class="Code">.</p>&#13;
			<p class="Code">Device     Boot    Start       End  Sectors  Size Id Type</p>&#13;
			<p class="Code">/dev/sda1  *        2048   1126399  1124352  549M  7 HPFS/NTFS/exFAT</p>&#13;
			<p class="Code">/dev/sda2        1126400  53655551 52529152   25G  7 HPFS/NTFS/exFAT</p>&#13;
			<p class="Code">/dev/sda3       53655552  55752703  2097152    1G 83 Linux</p>&#13;
			<p class="Code">/dev/sda4       55752704 104857599 49104896 23.4G  5 Extended</p>&#13;
			<p class="Code">/dev/sda5       55754752 104857599 49102848 23.4G 8e Linux LVM</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">In the above output <span class="My-Italic _idGenCharOverride-1">/dev/sda3</span> through to <span class="My-Italic _idGenCharOverride-1">/dev/sda5</span> are clearly the CentOS 8 partitions. The smaller <span class="My-Italic _idGenCharOverride-1">/dev/sda1</span> partition is the Windows system partition, leaving <span class="My-Italic _idGenCharOverride-1">/dev/sda2</span> as the Windows boot partition. </p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">The CentOS 8 boot system works using partition indexes where the first partition is partition 0, the second is partition 1 and so on. As such, the Windows boot partition from the point of view of the boot menu is located on hard disk 0 at partition index location 1 and is defined in the boot configuration as “hd0,1”.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">The boot menu configuration settings are stored in the<span class="My-Italic _idGenCharOverride-1"> /boot/grub2/grub.cfg</span> file which is generated using the <a id="_idIndexMarker053"/><a id="_idIndexMarker054"/><span class="My-Italic _idGenCharOverride-1">grub2-mkconfig</span> tool based on the content of the configuration files located in the <span class="My-Italic _idGenCharOverride-1">/etc/grub.d</span> directory. To add the Windows boot option to the configuration, edit the <span class="My-Italic _idGenCharOverride-1">/etc/grub.d/40_custom</span> file which should read as follows:</p>&#13;
			<p class="Code">#!/bin/sh</p>&#13;
			<p class="Code">exec tail -n +3 $0</p>&#13;
			<p class="Code"># This file provides an easy way to add custom menu entries.  Simply type the</p>&#13;
			<p class="Code"># menu entries you want to add after this comment.  Be careful not to change</p>&#13;
			<p class="Code"># the ‘exec tail’ line above.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Edit the file to add the following entry to the end of the <span class="My-Italic _idGenCharOverride-1">40_custom</span> file:</p>&#13;
			<p class="Code">menuentry "Windows 10" {</p>&#13;
			<p class="Code">         set root=(hd0,1)</p>&#13;
			<p class="Code">         chainloader +1</p>&#13;
			<p class="Code">         }</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Save the file and generate the boot menu as follows:</p>&#13;
			<p class="Code"># grub2-mkconfig --output=/boot/grub2/grub.cfg</p>&#13;
			<p class="Code">Generating grub configuration file ...</p>&#13;
			<p class="Code">done</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">On the next reboot, Windows will now be included as a boot option as shown in <a href="../Text/Installation_Dual_Boot.xhtml#_idTextAnchor051">Figure 4-5</a>:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US" xml:lang="en-US"><img class="_idGenObjectAttribute-5" src="Images/centos_8_boot_screen_with_win10.png" alt="" width="1298" height="724"/></p>&#13;
			<p class="Figure-Caption" lang="en-US" xml:lang="en-US"><span class="FigureCaptionMarker">Figure 4-5</span><a id="_idTextAnchor051"/></p>&#13;
			<p id="_idParaDest-31" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">4.3 </span><a id="_idTextAnchor052"/>Changing the Default Boot Option</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">When the system starts, the boot options screen will appear and wait 5 seconds for the user to make an operating system choice. If no selection has been made before the timeout elapses, the default operating system will be started. On a newly configured system, the default operating system will be the standard (non-rescue) CentOS 8 image. This default can, however, be changed from within CentOS.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">A range of boot configuration options (including the 5 second timeout and the boot RHGB settings outlined in <a href="../Text/Installation_Clean_Disk.xhtml#_idTextAnchor017"><span class="My-Italic _idGenCharOverride-1">“Installing CentOS 8 on a Clean Disk Drive”</span></a>) are declared in the <span class="My-Italic _idGenCharOverride-1">/etc/default/grub</span> <a id="_idTextAnchor053"/>file which reads as follows on a new installation:</p>&#13;
			<p class="Code">GRUB_TIMEOUT=5</p>&#13;
			<p class="Code">GRUB_DISTRIBUTOR=”$(sed ‘s, release .*$,,g’ /etc/system-release)”</p>&#13;
			<p class="Code">GRUB_DEFAULT=saved</p>&#13;
			<p class="Code">GRUB_DISABLE_SUBMENU=true</p>&#13;
			<p class="Code">GRUB_TERMINAL_OUTPUT=”console”</p>&#13;
			<p class="Code">GRUB_CMDLINE_LINUX=”crashkernel=auto resume=/dev/mapper/cl-swap rd.lvm.lv=cl/root rd.lvm.lv=cl/swap rhgb quiet”</p>&#13;
			<p class="Code">GRUB_DISABLE_RECOVERY=”true”</p>&#13;
			<p class="Code">GRUB_ENABLE_BLSCFG=true</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">The first step in changing the default boot system is to declare the GRUB_SAVEDEFAULT setting within this file:</p>&#13;
			<p class="Code">GRUB_TIMEOUT=5</p>&#13;
			<p class="Code">GRUB_DISTRIBUTOR="$(sed 's, release .*$,,g' /etc/system-release)"</p>&#13;
			<p class="Code">GRUB_DEFAULT=saved</p>&#13;
			<p class="Code"><span class="My-Bold _idGenCharOverride-2">GRUB_SAVEDEFAULT=true</span></p>&#13;
			<p class="Code">.</p>&#13;
			<p class="Code">.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">This setting allows a new default value to be saved within the boot configuration. Next, run the <span class="My-Italic _idGenCharOverride-1">grub2-set-default</span> command to change the default setting using a numbering system that counts the first option as 0. For the boot options shown in <a href="../Text/Installation_Dual_Boot.xhtml#_idTextAnchor051">Figure 4-5</a> above, for example, the first CentOS entry is position 0 while the Windows 10 option is position 2. The command to make Windows 10 the default boot option, therefore, would read as follows:</p>&#13;
			<p class="Code"># grub2-set-default 2</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Check that the new setting has taken effect by running the following command:</p>&#13;
			<p class="Code"># grub2-editenv list</p>&#13;
			<p class="Code">saved_entry=2</p>&#13;
			<p class="Code">kernelopts=root=/dev/mapper/cl-root ro crashkernel=auto resume=/dev/mapper/cl-swap rd.lvm.lv=cl/root rd.lvm.lv=cl/swap rhgb quiet </p>&#13;
			<p class="Code">boot_success=0</p>&#13;
			<p class="Code">boot_indeterminate=0</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Note that the <span class="My-Italic _idGenCharOverride-1">saved_entry</span> value is now set to 2. After changing the default, regenerate the boot configuration file as follows:</p>&#13;
			<p class="Code"># grub2-mkconfig --output=/boot/grub2/grub.cfg</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Reboot the system and verify that the boot menu defaults to the Windows 10 option and that Windows loads after the timeout expires.</p>&#13;
			<p id="_idParaDest-32" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">4.4 </span><a id="_idTextAnchor054"/>Accessing the <a id="_idIndexMarker055"/>Windows Partition from CentOS 8</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">When running CentOS in a dual boot configuration it is still possible to access files located on the Windows partition. This can be achieved by manually mounting the partition from the command-line. Before doing so, however, some additional packages need to be installed on the system. First the <span class="My-Italic _idGenCharOverride-1">fuse</span> kernel module needs to be downloaded and installed:</p>&#13;
			<p class="Code"># dnf install fuse</p>&#13;
			<p class="Code"># modprobe fuse</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Next, the <a id="_idIndexMarker056"/>Fuse NTFS driver needs to be installed. Unfortunately, this package is not included in the standard CentOS 8 repositories so the <a id="_idIndexMarker057"/>Extra Packages for Enterprise Linux (<a id="_idIndexMarker058"/>EPEL) repository needs to be added to the system as follows:</p>&#13;
			<p class="Code"># dnf install wget</p>&#13;
			<p class="Code"># wget http://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm</p>&#13;
			<p class="Code"># rpm -ivh epel-release-latest-8.noarch.rpm</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">With the EPEL repository added, the driver can now be installed:</p>&#13;
			<p class="Code"># dnf install fuse-ntfs-3g</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Once the requisite packages are installed, the next step is to create a directory to use as the mount point for our Windows partition. In this example we will create a directory named <span class="My-Italic _idGenCharOverride-1">/mnt/windows</span>:</p>&#13;
			<p class="Code"># mkdir /mnt/windows</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">In order to identify the device name that has been assigned to the Windows partition, use the <span class="My-Italic _idGenCharOverride-1">fdisk</span> command as follows:</p>&#13;
			<p class="Code"># fdisk -l</p>&#13;
			<p class="Code">.</p>&#13;
			<p class="Code">.</p>&#13;
			<p class="Code">   Device Boot      Start         End      Blocks   Id  System</p>&#13;
			<p class="Code">/dev/sda1   *           1          13      102400    7  HPFS/NTFS</p>&#13;
			<p class="Code">/dev/sda2              13        1400    11141120    7  HPFS/NTFS</p>&#13;
			<p class="Code">/dev/sda3            1400        1464      512000   83  Linux</p>&#13;
			<p class="Code">/dev/sda4            1464        2611     9214976    5  Extended</p>&#13;
			<p class="Code">/dev/sda5            1464        2611     9213952   8e  Linux LVM</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">In the above output, the main Windows partition containing the files we need access to is represented by <span class="My-Italic _idGenCharOverride-1">/dev/sda2</span>. Next, we need to run the <span class="My-Italic _idGenCharOverride-1">mount</span> command (assuming the Windows partition is /dev/sda2 and <a id="_idIndexMarker059"/>NTFS format) as follows: </p>&#13;
			<p class="Code"># mount /dev/sda2 /mnt/windows</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Check that the mount was successful by listing the contents of the top level directory of the mount point:</p>&#13;
			<p class="Code"># ls /mnt/windows</p>&#13;
			<p class="Code">‘$Recycle.Bin’             ProgramData            swapfile.sys</p>&#13;
			<p class="Code">‘Documents and Settings’  ‘Program Files’        ‘System Volume Information’</p>&#13;
			<p class="Code"> pagefile.sys              ‘Program Files (x86)’   Users</p>&#13;
			<p class="Code"> PerfLogs                  Recovery               Windows</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">To automate the mount each time the system is booted, simply add the appropriate mount line to the <a id="_idIndexMarker060"/><span class="My-Italic _idGenCharOverride-1">/etc/fstab</span> file: </p>&#13;
			<p class="Code">/dev/sda2 /mnt/windows ntfs defaults 0 0</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">To unmount the Windows file system at any time: </p>&#13;
			<p class="Code">umount /mnt/windows</p>&#13;
			<p id="_idParaDest-33" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">4.5 </span><a id="_idTextAnchor055"/>Summary</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">CentOS 8 can safely co-exist on the same disk drive as a Windows operating system by creating a dual boot environment. This involves shrinking the amount of space occupied by the Windows system to make room for CentOS 8 before performing the installation. Once CentOS has been installed, the boot menu configuration must be modified to include the option to boot from Windows. To access the Windows filesystem from within CentOS, the Fuse NTFS driver needs to be installed and used to mount the Windows partitions.</p>&#13;
		</div>&#13;
</div>



  </body></html>