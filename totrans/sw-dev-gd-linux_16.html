<html><head></head><body>
<div class="Basic-Text-Frame" id="_idContainer085">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">16</span></h1>
<h1 class="chapterTitle" id="_idParaDest-367"><span class="koboSpan" id="kobo.2.1">Monitoring Application Logs</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">Welcome to the world of Linux logging! </span><span class="koboSpan" id="kobo.3.2">As software developers, understanding logging in Linux, especially with tools like </span><code class="inlineCode"><span class="koboSpan" id="kobo.4.1">systemd</span></code><span class="koboSpan" id="kobo.5.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.6.1">journald</span></code><span class="koboSpan" id="kobo.7.1">, is crucial. </span><span class="koboSpan" id="kobo.7.2">Here’s a breakdown of what you need to know.</span></p>
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.8.1">Logs</span></strong><span class="koboSpan" id="kobo.9.1"> are</span><a id="_idIndexMarker582"/><span class="koboSpan" id="kobo.10.1"> records of events happening in a software application or operating system. </span><span class="koboSpan" id="kobo.10.2">It’s a flexible format and unique to each application, but how logs are processed, stored, and retrieved is more uniform on modern systems. </span><span class="koboSpan" id="kobo.10.3">It’s essential for you to understand logs as a developer because the logs you can access in Linux provide insights into the behavior of the operating system and all applications running on it. </span><span class="koboSpan" id="kobo.10.4">You’ll use this knowledge to understand errors, track application performance, and debug. </span><span class="koboSpan" id="kobo.10.5">Logs are your first line of defense in troubleshooting, so prepare to get comfortable with them.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.11.1">In this chapter, we’ll give you an overview of Unix and Linux logging, and show you the most common ways that software developers interact with logs. </span><span class="koboSpan" id="kobo.11.2">You’ll see:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.12.1">How logs are emitted by the system and applications running on it</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.13.1">Where logs are collected on most modern Linux systems</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.14.1">Some historical knowledge about how logging worked in the past, which still comes in handy on many production systems you’ll run into</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.15.1">How to find and view logs when you’re troubleshooting an application</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.16.1">How logs are being centralized at companies and when services are deployed in cloud environments</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.17.1">We’ll also give a few tips on getting the most out of structured logging while avoiding some common pitfalls that developers often fall into.</span></p>
<h1 class="heading-1" id="_idParaDest-368"><span class="koboSpan" id="kobo.18.1">Introduction to logging</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.19.1">As we saw in the introduction, </span><strong class="keyWord"><span class="koboSpan" id="kobo.20.1">logs</span></strong><span class="koboSpan" id="kobo.21.1"> are</span><a id="_idIndexMarker583"/><span class="koboSpan" id="kobo.22.1"> simply informational messages – records of events happening in a software application or operating system. </span><span class="koboSpan" id="kobo.22.2">Like many Unix concepts, there are few hard and fast rules: if you write a two-line script that writes a timestamp into a text file, that might count as a log. </span><span class="koboSpan" id="kobo.22.3">Some logs are simple plaintext strings sent to well-known file locations on the system, and others are highly structured binary data managed exclusively by a daemon such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.23.1">systemd</span></code><span class="koboSpan" id="kobo.24.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.25.1">As a developer, you’re probably familiar </span><a id="_idIndexMarker584"/><span class="koboSpan" id="kobo.26.1">with </span><strong class="keyWord"><span class="koboSpan" id="kobo.27.1">log levels</span></strong><span class="koboSpan" id="kobo.28.1">, which are labels that indicate the urgency of events on your software. </span><span class="koboSpan" id="kobo.28.2">Think “error,” “info,” and “debug” messages, which you’ve surely seen scrolling past in the terminal while developing software. </span><span class="koboSpan" id="kobo.28.3">We’ll cover these common log levels later, but for now, you should be aware of three main </span><em class="italic"><span class="koboSpan" id="kobo.29.1">sources</span></em><span class="koboSpan" id="kobo.30.1"> of logs in a modern, full-featured Linux environment: </span><strong class="keyWord"><span class="koboSpan" id="kobo.31.1">system</span></strong><span class="koboSpan" id="kobo.32.1">, </span><strong class="keyWord"><span class="koboSpan" id="kobo.33.1">service</span></strong><span class="koboSpan" id="kobo.34.1">, and non-service </span><strong class="keyWord"><span class="koboSpan" id="kobo.35.1">application</span></strong><span class="koboSpan" id="kobo.36.1"> logs. </span><span class="koboSpan" id="kobo.36.2">The source of the log can give you important contextual information about what’s happening in a specific log message.</span></p>
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.37.1">System logs</span></strong><span class="koboSpan" id="kobo.38.1"> are</span><a id="_idIndexMarker585"/><span class="koboSpan" id="kobo.39.1"> logs sent by the operating system (“the kernel”) itself. </span><span class="koboSpan" id="kobo.39.2">These include errors, messages about hardware events, resource consumption and limits, configuration and security, and noteworthy changes in the system state.</span></p>
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.40.1">Service logs</span></strong><span class="koboSpan" id="kobo.41.1"> are </span><a id="_idIndexMarker586"/><span class="koboSpan" id="kobo.42.1">emitted by the services running on a system. </span><span class="koboSpan" id="kobo.42.2">Specifically on Linux, they are emitted by the services managed by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.43.1">systemd</span></code><span class="koboSpan" id="kobo.44.1"> init system, which do their logging through a service called </span><code class="inlineCode"><span class="koboSpan" id="kobo.45.1">journald</span></code><span class="koboSpan" id="kobo.46.1">. </span><span class="koboSpan" id="kobo.46.2">They can provide insights into the health and status of various services.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.47.1">On the systems you’re likely to encounter, system and service logs are both commingled in </span><code class="inlineCode"><span class="koboSpan" id="kobo.48.1">journald</span></code><span class="koboSpan" id="kobo.49.1">. </span><span class="koboSpan" id="kobo.49.2">We’ll learn all about </span><code class="inlineCode"><span class="koboSpan" id="kobo.50.1">systemd</span></code><span class="koboSpan" id="kobo.51.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.52.1">journald</span></code><span class="koboSpan" id="kobo.53.1"> (and </span><code class="inlineCode"><span class="koboSpan" id="kobo.54.1">journalctl</span></code><span class="koboSpan" id="kobo.55.1">) as we progress through this chapter.</span></p>
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.56.1">Non-systemd-managed applications</span></strong><span class="koboSpan" id="kobo.57.1"> are</span><a id="_idIndexMarker587"/><span class="koboSpan" id="kobo.58.1"> the outliers that don’t generally log through </span><code class="inlineCode"><span class="koboSpan" id="kobo.59.1">journald</span></code><span class="koboSpan" id="kobo.60.1">. </span><span class="koboSpan" id="kobo.60.2">You’ll have to find their log files via documentation for each application, although well-behaved applications usually write their own log files in a directory like </span><code class="inlineCode"><span class="koboSpan" id="kobo.61.1">/var/log/$APPLICATION_NAME/</span></code><span class="koboSpan" id="kobo.62.1">, where </span><code class="inlineCode"><span class="koboSpan" id="kobo.63.1">$APPLICATION_NAME</span></code><span class="koboSpan" id="kobo.64.1"> is the name of the application.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.65.1">As we go through this chapter, the importance of understanding journald and journalctl commands will become apparent. </span><span class="koboSpan" id="kobo.65.2">However, before we go into that, we should note a few details about Linux logging.</span></p>
<h2 class="heading-2" id="_idParaDest-369"><span class="koboSpan" id="kobo.66.1">Logging on Linux can get... </span><span class="koboSpan" id="kobo.66.2">weird</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.67.1">You’ve </span><a id="_idIndexMarker588"/><span class="koboSpan" id="kobo.68.1">seen by now that Unix-like systems are tremendously flexible. </span><span class="koboSpan" id="kobo.68.2">If you don’t like the default way that things are done, you can break with convention and configure things to work the way you want.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.69.1">This is also a tremendous downside when you’re learning the basics of Unix and Linux. </span><span class="koboSpan" id="kobo.69.2">Many things – from software configuration to default user settings – can be configured in many different ways, and there’s no way to know what the convention is in a new environment except to ask (and sometimes, troubleshoot).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.70.1">Nowhere is that truer than when it comes to logging, which has been especially affected by the recent shifts in how companies do their computing. </span><span class="koboSpan" id="kobo.70.2">Logging was done a certain way for decades, when most companies directly purchased, configured, and managed long-lived physical servers with a single OS installed on them. </span><span class="koboSpan" id="kobo.70.3">As workloads have shifted to the cloud, and things have shifted to many operating systems per physical machine (VMs) and even many environments per OS (containers), traditional ideas of how logging should work have shifted as well.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.71.1">That’s all to say that when it comes to figuring out logging in a new job or team, the question is not, “How is logging done on Linux?” </span><span class="koboSpan" id="kobo.71.2">but rather, “How is logging currently done here?” </span><span class="koboSpan" id="kobo.71.3">It really depends on decisions made by the developers of the software you’re using. </span><span class="koboSpan" id="kobo.71.4">When learning about logging in this chapter, we advise that you keep this in mind.</span></p>
<h2 class="heading-2" id="_idParaDest-370"><span class="koboSpan" id="kobo.72.1">Sending log messages</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.73.1">While, in most situations, services will log either through a library or by simply writing to </span><code class="inlineCode"><span class="koboSpan" id="kobo.74.1">stdout</span></code><span class="koboSpan" id="kobo.75.1">, Unix-like systems provide a command that logs to a syslog server. </span><span class="koboSpan" id="kobo.75.2">We’ll look at what that means below. </span><span class="koboSpan" id="kobo.75.3">Since both </span><code class="inlineCode"><span class="koboSpan" id="kobo.76.1">syslogd</span></code><span class="koboSpan" id="kobo.77.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.78.1">systemd</span></code><span class="koboSpan" id="kobo.79.1"> provide a syslog server no matter what kind of system you are using, there is a unified command to send a log message:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.80.1">logger Hello World!
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.81.1">This will log </span><code class="inlineCode"><span class="koboSpan" id="kobo.82.1">Hello World</span></code><span class="koboSpan" id="kobo.83.1">. </span><span class="koboSpan" id="kobo.83.2">The logger command has many options, and it can be a valuable tool when debugging any issues, when wanting to log in a shell script, or when explaining how logging works.</span></p>
<h1 class="heading-1" id="_idParaDest-371"><span class="koboSpan" id="kobo.84.1">The systemd journal</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.85.1">When a system uses </span><code class="inlineCode"><span class="koboSpan" id="kobo.86.1">systemd</span></code><span class="koboSpan" id="kobo.87.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.88.1">journald</span></code><span class="koboSpan" id="kobo.89.1"> takes over the logging side. </span><span class="koboSpan" id="kobo.89.2">When you’re troubleshooting a Linux machine running</span><a id="_idIndexMarker589"/> <code class="inlineCode"><span class="koboSpan" id="kobo.90.1">systemd</span></code><span class="koboSpan" id="kobo.91.1">, this is the first place you should be looking for logs. </span><span class="koboSpan" id="kobo.91.2">By default, journald captures all output from supervised processes. </span><span class="koboSpan" id="kobo.91.3">Anything emitted on </span><code class="inlineCode"><span class="koboSpan" id="kobo.92.1">stderr</span></code><span class="koboSpan" id="kobo.93.1"> is treated as an error. </span><span class="koboSpan" id="kobo.93.2">So, unless the software is configured or hardcoded to log to a location that’s not </span><code class="inlineCode"><span class="koboSpan" id="kobo.94.1">stderr/stdout</span></code><span class="koboSpan" id="kobo.95.1">, you will find the logs in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.96.1">systemd</span></code><span class="koboSpan" id="kobo.97.1"> journal.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.98.1">Logs logged to </span><code class="inlineCode"><span class="koboSpan" id="kobo.99.1">journald</span></code><span class="koboSpan" id="kobo.100.1"> can be queried via the </span><code class="inlineCode"><span class="koboSpan" id="kobo.101.1">journalctl</span></code><span class="koboSpan" id="kobo.102.1"> command. </span><span class="koboSpan" id="kobo.102.2">It provides a means to query based on individual services, time, and system restarts and allows one to use options similar to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.103.1">tail</span></code><span class="koboSpan" id="kobo.104.1"> command. </span><span class="koboSpan" id="kobo.104.2">Let’s jump in and get some practice using </span><code class="inlineCode"><span class="koboSpan" id="kobo.105.1">journalctl</span></code><span class="koboSpan" id="kobo.106.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-372"><span class="koboSpan" id="kobo.107.1">Example journalctl commands</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.108.1">The basics </span><a id="_idIndexMarker590"/><span class="koboSpan" id="kobo.109.1">of working with </span><code class="inlineCode"><span class="koboSpan" id="kobo.110.1">journalctl</span></code><span class="koboSpan" id="kobo.111.1"> are simple. </span><span class="koboSpan" id="kobo.111.2">Think about it; when you’re troubleshooting an application, what do you need to be able to do with its logs?</span></p>
<p class="normal"><span class="koboSpan" id="kobo.112.1">First, you’ll want to be able to find and view the current set of logs. </span><code class="inlineCode"><span class="koboSpan" id="kobo.113.1">journalctl</span></code><span class="koboSpan" id="kobo.114.1"> will give you that, but you’ll quickly realize you didn’t actually want </span><em class="italic"><span class="koboSpan" id="kobo.115.1">all</span></em><span class="koboSpan" id="kobo.116.1"> the logs, just the most recent ones. </span><span class="koboSpan" id="kobo.116.2">So, let’s filter with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.117.1">-n</span></code><span class="koboSpan" id="kobo.118.1"> flag.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.119.1">To get a look at the last 100 log messages in </span><code class="inlineCode"><span class="koboSpan" id="kobo.120.1">journald</span></code><span class="koboSpan" id="kobo.121.1">, try this command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.122.1">journalctl –n 100
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.123.1">This will print out the last 100 lines logged to the system. </span><span class="koboSpan" id="kobo.123.2">You will notice that this is similar to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.124.1">tail</span></code><span class="koboSpan" id="kobo.125.1"> command explained earlier in this book. </span><span class="koboSpan" id="kobo.125.2">If you followed along, these lines will likely contain the “Hello World!” </span><span class="koboSpan" id="kobo.125.3">message from above.</span></p>
<h2 class="heading-2" id="_idParaDest-373"><span class="koboSpan" id="kobo.126.1">Following active logs for a unit</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.127.1">You might </span><a id="_idIndexMarker591"/><span class="koboSpan" id="kobo.128.1">also want to see logs in real time. </span><span class="koboSpan" id="kobo.128.2">For example, following your application logs during startup can help you see exactly when things go wrong:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.129.1">journalctl -fu unitname
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.130.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.131.1">-f</span></code><span class="koboSpan" id="kobo.132.1"> flag stands for “follow,” and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.133.1">-u</span></code><span class="koboSpan" id="kobo.134.1"> flag stands for “unit” – the system unit (or “service”) that you want </span><a id="_idIndexMarker592"/><span class="koboSpan" id="kobo.135.1">to filter logs for.</span></p>
<h2 class="heading-2" id="_idParaDest-374"><span class="koboSpan" id="kobo.136.1">Filtering by time</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.137.1">Even when you</span><a id="_idIndexMarker593"/><span class="koboSpan" id="kobo.138.1"> filter down to a specific unit that you’re interested in, you may still be overwhelmed by the number of logs that match. </span><span class="koboSpan" id="kobo.138.2">Filtering by time can be useful here, especially when you are trying to correlate a known external problem (outage, error, and so on) to the application logs from that moment in time forward. </span><span class="koboSpan" id="kobo.138.3">Use </span><code class="inlineCode"><span class="koboSpan" id="kobo.139.1">--since and --until</span></code><span class="koboSpan" id="kobo.140.1"> for this:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.141.1">journalctl --since "2021-01-01 00:00:00"
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.142.1">You can also use some shorthand for this, like </span><code class="inlineCode"><span class="koboSpan" id="kobo.143.1">today</span></code><span class="koboSpan" id="kobo.144.1">:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.145.1">journalctl --until today
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.146.1">You can also use </span><code class="inlineCode"><span class="koboSpan" id="kobo.147.1">–until</span></code><span class="koboSpan" id="kobo.148.1"> to set an end time for your filter and mix these up to get pretty specific. </span><span class="koboSpan" id="kobo.148.2">For example:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.149.1">journalctl --since "2021-01-01 00:00:00" --until "1 hour ago"
</span></code></pre>
<div class="note">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.150.1">Note</span></strong></p>
<p class="normal"><span class="koboSpan" id="kobo.151.1">One caveat to viewing and filtering logs by time is that you’ll almost always want to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.152.1">--utc</span></code><span class="koboSpan" id="kobo.153.1"> option for </span><code class="inlineCode"><span class="koboSpan" id="kobo.154.1">journalctl</span></code><span class="koboSpan" id="kobo.155.1">, which displays timestamps in UTC. </span><span class="koboSpan" id="kobo.155.2">When you’re helping an ops team troubleshoot an outage, this is almost exclusively done using UTC times to prevent timezone-related confusion.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.156.1">There are additional filters for things like user/group ID.</span></p>
<h2 class="heading-2" id="_idParaDest-375"><span class="koboSpan" id="kobo.157.1">Filtering for a specific log level</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.158.1">If you know</span><a id="_idIndexMarker594"/><span class="koboSpan" id="kobo.159.1"> you’re looking for an error, you can tell </span><code class="inlineCode"><span class="koboSpan" id="kobo.160.1">journalctl</span></code><span class="koboSpan" id="kobo.161.1"> to show you only errors (or any of the other log levels listed at </span><a href="https://wiki.archlinux.org/title/Systemd/Journal#Priority_level"><span class="url"><span class="koboSpan" id="kobo.162.1">https://wiki.archlinux.org/title/Systemd/Journal#Priority_level</span></span></a><span class="koboSpan" id="kobo.163.1"> in descending order of criticality: </span><code class="inlineCode"><span class="koboSpan" id="kobo.164.1">emerg</span></code><span class="koboSpan" id="kobo.165.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.166.1">alert</span></code><span class="koboSpan" id="kobo.167.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.168.1">crit</span></code><span class="koboSpan" id="kobo.169.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.170.1">err</span></code><span class="koboSpan" id="kobo.171.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.172.1">warning</span></code><span class="koboSpan" id="kobo.173.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.174.1">notice</span></code><span class="koboSpan" id="kobo.175.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.176.1">info</span></code><span class="koboSpan" id="kobo.177.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.178.1">debug</span></code><span class="koboSpan" id="kobo.179.1">):</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.180.1">journalctl -p err
</span></code></pre>
<h2 class="heading-2" id="_idParaDest-376"><span class="koboSpan" id="kobo.181.1">Inspecting logs from a previous boot</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.182.1">Sometimes</span><a id="_idIndexMarker595"/><span class="koboSpan" id="kobo.183.1"> things get really wild, and a fault actually causes a reboot. </span><span class="koboSpan" id="kobo.183.2">In those cases, you’ll want to see logs from a previous boot of the system. </span><span class="koboSpan" id="kobo.183.3">You can view all available boots with </span><code class="inlineCode"><span class="koboSpan" id="kobo.184.1">--list-boots</span></code><span class="koboSpan" id="kobo.185.1">, like so:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.186.1">journalctl --list-boots
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.187.1">Then select a specific boot from the list with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.188.1">-b</span></code><span class="koboSpan" id="kobo.189.1"> argument. </span><span class="koboSpan" id="kobo.189.2">In this case, we want the one labeled </span><code class="inlineCode"><span class="koboSpan" id="kobo.190.1">2</span></code><span class="koboSpan" id="kobo.191.1">:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.192.1">journalctl -b –2
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.193.1">By itself, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.194.1">–b</span></code><span class="koboSpan" id="kobo.195.1"> flag means “the current system boot.”</span></p>
<h2 class="heading-2" id="_idParaDest-377"><span class="koboSpan" id="kobo.196.1">Kernel messages</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.197.1">In the</span><a id="_idIndexMarker596"/><span class="koboSpan" id="kobo.198.1"> introduction, we mentioned that system-level log messages are sent by the operating system (“the kernel,” in Linux jargon). </span><span class="koboSpan" id="kobo.198.2">To see just those messages, use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.199.1">--k</span></code><span class="koboSpan" id="kobo.200.1"> (or </span><code class="inlineCode"><span class="koboSpan" id="kobo.201.1">--dmesg</span></code><span class="koboSpan" id="kobo.202.1">, for historical reasons) flag.</span></p>
<h1 class="heading-1" id="_idParaDest-378"><span class="koboSpan" id="kobo.203.1">Logging in Docker containers</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.204.1">In a Docker container, the most</span><a id="_idIndexMarker597"/><span class="koboSpan" id="kobo.205.1"> common way to treat logs is to simply assume that the container’s main process is the one we want output from and that it’s logging to </span><a id="_idIndexMarker598"/><span class="koboSpan" id="kobo.206.1">the standard output (</span><code class="inlineCode"><span class="koboSpan" id="kobo.207.1">stdout</span></code><span class="koboSpan" id="kobo.208.1">). </span><span class="koboSpan" id="kobo.208.2">Container orchestrators (that is, tools like Kubernetes and Nomad), as well as various cloud services that are responsible for executing containers, will assume </span><code class="inlineCode"><span class="koboSpan" id="kobo.209.1">stdout</span></code><span class="koboSpan" id="kobo.210.1"> to be where relevant logs will go and, depending on the configuration, will forward it accordingly. </span><span class="koboSpan" id="kobo.210.2">We will go a bit more into this in the </span><em class="italic"><span class="koboSpan" id="kobo.211.1">Centralized logging</span></em><span class="koboSpan" id="kobo.212.1"> section below.</span></p>
<h1 class="heading-1" id="_idParaDest-379"><span class="koboSpan" id="kobo.213.1">Syslog basics</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.214.1">Compared </span><a id="_idIndexMarker599"/><span class="koboSpan" id="kobo.215.1">to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.216.1">systemd</span></code><span class="koboSpan" id="kobo.217.1">/</span><code class="inlineCode"><span class="koboSpan" id="kobo.218.1">journald</span></code><span class="koboSpan" id="kobo.219.1"> logging we’ve shown you, syslog may seem a bit archaic. </span><span class="koboSpan" id="kobo.219.2">We prefer to think of it as having a </span><em class="italic"><span class="koboSpan" id="kobo.220.1">storied history</span></em><span class="koboSpan" id="kobo.221.1"> – although it’s been around since the 1980s, it’s still a useful, flexible, and widely-used logging tool. </span><span class="koboSpan" id="kobo.221.2">More importantly, you’re almost guaranteed to come across it on real production systems, so it’s worth knowing the basics to avoid being caught off guard during an outage where time is critical.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.222.1">On a Unix-like system, logging to syslog is often equivalent to logging to a file in </span><code class="inlineCode"><span class="koboSpan" id="kobo.223.1">/var/log</span></code><span class="koboSpan" id="kobo.224.1">, with the majority of messages typically going to </span><code class="inlineCode"><span class="koboSpan" id="kobo.225.1">/var/log/messages</span></code><span class="koboSpan" id="kobo.226.1">. </span><span class="koboSpan" id="kobo.226.2">Keep in mind, however, that not everything you find in </span><code class="inlineCode"><span class="koboSpan" id="kobo.227.1">/var/log</span></code><span class="koboSpan" id="kobo.228.1"> necessarily went through syslog. </span><span class="koboSpan" id="kobo.228.2">Various pieces of software also implement their own way of writing log files, skipping the syslog daemon entirely.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.229.1">This works by syslog ingesting all the logs sent to it and depending on various parameters, like the facilities mentioned below, outputting them into a file. </span><span class="koboSpan" id="kobo.229.2">On virtually all systems, the default for this is </span><code class="inlineCode"><span class="koboSpan" id="kobo.230.1">/var/log/messages</span></code><span class="koboSpan" id="kobo.231.1">. </span><span class="koboSpan" id="kobo.231.2">If you followed along and your system uses syslog, then this is also where you’ll find the </span><code class="inlineCode"><span class="koboSpan" id="kobo.232.1">Hello World!</span></code><span class="koboSpan" id="kobo.233.1"> message from above.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.234.1">Syslog is a standardized protocol for logging. </span><span class="koboSpan" id="kobo.234.2">While, at the time of this writing, </span><code class="inlineCode"><span class="koboSpan" id="kobo.235.1">syslogd</span></code><span class="koboSpan" id="kobo.236.1"> mostly deals with log lines, the current standard [</span><code class="inlineCode"><span class="koboSpan" id="kobo.237.1">RFC 5424</span></code><span class="koboSpan" id="kobo.238.1">] also allows for structured logging. </span><span class="koboSpan" id="kobo.238.2">However, since this isn’t widely supported, we will just briefly go over its basic concepts as a protocol for line/message-based logging. </span><span class="koboSpan" id="kobo.238.3">If you don’t interact with syslog at all, feel free to skip this section.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.239.1">As mentioned </span><a id="_idIndexMarker600"/><span class="koboSpan" id="kobo.240.1">earlier, syslog is a protocol. </span><span class="koboSpan" id="kobo.240.2">While it’s most frequently used for software, such as databases that want to log locally, production setups usually have a centralized logging server that logs are shipped to. </span><span class="koboSpan" id="kobo.240.3">Being only a protocol, various software (such as PostgreSQL, nginx, and so on) can emit logs using this protocol, and various logging-related software, like </span><code class="inlineCode"><span class="koboSpan" id="kobo.241.1">Logstash</span></code><span class="koboSpan" id="kobo.242.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.243.1">Loki</span></code><span class="koboSpan" id="kobo.244.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.245.1">syslogd</span></code><span class="koboSpan" id="kobo.246.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.247.1">syslog-ng</span></code><span class="koboSpan" id="kobo.248.1">, and others can ingest its logs. </span><span class="koboSpan" id="kobo.248.2">It usually uses either port 514 (UDP) or port 6514 (TCP).</span></p>
<h2 class="heading-2" id="_idParaDest-380"><span class="koboSpan" id="kobo.249.1">Facilities</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.250.1">Since syslog is a</span><a id="_idIndexMarker601"/><span class="koboSpan" id="kobo.251.1"> very old protocol from the 1980s, some of its concepts might look archaic. </span><span class="koboSpan" id="kobo.251.2">It uses pre-defined </span><em class="italic"><span class="koboSpan" id="kobo.252.1">facilities</span></em><span class="koboSpan" id="kobo.253.1"> to specify the type of log message. </span><span class="koboSpan" id="kobo.253.2">Each facility has its own code:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.254.1">0: </span><code class="inlineCode"><span class="koboSpan" id="kobo.255.1">kern</span></code><span class="koboSpan" id="kobo.256.1"> – Kernel messages.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.257.1">1: </span><code class="inlineCode"><span class="koboSpan" id="kobo.258.1">user</span></code><span class="koboSpan" id="kobo.259.1"> – User-level messages. </span><span class="koboSpan" id="kobo.259.2">These are often used by processes.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.260.1">2: </span><code class="inlineCode"><span class="koboSpan" id="kobo.261.1">mail</span></code><span class="koboSpan" id="kobo.262.1"> – Mail system. </span><span class="koboSpan" id="kobo.262.2">Mostly useful for mail servers, SMTP, IMAP, and POP3. </span><span class="koboSpan" id="kobo.262.3">Spam-related daemons and software usually log here.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.263.1">3: </span><code class="inlineCode"><span class="koboSpan" id="kobo.264.1">daemon</span></code><span class="koboSpan" id="kobo.265.1"> – System daemons. </span><span class="koboSpan" id="kobo.265.2">Daemons, especially ones related to the OS (such as for NTP), log here.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.266.1">4: </span><code class="inlineCode"><span class="koboSpan" id="kobo.267.1">auth</span></code><span class="koboSpan" id="kobo.268.1"> – Security/authentication messages. </span><span class="koboSpan" id="kobo.268.2">You will typically find login attempts, for example, locally, via SSH, but also for various other services here.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.269.1">5: </span><code class="inlineCode"><span class="koboSpan" id="kobo.270.1">syslog</span></code><span class="koboSpan" id="kobo.271.1"> – Messages generated internally by </span><code class="inlineCode"><span class="koboSpan" id="kobo.272.1">syslogd</span></code><span class="koboSpan" id="kobo.273.1">. </span><span class="koboSpan" id="kobo.273.2">These will be messages related to syslog itself.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.274.1">6: </span><code class="inlineCode"><span class="koboSpan" id="kobo.275.1">lpr</span></code><span class="koboSpan" id="kobo.276.1"> – Line printer subsystem. </span><span class="koboSpan" id="kobo.276.2">Printer-related logs.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.277.1">7: </span><code class="inlineCode"><span class="koboSpan" id="kobo.278.1">news</span></code><span class="koboSpan" id="kobo.279.1"> – Network news subsystem. </span><span class="koboSpan" id="kobo.279.2">This is historical, and not typically used anymore.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.280.1">8: </span><code class="inlineCode"><span class="koboSpan" id="kobo.281.1">uucp</span></code><span class="koboSpan" id="kobo.282.1"> – UUCP subsystem. </span><span class="koboSpan" id="kobo.282.2">This is historical, and not typically used anymore.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.283.1">9: </span><code class="inlineCode"><span class="koboSpan" id="kobo.284.1">cron</span></code><span class="koboSpan" id="kobo.285.1"> – Cron subsystem. </span><span class="koboSpan" id="kobo.285.2">Logs related to cron jobs. </span><span class="koboSpan" id="kobo.285.3">These can be very useful for debugging cron jobs.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.286.1">10: </span><code class="inlineCode"><span class="koboSpan" id="kobo.287.1">authpriv</span></code><span class="koboSpan" id="kobo.288.1"> – Security/authentication messages. </span><span class="koboSpan" id="kobo.288.2">This is similar to </span><code class="inlineCode"><span class="koboSpan" id="kobo.289.1">auth</span></code><span class="koboSpan" id="kobo.290.1"> but is usually considered to be logged to a more restricted set of destinations. </span><span class="koboSpan" id="kobo.290.2">Most Linux software logs here instead of auth.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.291.1">11: </span><code class="inlineCode"><span class="koboSpan" id="kobo.292.1">ftp</span></code><span class="koboSpan" id="kobo.293.1"> – FTP daemon. </span><span class="koboSpan" id="kobo.293.2">Mostly historical. </span><span class="koboSpan" id="kobo.293.3">Logs for FTP servers.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.294.1">12: </span><code class="inlineCode"><span class="koboSpan" id="kobo.295.1">ntp</span></code><span class="koboSpan" id="kobo.296.1"> – NTP subsystem. </span><span class="koboSpan" id="kobo.296.2">Logs for</span><a id="_idIndexMarker602"/><span class="koboSpan" id="kobo.297.1"> the </span><strong class="keyWord"><span class="koboSpan" id="kobo.298.1">Network Time Protocol</span></strong><span class="koboSpan" id="kobo.299.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.300.1">NTP</span></strong><span class="koboSpan" id="kobo.301.1">), so clock synchronization.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.302.1">13: </span><code class="inlineCode"><span class="koboSpan" id="kobo.303.1">security</span></code><span class="koboSpan" id="kobo.304.1"> – Log audit. </span><span class="koboSpan" id="kobo.304.2">Security-related events.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.305.1">14: </span><code class="inlineCode"><span class="koboSpan" id="kobo.306.1">console</span></code><span class="koboSpan" id="kobo.307.1"> – Log alert. </span><span class="koboSpan" id="kobo.307.2">Messages related to the “local console.”</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.308.1">15: </span><code class="inlineCode"><span class="koboSpan" id="kobo.309.1">solaris-cron</span></code><span class="koboSpan" id="kobo.310.1"> – Clock daemon.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.311.1">16 to 23: </span><code class="inlineCode"><span class="koboSpan" id="kobo.312.1">local0</span></code><span class="koboSpan" id="kobo.313.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.314.1">local7</span></code><span class="koboSpan" id="kobo.315.1"> – Locally used facilities, meaning local software. </span><span class="koboSpan" id="kobo.315.2">PostgreSQL, for </span><a id="_idIndexMarker603"/><span class="koboSpan" id="kobo.316.1">example, logs to </span><code class="inlineCode"><span class="koboSpan" id="kobo.317.1">local0</span></code><span class="koboSpan" id="kobo.318.1"> per default when logging to syslog.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.319.1">On many systems, you’ll find files in </span><code class="inlineCode"><span class="koboSpan" id="kobo.320.1">/var/log/</span></code><span class="koboSpan" id="kobo.321.1"> that are named similarly to these facilities. </span><span class="koboSpan" id="kobo.321.2">So, for example, if you need to debug a cron job on a system not using journald, you’ll likely find the output in </span><code class="inlineCode"><span class="koboSpan" id="kobo.322.1">/var/log/cron</span></code><span class="koboSpan" id="kobo.323.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.324.1">/var/cron/log</span></code><span class="koboSpan" id="kobo.325.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.326.1">/var/log/messages</span></code><span class="koboSpan" id="kobo.327.1">, or similar.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.328.1">Keep in mind that what exactly is logged in each facility is not standardized. </span><span class="koboSpan" id="kobo.328.2">You will likely come across situations where different operating systems or similar software might not agree on which facility to log to.</span></p>
<h2 class="heading-2" id="_idParaDest-381"><span class="koboSpan" id="kobo.329.1">Severity levels</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.330.1">This is a </span><a id="_idIndexMarker604"/><span class="koboSpan" id="kobo.331.1">concept you are probably more familiar with. </span><span class="koboSpan" id="kobo.331.2">Messages come with a severity of one of seven different levels:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.332.1">0: </span><code class="inlineCode"><span class="koboSpan" id="kobo.333.1">emerg</span></code><span class="koboSpan" id="kobo.334.1"> – Emergency</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.335.1">0: </span><code class="inlineCode"><span class="koboSpan" id="kobo.336.1">alert</span></code><span class="koboSpan" id="kobo.337.1"> – Alert</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.338.1">0: </span><code class="inlineCode"><span class="koboSpan" id="kobo.339.1">crit</span></code><span class="koboSpan" id="kobo.340.1"> – Critical</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.341.1">0: </span><code class="inlineCode"><span class="koboSpan" id="kobo.342.1">err</span></code><span class="koboSpan" id="kobo.343.1"> – Error</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.344.1">0: </span><code class="inlineCode"><span class="koboSpan" id="kobo.345.1">warning</span></code><span class="koboSpan" id="kobo.346.1"> – Warning</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.347.1">0: </span><code class="inlineCode"><span class="koboSpan" id="kobo.348.1">notice</span></code><span class="koboSpan" id="kobo.349.1"> – Notice</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.350.1">0: </span><code class="inlineCode"><span class="koboSpan" id="kobo.351.1">info</span></code><span class="koboSpan" id="kobo.352.1"> – Informational</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.353.1">0: </span><code class="inlineCode"><span class="koboSpan" id="kobo.354.1">debug</span></code><span class="koboSpan" id="kobo.355.1"> – Debug</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.356.1">As with facilities, what</span><a id="_idIndexMarker605"/><span class="koboSpan" id="kobo.357.1"> exactly constitutes each severity level depends on the software used.</span></p>
<h2 class="heading-2" id="_idParaDest-382"><span class="koboSpan" id="kobo.358.1">Configuration and implementations</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.359.1">Syslog has many</span><a id="_idIndexMarker606"/><span class="koboSpan" id="kobo.360.1"> implementations. </span><span class="koboSpan" id="kobo.360.2">These typically allow you to configure filtering, and </span><a id="_idIndexMarker607"/><span class="koboSpan" id="kobo.361.1">save and forward messages based on facilities and severity levels. </span><span class="koboSpan" id="kobo.361.2">Some systems come with a service called </span><code class="inlineCode"><span class="koboSpan" id="kobo.362.1">syslogd</span></code><span class="koboSpan" id="kobo.363.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.364.1">rsyslog</span></code><span class="koboSpan" id="kobo.365.1">, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.366.1">syslog-ng</span></code><span class="koboSpan" id="kobo.367.1">, which can be configured in </span><code class="inlineCode"><span class="koboSpan" id="kobo.368.1">/etc/syslog.conf</span></code><span class="koboSpan" id="kobo.369.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.370.1">/etc/syslog-ng/</span></code><span class="koboSpan" id="kobo.371.1">. </span><span class="koboSpan" id="kobo.371.2">Loki, Logstash, and other distributed log management tools have their own respective ways of configuring logging, usually in a three-fold structure, with one place to define input, another to filter and transform, and a third to store or forward the output.</span></p>
<h1 class="heading-1" id="_idParaDest-383"><span class="koboSpan" id="kobo.372.1">Tips for logging</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.373.1">Everyone does logging a bit </span><a id="_idIndexMarker608"/><span class="koboSpan" id="kobo.374.1">differently and what is considered best practice can vary across projects and time. </span><span class="koboSpan" id="kobo.374.2">However, there are some things you should be aware of.</span></p>
<h2 class="heading-2" id="_idParaDest-384"><span class="koboSpan" id="kobo.375.1">Keywords when using structured logging</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.376.1">When using any kind of structured logging, try to make sure to share common keywords, such as request and user IDs, while also trying to avoid conflicting keywords used for similar, but not exactly the same, things. </span><span class="koboSpan" id="kobo.376.2">Depending on the backing database, you might also run into issues with types here, for example, in a situation where </span><code class="inlineCode"><span class="koboSpan" id="kobo.377.1">user</span></code><span class="koboSpan" id="kobo.378.1"> might be the key for an integer, a string, or its own nested structure, like a JSON object.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.379.1">Sometimes it’s possible to avoid any overlaps by creating per-service namespaces and keeping a list of “globally used” keys, along with definitions for them.</span></p>
<h2 class="heading-2" id="_idParaDest-385"><span class="koboSpan" id="kobo.380.1">Severity</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.381.1">When developing</span><a id="_idIndexMarker609"/><span class="koboSpan" id="kobo.382.1"> software, it makes sense to have some internal document explaining which severity has which meaning. </span><span class="koboSpan" id="kobo.382.2">This avoids situations where failed login attempts to a publicly reachable service, or 404 error codes from crawlers requesting obsolete websites, raise an alarm and wake a colleague in the middle of the night. </span><span class="koboSpan" id="kobo.382.3">But even if that’s not the case, it can make debugging and being aware of problems a lot easier.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.383.1">For this reason, it’s a good idea to clearly distinguish between the following:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.384.1">Situations that </span><em class="italic"><span class="koboSpan" id="kobo.385.1">might</span></em><span class="koboSpan" id="kobo.386.1"> indicate a problem</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.387.1">Situations that should not happen, but </span><em class="italic"><span class="koboSpan" id="kobo.388.1">can</span></em><span class="koboSpan" id="kobo.389.1"> happen</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.390.1">Situations that clearly indicate a bug or more severe problem</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.391.1">Logs have the tendency to become more complex as software grows and services get added, so it’s a good investment to be clear about what to log and when from the very beginning.</span></p>
<h1 class="heading-1" id="_idParaDest-386"><span class="koboSpan" id="kobo.392.1">Centralized logging</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.393.1">In a corporate setting, it is </span><a id="_idIndexMarker610"/><span class="koboSpan" id="kobo.394.1">typical to centralize logs. </span><span class="koboSpan" id="kobo.394.2">This makes it easier to</span><a id="_idIndexMarker611"/><span class="koboSpan" id="kobo.395.1"> connect the dots when debugging issues. </span><span class="koboSpan" id="kobo.395.2">It also means that in a distributed application, not every log on each physical or virtual machine or container has to be looked at individually. </span><span class="koboSpan" id="kobo.395.3">These centralized logging services typically make it easy and fast to query large amounts of logs, especially when the company uses structured logging and services adhere to a uniform log structure.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.396.1">These logging services are either their own products, such as rsyslog, Loki, the ELK stack (Elastic Search, Logstash, and Kibana), and Graylog, or they are managed services. </span><span class="koboSpan" id="kobo.396.2">These can, for example, be the hosted variants of the services we just mentioned or cloud-specific logging solutions, such as Google’s operations suite (formerly known as Stackdriver), AWS CloudWatch, or Azure Monitor. </span><span class="koboSpan" id="kobo.396.3">There are many similarities between these systems in that they provide mechanisms to “ship” logs from files or via some kind of API, filter and restructure them, and eventually, save them into final storage, ready to be queried.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.397.1">In microservice architectures, it’s common to pass along context, such as a request ID, so a request from a client can easily be traced through the various services, which is essential for debugging architectures that involve many services.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.398.1">As mentioned, most of these systems have mechanisms to ship logs to the central log server or cluster. </span><span class="koboSpan" id="kobo.398.2">They go by names like Logstash (the L in ELK stack) and Promtail (used with Loki) and typically provide multiple ways of ingesting logs. </span><span class="koboSpan" id="kobo.398.3">For example, they might be configured to create an HTTP server, act as a syslog server, tap into journald, read from any other log shipping services, use cloud APIs, or simply tail files. </span><span class="koboSpan" id="kobo.398.4">They are run either as additional daemons on systems, as a Pod in Kubernetes, or as part of a Nomad setup. </span><span class="koboSpan" id="kobo.398.5">Since they are meant to allow centralizing logs no matter what software is in use, they tend to allow for a variety of log inputs and are typically very flexible on the setup side – for example, allowing one to create a hierarchy by forwarding between individual log-shipping services. </span><span class="koboSpan" id="kobo.398.6">On container orchestrators like Kubernetes and Nomad, this is often implemented with a “sidecar container” that runs next to your application containers and captures logs from all containers in that Pod/allocation/node before shipping them to their destination.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.399.1"><img alt="" role="presentation" src="../Images/B19251_16_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.400.1">Figure 16.1: Container orchestration with a sidecar container</span></p>
<p class="normal"><span class="koboSpan" id="kobo.401.1">As you can see, while there</span><a id="_idIndexMarker612"/><span class="koboSpan" id="kobo.402.1"> are many technologies and products surrounding</span><a id="_idIndexMarker613"/><span class="koboSpan" id="kobo.403.1"> logging, they all fall into at least one of the categories described above, so when you centralize logging in your environment, this should give you an idea of how the parts relate to each other.</span></p>
<h1 class="heading-1" id="_idParaDest-387"><span class="koboSpan" id="kobo.404.1">Conclusion</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.405.1">Logging can be a moving target in modern production environments. </span><span class="koboSpan" id="kobo.405.2">Learning and experimenting with the basics covered in this chapter should give you a good foundation. </span><span class="koboSpan" id="kobo.405.3">It is our hope that getting comfortable with syslog and journalctl will also equip you with a low-level understanding and historical perspective that will make it easier for you to work out how tomorrow’s logging-as-a-service solution actually works under the covers.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.406.1">We think you’ll find that the skills you learned in this chapter give you a practical, measurable advantage when it comes to designing, debugging, and optimizing the applications you create and deploy. </span><span class="koboSpan" id="kobo.406.2">Mastering the basics of journald, as you just saw, lets you swiftly diagnose and pinpoint issues, whether they are related to your application specifically or to the larger Linux system around it. </span><span class="koboSpan" id="kobo.406.3">Having some understanding of alternative and historical Linux logging approaches will help when you’re troubleshooting systems (or people) that haven’t been updated in a long time.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.407.1">It’s not just about solving issues; it’s also about making your life easier and your work better. </span><span class="koboSpan" id="kobo.407.2">Plus, it’s a skill that makes you stand out. </span><span class="koboSpan" id="kobo.407.3">In short, knowing your way around Linux logs makes you a smarter, more effective developer.</span></p>
<h1 class="heading-1"><span class="koboSpan" id="kobo.408.1">Learn more on Discord</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.409.1">To join the Discord community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</span></p>
<p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.410.1">https://packt.link/SecNet</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.411.1"><img alt="" role="presentation" src="../Images/QR_Code1768422420210094187.png"/></span></p>
</div>
</body></html>