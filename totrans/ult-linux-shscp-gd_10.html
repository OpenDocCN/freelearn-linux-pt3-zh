<html><head></head><body>
  <div id="_idContainer149" class="Basic-Text-Frame">
    <h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">10</span></h1>
    <h1 id="_idParaDest-244" class="chapterTitle"><span class="koboSpan" id="kobo.2.1">Understanding Functions</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.3.1">Functions are an important component of pretty much every modern programming language. </span><span class="koboSpan" id="kobo.3.2">They’re simply blocks of code that each perform one specific task. </span><span class="koboSpan" id="kobo.3.3">The cool thing about them is that they allow programmers to reuse code. </span><span class="koboSpan" id="kobo.3.4">That is, one block of code can be called either from within a program in various places, or it can be called by various different programs from function libraries. </span><span class="koboSpan" id="kobo.3.5">In this chapter, I’ll show you the basics about using functions in shell scripts.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.4.1">Topics in this chapter include:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.5.1">Introduction to functions</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.6.1">Defining a function</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.7.1">Using functions in shell scripts</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.8.1">Creating function libraries</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.9.1">Looking at some real-world examples</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.10.1">If you’re ready, let’s get started.</span></p>
    <h1 id="_idParaDest-245" class="heading 1"><span class="koboSpan" id="kobo.11.1">Technical Requirements</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.12.1">Use any of your Linux virtual machines or your Linux host machine.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.13.1">Also, as always, you can grab the scripts and text files from Github, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.14.1">git clone https://github.com/PacktPublishing/The-Ultimate-Linux-Shell-Scripting-Guide.git
</span></code></pre>
    <h1 id="_idParaDest-246" class="heading 1"><span class="koboSpan" id="kobo.15.1">Introduction to Functions</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.16.1">As I’ve mentioned above, a function</span><a id="_idIndexMarker693"/><span class="koboSpan" id="kobo.17.1"> is a block of programming code that performs a specific task. </span><span class="koboSpan" id="kobo.17.2">What makes functions so cool is that they really cut down on the amount of code that you have to type. </span><span class="koboSpan" id="kobo.17.3">Instead of having to type in the same code every time you want to perform a task, you can just call the function, instead. </span><span class="koboSpan" id="kobo.17.4">This cuts down on the size of your scripts, and makes typing the script much less prone to error. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.18.1">Also, after a function has been called the first time, it resides in system memory, which can enhance the performance of your scripts.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.19.1">You can create functions that accept parameters from the main program, that return values to the main program, or that might do some stand-alone task that doesn’t involve either passing parameters or passing values. </span><span class="koboSpan" id="kobo.19.2">Learning to create functions is easy, because for the most part you’re just using the same coding techniques that I’ve already shown you. </span><span class="koboSpan" id="kobo.19.3">I mean, yeah, there are some new things that you’ll have to learn, but there’s really nothing hard about any of it.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.20.1">If you’re running Linux on your workstation, you’re already using a lot of functions without realizing it. </span><span class="koboSpan" id="kobo.20.2">To see the functions that your system is running, just run a </span><code class="inlineCode"><span class="koboSpan" id="kobo.21.1">declare -F </span></code><span class="koboSpan" id="kobo.22.1">command, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.23.1">[donnie@fedora ~]$ declare -F
declare -f __expand_tilde_by_ref
declare -f __fzf_comprun
declare -f __fzf_defc
. </span><span class="koboSpan" id="kobo.23.2">. </span><span class="koboSpan" id="kobo.23.3">.
</span><span class="koboSpan" id="kobo.23.4">. </span><span class="koboSpan" id="kobo.23.5">. </span><span class="koboSpan" id="kobo.23.6">.
</span><span class="koboSpan" id="kobo.23.7">declare -f gawkpath_prepend
declare -f quote
declare -f quote_readline
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.24.1">These functions are loaded into system memory by the shell every time you log into your computer, and are used by the various utilities that make up the </span><code class="inlineCode"><span class="koboSpan" id="kobo.25.1">bash</span></code><span class="koboSpan" id="kobo.26.1"> ecosystem.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.27.1">Running </span><code class="inlineCode"><span class="koboSpan" id="kobo.28.1">declare</span></code><span class="koboSpan" id="kobo.29.1"> with a lower case </span><code class="inlineCode"><span class="koboSpan" id="kobo.30.1">-f</span></code><span class="koboSpan" id="kobo.31.1"> also shows you the code for each function. </span><span class="koboSpan" id="kobo.31.2">You can also list the name of a function to only see the code for it, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.32.1">[donnie@fedora ~]$ declare -f __expand_tilde_by_ref
__expand_tilde_by_ref ()
{
    if [[ ${!1-} == \~* ]]; then
        eval $1="$(printf ~%q "${!1#\~}")";
    fi
}
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.33.1">To see where these functions</span><a id="_idIndexMarker694"/><span class="koboSpan" id="kobo.34.1"> are defined, you’ll need to enter debugger mode and then use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.35.1">declare -F</span></code><span class="koboSpan" id="kobo.36.1"> command, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.37.1">[donnie@fedora ~]$ bash --debugger
[donnie@fedora ~]$ declare -F __expand_tilde_by_ref
__expand_tilde_by_ref 1069 /usr/share/bash-completion/bash_completion
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.38.1">So, you see that this function is defined on line number 1069 of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.39.1">bash_completion</span></code><span class="koboSpan" id="kobo.40.1"> function library file that’s in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.41.1">/usr/share/bash-completion/</span></code><span class="koboSpan" id="kobo.42.1"> directory. </span><span class="koboSpan" id="kobo.42.2">Go ahead and peek into that file, and you’ll see that many functions are defined in it. </span><span class="koboSpan" id="kobo.42.3">When you’re through with debugger mode, just type </span><code class="inlineCode"><span class="koboSpan" id="kobo.43.1">exit</span></code><span class="koboSpan" id="kobo.44.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.45.1">You can also obtain information about a function with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.46.1">type</span></code><span class="koboSpan" id="kobo.47.1"> command, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.48.1">[donnie@fedora ~]$ type quote
quote is a function
quote ()
{
    local quoted=${1//\'/\'\\\'\'};
    printf "'%s'" "$quoted"
}
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.49.1">Now that you know</span><a id="_idIndexMarker695"/><span class="koboSpan" id="kobo.50.1"> what functions are, let’s see if we can define some.</span></p>
    <h1 id="_idParaDest-247" class="heading 1"><span class="koboSpan" id="kobo.51.1">Defining a Function</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.52.1">You can define a function in the following places:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.53.1">On the command-line</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.54.1">In a shell script</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.55.1">In a function library</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.56.1">In a shell configuration file</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.57.1">Defining a function from</span><a id="_idIndexMarker696"/><span class="koboSpan" id="kobo.58.1"> the command-line can be useful if you need to do any quick testing or experimentation with new code. </span><span class="koboSpan" id="kobo.58.2">Here’s what it looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.59.1">[donnie@fedora ~]$ howdy() { echo "Howdy, world!" </span><span class="koboSpan" id="kobo.59.2">; echo "How's it going?"; }
[donnie@fedora ~]$ howdy
Howdy, world!
</span><span class="koboSpan" id="kobo.59.3">How's it going?
</span><span class="koboSpan" id="kobo.59.4">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.60.1">The name of this function is </span><code class="inlineCode"><span class="koboSpan" id="kobo.61.1">howdy</span></code><span class="koboSpan" id="kobo.62.1">, and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.63.1">()</span></code><span class="koboSpan" id="kobo.64.1"> tells the shell that this is a function. </span><span class="koboSpan" id="kobo.64.2">The code for the function is within the pair of curly braces. </span><span class="koboSpan" id="kobo.64.3">The function consists of two </span><code class="inlineCode"><span class="koboSpan" id="kobo.65.1">echo</span></code><span class="koboSpan" id="kobo.66.1"> commands, which are separated by a semi-colon. </span><span class="koboSpan" id="kobo.66.2">Note that you need to place another semi-colon at the end of the final command. </span><span class="koboSpan" id="kobo.66.3">You also need to have one blank space between the first curly brace and the first command, and the final semi-colon and the closing curly brace.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.67.1">Some tutorials that you’ll find might tell you that you can begin the function with the keyword </span><code class="inlineCode"><span class="koboSpan" id="kobo.68.1">function</span></code><span class="koboSpan" id="kobo.69.1">, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.70.1">[donnie@fedora ~]$ function howdy() { echo "Howdy, world!" </span><span class="koboSpan" id="kobo.70.2">; echo "How's it going?"; }
[donnie@fedora ~]$ howdy
Howdy, world!
</span><span class="koboSpan" id="kobo.70.3">How's it going?
</span><span class="koboSpan" id="kobo.70.4">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.71.1">But, creating functions without the </span><code class="inlineCode"><span class="koboSpan" id="kobo.72.1">function</span></code><span class="koboSpan" id="kobo.73.1"> keyword works well, so there’s no real reason to use it.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.74.1">Be aware that using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.75.1">function</span></code><span class="koboSpan" id="kobo.76.1"> keyword is a really bad idea, because it’s not portable. </span><span class="koboSpan" id="kobo.76.2">I mean, it works on </span><code class="inlineCode"><span class="koboSpan" id="kobo.77.1">bash</span></code><span class="koboSpan" id="kobo.78.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.79.1">zsh</span></code><span class="koboSpan" id="kobo.80.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.81.1">ash</span></code><span class="koboSpan" id="kobo.82.1">, but it doesn’t work on </span><code class="inlineCode"><span class="koboSpan" id="kobo.83.1">ksh</span></code><span class="koboSpan" id="kobo.84.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.85.1">dash</span></code><span class="koboSpan" id="kobo.86.1">, or Bourne Shell. </span><span class="koboSpan" id="kobo.86.2">Even where you can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.87.1">function</span></code><span class="koboSpan" id="kobo.88.1"> keyword, it serves no real purpose. </span><span class="koboSpan" id="kobo.88.2">So, your best bet is to just never use it.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.89.1">Any functions that you define on the command line will be ephemeral and will disappear as soon as you close the terminal. </span><span class="koboSpan" id="kobo.89.2">So, you’ll want to commit them to a file to make them permanent. </span><span class="koboSpan" id="kobo.89.3">Also, any functions that you define on the command-line will not be visible in a </span><code class="inlineCode"><span class="koboSpan" id="kobo.90.1">bash --debug</span></code><span class="koboSpan" id="kobo.91.1"> session, because they don’t get exported to a child shell.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.92.1">There’s no difference in how you would create a function in shell scripts, function library files, and shell configuration files. </span><span class="koboSpan" id="kobo.92.2">But, there a couple of different methods for how you structure your functions.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.93.1">The first method is to place the entire function on a single line, with or without the preceding </span><code class="inlineCode"><span class="koboSpan" id="kobo.94.1">function</span></code><span class="koboSpan" id="kobo.95.1"> keyword. </span><span class="koboSpan" id="kobo.95.2">This would look exactly as it would if you were to create a function on the command-line. </span><span class="koboSpan" id="kobo.95.3">Since you’ve already seen that, I’ll say no more about it.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.96.1">The other method</span><a id="_idIndexMarker697"/><span class="koboSpan" id="kobo.97.1"> is to structure your functions in a multi-line format, as you would do in other programming languages such as C or Java. </span><span class="koboSpan" id="kobo.97.2">This is really your best bet, because it makes your code much more readable and less prone to error. </span><span class="koboSpan" id="kobo.97.3">A quick way to see how that looks is to view the single-line </span><code class="inlineCode"><span class="koboSpan" id="kobo.98.1">howdy</span></code><span class="koboSpan" id="kobo.99.1"> function that I just created on the command-line with </span><code class="inlineCode"><span class="koboSpan" id="kobo.100.1">declare -f</span></code><span class="koboSpan" id="kobo.101.1">, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.102.1">[donnie@fedora ~]$ declare -f howdy
howdy ()
{
    echo "Howdy, world!";
    echo "How's it going?"
</span><span class="koboSpan" id="kobo.102.2">}
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.103.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.104.1">declare -f</span></code><span class="koboSpan" id="kobo.105.1"> command automatically converts the function that I entered on the command-line into multi-line format. </span><span class="koboSpan" id="kobo.105.2">If I wanted to, I could just copy and paste this into a shell script file. </span><span class="koboSpan" id="kobo.105.3">In fact, I think I will copy it into a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.106.1">howdy_func.sh</span></code><span class="koboSpan" id="kobo.107.1"> script. </span><span class="koboSpan" id="kobo.107.2">Here’s what it will look like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.108.1">#!/bin/bash
howdy ()
{
    echo "Howdy, world!";
    echo "How's it going?"
</span><span class="koboSpan" id="kobo.108.2">}
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.109.1">As before, the preceding </span><code class="inlineCode"><span class="koboSpan" id="kobo.110.1">function</span></code><span class="koboSpan" id="kobo.111.1"> keyword is optional. </span><span class="koboSpan" id="kobo.111.2">I’ve chosen to omit it, since it serves no function and isn’t compatible with some non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.112.1">bash</span></code><span class="koboSpan" id="kobo.113.1"> shells.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.114.1">Okay, this all looks good, but watch what happens</span><a id="_idIndexMarker698"/><span class="koboSpan" id="kobo.115.1"> when I run the script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.116.1">[donnie@fedora ~]$ ./howdy_func.sh
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.117.1">Nothing happens, which isn’t good. </span><span class="koboSpan" id="kobo.117.2">I’ll show you why in the next section.</span></p>
    <h1 id="_idParaDest-248" class="heading 1"><span class="koboSpan" id="kobo.118.1">Using Functions in Shell Scripts</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.119.1">You’ll be amazed</span><a id="_idIndexMarker699"/><span class="koboSpan" id="kobo.120.1"> at how functions</span><a id="_idIndexMarker700"/><span class="koboSpan" id="kobo.121.1"> can make your shell scripts so much more </span><em class="italic"><span class="koboSpan" id="kobo.122.1">functional</span></em><span class="koboSpan" id="kobo.123.1">. </span><span class="koboSpan" id="kobo.123.2">(Yeah, I know. </span><span class="koboSpan" id="kobo.123.3">That really was a bad pun.) Read on to see how to make that happen.</span></p>
    <h2 id="_idParaDest-249" class="heading 2"><span class="koboSpan" id="kobo.124.1">Creating and Calling Functions</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.125.1">When you place a function</span><a id="_idIndexMarker701"/><span class="koboSpan" id="kobo.126.1"> inside a shell script, the function code won’t get executed</span><a id="_idIndexMarker702"/><span class="koboSpan" id="kobo.127.1"> until you call the function. </span><span class="koboSpan" id="kobo.127.2">Let’s modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.128.1">howdy_func.sh</span></code><span class="koboSpan" id="kobo.129.1"> script to make that happen, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.130.1">#!/bin/bash
howdy ()
{
    echo "Howdy, world!";
    echo "How's it going?"
</span><span class="koboSpan" id="kobo.130.2">}
howdy
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.131.1">You see that all I had to do was to place the name of the function outside of the function code block. </span><span class="koboSpan" id="kobo.131.2">Also, note that the function definition must come before the function call. </span><span class="koboSpan" id="kobo.131.3">Otherwise, the shell will never be able to find the function. </span><span class="koboSpan" id="kobo.131.4">Anyway, when I run the script now, it works fine:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.132.1">[donnie@fedora ~]$ ./howdy_func.sh
Howdy, world!
</span><span class="koboSpan" id="kobo.132.2">How's it going?
</span><span class="koboSpan" id="kobo.132.3">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.133.1">I should also point out that the first curly brace can be on a line by itself as you see above, or it can be on the same line as the function name, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.134.1">#!/bin/bash
howdy() {
        echo "Howdy, world!"
        </span><span class="koboSpan" id="kobo.134.2">echo "How's it going?"
</span><span class="koboSpan" id="kobo.134.3">}
howdy
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.135.1">I personally prefer this way for a simple reason. </span><span class="koboSpan" id="kobo.135.2">It’s just that my preferred text editor is </span><code class="inlineCode"><span class="koboSpan" id="kobo.136.1">vim</span></code><span class="koboSpan" id="kobo.137.1">, and placing the first curly brace on the same line as the function name causes </span><code class="inlineCode"><span class="koboSpan" id="kobo.138.1">vim</span></code><span class="koboSpan" id="kobo.139.1"> to activate its automatic indenting feature.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.140.1">The ability to reuse code is one of the coolest features about functions. </span><span class="koboSpan" id="kobo.140.2">Instead of having to type the same code in every place where you need to perform a certain task, just type it once and call it from wherever you need to. </span><span class="koboSpan" id="kobo.140.3">Let’s make another slight modification to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.141.1">howdy_func.sh</span></code><span class="koboSpan" id="kobo.142.1"> script, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.143.1">#!/bin/bash
howdy ()
{
    echo "Howdy, world!";
    echo "How's it going?"
</span><span class="koboSpan" id="kobo.143.2">}
howdy
echo
echo "Let's do some more stuff and then"
echo "we'll call the function again."
</span><span class="koboSpan" id="kobo.143.3">echo
howdy
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.144.1">Here’s what running the modified script looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.145.1">[donnie@fedora ~]$ ./howdy_func.sh
Howdy, world!
</span><span class="koboSpan" id="kobo.145.2">How's it going?
</span><span class="koboSpan" id="kobo.145.3">Let's do some more stuff and then
we'll call the function again.
</span><span class="koboSpan" id="kobo.145.4">Howdy, world!
</span><span class="koboSpan" id="kobo.145.5">How's it going?
</span><span class="koboSpan" id="kobo.145.6">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.146.1">So, I called the function</span><a id="_idIndexMarker703"/><span class="koboSpan" id="kobo.147.1"> twice, and it got executed</span><a id="_idIndexMarker704"/><span class="koboSpan" id="kobo.148.1"> twice. </span><span class="koboSpan" id="kobo.148.2">How cool is that? </span><span class="koboSpan" id="kobo.148.3">But, it gets even better.</span></p>
    <h2 id="_idParaDest-250" class="heading 2"><span class="koboSpan" id="kobo.149.1">Passing Positional Parameters to Functions</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.150.1">You can also pass positional parameters</span><a id="_idIndexMarker705"/><span class="koboSpan" id="kobo.151.1"> into a function, the same as you can pass them into a shell script. </span><span class="koboSpan" id="kobo.151.2">To do that, call the function with a value that you want to pass as a positional parameter, as you see here in this </span><code class="inlineCode"><span class="koboSpan" id="kobo.152.1">greet_func.sh</span></code><span class="koboSpan" id="kobo.153.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.154.1">#!/bin/bash
greetings() {
        echo "Greetings, $1"
}
greetings Donnie
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.155.1">You see the </span><code class="inlineCode"><span class="koboSpan" id="kobo.156.1">$1</span></code><span class="koboSpan" id="kobo.157.1"> positional parameter in the function. </span><span class="koboSpan" id="kobo.157.2">When I call the function, I’m passing the value </span><code class="inlineCode"><span class="koboSpan" id="kobo.158.1">Donnie</span></code><span class="koboSpan" id="kobo.159.1"> into the function. </span><span class="koboSpan" id="kobo.159.2">Here’s what happens when I run the script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.160.1">[donnie@fedora ~]$ ./greet_func.sh
Greetings, Donnie
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.161.1">You can also pass the positional parameter into the script as you normally would, and then pass it into the function, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.162.1">#!/bin/bash
greetings() {
        echo "Greetings, $1"
}
greetings $1
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.163.1">Here’s what happens when I run this script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.164.1">[donnie@fedora ~]$ ./greet_func2.sh Frank
Greetings, Frank
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.165.1">That’s good, but it only works</span><a id="_idIndexMarker706"/><span class="koboSpan" id="kobo.166.1"> with one parameter. </span><span class="koboSpan" id="kobo.166.2">Any additional names that you pass in as parameters won’t show up in the output. </span><span class="koboSpan" id="kobo.166.3">You can fix that by defining additional parameters, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.167.1">#!/bin/bash
greetings() {
        echo "Greetings, $1 $2"
}
greetings $1 $2
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.168.1">And, that’s fine if you know that you’ll always want to pass in a specified number of parameters. </span><span class="koboSpan" id="kobo.168.2">If you don’t want to limit yourself like this, use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.169.1">$@</span></code><span class="koboSpan" id="kobo.170.1"> as the positional parameter. </span><span class="koboSpan" id="kobo.170.2">That way, you can pass in however many parameters you want each time that you run the script. </span><span class="koboSpan" id="kobo.170.3">Here’s what it looks like:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.171.1">#!/bin/bash
greetings() {
        echo "Greetings, $@"
}
greetings $@
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.172.1">Let’s see what it looks like when I pass in four names:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.173.1">[donnie@fedora ~]$ ./greet_func4.sh Vicky Cleopatra Frank Charlie
Greetings, Vicky Cleopatra Frank Charlie
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.174.1">That looks good. </span><span class="koboSpan" id="kobo.174.2">But, I can still fancy it up a bit, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.175.1">[donnie@fedora ~]$ ./greet_func4.sh Vicky, Cleopatra, Frank, "and Charlie"!
</span><span class="koboSpan" id="kobo.175.2">Greetings, Vicky, Cleopatra, Frank, and Charlie!
</span><span class="koboSpan" id="kobo.175.3">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.176.1">Pretty slick, eh? </span><span class="koboSpan" id="kobo.176.2">What’s even more slick</span><a id="_idIndexMarker707"/><span class="koboSpan" id="kobo.177.1"> is having a function pass values back to the main program.</span></p>
    <h2 id="_idParaDest-251" class="heading 2"><span class="koboSpan" id="kobo.178.1">Passing Values from a Function</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.179.1">Okay, here’s where I need to pause</span><a id="_idIndexMarker708"/><span class="koboSpan" id="kobo.180.1"> for a moment and clarify something for the veterans of other programming languages. </span><span class="koboSpan" id="kobo.180.2">Unlike what you may be used to with other languages, a shell scripting function cannot </span><em class="italic"><span class="koboSpan" id="kobo.181.1">directly</span></em><span class="koboSpan" id="kobo.182.1"> return a value to its caller, which is normally the main body of the program.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.183.1">Okay, there is a </span><code class="inlineCode"><span class="koboSpan" id="kobo.184.1">return</span></code><span class="koboSpan" id="kobo.185.1"> command</span><a id="_idIndexMarker709"/><span class="koboSpan" id="kobo.186.1"> that you can use in a function, but it’s not the same as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.187.1">return</span></code><span class="koboSpan" id="kobo.188.1"> command in other languages. </span><span class="koboSpan" id="kobo.188.2">In shell scripts, the only thing that you can pass with </span><code class="inlineCode"><span class="koboSpan" id="kobo.189.1">return</span></code><span class="koboSpan" id="kobo.190.1"> is just the exit status of a command.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.191.1">You can create a function</span><a id="_idIndexMarker710"/><span class="koboSpan" id="kobo.192.1"> that will return</span><a id="_idIndexMarker711"/><span class="koboSpan" id="kobo.193.1"> a value, but you have to do it with either a </span><strong class="keyWord"><span class="koboSpan" id="kobo.194.1">global variable</span></strong><span class="koboSpan" id="kobo.195.1"> or a combination of a </span><strong class="keyWord"><span class="koboSpan" id="kobo.196.1">local variable</span></strong><span class="koboSpan" id="kobo.197.1"> and command substitution. </span><span class="koboSpan" id="kobo.197.2">Another difference is that in other languages, variables are local by default, and you have to specify which variables are to be global. </span><span class="koboSpan" id="kobo.197.3">In shell scripting, it’s just the opposite. </span><span class="koboSpan" id="kobo.197.4">Shell scripting variables are global by default, and you have to specify which variables are to be local.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.198.1">Now, for those of you who aren’t veterans of other programming languages, allow me to explain the difference between local and global variables.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.199.1">A global variable can be accessed from anywhere in a script, even if you defined it within a function. </span><span class="koboSpan" id="kobo.199.2">For example, look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.200.1">valuepass</span></code><span class="koboSpan" id="kobo.201.1"> function in this </span><code class="inlineCode"><span class="koboSpan" id="kobo.202.1">value1.sh</span></code><span class="koboSpan" id="kobo.203.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.204.1">#/bin/bash
valuepass() {
        textstring='Donnie is the great BeginLinux Guru'
}
valuepass
echo $textstring
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.205.1">Here’s what happens when I run the script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.206.1">donnie@debian12:~$ ./value1.sh
Donnie is the great BeginLinux Guru
donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.207.1">In this script, you see that the function does nothing except to define the global </span><code class="inlineCode"><span class="koboSpan" id="kobo.208.1">textstring </span></code><span class="koboSpan" id="kobo.209.1">variable and set its value. </span><span class="koboSpan" id="kobo.209.2">The value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.210.1">textstring</span></code><span class="koboSpan" id="kobo.211.1"> is available outside of the function, which means that after calling the function, I can then echo back the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.212.1">textstring</span></code><span class="koboSpan" id="kobo.213.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.214.1">Now, let’s define </span><code class="inlineCode"><span class="koboSpan" id="kobo.215.1">textstring</span></code><span class="koboSpan" id="kobo.216.1"> as a local variable in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.217.1">value2.sh</span></code><span class="koboSpan" id="kobo.218.1"> script, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.219.1">#/bin/bash
valuepass() {
        local textstring='Donnie is the great BeginLinux Guru'
}
valuepass
echo $textstring
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.220.1">Watch what happens when I run the script this time:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.221.1">donnie@debian12:~$ ./value2.sh
donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.222.1">There’s no output this time, because the local variable isn’t accessible outside of the function. </span><span class="koboSpan" id="kobo.222.2">Or, more accurately, the local variable isn’t </span><em class="italic"><span class="koboSpan" id="kobo.223.1">directly</span></em><span class="koboSpan" id="kobo.224.1"> accessible outside of the function. </span><span class="koboSpan" id="kobo.224.2">There are ways to make the function pass the value of a local variable to an external caller, which I’ll show you in just a few moments.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.225.1">First though, I want answer a question that I know you’re anxious to ask. </span><span class="koboSpan" id="kobo.225.2">That is, if we can use a global variable to pass a value outside of a function, why do we need local variables? </span><span class="koboSpan" id="kobo.225.3">Well, it’s just that if you use nothing but global variables in your functions, you could turn your script into a debugging nightmare. </span><span class="koboSpan" id="kobo.225.4">That’s because if you accidentally create a variable outside of the function with the same name as a global variable that’s inside of the function, you would overwrite the value of the variable from within the function.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.226.1">By using only local variables</span><a id="_idIndexMarker712"/><span class="koboSpan" id="kobo.227.1"> inside of functions, you avoid that problem. </span><span class="koboSpan" id="kobo.227.2">If you have an external variable that has the same name as a local variable that’s in a function, the external variable won’t overwrite the internal variable’s value. </span><span class="koboSpan" id="kobo.227.3">To demo this, let’s create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.228.1">value3.sh</span></code><span class="koboSpan" id="kobo.229.1"> script, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.230.1">#/bin/bash
valuepass() {
        textstring='Donnie is the great BeginLinux Guru'
}
valuepass
echo $textstring
textstring='Who is the great BeginLinux Guru?'
</span><span class="koboSpan" id="kobo.230.2">echo $textstring
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.231.1">You see that I’ve set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.232.1">textstring</span></code><span class="koboSpan" id="kobo.233.1"> variable in the function back to a global variable, and I’ve defined the variable again outside of the function. </span><span class="koboSpan" id="kobo.233.2">Here’s what happens when I run the script now:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.234.1">donnie@debian12:~$ ./value3.sh
Donnie is the great BeginLinux Guru
Who is the great BeginLinux Guru?
</span><span class="koboSpan" id="kobo.234.2">donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.235.1">The second </span><code class="inlineCode"><span class="koboSpan" id="kobo.236.1">echo $textstring</span></code><span class="koboSpan" id="kobo.237.1"> command used the new value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.238.1">textstring</span></code><span class="koboSpan" id="kobo.239.1">, which overwrote the previous value. </span><span class="koboSpan" id="kobo.239.2">That’s fine if that’s what you want to happen, but it usually isn’t what you want to happen.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.240.1">One way to have a function pass</span><a id="_idIndexMarker713"/><span class="koboSpan" id="kobo.241.1"> a value with a local variable is to call the function from within a command substitution construct. </span><span class="koboSpan" id="kobo.241.2">To demo that, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.242.1">value4.sh</span></code><span class="koboSpan" id="kobo.243.1"> script, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.244.1">#!/bin/bash
valuepass() {
        local textstring='Donnie is the great BeginLinux Guru'
        echo "$textstring"
}
result=$(valuepass)
echo $result
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.245.1">You see here that I’ve created the external </span><code class="inlineCode"><span class="koboSpan" id="kobo.246.1">result</span></code><span class="koboSpan" id="kobo.247.1"> variable, and assigned to it the value that was obtained by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.248.1">$(valuepass)</span></code><span class="koboSpan" id="kobo.249.1"> command substitution.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.250.1">Another method for obtaining a value</span><a id="_idIndexMarker714"/><span class="koboSpan" id="kobo.251.1"> from a function is to use a </span><strong class="keyWord"><span class="koboSpan" id="kobo.252.1">result variable</span></strong><span class="koboSpan" id="kobo.253.1">. </span><span class="koboSpan" id="kobo.253.2">This involves passing the </span><em class="italic"><span class="koboSpan" id="kobo.254.1">name</span></em><span class="koboSpan" id="kobo.255.1"> of a variable into the function when you call it, and then assigning a value to that variable inside the function. </span><span class="koboSpan" id="kobo.255.2">Let’s look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.256.1">value5.sh</span></code><span class="koboSpan" id="kobo.257.1"> script to see how that works:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.258.1">#/bin/bash
valuepass() {
        local __internalvar=$1
        local myresult='Shell scripting is cool!'
        </span><span class="koboSpan" id="kobo.258.2">eval $__internalvar="'$myresult'"
}
valuepass result
echo $result
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.259.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.260.1">valuepass result</span></code><span class="koboSpan" id="kobo.261.1"> command calls the function and passes the name of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.262.1">result</span></code><span class="koboSpan" id="kobo.263.1"> variable into the function, via the </span><code class="inlineCode"><span class="koboSpan" id="kobo.264.1">$1</span></code><span class="koboSpan" id="kobo.265.1"> positional parameter. </span><span class="koboSpan" id="kobo.265.2">Understand though, that </span><code class="inlineCode"><span class="koboSpan" id="kobo.266.1">result</span></code><span class="koboSpan" id="kobo.267.1"> still doesn’t have an assigned value, so the only thing that you’re passing into the function is just the name of the variable, and nothing else.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.268.1">Up to this point, you’ve only seen positional parameters used to pass values into the script when you invoke the script. </span><span class="koboSpan" id="kobo.268.2">Here, you seen how positional parameters can also be used to pass values from the main body of a script into a function.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.269.1">Inside the function, this variable name is represented by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.270.1">$1</span></code><span class="koboSpan" id="kobo.271.1"> positional parameter. </span><span class="koboSpan" id="kobo.271.2">This variable name is assigned as the value of the local </span><code class="inlineCode"><span class="koboSpan" id="kobo.272.1">__internalvar</span></code><span class="koboSpan" id="kobo.273.1"> variable. </span><span class="koboSpan" id="kobo.273.2">The next line assigns </span><code class="inlineCode"><span class="koboSpan" id="kobo.274.1">Shell scripting is cool!</span></code><span class="koboSpan" id="kobo.275.1"> as the value of the local </span><code class="inlineCode"><span class="koboSpan" id="kobo.276.1">myresult</span></code><span class="koboSpan" id="kobo.277.1"> variable. </span><span class="koboSpan" id="kobo.277.2">In the final line, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.278.1">eval</span></code><span class="koboSpan" id="kobo.279.1"> command sets the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.280.1">$myresult</span></code><span class="koboSpan" id="kobo.281.1"> as the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.282.1">$__internalvar</span></code><span class="koboSpan" id="kobo.283.1"> variable.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.284.1">Remember that the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.285.1">__internalvar</span></code><span class="koboSpan" id="kobo.286.1"> variable is </span><code class="inlineCode"><span class="koboSpan" id="kobo.287.1">result</span></code><span class="koboSpan" id="kobo.288.1">, which is the name of the variable that we passed into the function. </span><span class="koboSpan" id="kobo.288.2">Also, be aware that this is now a global variable, because I didn’t specify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.289.1">local</span></code><span class="koboSpan" id="kobo.290.1"> keyword here. </span><span class="koboSpan" id="kobo.290.2">This means that its value can be passed back to the main body of the script.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.291.1">So now, </span><code class="inlineCode"><span class="koboSpan" id="kobo.292.1">$__internalvar</span></code><span class="koboSpan" id="kobo.293.1"> is really the </span><code class="inlineCode"><span class="koboSpan" id="kobo.294.1">result</span></code><span class="koboSpan" id="kobo.295.1"> variable with </span><code class="inlineCode"><span class="koboSpan" id="kobo.296.1">Shell scripting is cool!</span></code><span class="koboSpan" id="kobo.297.1"> as its assigned value.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.298.1">Understand though, that you don’t want the variable</span><a id="_idIndexMarker715"/><span class="koboSpan" id="kobo.299.1"> name that you pass into a function to be the same as the name of the local variable that’s inside the function. </span><span class="koboSpan" id="kobo.299.2">Otherwise, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.300.1">eval</span></code><span class="koboSpan" id="kobo.301.1"> command won’t be able to properly set the value of the variable. </span><span class="koboSpan" id="kobo.301.2">That’s why I prefaced the name of the local variable with a pair of underscores, so that I can be sure to prevent having a variable with the same name outside of the function. </span><span class="koboSpan" id="kobo.301.3">(Of course, only one underscore would have sufficed, but the accepted</span><a id="_idIndexMarker716"/><span class="koboSpan" id="kobo.302.1"> convention is to use two underscores.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.303.1">Next, let’s create some libraries.</span></p>
    <h1 id="_idParaDest-252" class="heading 1"><span class="koboSpan" id="kobo.304.1">Creating Function Libraries</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.305.1">For a convenient way to make your functions</span><a id="_idIndexMarker717"/><span class="koboSpan" id="kobo.306.1"> reusable, just place them into a function library. </span><span class="koboSpan" id="kobo.306.2">Then, from within your scripts, call the desired libraries with either a </span><code class="inlineCode"><span class="koboSpan" id="kobo.307.1">source</span></code><span class="koboSpan" id="kobo.308.1"> command or a dot command. </span><span class="koboSpan" id="kobo.308.2">If you’re the only one who will ever use the libraries, you can place them in your own home directory.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.309.1">If you want to make them available for everyone, you can place them in a central location, such as in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.310.1">/usr/local/lib/</span></code><span class="koboSpan" id="kobo.311.1"> directory.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.312.1">For a simple demonstration, I’ve created the </span><code class="inlineCode"><span class="koboSpan" id="kobo.313.1">donnie_library</span></code><span class="koboSpan" id="kobo.314.1"> file in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.315.1">/usr/local/lib/</span></code><span class="koboSpan" id="kobo.316.1"> directory with two simple functions. </span><span class="koboSpan" id="kobo.316.2">It looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.317.1">howdy_world() {
echo "Howdy, world!"
</span><span class="koboSpan" id="kobo.317.2">echo "How's it going?"
</span><span class="koboSpan" id="kobo.317.3">}
howdy_georgia() {
echo "Howdy, Georgia!"
</span><span class="koboSpan" id="kobo.317.4">echo "How's it going?"
</span><span class="koboSpan" id="kobo.317.5">}
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.318.1">(I live in the state of Georgia, which explains the second function.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.319.1">There’s no need to set the executable permission on this file, because it only contains code that will be called in by an executable script.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.320.1">Next, I created the </span><code class="inlineCode"><span class="koboSpan" id="kobo.321.1">library_demo1.sh</span></code><span class="koboSpan" id="kobo.322.1"> script, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.323.1">#!/bin/bash
source /usr/local/lib/donnie_library
howdy_world
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.324.1">You see that I used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.325.1">source</span></code><span class="koboSpan" id="kobo.326.1"> command to reference the </span><code class="inlineCode"><span class="koboSpan" id="kobo.327.1">donnie_library</span></code><span class="koboSpan" id="kobo.328.1"> file. </span><span class="koboSpan" id="kobo.328.2">I then called the </span><code class="inlineCode"><span class="koboSpan" id="kobo.329.1">howdy_world</span></code><span class="koboSpan" id="kobo.330.1"> function as I would normally do. </span><span class="koboSpan" id="kobo.330.2">Running the script looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.331.1">[donnie@fedora ~]$ ./library_demo1.sh
Howdy, world!
</span><span class="koboSpan" id="kobo.331.2">How's it going?
</span><span class="koboSpan" id="kobo.331.3">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.332.1">I also created the </span><code class="inlineCode"><span class="koboSpan" id="kobo.333.1">library_demo2.sh</span></code><span class="koboSpan" id="kobo.334.1"> file, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.335.1">#!/bin/bash
. </span><span class="koboSpan" id="kobo.335.2">/usr/local/lib/donnie_library
howdy_georgia
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.336.1">This time I replaced the </span><code class="inlineCode"><span class="koboSpan" id="kobo.337.1">source</span></code><span class="koboSpan" id="kobo.338.1"> command</span><a id="_idIndexMarker718"/><span class="koboSpan" id="kobo.339.1"> with a dot, to show you that they both do the exact same thing.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.340.1">Be aware that using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.341.1">source</span></code><span class="koboSpan" id="kobo.342.1"> keyword works on </span><code class="inlineCode"><span class="koboSpan" id="kobo.343.1">ash</span></code><span class="koboSpan" id="kobo.344.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.345.1">ksh</span></code><span class="koboSpan" id="kobo.346.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.347.1">zsh</span></code><span class="koboSpan" id="kobo.348.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.349.1">bash</span></code><span class="koboSpan" id="kobo.350.1">, but it doesn’t work on certain other shells, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.351.1">dash</span></code><span class="koboSpan" id="kobo.352.1"> or Bourne. </span><span class="koboSpan" id="kobo.352.2">If you need your scripts to run on as many shells as possible, you’ll need to use the dot, and avoid using </span><code class="inlineCode"><span class="koboSpan" id="kobo.353.1">source</span></code><span class="koboSpan" id="kobo.354.1">.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.355.1">I then called the second function in the library file. </span><span class="koboSpan" id="kobo.355.2">Running this script looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.356.1">[donnie@fedora ~]$ ./library_demo2.sh
Howdy, Georgia!
</span><span class="koboSpan" id="kobo.356.2">How's it going?
</span><span class="koboSpan" id="kobo.356.3">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.357.1">For something a bit more practical, let’s add a network checking function, using a </span><code class="inlineCode"><span class="koboSpan" id="kobo.358.1">case..esac</span></code><span class="koboSpan" id="kobo.359.1"> construct. </span><span class="koboSpan" id="kobo.359.2">Unfortunately, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.360.1">donnie_library</span></code><span class="koboSpan" id="kobo.361.1"> file is now too large to show you here in the book, but you can download it from the Github repository. </span><span class="koboSpan" id="kobo.361.2">Still though, I do want to point out one thing about this </span><code class="inlineCode"><span class="koboSpan" id="kobo.362.1">case..esac</span></code><span class="koboSpan" id="kobo.363.1"> construct, which you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.364.1">network() {
site="$1"
case "$site" in
"")
        site="google.com"
;;
*)
        site="$1"
;;
esac
. </span><span class="koboSpan" id="kobo.364.2">. </span><span class="koboSpan" id="kobo.364.3">.
</span><span class="koboSpan" id="kobo.364.4">. </span><span class="koboSpan" id="kobo.364.5">. </span><span class="koboSpan" id="kobo.364.6">.
</span><span class="koboSpan" id="kobo.364.7">}
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.365.1">Note how for the first condition I used a </span><code class="inlineCode"><span class="koboSpan" id="kobo.366.1">"")</span></code><span class="koboSpan" id="kobo.367.1"> construct. </span><span class="koboSpan" id="kobo.367.2">The pair of double-quotes, with no blank space between them, means that no value has been passed in for the positional parameter. </span><span class="koboSpan" id="kobo.367.3">This also means that </span><code class="inlineCode"><span class="koboSpan" id="kobo.368.1">google.com</span></code><span class="koboSpan" id="kobo.369.1"> will be used as the default site name.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.370.1">Now, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.371.1">library_demo3.sh</span></code><span class="koboSpan" id="kobo.372.1"> script that uses this new function looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.373.1">#!/bin/bash
. </span><span class="koboSpan" id="kobo.373.2">/usr/local/lib/donnie_library
network $1
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.374.1">Running the script without supplying an argument looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.375.1">[donnie@fedora ~]$ ./libary_demo3.sh
2023-10-27 . </span><span class="koboSpan" id="kobo.375.2">. </span><span class="koboSpan" id="kobo.375.3">. </span><span class="koboSpan" id="kobo.375.4">Success! </span><span class="koboSpan" id="kobo.375.5">google.com is reachable.
</span><span class="koboSpan" id="kobo.375.6">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.376.1">Here’s how it looks when I supply a valid</span><a id="_idIndexMarker719"/><span class="koboSpan" id="kobo.377.1"> site name as the argument:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.378.1">[donnie@fedora ~]$ ./libary_demo3.sh www.civicsandpolitics.com
2023-10-27 . </span><span class="koboSpan" id="kobo.378.2">. </span><span class="koboSpan" id="kobo.378.3">. </span><span class="koboSpan" id="kobo.378.4">Success! </span><span class="koboSpan" id="kobo.378.5">www.civicsandpolitics.com is reachable.
</span><span class="koboSpan" id="kobo.378.6">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.379.1">And finally, here’s what I get when I supply an invalid site name:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.380.1">[donnie@fedora ~]$ ./libary_demo3.sh www.donnie.com
ping: www.donnie.com: Name or service not known
2023-10-27 . </span><span class="koboSpan" id="kobo.380.2">. </span><span class="koboSpan" id="kobo.380.3">. </span><span class="koboSpan" id="kobo.380.4">Network Failure for site www.donnie.com!
</span><span class="koboSpan" id="kobo.380.5">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.381.1">I know, it’s a crying shame that there’s no website that’s named after me. </span><span class="koboSpan" id="kobo.381.2">(I might have to correct</span><a id="_idIndexMarker720"/><span class="koboSpan" id="kobo.382.1"> that problem some day.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.383.1">And, guess what? </span><span class="koboSpan" id="kobo.383.2">That’s really all I have to say about function libraries. </span><span class="koboSpan" id="kobo.383.3">Let’s move on to the real world.</span></p>
    <h1 id="_idParaDest-253" class="heading 1"><span class="koboSpan" id="kobo.384.1">Looking at Some Real-World Examples</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.385.1">Here are a few cool examples of functions in action. </span><span class="koboSpan" id="kobo.385.2">Enjoy!</span></p>
    <h2 id="_idParaDest-254" class="heading 2"><span class="koboSpan" id="kobo.386.1">Checking Network Connectivity</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.387.1">This function is essentially</span><a id="_idIndexMarker721"/><span class="koboSpan" id="kobo.388.1"> the same as the one that I’ve just shown you in the previous section. </span><span class="koboSpan" id="kobo.388.2">The only real difference is that I’m using an </span><code class="inlineCode"><span class="koboSpan" id="kobo.389.1">if..then</span></code><span class="koboSpan" id="kobo.390.1"> construct instead of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.391.1">case..esac</span></code><span class="koboSpan" id="kobo.392.1"> construct. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.393.1">Also, I placed this function into the actual executable script. </span><span class="koboSpan" id="kobo.393.2">But, you can easily move it into a library file if you desire. </span><span class="koboSpan" id="kobo.393.3">(I can’t show you the entire script here due to book formatting constraints, but you can download it from the Github repository. </span><span class="koboSpan" id="kobo.393.4">It’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.394.1">network_func.sh</span></code><span class="koboSpan" id="kobo.395.1"> file.) Anyway, here’s the important part that I really want you to see:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.396.1">#!/bin/bash
network() {
if [[ $# -eq 0 ]]; then
        site="google.com"
else
        site="$1"
fi
. </span><span class="koboSpan" id="kobo.396.2">. </span><span class="koboSpan" id="kobo.396.3">.
</span><span class="koboSpan" id="kobo.396.4">. </span><span class="koboSpan" id="kobo.396.5">. </span><span class="koboSpan" id="kobo.396.6">.
</span><span class="koboSpan" id="kobo.396.7">}
network
network www.civicsandpolitics.com
network donnie.com
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.397.1">You see that after I defined the </span><code class="inlineCode"><span class="koboSpan" id="kobo.398.1">network()</span></code><span class="koboSpan" id="kobo.399.1"> function, I called it three different times. </span><span class="koboSpan" id="kobo.399.2">I first called it without a positional parameter, so that it would ping </span><code class="inlineCode"><span class="koboSpan" id="kobo.400.1">google.com</span></code><span class="koboSpan" id="kobo.401.1">. </span><span class="koboSpan" id="kobo.401.2">I then called it with another real website and then with a fake website as the positional parameter. </span><span class="koboSpan" id="kobo.401.3">Here’s what I get when I run this new script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.402.1">[donnie@fedora ~]$ ./network_func.sh
2023-10-27 . </span><span class="koboSpan" id="kobo.402.2">. </span><span class="koboSpan" id="kobo.402.3">. </span><span class="koboSpan" id="kobo.402.4">Success for google.com!
</span><span class="koboSpan" id="kobo.402.5">2023-10-27 . </span><span class="koboSpan" id="kobo.402.6">. </span><span class="koboSpan" id="kobo.402.7">. </span><span class="koboSpan" id="kobo.402.8">Success for www.civicsandpolitics.com!
</span><span class="koboSpan" id="kobo.402.9">ping: donnie.com: Name or service not known
2023-10-27 . </span><span class="koboSpan" id="kobo.402.10">. </span><span class="koboSpan" id="kobo.402.11">. </span><span class="koboSpan" id="kobo.402.12">Network Failure for donnie.com!
</span><span class="koboSpan" id="kobo.402.13">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.403.1">That part works. </span><span class="koboSpan" id="kobo.403.2">Let’s now look in the system log file to see if the </span><code class="inlineCode"><span class="koboSpan" id="kobo.404.1">logger</span></code><span class="koboSpan" id="kobo.405.1"> utility that’s in the function actually made the appropriate log entries:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.406.1">[donnie@fedora ~]$ sudo tail /var/log/messages
. </span><span class="koboSpan" id="kobo.406.2">. </span><span class="koboSpan" id="kobo.406.3">.
</span><span class="koboSpan" id="kobo.406.4">. </span><span class="koboSpan" id="kobo.406.5">. </span><span class="koboSpan" id="kobo.406.6">.
</span><span class="koboSpan" id="kobo.406.7">Oct 27 16:14:21 fedora donnie[38134]: google.com is reachable.
</span><span class="koboSpan" id="kobo.406.8">Oct 27 16:14:23 fedora donnie[38137]: www.civicsandpolitics.com is reachable.
</span><span class="koboSpan" id="kobo.406.9">Oct 27 16:14:23 fedora donnie[38140]: Could not reach donnie.com.
</span><span class="koboSpan" id="kobo.406.10">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.407.1">Yeah, that part works</span><a id="_idIndexMarker722"/><span class="koboSpan" id="kobo.408.1"> too. </span><span class="koboSpan" id="kobo.408.2">So once again, we have achieved coolness. </span><span class="koboSpan" id="kobo.408.3">(Of course, you can also modify the script so that you can supply your own positional parameter as an argument. </span><span class="koboSpan" id="kobo.408.4">I’ll leave it to you to do that.)</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.409.1">Be aware that I tested this script on a Fedora machine, which still uses the old-style </span><code class="inlineCode"><span class="koboSpan" id="kobo.410.1">rsyslog</span></code><span class="koboSpan" id="kobo.411.1"> log files. </span><span class="koboSpan" id="kobo.411.2">If you try this on Debian, you’ll need to install </span><code class="inlineCode"><span class="koboSpan" id="kobo.412.1">rsyslog</span></code><span class="koboSpan" id="kobo.413.1"> yourself. </span><span class="koboSpan" id="kobo.413.2">By default, Debian 12 now only uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.414.1">journald</span></code><span class="koboSpan" id="kobo.415.1"> logging system, and doesn’t come with </span><code class="inlineCode"><span class="koboSpan" id="kobo.416.1">rsyslog</span></code><span class="koboSpan" id="kobo.417.1"> installed.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.418.1">Next, is a little something that I whipped up for myself.</span></p>
    <h2 id="_idParaDest-255" class="heading 2"><span class="koboSpan" id="kobo.419.1">Using the CoinGecko API</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.420.1">CoinGecko is a cool website</span><a id="_idIndexMarker723"/><span class="koboSpan" id="kobo.421.1"> where you can go to check on the prices and statistics of pretty</span><a id="_idIndexMarker724"/><span class="koboSpan" id="kobo.422.1"> much every cryptocurrency there is. </span><span class="koboSpan" id="kobo.422.2">It’s fairly quick to use if you just need to check on one coin, but it can be fairly time-consuming if you need to check on multiple coins.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.423.1">You can create a custom portfolio of coins, which is useful if you always want to see the same list of coins. </span><span class="koboSpan" id="kobo.423.2">But, it’s not so useful if you always want to check on different lists of coins. </span><span class="koboSpan" id="kobo.423.3">So, you might like to streamline the process a bit. </span><span class="koboSpan" id="kobo.423.4">For that, you can create a shell script</span><a id="_idIndexMarker725"/><span class="koboSpan" id="kobo.424.1"> that uses the CoinGecko </span><strong class="keyWord"><span class="koboSpan" id="kobo.425.1">Application Programming Interface</span></strong><span class="koboSpan" id="kobo.426.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.427.1">API</span></strong><span class="koboSpan" id="kobo.428.1">).</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.429.1">To take full advantage of all of the CoinGecko API features, you’ll need to become a paying customer, which is rather expensive. </span><span class="koboSpan" id="kobo.429.2">Fortunately, you don’t need to do that for this demo. </span><span class="koboSpan" id="kobo.429.3">Instead, you’ll just use CoinGecko’s public API key, which is free-of-charge. </span><span class="koboSpan" id="kobo.429.4">To demo this, let’s do a hands-on lab.</span></p>
    <h3 id="_idParaDest-256" class="heading 3"><span class="koboSpan" id="kobo.430.1">Hands-on Lab – Creating the coingecko.sh Script</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.431.1">To begin, take a look at CoinGecko’s documentation page (</span><span class="url"><span class="koboSpan" id="kobo.432.1">https://www.coingecko.com/api/documentation)</span></span><span class="koboSpan" id="kobo.433.1">, and follow these steps as mentioned below:</span></p>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.434.1">Scroll down the page, and</span><a id="_idIndexMarker726"/><span class="koboSpan" id="kobo.435.1"> you’ll see a list of the various functions that you can perform with the public API. </span><span class="koboSpan" id="kobo.435.2">You can use the forms in the drop-down lists to create the code that you’ll copy into a shell script. </span><span class="koboSpan" id="kobo.435.3">I’ve already created the </span><code class="inlineCode"><span class="koboSpan" id="kobo.436.1">coingecko.sh</span></code><span class="koboSpan" id="kobo.437.1"> shell script that performs three of those functions, which you can download from the Github repository. </span><span class="koboSpan" id="kobo.437.2">Before you use it though, you’ll need to ensure that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.438.1">curl</span></code><span class="koboSpan" id="kobo.439.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.440.1">jq</span></code><span class="koboSpan" id="kobo.441.1"> packages are installed on your system. </span><span class="koboSpan" id="kobo.441.2">Anyway, here’s how the script works.</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.442.1">At the top of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.443.1">gecko_api</span></code><span class="koboSpan" id="kobo.444.1"> function, I defined the </span><code class="inlineCode"><span class="koboSpan" id="kobo.445.1">coin</span></code><span class="koboSpan" id="kobo.446.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.447.1">currency</span></code><span class="koboSpan" id="kobo.448.1"> variables as positional parameters </span><code class="inlineCode"><span class="koboSpan" id="kobo.449.1">$1</span></code><span class="koboSpan" id="kobo.450.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.451.1">$2</span></code><span class="koboSpan" id="kobo.452.1">. </span><span class="koboSpan" id="kobo.452.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.453.1">if [ -z $coin ]; then</span></code><span class="koboSpan" id="kobo.454.1"> line checks to see if the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.455.1">coin</span></code><span class="koboSpan" id="kobo.456.1"> is zero length. </span><span class="koboSpan" id="kobo.456.2">If it is, it means that I haven’t entered any arguments when I invoked the script. </span><span class="koboSpan" id="kobo.456.3">So, it will then echo a series of statements about how to invoke the script.</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.457.1">Next, you see this </span><code class="inlineCode"><span class="koboSpan" id="kobo.458.1">elif</span></code><span class="koboSpan" id="kobo.459.1"> stanza:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.460.1">elif [ $coin == list ]; then
        curl -X 'GET' \ 
"https://api.coingecko.com/api/v3/coins/list?include_platform=true" \
  -H 'accept: application/json' | jq | tee coinlist.txt
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.461.1">I copied this </span><code class="inlineCode"><span class="koboSpan" id="kobo.462.1">curl</span></code><span class="koboSpan" id="kobo.463.1"> command from the CoinGecko documentation page, and pasted it into the script.</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.464.1">Then, I piped the output into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.465.1">jq</span></code><span class="koboSpan" id="kobo.466.1"> utility to convert the normal </span><strong class="keyWord"><span class="koboSpan" id="kobo.467.1">json</span></strong><span class="koboSpan" id="kobo.468.1"> output to </span><strong class="keyWord"><span class="koboSpan" id="kobo.469.1">pretty json</span></strong><span class="koboSpan" id="kobo.470.1"> format.</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.471.1">I then piped that output</span><a id="_idIndexMarker727"/><span class="koboSpan" id="kobo.472.1"> into </span><code class="inlineCode"><span class="koboSpan" id="kobo.473.1">tee</span></code><span class="koboSpan" id="kobo.474.1"> in order to both view the output on screen and save it to a text file. </span><span class="koboSpan" id="kobo.474.2">Invoking the script with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.475.1">list</span></code><span class="koboSpan" id="kobo.476.1"> argument will download the entire list of coins that are supported by the API. </span><span class="koboSpan" id="kobo.476.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.477.1">elif</span></code><span class="koboSpan" id="kobo.478.1"> construct in the next stanza is the same as this </span><code class="inlineCode"><span class="koboSpan" id="kobo.479.1">elif</span></code><span class="koboSpan" id="kobo.480.1"> construct, except that it will show a list of </span><em class="italic"><span class="koboSpan" id="kobo.481.1">versus currencies</span></em><span class="koboSpan" id="kobo.482.1"> that you can use for pricing the coins.</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.483.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.484.1">else</span></code><span class="koboSpan" id="kobo.485.1"> construct in the final stanza of the function requires you to enter both a coin and a versus currency as arguments. </span><span class="koboSpan" id="kobo.485.2">The original code from the documentation page contained the actual names of the coin and versus currency that I entered into the form on the documentation page. </span><span class="koboSpan" id="kobo.485.3">I changed them to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.486.1">$coin</span></code><span class="koboSpan" id="kobo.487.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.488.1">$currency</span></code><span class="koboSpan" id="kobo.489.1"> variables, respectively. </span><span class="koboSpan" id="kobo.489.2">I then had to change the pair of single quotes that surround the URL with a pair of double quotes, so that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.490.1">$</span></code><span class="koboSpan" id="kobo.491.1"> in the variable names would be interpreted correctly.</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.492.1">Let’s say that you want to check the price of Bitcoin in US dollars. </span><span class="koboSpan" id="kobo.492.2">First, open the </span><code class="inlineCode"><span class="koboSpan" id="kobo.493.1">coinlist.txt</span></code><span class="koboSpan" id="kobo.494.1"> file that you created when you ran the </span><code class="inlineCode"><span class="koboSpan" id="kobo.495.1">./coingecko list</span></code><span class="koboSpan" id="kobo.496.1"> command. </span><span class="koboSpan" id="kobo.496.2">Search for Bitcoin, and you’ll find a stanza that looks like this:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.497.1">{
    "id": "bitcoin",
    "symbol": "btc",
    "name": "Bitcoin",
    "platforms": {}
  },
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.498.1">Next, open the </span><code class="inlineCode"><span class="koboSpan" id="kobo.499.1">currency_list.txt</span></code><span class="koboSpan" id="kobo.500.1"> that you created when you ran the </span><code class="inlineCode"><span class="koboSpan" id="kobo.501.1">./coingecko currencies</span></code><span class="koboSpan" id="kobo.502.1"> command. </span><span class="koboSpan" id="kobo.502.2">Scroll down until you find the versus currency that you want to use to price your particular coin or coins. </span><span class="koboSpan" id="kobo.502.3">Now, to view the price of your coin(s) in your desired currency, enter the </span><code class="inlineCode"><span class="koboSpan" id="kobo.503.1">"id:"</span></code><span class="koboSpan" id="kobo.504.1"> value for the coin from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.505.1">coinlist.txt</span></code><span class="koboSpan" id="kobo.506.1"> file as the first argument, and the desired versus currency as the second argument, like this:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.507.1">[donnie@fedora ~]$ ./coingecko.sh bitcoin usd
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   157    0   157    0     0    876      0 --:--:-- --:--:-- --:--:--   872
{
  "bitcoin": {
    "usd": 34664,
    "usd_market_cap": 675835016546.567,
    "usd_24h_vol": 27952066301.047348,
    "usd_24h_change": 2.6519150329293883,
    "last_updated_at": 1698262594
  }
}
[donnie@fedora ~]$
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.508.1">So, it looks like the current price of Bitcoin is $34664 US.</span></li>
    </ol>
    <p class="normal one"><span class="koboSpan" id="kobo.509.1">You can view multiple coins</span><a id="_idIndexMarker728"/><span class="koboSpan" id="kobo.510.1"> at a time by entering a comma-separated list, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.511.1">[donnie@fedora ~]$ ./coingecko.sh bitcoin,ethereum,dero usd
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   471    0   471    0     0   3218      0 --:--:-- --:--:-- --:--:--  3226
{
  "bitcoin": {
    "usd": 34662,
    "usd_market_cap": 675835016546.567,
    "usd_24h_vol": 27417000940.815952,
    "usd_24h_change": 2.647099155664393,
    "last_updated_at": 1698262727
. </span><span class="koboSpan" id="kobo.511.2">. </span><span class="koboSpan" id="kobo.511.3">.
</span><span class="koboSpan" id="kobo.511.4">. </span><span class="koboSpan" id="kobo.511.5">. </span><span class="koboSpan" id="kobo.511.6">.
</span><span class="koboSpan" id="kobo.511.7">[donnie@fedora ~]$
</span></code></pre>
    <ol>
      <li class="numberedList" value="11"><span class="koboSpan" id="kobo.512.1">If you’re a trader, you might want</span><a id="_idIndexMarker729"/><span class="koboSpan" id="kobo.513.1"> to check the price of an altcoin in terms of some other versus currency, such as Bitcoin satoshis. </span><span class="koboSpan" id="kobo.513.2">Here, I’m checking the Bitcoin satoshi price of Dero:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.514.1">[donnie@fedora ~]$ ./coingecko.sh dero sats
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   161    0   161    0     0    746      0 --:--:-- --:--:-- --:--:--   748
{
  "dero": {
    "sats": 8544.47,
    "sats_market_cap": 106868665749.11504,
    "sats_24h_vol": 50996466.4091239,
    "sats_24h_change": -3.2533636291339687,
    "last_updated_at": 1698263552
  }
}
[donnie@fedora ~]
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.515.1">So, the current satoshi price of Dero is 8544.47 sats. </span><span class="koboSpan" id="kobo.515.2">(Of course, these prices will be different by the time you look at them.)</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.516.1">The top three lines of the output are from the curl command that the script used to download information about the coins. </span><span class="koboSpan" id="kobo.516.2">For some strange reason, bash considers this curl message as an error message, even though it really isn’t. </span><span class="koboSpan" id="kobo.516.3">But, that’s actually good, because you can prevent having to see this message by using a stderr redirector at the end of your command, like this:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.517.1">donnie@fedora:~$ ./coingecko.sh dero sats 2&gt;/dev/null
{
  "dero": {
    "sats": 3389.23,
    "sats_market_cap": 42965410638.71136,
    "sats_24h_vol": 112468964.13986385,
    "sats_24h_change": 2.81262920882357,
    "last_updated_at": 1718482347
  }
}
donnie@fedora:~$
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.518.1">Oh, I almost forgot about the most important part of the script, which is the command that calls the function:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.519.1">gecko_api $1 $2
</span></code></pre>
      </li>
    </ol>
    <p class="normal one"><span class="koboSpan" id="kobo.520.1">It asks for two positional parameters, but will work just fine if you just enter either </span><code class="inlineCode"><span class="koboSpan" id="kobo.521.1">list</span></code><span class="koboSpan" id="kobo.522.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.523.1">currencies</span></code><span class="koboSpan" id="kobo.524.1"> as a single argument.</span></p>
    <ol>
      <li class="numberedList" value="15"><span class="koboSpan" id="kobo.525.1">Okay, this is good. </span><span class="koboSpan" id="kobo.525.2">But, what if you have a very long list of coins that you want to track, and you don’t want to type that whole long list in every time that invoke this script? </span><span class="koboSpan" id="kobo.525.3">Well, that’s easy. </span><span class="koboSpan" id="kobo.525.4">I’ll just create the mycoins.sh script, which will call the coingecko.sh script. </span><span class="koboSpan" id="kobo.525.5">Here’s how it looks:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.526.1">#!/bin/bash
./coingecko.sh bitcoin,dero,ethereum,bitcoin-cash,bitcoin-cash-sv,bitcoin-gold,radiant,monero usd 2&gt;/dev/null
</span></code></pre>
      </li>
    </ol>
    <p class="normal one"><span class="koboSpan" id="kobo.527.1">Of course, you can edit this script to add your own list of favorite coins.</span></p>
    <ol>
      <li class="numberedList" value="16"><span class="koboSpan" id="kobo.528.1">For a variation on this theme, download the </span><code class="inlineCode"><span class="koboSpan" id="kobo.529.1">coingecko-case.sh</span></code><span class="koboSpan" id="kobo.530.1"> script, too. </span><span class="koboSpan" id="kobo.530.2">It’s the same script, but I built it with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.531.1">case..esac</span></code><span class="koboSpan" id="kobo.532.1"> construct instead of an </span><code class="inlineCode"><span class="koboSpan" id="kobo.533.1">if..then</span></code><span class="koboSpan" id="kobo.534.1"> contruct.</span></li>
    </ol>
    <p class="normal"><span class="koboSpan" id="kobo.535.1">That’s about</span><a id="_idIndexMarker730"/><span class="koboSpan" id="kobo.536.1"> it for functions, at least for now. </span><span class="koboSpan" id="kobo.536.2">But, don’t be too surprised if you see more throughout the rest of this book.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.537.1">Now, let’s wrap up and move on.</span></p>
    <h1 id="_idParaDest-257" class="heading 1"><span class="koboSpan" id="kobo.538.1">Summary</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.539.1">Functions are an important part of most every modern programming language. </span><span class="koboSpan" id="kobo.539.2">In this chapter I’ve shown you how to construct them, how to call them, and how to create function libraries that you can either use for yourself or share with other users.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.540.1">In the next chapter, I’ll show you how to perform mathematical operations with shell scripts. </span><span class="koboSpan" id="kobo.540.2">I’ll see you there.</span></p>
    <h1 id="_idParaDest-258" class="heading 1"><span class="koboSpan" id="kobo.541.1">Questions</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.542.1">Which two of the following methods would you use to create a function? </span><span class="koboSpan" id="kobo.542.2">(Choose two.)</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.543.1">function function_name()</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.544.1">function_name()</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.545.1">declare -f function_name</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.546.1">declare -F function_name</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.547.1">You want to create a function that will pass the value of a variable back to the main program. </span><span class="koboSpan" id="kobo.547.2">Which of the following should you use to do that?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.548.1">A global variable</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.549.1">A local variable</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.550.1">A </span><code class="inlineCode"><span class="koboSpan" id="kobo.551.1">return</span></code><span class="koboSpan" id="kobo.552.1"> statement</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.553.1">A continue statement</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.554.1">You want to create a function that any user can use in his or her own scripts. </span><span class="koboSpan" id="kobo.554.2">What is the best way to do that?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.555.1">Create a function library file in a central location, and make it executable.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.556.1">Add the new functions to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.557.1">/etc/bashrc</span></code><span class="koboSpan" id="kobo.558.1"> file.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.559.1">Create a function library file in a central location, but don’t make it executable.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.560.1">D. </span><span class="koboSpan" id="kobo.560.2">Create a function library file in your own home directory.</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.561.1">Which two of the following commands would you use to reference a function library in your shell scripts? </span><span class="koboSpan" id="kobo.561.2">(Choose two.)</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.562.1">load</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.563.1">reference</span></code></li>
          <li class="alphabeticList level 2"> <code class="inlineCode"><span class="koboSpan" id="kobo.564.1">source</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.565.1">.</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.566.1">You want to see the list of functions that are loaded into memory, along with their associated source code. </span><span class="koboSpan" id="kobo.566.2">Which command would you use?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.567.1">declare -f</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.568.1">declare -F</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.569.1">debugger -f</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.570.1">debugger -F</span></code></li>
        </ol>
      </li>
    </ol>
    <h1 id="_idParaDest-259" class="heading 1"><span class="koboSpan" id="kobo.571.1">Further Reading</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.572.1">Bash Functions: </span><span class="url"><span class="koboSpan" id="kobo.573.1">https://linuxize.com/post/bash-functions/</span></span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.574.1">Returning Values from Bash Functions: </span><span class="url"><span class="koboSpan" id="kobo.575.1">https://www.linuxjournal.com/content/return-values-bash-functions</span></span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.576.1">Bash Function &amp; How to Use It {Variables, Arguments, Return}: </span><span class="url"><span class="koboSpan" id="kobo.577.1">https://phoenixnap.com/kb/bash-function</span></span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.578.1">Writing shell scripts-Lesson 15: Errors and Signals and Traps: </span><span class="url"><span class="koboSpan" id="kobo.579.1">http://linuxcommand.org/lc3_wss0150.php</span></span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.580.1">(Note that the author of this tutorial uses all upper-case letters for the names of scripting variables, which is something that I don’t advocate. </span><span class="koboSpan" id="kobo.580.2">Other than that, it’s a good tutorial.)</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.581.1">Advance Bash Script Guide: </span><span class="url"><span class="koboSpan" id="kobo.582.1">https://tldp.org/LDP/abs/html/abs-guide.html#FUNCTIONS</span></span></li>
    </ul>
    <h1 id="_idParaDest-260" class="heading 1"><span class="koboSpan" id="kobo.583.1">Answers</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.584.1">a and b</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.585.1">b</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.586.1">c</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.587.1">c and d</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.588.1">a</span></li>
    </ol>
    <h1 id="_idParaDest-261" class="heading 1"><span class="koboSpan" id="kobo.589.1">Join our community on Discord!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.590.1">Read this book alongside other users, Linux experts, and the author himself. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.591.1">Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. </span><span class="koboSpan" id="kobo.591.2">Scan the QR code or visit the link to join the community.</span></p>
    <p class="normal"><span class="url"><span class="koboSpan" id="kobo.592.1">https://packt.link/SecNet</span></span></p>
    <p class="normal"><span class="koboSpan" id="kobo.593.1"><img src="../Images/QR_Code10596186092701843.png" alt=""/></span></p>
  </div>
</body></html>