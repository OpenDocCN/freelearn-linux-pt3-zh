<html><head></head><body>
  <div id="_idContainer264" class="Basic-Text-Frame">
    <h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">19</span></h1>
    <h1 id="_idParaDest-386" class="chapterTitle"><span class="koboSpan" id="kobo.2.1">Shell Script Portability</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.3.1">As we’ll see in a bit, many different shells are available for Linux, Unix, and Unix-like operating systems. </span><span class="koboSpan" id="kobo.3.2">Thus far though, we’ve mainly just been working with </span><code class="inlineCode"><span class="koboSpan" id="kobo.4.1">bash</span></code><span class="koboSpan" id="kobo.5.1">. </span><span class="koboSpan" id="kobo.5.2">The big advantage of </span><code class="inlineCode"><span class="koboSpan" id="kobo.6.1">bash</span></code><span class="koboSpan" id="kobo.7.1"> is that it comes already installed on most Linux distros, macOS, and OpenIndiana. </span><span class="koboSpan" id="kobo.7.2">It normally isn’t installed by default on the BSD-type distros, but you can install it yourself, if you need to.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.8.1">The big advantage of </span><code class="inlineCode"><span class="koboSpan" id="kobo.9.1">bash</span></code><span class="koboSpan" id="kobo.10.1"> is that it can use different scripting constructs that can make life easier for scripters. </span><span class="koboSpan" id="kobo.10.2">The big disadvantage of </span><code class="inlineCode"><span class="koboSpan" id="kobo.11.1">bash</span></code><span class="koboSpan" id="kobo.12.1"> is that many of these </span><code class="inlineCode"><span class="koboSpan" id="kobo.13.1">bash</span></code><span class="koboSpan" id="kobo.14.1"> constructs aren’t always available in non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.15.1">bash</span></code><span class="koboSpan" id="kobo.16.1"> shells. </span><span class="koboSpan" id="kobo.16.2">That’s not a big problem if you can install </span><code class="inlineCode"><span class="koboSpan" id="kobo.17.1">bash</span></code><span class="koboSpan" id="kobo.18.1"> on all of your machines, but that’s not always possible. </span><span class="koboSpan" id="kobo.18.2">(I’ll explain why in just a bit.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.19.1">In this chapter, I’ll show you some of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.20.1">bash</span></code><span class="koboSpan" id="kobo.21.1"> alternatives that you might encounter, and how to make your shell scripts run on a wide variety of these shells.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.22.1">Topics in this chapter include:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.23.1">Running </span><code class="inlineCode"><span class="koboSpan" id="kobo.24.1">bash</span></code><span class="koboSpan" id="kobo.25.1"> on non-Linux systems</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.26.1">Understanding POSIX compliance</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.27.1">Understanding the differences between shells</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.28.1">Understanding bashisms</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.29.1">Testing scripts for POSIX compliance</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.30.1">That about does it for the introduction. </span><span class="koboSpan" id="kobo.30.2">So now, let’s dig in.</span></p>
    <h1 id="_idParaDest-387" class="heading 1"><span class="koboSpan" id="kobo.31.1">Technical Requirements</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.32.1">I’m using Fedora, Debian, and FreeBSD virtual machines for this chapter. </span><span class="koboSpan" id="kobo.32.2">If any of you are using a Mac, you can try the scripts on it as well, if you like. </span><span class="koboSpan" id="kobo.32.3">As always, you can get grab the scripts from GitHub by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.33.1">git clone https://github.com/PacktPublishing/The-Ultimate-Linux-Shell-Scripting-Guide.git
</span></code></pre>
    <h1 id="_idParaDest-388" class="heading 1"><span class="koboSpan" id="kobo.34.1">Running bash on Non-Linux Systems</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.35.1">Before we talk about</span><a id="_idIndexMarker1110"/><span class="koboSpan" id="kobo.36.1"> the alternatives to </span><code class="inlineCode"><span class="koboSpan" id="kobo.37.1">bash</span></code><span class="koboSpan" id="kobo.38.1">, let’s talk about using </span><code class="inlineCode"><span class="koboSpan" id="kobo.39.1">bash</span></code><span class="koboSpan" id="kobo.40.1"> on non-Linux operating systems. </span><span class="koboSpan" id="kobo.40.2">I mean, the easiest way to make your shell scripts portable is to have the same shell everywhere.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.41.1">As I mentioned in the</span><a id="_idIndexMarker1111"/><span class="koboSpan" id="kobo.42.1"> introduction, </span><code class="inlineCode"><span class="koboSpan" id="kobo.43.1">bash</span></code><span class="koboSpan" id="kobo.44.1"> is already installed on most Linux-based operating systems, as well as on macOS and OpenIndiana. </span><span class="koboSpan" id="kobo.44.2">If you want to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.45.1">bash</span></code><span class="koboSpan" id="kobo.46.1"> on a BSD-type distro, such as FreeBSD or OpenBSD, you’ll need to install it yourself. </span><span class="koboSpan" id="kobo.46.2">I’ve already shown you how to install </span><code class="inlineCode"><span class="koboSpan" id="kobo.47.1">bash</span></code><span class="koboSpan" id="kobo.48.1"> on FreeBSD in </span><em class="chapterRef"><span class="koboSpan" id="kobo.49.1">Chapter 8, Basic Shell Script Construction</span></em><span class="koboSpan" id="kobo.50.1">. </span><span class="koboSpan" id="kobo.50.2">To refresh your memory, I’ll show you again:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.51.1">donnie@freebsd14:~ $ sudo pkg install bash
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.52.1">It’s just as easy on any other BSD-type distro, except that they all use different package managers. </span><span class="koboSpan" id="kobo.52.2">Here’s the table of commands for the various BSDs:</span></p>
    <table id="table001-6" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.53.1">BSD Distro</span></strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.54.1">Command to install bash</span></strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.55.1">FreeBSD</span></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.56.1">sudo pkg install bash</span></code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.57.1">OpenBSD</span></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.58.1">sudo pkg_add bash</span></code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.59.1">DragonflyBSD</span></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.60.1">sudo pkg install bash</span></code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><span class="koboSpan" id="kobo.61.1">NetBSD</span></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.62.1">sudo pkgin install bash</span></code></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref"><span class="koboSpan" id="kobo.63.1">Table 19.1: Commands to install bash on the BSD distros</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.64.1">Now, if you were to run a script with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.65.1">#!/bin/bash</span></code><span class="koboSpan" id="kobo.66.1"> shebang line on any of these BSD distros, you would get an error message that looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.67.1">donnie@freebsd14:~ $ ./ip.sh
-sh: ./ip.sh: not found
donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.68.1">This message is a bit misleading because it gives the impression that the shell can’t find the script. </span><span class="koboSpan" id="kobo.68.2">In reality, the script can’t find </span><code class="inlineCode"><span class="koboSpan" id="kobo.69.1">bash</span></code><span class="koboSpan" id="kobo.70.1">. </span><span class="koboSpan" id="kobo.70.2">That’s because, unlike what you’re used to seeing on Linux and OpenIndiana, </span><code class="inlineCode"><span class="koboSpan" id="kobo.71.1">bash</span></code><span class="koboSpan" id="kobo.72.1"> isn’t in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.73.1">/bin/</span></code><span class="koboSpan" id="kobo.74.1"> directory on BSD distros. </span><span class="koboSpan" id="kobo.74.2">Instead, the BSD</span><a id="_idIndexMarker1112"/><span class="koboSpan" id="kobo.75.1"> distros have </span><code class="inlineCode"><span class="koboSpan" id="kobo.76.1">bash</span></code><span class="koboSpan" id="kobo.77.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.78.1">/usr/local/bin/</span></code><span class="koboSpan" id="kobo.79.1"> directory. </span><span class="koboSpan" id="kobo.79.2">There</span><a id="_idIndexMarker1113"/><span class="koboSpan" id="kobo.80.1"> are a couple of ways to fix this, which we’ll look at next.</span></p>
    <h2 id="_idParaDest-389" class="heading 2"><span class="koboSpan" id="kobo.81.1">Using env to Set the bash Environment</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.82.1">The first way to ensure</span><a id="_idIndexMarker1114"/><span class="koboSpan" id="kobo.83.1"> that your scripts can always find </span><code class="inlineCode"><span class="koboSpan" id="kobo.84.1">bash</span></code><span class="koboSpan" id="kobo.85.1"> is to replace the </span><code class="inlineCode"><span class="koboSpan" id="kobo.86.1">#!/bin/bash</span></code><span class="koboSpan" id="kobo.87.1"> line in your scripts with:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.88.1">#!/usr/bin/env bash
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.89.1">This causes the script to look for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.90.1">bash</span></code><span class="koboSpan" id="kobo.91.1"> executable in the user’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.92.1">PATH</span></code><span class="koboSpan" id="kobo.93.1"> environment, instead of in a specific, hard-coded location.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.94.1">I’ve shown you in </span><em class="chapterRef"><span class="koboSpan" id="kobo.95.1">Chapter 3, Understanding Variables and Pipelines</span></em><span class="koboSpan" id="kobo.96.1"> how to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.97.1">env</span></code><span class="koboSpan" id="kobo.98.1"> command to view the environmental variables that are set in </span><code class="inlineCode"><span class="koboSpan" id="kobo.99.1">bash</span></code><span class="koboSpan" id="kobo.100.1">. </span><span class="koboSpan" id="kobo.100.2">In this case, I’m using </span><code class="inlineCode"><span class="koboSpan" id="kobo.101.1">env</span></code><span class="koboSpan" id="kobo.102.1"> to specify the shell that I want to use to interpret this script.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.103.1">This is the easiest method, but there are a few potential problems with it.</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.104.1">If you specify an interpreter for which multiple versions are installed, you won’t know which version will be invoked by the script. </span><span class="koboSpan" id="kobo.104.2">If for some crazy reason a machine has multiple versions of </span><code class="inlineCode"><span class="koboSpan" id="kobo.105.1">bash</span></code><span class="koboSpan" id="kobo.106.1"> installed, you won’t know which version that </span><code class="inlineCode"><span class="koboSpan" id="kobo.107.1">#!/usr/bin/env bash</span></code><span class="koboSpan" id="kobo.108.1"> will invoke.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.109.1">Using </span><code class="inlineCode"><span class="koboSpan" id="kobo.110.1">#!/usr/bin/env bash</span></code><span class="koboSpan" id="kobo.111.1"> could be a security problem. </span><span class="koboSpan" id="kobo.111.2">The normal </span><code class="inlineCode"><span class="koboSpan" id="kobo.112.1">bash</span></code><span class="koboSpan" id="kobo.113.1"> executable is always installed in a directory for which only someone with root privileges can add, remove, or modify files. </span><span class="koboSpan" id="kobo.113.2">But, let’s say that a malicious hacker were to gain access to your own normal user account. </span><span class="koboSpan" id="kobo.113.3">In that case, he or she wouldn’t need to obtain root privileges in order to plant a malicious fake </span><code class="inlineCode"><span class="koboSpan" id="kobo.114.1">bash</span></code><span class="koboSpan" id="kobo.115.1"> in your own home directory, and to alter your </span><code class="inlineCode"><span class="koboSpan" id="kobo.116.1">PATH</span></code><span class="koboSpan" id="kobo.117.1"> environment so that the fake </span><code class="inlineCode"><span class="koboSpan" id="kobo.118.1">bash</span></code><span class="koboSpan" id="kobo.119.1"> would be invoked instead of the real </span><code class="inlineCode"><span class="koboSpan" id="kobo.120.1">bash</span></code><span class="koboSpan" id="kobo.121.1">. </span><span class="koboSpan" id="kobo.121.2">Using the hard-coded </span><code class="inlineCode"><span class="koboSpan" id="kobo.122.1">#!/bin/bash</span></code><span class="koboSpan" id="kobo.123.1"> line would prevent that problem.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.124.1">With </span><code class="inlineCode"><span class="koboSpan" id="kobo.125.1">#!/usr/bin/env bash</span></code><span class="koboSpan" id="kobo.126.1">, you won’t be able to invoke any </span><code class="inlineCode"><span class="koboSpan" id="kobo.127.1">bash</span></code><span class="koboSpan" id="kobo.128.1"> options on the shebang line. </span><span class="koboSpan" id="kobo.128.2">For example, let’s say that you need to troubleshoot a troublesome script, and you want to run the script in debug mode. </span><span class="koboSpan" id="kobo.128.3">Using </span><code class="inlineCode"><span class="koboSpan" id="kobo.129.1">#!/bin/bash --debug</span></code><span class="koboSpan" id="kobo.130.1"> will work, but using </span><code class="inlineCode"><span class="koboSpan" id="kobo.131.1">#!/usr/bin/env bash --debug</span></code><span class="koboSpan" id="kobo.132.1"> won’t work. </span><span class="koboSpan" id="kobo.132.2">That’s because the </span><code class="inlineCode"><span class="koboSpan" id="kobo.133.1">env</span></code><span class="koboSpan" id="kobo.134.1"> command can only recognize one option parameter, which in this case would be </span><code class="inlineCode"><span class="koboSpan" id="kobo.135.1">bash</span></code><span class="koboSpan" id="kobo.136.1">. </span><span class="koboSpan" id="kobo.136.2">(It will never see the </span><code class="inlineCode"><span class="koboSpan" id="kobo.137.1">--debug</span></code><span class="koboSpan" id="kobo.138.1"> option.)</span></li>
    </ul>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.139.1">For now, don’t worry about what the </span><code class="inlineCode"><span class="koboSpan" id="kobo.140.1">--debug</span></code><span class="koboSpan" id="kobo.141.1"> option is doing. </span><span class="koboSpan" id="kobo.141.2">I’ll show you more about debugging shell scripts in </span><em class="chapterRef"><span class="koboSpan" id="kobo.142.1">Chapter 21, Debugging Shell Scripts</span></em><span class="koboSpan" id="kobo.143.1">.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.144.1">Although using </span><code class="inlineCode"><span class="koboSpan" id="kobo.145.1">#!/usr/bin/env bash</span></code><span class="koboSpan" id="kobo.146.1"> seems</span><a id="_idIndexMarker1115"/><span class="koboSpan" id="kobo.147.1"> like the simplest solution, I prefer to avoid it whenever possible. </span><span class="koboSpan" id="kobo.147.2">So, let’s look at another solution that’s a bit more secure and reliable.</span></p>
    <h2 id="_idParaDest-390" class="heading 2"><span class="koboSpan" id="kobo.148.1">Creating a Symbolic Link to bash</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.149.1">My preferred solution</span><a id="_idIndexMarker1116"/><span class="koboSpan" id="kobo.150.1"> for ensuring that your scripts can find </span><code class="inlineCode"><span class="koboSpan" id="kobo.151.1">bash</span></code><span class="koboSpan" id="kobo.152.1"> works the same on all of the BSD distros. </span><span class="koboSpan" id="kobo.152.2">You just have to create a symbolic link to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.153.1">bash</span></code><span class="koboSpan" id="kobo.154.1"> executable in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.155.1">/bin/</span></code><span class="koboSpan" id="kobo.156.1"> directory. </span><span class="koboSpan" id="kobo.156.2">Here’s how it looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.157.1">donnie@freebsd14:~ $ which bash
/usr/local/bin/bash
donnie@freebsd14:~ $ sudo ln -s /usr/local/bin/bash /bin/bash
Password:
donnie@freebsd14:~ $ which bash
/bin/bash
donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.158.1">To use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.159.1">ln -s</span></code><span class="koboSpan" id="kobo.160.1"> command to create a link, you would first specify the path to the file to which you want to link. </span><span class="koboSpan" id="kobo.160.2">Then, specify the path and name for the link that you want to create. </span><span class="koboSpan" id="kobo.160.3">Note how after I created the link, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.161.1">which</span></code><span class="koboSpan" id="kobo.162.1"> command now finds </span><code class="inlineCode"><span class="koboSpan" id="kobo.163.1">bash</span></code><span class="koboSpan" id="kobo.164.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.165.1">/bin/</span></code><span class="koboSpan" id="kobo.166.1"> directory, instead of in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.167.1">/usr/local/bin/</span></code><span class="koboSpan" id="kobo.168.1"> directory. </span><span class="koboSpan" id="kobo.168.2">That’s because </span><code class="inlineCode"><span class="koboSpan" id="kobo.169.1">/bin/</span></code><span class="koboSpan" id="kobo.170.1"> is listed before </span><code class="inlineCode"><span class="koboSpan" id="kobo.171.1">/usr/local/bin/</span></code><span class="koboSpan" id="kobo.172.1"> in the default </span><code class="inlineCode"><span class="koboSpan" id="kobo.173.1">PATH</span></code><span class="koboSpan" id="kobo.174.1"> setting, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.175.1">donnie@freebsd14:~ $ echo $PATH
/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin:/home/donnie/bin
donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.176.1">You can now use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.177.1">#!/bin/bash</span></code><span class="koboSpan" id="kobo.178.1"> shebang line on your BSD machine, the same as you would on a Linux machine.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.179.1">Okay, this is all good if you can have </span><code class="inlineCode"><span class="koboSpan" id="kobo.180.1">bash</span></code><span class="koboSpan" id="kobo.181.1"> installed on all of your systems. </span><span class="koboSpan" id="kobo.181.2">But, what if you can’t? </span><span class="koboSpan" id="kobo.181.3">What if you need</span><a id="_idIndexMarker1117"/><span class="koboSpan" id="kobo.182.1"> to write scripts that will run on </span><code class="inlineCode"><span class="koboSpan" id="kobo.183.1">bash</span></code><span class="koboSpan" id="kobo.184.1"> as well as on alternate shells? </span><span class="koboSpan" id="kobo.184.2">To answer that, we’ll first need to look at something called </span><strong class="keyWord"><span class="koboSpan" id="kobo.185.1">POSIX</span></strong><span class="koboSpan" id="kobo.186.1">.</span></p>
    <h1 id="_idParaDest-391" class="heading 1"><span class="koboSpan" id="kobo.187.1">Understanding POSIX compliance</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.188.1">Way back in the Stone Age of Computing, there was </span><a id="_idIndexMarker1118"/><span class="koboSpan" id="kobo.189.1">no such thing as standardization. </span><span class="koboSpan" id="kobo.189.2">In order to keep things relevant, let’s begin our history with the advent of Unix.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.190.1">AT&amp;T, who created Unix in the early 1970s, wasn’t allowed to market it until 1983. </span><span class="koboSpan" id="kobo.190.2">This was due to an anti-trust legal case that the U.S. </span><span class="koboSpan" id="kobo.190.3">government had filed against AT&amp;T back in 1956. </span><span class="koboSpan" id="kobo.190.4">(I don’t know the details of the case, so please don’t ask.) But, they were allowed to license the code to other vendors so that they could sell their own modified implementations. </span><span class="koboSpan" id="kobo.190.5">Because of this, several different implementations of Unix emerged, which weren’t always completely compatible with each other. </span><span class="koboSpan" id="kobo.190.6">These</span><a id="_idIndexMarker1119"/><span class="koboSpan" id="kobo.191.1"> different implementations included the </span><strong class="keyWord"><span class="koboSpan" id="kobo.192.1">Berkeley Software Distribution</span></strong><span class="koboSpan" id="kobo.193.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.194.1">BSD</span></strong><span class="koboSpan" id="kobo.195.1">), </span><strong class="keyWord"><span class="koboSpan" id="kobo.196.1">Microsoft Xenix</span></strong><span class="koboSpan" id="kobo.197.1">, and </span><strong class="keyWord"><span class="koboSpan" id="kobo.198.1">SunOS</span></strong><span class="koboSpan" id="kobo.199.1">. </span><span class="koboSpan" id="kobo.199.2">In 1983, AT&amp;T was</span><a id="_idIndexMarker1120"/><span class="koboSpan" id="kobo.200.1"> finally allowed to market its own </span><strong class="keyWord"><span class="koboSpan" id="kobo.201.1">System V Unix</span></strong><span class="koboSpan" id="kobo.202.1">. </span><span class="koboSpan" id="kobo.202.2">Making things more interesting</span><a id="_idIndexMarker1121"/><span class="koboSpan" id="kobo.203.1"> was the wide variety of shells</span><a id="_idIndexMarker1122"/><span class="koboSpan" id="kobo.204.1"> that eventually became available for these various Unix systems. </span><span class="koboSpan" id="kobo.204.2">The Thompson shell came first, and was superseded by the Bourne shell a few years later. </span><span class="koboSpan" id="kobo.204.3">Other shells, such as the C shell and the Korn shell, soon followed. </span><span class="koboSpan" id="kobo.204.4">Finally, in the early 1990s, Linus Torvalds created the Linux kernel, which was a clean slate reimplementation of the Unix kernel. </span><span class="koboSpan" id="kobo.204.5">Nowadays, Linux-based operating systems have mostly supplanted Unix-based systems, and the Bourne Again Shell (</span><code class="inlineCode"><span class="koboSpan" id="kobo.205.1">bash</span></code><span class="koboSpan" id="kobo.206.1">) is the dominant shell for Linux-based systems.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.207.1">In the 1980s, customers began demanding some semblance of standardization between the various Unix vendors. </span><span class="koboSpan" id="kobo.207.2">This culminated in the creation of the </span><strong class="keyWord"><span class="koboSpan" id="kobo.208.1">POSIX</span></strong><span class="koboSpan" id="kobo.209.1"> standard by the </span><strong class="keyWord"><span class="koboSpan" id="kobo.210.1">IEEE Computer Society</span></strong><span class="koboSpan" id="kobo.211.1"> in 1988.</span></p>
    <div class="note">
      <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.212.1">IEEE</span></strong><span class="koboSpan" id="kobo.213.1"> stands for </span><strong class="keyWord"><span class="koboSpan" id="kobo.214.1">Institute of Electrical and Electronics Engineers</span></strong><span class="koboSpan" id="kobo.215.1">. </span><span class="koboSpan" id="kobo.215.2">Curiously however, all you’ll see</span><a id="_idIndexMarker1123"/><span class="koboSpan" id="kobo.216.1"> on their website is IEEE, with no explanation of what it stands for.</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.217.1">POSIX</span><a id="_idIndexMarker1124"/><span class="koboSpan" id="kobo.218.1"> stands for </span><strong class="keyWord"><span class="koboSpan" id="kobo.219.1">Portable Operating System Interface</span></strong><span class="koboSpan" id="kobo.220.1">.</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.221.1">Finally, for those of you who</span><a id="_idIndexMarker1125"/><span class="koboSpan" id="kobo.222.1"> are outside the U.S., AT&amp;T stands for </span><strong class="keyWord"><span class="koboSpan" id="kobo.223.1">American Telephone and Telegraph</span></strong><span class="koboSpan" id="kobo.224.1">.</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.225.1">And yes, it really is true that Microsoft used to be a Unix vendor.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.226.1">The main purpose of POSIX</span><a id="_idIndexMarker1126"/><span class="koboSpan" id="kobo.227.1"> is to ensure that shells and utilities work the same way across all implementations of Unix. </span><span class="koboSpan" id="kobo.227.2">For example, if you know how to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.228.1">ps</span></code><span class="koboSpan" id="kobo.229.1"> utility on Solaris/OpenIndiana, then you also know how to use it on FreeBSD. </span><span class="koboSpan" id="kobo.229.2">The big problem is that while many Unix implementations and their default shells are POSIX-compliant, some are only partially compliant. </span><span class="koboSpan" id="kobo.229.3">On the other hand, most Linux-based operating systems are only partially POSIX-compliant. </span><span class="koboSpan" id="kobo.229.4">That’s because many Linux utilities use different option switches that their Unix/Unix-like brethren don’t use, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.230.1">bash</span></code><span class="koboSpan" id="kobo.231.1"> itself has programming features that aren’t available in POSIX-compliant shells. </span><span class="koboSpan" id="kobo.231.2">For example, you can use an </span><code class="inlineCode"><span class="koboSpan" id="kobo.232.1">if [ -f /bin/someprogram ]</span></code><span class="koboSpan" id="kobo.233.1"> type of construct to test for the presence of a file in a POSIX-compliant shell, but you can’t use </span><code class="inlineCode"><span class="koboSpan" id="kobo.234.1">if [[ -f /bin/someprogram ]]</span></code><span class="koboSpan" id="kobo.235.1">. </span><span class="koboSpan" id="kobo.235.2">(I’ll explain more about this in a few moments.)</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.236.1">POSIX also defines which programming libraries must come with any given implementation of Unix. </span><span class="koboSpan" id="kobo.236.2">However, this is mainly of interest to actual programmers, rather than to shell scripters.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.237.1">To be fair, I’ll admit that POSIX compliance might never become an issue for you if you only work on Linux servers or workstations. </span><span class="koboSpan" id="kobo.237.2">But, let’s say that you work with a large fleet of servers with a mix of Unix, BSD, and Linux systems. </span><span class="koboSpan" id="kobo.237.3">Now, let’s say that some of those Unix and BSD servers are still running legacy systems for which </span><code class="inlineCode"><span class="koboSpan" id="kobo.238.1">bash</span></code><span class="koboSpan" id="kobo.239.1"> isn’t available. </span><span class="koboSpan" id="kobo.239.2">You might find it necessary to create POSIX-compliant shell scripts that will run on every server in the fleet without modification. </span><span class="koboSpan" id="kobo.239.3">Also, </span><strong class="keyWord"><span class="koboSpan" id="kobo.240.1">Internet of Things</span></strong><span class="koboSpan" id="kobo.241.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.242.1">IoT</span></strong><span class="koboSpan" id="kobo.243.1">) devices are generally very low-resource devices that might not be able to run </span><code class="inlineCode"><span class="koboSpan" id="kobo.244.1">bash</span></code><span class="koboSpan" id="kobo.245.1">. </span><span class="koboSpan" id="kobo.245.2">Instead, they’ll have something more lightweight, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.246.1">ash</span></code><span class="koboSpan" id="kobo.247.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.248.1">dash</span></code><span class="koboSpan" id="kobo.249.1">. </span><span class="koboSpan" id="kobo.249.2">In general, these lightweight, non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.250.1">bash</span></code><span class="koboSpan" id="kobo.251.1"> shells will be POSIX-compliant, and won’t be able</span><a id="_idIndexMarker1127"/><span class="koboSpan" id="kobo.252.1"> to run scripts</span><a id="_idIndexMarker1128"/><span class="koboSpan" id="kobo.253.1"> that use </span><code class="inlineCode"><span class="koboSpan" id="kobo.254.1">bash</span></code><span class="koboSpan" id="kobo.255.1">-specific features.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.256.1">Now that you have a good understanding of what POSIX is all about, let’s talk about the differences between the various shells.</span></p>
    <h1 id="_idParaDest-392" class="heading 1"><span class="koboSpan" id="kobo.257.1">Understanding the Differences Between Shells</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.258.1">In addition to defining a specific</span><a id="_idIndexMarker1129"/><span class="koboSpan" id="kobo.259.1"> shell that you want to use, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.260.1">/bin/bash</span></code><span class="koboSpan" id="kobo.261.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.262.1">/bin/zsh</span></code><span class="koboSpan" id="kobo.263.1">, you can also define the generic </span><code class="inlineCode"><span class="koboSpan" id="kobo.264.1">/bin/sh</span></code><span class="koboSpan" id="kobo.265.1"> shell to make your scripts more portable, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.266.1">#!/bin/sh
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.267.1">This generic </span><code class="inlineCode"><span class="koboSpan" id="kobo.268.1">sh</span></code><span class="koboSpan" id="kobo.269.1"> shell allows you to run your scripts on different systems that might or might not have </span><code class="inlineCode"><span class="koboSpan" id="kobo.270.1">bash</span></code><span class="koboSpan" id="kobo.271.1"> installed. </span><span class="koboSpan" id="kobo.271.2">But, here’s the problem. </span><span class="koboSpan" id="kobo.271.3">Years ago, </span><code class="inlineCode"><span class="koboSpan" id="kobo.272.1">sh</span></code><span class="koboSpan" id="kobo.273.1"> used to always be the Bourne shell. </span><span class="koboSpan" id="kobo.273.2">Nowadays, </span><code class="inlineCode"><span class="koboSpan" id="kobo.274.1">sh</span></code><span class="koboSpan" id="kobo.275.1"> is still the Bourne shell on some operating systems, but is something else entirely on other operating systems. </span><span class="koboSpan" id="kobo.275.2">Here’s the breakdown of how it works:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.276.1">On most BSD-type systems, such as FreeBSD and OpenBSD, </span><code class="inlineCode"><span class="koboSpan" id="kobo.277.1">sh</span></code><span class="koboSpan" id="kobo.278.1"> is the old-school Bourne shell. </span><span class="koboSpan" id="kobo.278.2">According to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.279.1">sh</span></code><span class="koboSpan" id="kobo.280.1"> man page, it only supports POSIX-compliant features, plus a few BSD extensions.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.281.1">On Red Hat-type systems, </span><code class="inlineCode"><span class="koboSpan" id="kobo.282.1">sh</span></code><span class="koboSpan" id="kobo.283.1"> is a symbolic link that points to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.284.1">bash</span></code><span class="koboSpan" id="kobo.285.1"> executable.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.286.1">On Debian/Ubuntu-type systems, </span><code class="inlineCode"><span class="koboSpan" id="kobo.287.1">sh</span></code><span class="koboSpan" id="kobo.288.1"> is a symbolic link that points to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.289.1">dash</span></code><span class="koboSpan" id="kobo.290.1"> executable. </span><code class="inlineCode"><span class="koboSpan" id="kobo.291.1">dash</span></code><span class="koboSpan" id="kobo.292.1"> stands for </span><strong class="keyWord"><span class="koboSpan" id="kobo.293.1">Debian Almquist Shell</span></strong><span class="koboSpan" id="kobo.294.1">, which is a faster, more lightweight</span><a id="_idIndexMarker1130"/><span class="koboSpan" id="kobo.295.1"> implementation of the Bourne shell.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.296.1">On Alpine Linux, </span><code class="inlineCode"><span class="koboSpan" id="kobo.297.1">sh</span></code><span class="koboSpan" id="kobo.298.1"> is a symbolic link that points to </span><code class="inlineCode"><span class="koboSpan" id="kobo.299.1">ash</span></code><span class="koboSpan" id="kobo.300.1">, which is a lightweight shell that’s built into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.301.1">busybox</span></code><span class="koboSpan" id="kobo.302.1"> executable. </span><span class="koboSpan" id="kobo.302.2">(On Alpine Linux, </span><code class="inlineCode"><span class="koboSpan" id="kobo.303.1">bash</span></code><span class="koboSpan" id="kobo.304.1"> is not installed by default.)</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.305.1">On OpenIndiana, which is a </span><strong class="keyWord"><span class="koboSpan" id="kobo.306.1">Free Open Source Software</span></strong><span class="koboSpan" id="kobo.307.1"> fork of Oracle’s Solaris operating</span><a id="_idIndexMarker1131"/><span class="koboSpan" id="kobo.308.1"> system, </span><code class="inlineCode"><span class="koboSpan" id="kobo.309.1">sh</span></code><span class="koboSpan" id="kobo.310.1"> is a symbolic link that points to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.311.1">ksh93</span></code><span class="koboSpan" id="kobo.312.1"> shell. </span><span class="koboSpan" id="kobo.312.2">This shell, which is also known as the Korn shell, is somewhat compatible with </span><code class="inlineCode"><span class="koboSpan" id="kobo.313.1">bash</span></code><span class="koboSpan" id="kobo.314.1">. </span><span class="koboSpan" id="kobo.314.2">(It was created by a guy named David Korn, and has nothing to do with any vegetable.) However, the default login shell for OpenIndiana is </span><code class="inlineCode"><span class="koboSpan" id="kobo.315.1">bash</span></code><span class="koboSpan" id="kobo.316.1">.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.317.1">On macOS, </span><code class="inlineCode"><span class="koboSpan" id="kobo.318.1">sh</span></code><span class="koboSpan" id="kobo.319.1"> points</span><a id="_idIndexMarker1132"/><span class="koboSpan" id="kobo.320.1"> to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.321.1">bash</span></code><span class="koboSpan" id="kobo.322.1"> executable. </span><span class="koboSpan" id="kobo.322.2">Interestingly, </span><code class="inlineCode"><span class="koboSpan" id="kobo.323.1">zsh</span></code><span class="koboSpan" id="kobo.324.1"> is now the default user login shell for macOS, but </span><code class="inlineCode"><span class="koboSpan" id="kobo.325.1">bash</span></code><span class="koboSpan" id="kobo.326.1"> is still installed and available for use.</span></li>
    </ul>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.327.1">Using </span><code class="inlineCode"><span class="koboSpan" id="kobo.328.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.329.1"> will only work if you’re careful about making your scripts portable. </span><span class="koboSpan" id="kobo.329.2">If </span><code class="inlineCode"><span class="koboSpan" id="kobo.330.1">sh</span></code><span class="koboSpan" id="kobo.331.1"> on your machine points to something other than </span><code class="inlineCode"><span class="koboSpan" id="kobo.332.1">bash</span></code><span class="koboSpan" id="kobo.333.1">, it won’t work for scripts that require advanced features that are specific to </span><code class="inlineCode"><span class="koboSpan" id="kobo.334.1">bash</span></code><span class="koboSpan" id="kobo.335.1">. </span><span class="koboSpan" id="kobo.335.2">So, if you use </span><code class="inlineCode"><span class="koboSpan" id="kobo.336.1">sh</span></code><span class="koboSpan" id="kobo.337.1">, be sure to test it on different systems to ensure that everything works as it should.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.338.1">Before we get to the testing</span><a id="_idIndexMarker1133"/><span class="koboSpan" id="kobo.339.1"> part though, let’s look at the concept of bashisms, and how to avoid them.</span></p>
    <h1 id="_idParaDest-393" class="heading 1"><span class="koboSpan" id="kobo.340.1">Understanding Bashisms</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.341.1">A </span><strong class="keyWord"><span class="koboSpan" id="kobo.342.1">bashism</span></strong><span class="koboSpan" id="kobo.343.1"> is any feature that’s specific</span><a id="_idIndexMarker1134"/><span class="koboSpan" id="kobo.344.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.345.1">bash</span></code><span class="koboSpan" id="kobo.346.1">, and that won’t work with other shells. </span><span class="koboSpan" id="kobo.346.2">Let’s look at a few examples.</span></p>
    <h2 id="_idParaDest-394" class="heading 2"><span class="koboSpan" id="kobo.347.1">Using Portable Tests</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.348.1">For our first example, try running</span><a id="_idIndexMarker1135"/><span class="koboSpan" id="kobo.349.1"> this command on your Fedora virtual machine:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.350.1">donnie@fedora:~$ [[ -x /bin/ls ]] &amp;&amp; echo "This file is installed.";
This file is installed.
</span><span class="koboSpan" id="kobo.350.2">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.351.1">Here, I’m testing for the presence of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.352.1">ls</span></code><span class="koboSpan" id="kobo.353.1"> executable file in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.354.1">/bin/</span></code><span class="koboSpan" id="kobo.355.1"> directory. </span><span class="koboSpan" id="kobo.355.2">The file is there, so the </span><code class="inlineCode"><span class="koboSpan" id="kobo.356.1">echo</span></code><span class="koboSpan" id="kobo.357.1"> command is invoked. </span><span class="koboSpan" id="kobo.357.2">Now, let’s run the same command on a FreeBSD virtual machine:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.358.1">donnie@freebsd14:~ $ [[ -f /bin/ls ]] &amp;&amp; echo "This file is installed."
</span><span class="koboSpan" id="kobo.358.2">-sh: [[: not found
donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.359.1">This time I get an error, because the default user login shell on FreeBSD is </span><code class="inlineCode"><span class="koboSpan" id="kobo.360.1">sh</span></code><span class="koboSpan" id="kobo.361.1">, instead of </span><code class="inlineCode"><span class="koboSpan" id="kobo.362.1">bash</span></code><span class="koboSpan" id="kobo.363.1">. </span><span class="koboSpan" id="kobo.363.2">The problem here is that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.364.1">[[. </span><span class="koboSpan" id="kobo.364.2">. </span><span class="koboSpan" id="kobo.364.3">.]]</span></code><span class="koboSpan" id="kobo.365.1"> construct isn’t supported on the FreeBSD implementation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.366.1">sh</span></code><span class="koboSpan" id="kobo.367.1">. </span><span class="koboSpan" id="kobo.367.2">Let’s see if we can fix that:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.368.1">donnie@freebsd14:~ $ [ -f /bin/ls ] &amp;&amp; echo "This file is installed."
</span><span class="koboSpan" id="kobo.368.2">This file is installed.
</span><span class="koboSpan" id="kobo.368.3">donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.369.1">Very cool, this works. </span><span class="koboSpan" id="kobo.369.2">So now, you’re wondering why anyone would use the non-POSIX </span><code class="inlineCode"><span class="koboSpan" id="kobo.370.1">[[. </span><span class="koboSpan" id="kobo.370.2">. </span><span class="koboSpan" id="kobo.370.3">.]]</span></code><span class="koboSpan" id="kobo.371.1"> construct instead of the more portable </span><code class="inlineCode"><span class="koboSpan" id="kobo.372.1">[. </span><span class="koboSpan" id="kobo.372.2">. </span><span class="koboSpan" id="kobo.372.3">.]</span></code><span class="koboSpan" id="kobo.373.1">. </span><span class="koboSpan" id="kobo.373.2">Well, it’s mainly because certain types of tests don’t work with </span><code class="inlineCode"><span class="koboSpan" id="kobo.374.1">[. </span><span class="koboSpan" id="kobo.374.2">. </span><span class="koboSpan" id="kobo.374.3">.]</span></code><span class="koboSpan" id="kobo.375.1">. </span><span class="koboSpan" id="kobo.375.2">For example, let’s look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.376.1">test-test-1.sh</span></code><span class="koboSpan" id="kobo.377.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.378.1">#!/bin/bash
if [[ "$1" == z* ]]; then
    echo "Pattern matched: "$1" starts with 'z'."
</span><span class="koboSpan" id="kobo.378.2">else
    echo "Pattern not matched: "$1" doesn't start with 'z'."
</span><span class="koboSpan" id="kobo.378.3">fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.379.1">When I invoke this script, I’ll supply</span><a id="_idIndexMarker1136"/><span class="koboSpan" id="kobo.380.1"> a word as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.381.1">$1</span></code><span class="koboSpan" id="kobo.382.1"> positional parameter. </span><span class="koboSpan" id="kobo.382.2">If the first letter of the word is “z”, then the pattern will match.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.383.1">In this script, </span><code class="inlineCode"><span class="koboSpan" id="kobo.384.1">z*</span></code><span class="koboSpan" id="kobo.385.1"> is a regular expression. </span><span class="koboSpan" id="kobo.385.2">We’re using this regular expression to match all words that begin with the letter “z”. </span><span class="koboSpan" id="kobo.385.3">Any time you do regular expression matching within a test, you have to place it within a double square bracket, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.386.1">[[. </span><span class="koboSpan" id="kobo.386.2">. </span><span class="koboSpan" id="kobo.386.3">.]]</span></code><span class="koboSpan" id="kobo.387.1">, construct.</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.388.1">(I explained about regular expressions in </span><em class="chapterRef"><span class="koboSpan" id="kobo.389.1">Chapter 9, Filtering Text with grep, sed, and Regular Expressions</span></em><span class="koboSpan" id="kobo.390.1">.)</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.391.1">Here’s how it works:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.392.1">donnie@fedora:~$ ./test-test-1.sh zebra
Pattern matched: zebra starts with 'z'.
</span><span class="koboSpan" id="kobo.392.2">donnie@fedora:~$ ./test-test-1.sh donnie
Pattern not matched: donnie doesn't start with 'z'.
</span><span class="koboSpan" id="kobo.392.3">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.393.1">Now, look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.394.1">test-test-2.sh</span></code><span class="koboSpan" id="kobo.395.1"> script, which uses </span><code class="inlineCode"><span class="koboSpan" id="kobo.396.1">[. </span><span class="koboSpan" id="kobo.396.2">. </span><span class="koboSpan" id="kobo.396.3">.]</span></code><span class="koboSpan" id="kobo.397.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.398.1">#!/bin/bash
if [ "$1" == z* ]; then
    echo "Pattern matched: "$1" starts with 'z'."
</span><span class="koboSpan" id="kobo.398.2">else
    echo "Pattern not matched: "$1" doesn't start with 'z'."
</span><span class="koboSpan" id="kobo.398.3">fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.399.1">This is identical to the first script, except that it uses single square brackets for the test instead of double square brackets. </span><span class="koboSpan" id="kobo.399.2">Here’s what happens when I run the script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.400.1">donnie@fedora:~$ ./test-test-2.sh zebra
Pattern not matched: zebra doesn't start with 'z'.
</span><span class="koboSpan" id="kobo.400.2">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.401.1">You see that this test doesn’t work </span><a id="_idIndexMarker1137"/><span class="koboSpan" id="kobo.402.1">with the single square brackets. </span><span class="koboSpan" id="kobo.402.2">That’s because the single square bracket construct doesn’t recognize the use of regular expressions. </span><span class="koboSpan" id="kobo.402.3">But, if using double square brackets doesn’t work on certain implementations of </span><code class="inlineCode"><span class="koboSpan" id="kobo.403.1">sh</span></code><span class="koboSpan" id="kobo.404.1">, then how can I make this script portable? </span><span class="koboSpan" id="kobo.404.2">Well, here’s one solution:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.405.1">#!/bin/sh
if [ "$(echo $1 | cut -c1)" = z ]; then
    echo "Pattern matched: "$1" starts with 'z'."
</span><span class="koboSpan" id="kobo.405.2">else
    echo "Pattern not matched: "$1" doesn't start with 'z'."
</span><span class="koboSpan" id="kobo.405.3">fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.406.1">Instead of using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.407.1">z*</span></code><span class="koboSpan" id="kobo.408.1"> regular expression to match any word that begins with the letter “z”, I’m just echoing the word into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.409.1">cut -c1</span></code><span class="koboSpan" id="kobo.410.1"> command in order to isolate the first letter. </span><span class="koboSpan" id="kobo.410.2">I also changed the </span><code class="inlineCode"><span class="koboSpan" id="kobo.411.1">==</span></code><span class="koboSpan" id="kobo.412.1"> in the test to </span><code class="inlineCode"><span class="koboSpan" id="kobo.413.1">=</span></code><span class="koboSpan" id="kobo.414.1">, because </span><code class="inlineCode"><span class="koboSpan" id="kobo.415.1">==</span></code><span class="koboSpan" id="kobo.416.1"> is also considered a bashism.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.417.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.418.1">==</span></code><span class="koboSpan" id="kobo.419.1"> actually does work with the FreeBSD implementation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.420.1">sh</span></code><span class="koboSpan" id="kobo.421.1">, but it might not work on other implementations. </span><span class="koboSpan" id="kobo.421.2">For example, it doesn’t work on </span><code class="inlineCode"><span class="koboSpan" id="kobo.422.1">dash</span></code><span class="koboSpan" id="kobo.423.1">, which is invoked by </span><code class="inlineCode"><span class="koboSpan" id="kobo.424.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.425.1"> on Debian/Ubuntu-type distros.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.426.1">While I was at it, I changed the shebang line to </span><code class="inlineCode"><span class="koboSpan" id="kobo.427.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.428.1">, because I’ll also want to test this on FreeBSD with the Bourne shell. </span><span class="koboSpan" id="kobo.428.2">So, will this work? </span><span class="koboSpan" id="kobo.428.3">Let’s try it on Fedora, on which </span><code class="inlineCode"><span class="koboSpan" id="kobo.429.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.430.1"> points to </span><code class="inlineCode"><span class="koboSpan" id="kobo.431.1">bash</span></code><span class="koboSpan" id="kobo.432.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.433.1">donnie@fedora:~$ ./test-test-3.sh zebra
Pattern matched: zebra starts with 'z'.
</span><span class="koboSpan" id="kobo.433.2">donnie@fedora:~$ ./test-test-3.sh donnie
Pattern not matched: donnie doesn't start with 'z'.
</span><span class="koboSpan" id="kobo.433.3">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.434.1">Yeah, it works fine on Fedora. </span><span class="koboSpan" id="kobo.434.2">Now, let’s see what happens on FreeBSD:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.435.1">donnie@freebsd14:~ $ ./test-test-3.sh zealot
Pattern matched: zealot starts with 'z'.
</span><span class="koboSpan" id="kobo.435.2">donnie@freebsd14:~ $ ./test-test-3.sh donnie
Pattern not matched: donnie doesn't start with 'z'.
</span><span class="koboSpan" id="kobo.435.3">donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.436.1">Yes indeed, it works like a champ. </span><span class="koboSpan" id="kobo.436.2">And, for the record, I also tested it on a Debian machine with </span><code class="inlineCode"><span class="koboSpan" id="kobo.437.1">dash</span></code><span class="koboSpan" id="kobo.438.1">, and it works</span><a id="_idIndexMarker1138"/><span class="koboSpan" id="kobo.439.1"> fine on it, as well.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.440.1">Now, let’s look at our next portability problem.</span></p>
    <h2 id="_idParaDest-395" class="heading 2"><span class="koboSpan" id="kobo.441.1">Making Portable Arrays</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.442.1">Sometimes, you need to create</span><a id="_idIndexMarker1139"/><span class="koboSpan" id="kobo.443.1"> and manipulate lists of items in your shell scripts. </span><span class="koboSpan" id="kobo.443.2">With </span><code class="inlineCode"><span class="koboSpan" id="kobo.444.1">bash</span></code><span class="koboSpan" id="kobo.445.1">, you can create variable arrays the same as you can with languages such a C, C++, or Java. </span><span class="koboSpan" id="kobo.445.2">For example, let’s look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.446.1">ip-2.sh</span></code><span class="koboSpan" id="kobo.447.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.448.1">#!/bin/sh
echo "IP Addresses of intruder attempts"
declare -a ip
ip=( 192.168.3.78 192.168.3.4 192.168.3.9 )
echo "ip[0] is ${ip[0]}, the first item in the list."
</span><span class="koboSpan" id="kobo.448.2">echo "ip[2] is ${ip[2]}, the third item in the list."
</span><span class="koboSpan" id="kobo.448.3">echo "***********************************"
echo "The most dangerous intruder is ${ip[1]}, which is in ip[1]."
</span><span class="koboSpan" id="kobo.448.4">echo "***********************************"
echo "Here is the entire list of IP addresses in the array."
</span><span class="koboSpan" id="kobo.448.5">echo ${ip[*]}
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.449.1">This is identical to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.450.1">ip.sh</span></code><span class="koboSpan" id="kobo.451.1"> script that I showed you in </span><em class="chapterRef"><span class="koboSpan" id="kobo.452.1">Chapter 8, Basic Shell Script Construction</span></em><span class="koboSpan" id="kobo.453.1">, except that I changed the shebang line to </span><code class="inlineCode"><span class="koboSpan" id="kobo.454.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.455.1">. </span><span class="koboSpan" id="kobo.455.2">To refresh your memory, I’m using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.456.1">declare -a</span></code><span class="koboSpan" id="kobo.457.1"> command to create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.458.1">ip</span></code><span class="koboSpan" id="kobo.459.1"> array, and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.460.1">ip=</span></code><span class="koboSpan" id="kobo.461.1"> line to populate the array. </span><span class="koboSpan" id="kobo.461.2">This should work fine on my Fedora machine, since the Fedora </span><code class="inlineCode"><span class="koboSpan" id="kobo.462.1">sh</span></code><span class="koboSpan" id="kobo.463.1"> points to </span><code class="inlineCode"><span class="koboSpan" id="kobo.464.1">bash</span></code><span class="koboSpan" id="kobo.465.1">. </span><span class="koboSpan" id="kobo.465.2">Let’s see if it does:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.466.1">donnie@fedora:~$ ./ip-2.sh
IP Addresses of intruder attempts
ip[0] is 192.168.3.78, the first item in the list.
</span><span class="koboSpan" id="kobo.466.2">ip[2] is 192.168.3.9, the third item in the list.
</span><span class="koboSpan" id="kobo.466.3">***********************************
The most dangerous intruder is 192.168.3.4, which is in ip[1].
</span><span class="koboSpan" id="kobo.466.4">***********************************
Here is the entire list of IP addresses in the array.
</span><span class="koboSpan" id="kobo.466.5">192.168.3.78 192.168.3.4 192.168.3.9
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.467.1">Yes, it does work.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.468.1">Now, let’s see how it looks on FreeBSD:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.469.1">donnie@freebsd14:~ $ ./ip-2.sh
IP Addresses of intruder attempts
./ip-2.sh: declare: not found
./ip-2.sh: 4: Syntax error: word unexpected (expecting ")")
donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.470.1">The problem this time</span><a id="_idIndexMarker1140"/><span class="koboSpan" id="kobo.471.1"> is that the Bourne (</span><code class="inlineCode"><span class="koboSpan" id="kobo.472.1">sh</span></code><span class="koboSpan" id="kobo.473.1">) shell on FreeBSD can’t use variable arrays. </span><span class="koboSpan" id="kobo.473.2">To make this script portable, we’ll need to find a work-around. </span><span class="koboSpan" id="kobo.473.3">So, let’s try this </span><code class="inlineCode"><span class="koboSpan" id="kobo.474.1">ip-3.sh</span></code><span class="koboSpan" id="kobo.475.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.476.1">#!/bin/sh
set 192.168.3.78 192.168.3.4 192.168.3.9
echo "$1 is the first item in the list."
</span><span class="koboSpan" id="kobo.476.2">echo "$3 is the third item in the list."
</span><span class="koboSpan" id="kobo.476.3">echo "**********************************"
echo "The most dangerous intruder is $2, which is the second item of the list."
</span><span class="koboSpan" id="kobo.476.4">echo "*********************************"
echo "Here is the entire list of IP addresses in the array:"
echo "$@"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.477.1">Instead of building an actual array this time, I’m using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.478.1">set</span></code><span class="koboSpan" id="kobo.479.1"> command to create a list of IP addresses that I can access with positional parameters. </span><span class="koboSpan" id="kobo.479.2">I know, you thought that positional parameters were only for passing arguments in from the command line when you invoke the script. </span><span class="koboSpan" id="kobo.479.3">But what you see here is just another way to use them. </span><span class="koboSpan" id="kobo.479.4">The big question though is, does this work? </span><span class="koboSpan" id="kobo.479.5">Let’s see what it does on the FreeBSD machine:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.480.1">donnie@freebsd14:~ $ ./ip-3.sh
192.168.3.78 is the first item in the list.
</span><span class="koboSpan" id="kobo.480.2">192.168.3.9 is the third item in the list.
</span><span class="koboSpan" id="kobo.480.3">**********************************
The most dangerous intruder is 192.168.3.4, which is the second item of the list.
</span><span class="koboSpan" id="kobo.480.4">*********************************
Here is the entire list of IP addresses in the array:
192.168.3.78 192.168.3.4 192.168.3.9
donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.481.1">Once again, we have achieved coolness.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.482.1">Note that when using </span><code class="inlineCode"><span class="koboSpan" id="kobo.483.1">set</span></code><span class="koboSpan" id="kobo.484.1"> and positional parameters, we’re not creating an actual array. </span><span class="koboSpan" id="kobo.484.2">Instead, we’re just </span><em class="italic"><span class="koboSpan" id="kobo.485.1">simulating</span></em><span class="koboSpan" id="kobo.486.1"> an array. </span><span class="koboSpan" id="kobo.486.2">But hey, whatever works, right?</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.487.1">You can also build a simulated array</span><a id="_idIndexMarker1141"/><span class="koboSpan" id="kobo.488.1"> from a text file, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.489.1">cat</span></code><span class="koboSpan" id="kobo.490.1"> command. </span><span class="koboSpan" id="kobo.490.2">First, let’s create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.491.1">iplist.txt</span></code><span class="koboSpan" id="kobo.492.1"> file, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.493.1">donnie@fedora:~$ cat iplist.txt
192.168.0.12
192.168.0.16
192.168.0.222
192.168.0.3
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.494.1">Now, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.495.1">ip-4.sh</span></code><span class="koboSpan" id="kobo.496.1"> script, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.497.1">#!/bin/sh
set $(cat iplist.txt)
echo "$1 is the first item in the list."
</span><span class="koboSpan" id="kobo.497.2">echo "$3 is the third item in the list."
</span><span class="koboSpan" id="kobo.497.3">echo "********************************"
echo "The most dangerous intruder is $2, which is the second item of the list."
</span><span class="koboSpan" id="kobo.497.4">echo "*******************************"
echo "Here is the entire list of IP addresses in the array:"
echo "$@"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.498.1">And, here’s what I get when I run this on FreeBSD:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.499.1">donnie@freebsd14:~ $ ./ip-4.sh
192.168.0.12 is the first item in the list.
</span><span class="koboSpan" id="kobo.499.2">192.168.0.222 is the third item in the list.
</span><span class="koboSpan" id="kobo.499.3">********************************
The most dangerous intruder is 192.168.0.16, which is the second item of the list.
</span><span class="koboSpan" id="kobo.499.4">*******************************
Here is the entire list of IP addresses in the array:
192.168.0.12 192.168.0.16 192.168.0.222 192.168.0.3
donnie@freebsd14:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.500.1">So yeah, it’s looking good.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.501.1">Next, let’s address something</span><a id="_idIndexMarker1142"/><span class="koboSpan" id="kobo.502.1"> that hasn’t been a problem for us yet, but could be in the future. </span><span class="koboSpan" id="kobo.502.2">That is, the use of </span><code class="inlineCode"><span class="koboSpan" id="kobo.503.1">echo</span></code><span class="koboSpan" id="kobo.504.1">.</span></p>
    <h2 id="_idParaDest-396" class="heading 2"><span class="koboSpan" id="kobo.505.1">Understanding Portability Problems with echo</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.506.1">So far, we haven’t encountered</span><a id="_idIndexMarker1143"/><span class="koboSpan" id="kobo.507.1"> any problems with using </span><code class="inlineCode"><span class="koboSpan" id="kobo.508.1">echo</span></code><span class="koboSpan" id="kobo.509.1"> in our</span><a id="_idIndexMarker1144"/><span class="koboSpan" id="kobo.510.1"> scripts. </span><span class="koboSpan" id="kobo.510.2">That’s only because we haven’t used any of </span><code class="inlineCode"><span class="koboSpan" id="kobo.511.1">echo</span></code><span class="koboSpan" id="kobo.512.1">'s advanced formatting features. </span><span class="koboSpan" id="kobo.512.2">To demonstrate, run this command on your Fedora virtual machine:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.513.1">donnie@fedora:~$ echo -e "I want to fly \vto the moon."
</span><span class="koboSpan" id="kobo.513.2">I want to fly
                    to the moon.
</span><span class="koboSpan" id="kobo.513.3">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.514.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.515.1">\v</span></code><span class="koboSpan" id="kobo.516.1"> that you see in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.517.1">\vto the moon</span></code><span class="koboSpan" id="kobo.518.1"> string inserts a vertical tab, which causes the output to be broken into two lines, with preceding tabs on the second line. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.519.1">To use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.520.1">\v</span></code><span class="koboSpan" id="kobo.521.1"> tag, I had to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.522.1">echo</span></code><span class="koboSpan" id="kobo.523.1"> with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.524.1">-e</span></code><span class="koboSpan" id="kobo.525.1"> option. </span><span class="koboSpan" id="kobo.525.2">Now, try this again without the </span><code class="inlineCode"><span class="koboSpan" id="kobo.526.1">-e</span></code><span class="koboSpan" id="kobo.527.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.528.1">donnie@fedora:~$ echo "I want to fly \vto the moon."
</span><span class="koboSpan" id="kobo.528.2">I want to fly \vto the moon.
</span><span class="koboSpan" id="kobo.528.3">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.529.1">You see that without the </span><code class="inlineCode"><span class="koboSpan" id="kobo.530.1">-e</span></code><span class="koboSpan" id="kobo.531.1">, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.532.1">\v</span></code><span class="koboSpan" id="kobo.533.1"> doesn’t insert the vertical tab as it’s supposed to do.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.534.1">The big problem with </span><code class="inlineCode"><span class="koboSpan" id="kobo.535.1">echo</span></code><span class="koboSpan" id="kobo.536.1"> is that there’s no consistency in how the various non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.537.1">bash</span></code><span class="koboSpan" id="kobo.538.1"> shells handle its option switches. </span><span class="koboSpan" id="kobo.538.2">For example, let’s open a </span><code class="inlineCode"><span class="koboSpan" id="kobo.539.1">dash</span></code><span class="koboSpan" id="kobo.540.1"> session on our Debian machine to see what happens on it:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.541.1">donnie@debian12:~$ dash
$ echo -e "I want to fly \vto the moon."
</span><span class="koboSpan" id="kobo.541.2">-e I want to fly
                        to the moon.
</span><span class="koboSpan" id="kobo.541.3">$ echo "I want to fly \vto the moon."
</span><span class="koboSpan" id="kobo.541.4">I want to fly
                       to the moon.
</span><span class="koboSpan" id="kobo.541.5">$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.542.1">You see that</span><a id="_idIndexMarker1145"/><span class="koboSpan" id="kobo.543.1"> on </span><code class="inlineCode"><span class="koboSpan" id="kobo.544.1">dash</span></code><span class="koboSpan" id="kobo.545.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.546.1">echo -e</span></code><span class="koboSpan" id="kobo.547.1"> inserts</span><a id="_idIndexMarker1146"/><span class="koboSpan" id="kobo.548.1"> a </span><code class="inlineCode"><span class="koboSpan" id="kobo.549.1">-e</span></code><span class="koboSpan" id="kobo.550.1"> at the beginning of the output string. </span><span class="koboSpan" id="kobo.550.2">But, if we omit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.551.1">-e</span></code><span class="koboSpan" id="kobo.552.1">, the output displays correctly. </span><span class="koboSpan" id="kobo.552.2">That’s because the POSIX standard doesn’t define the </span><code class="inlineCode"><span class="koboSpan" id="kobo.553.1">-e</span></code><span class="koboSpan" id="kobo.554.1"> option for </span><code class="inlineCode"><span class="koboSpan" id="kobo.555.1">echo</span></code><span class="koboSpan" id="kobo.556.1">. </span><span class="koboSpan" id="kobo.556.2">Instead, it just allows </span><code class="inlineCode"><span class="koboSpan" id="kobo.557.1">echo</span></code><span class="koboSpan" id="kobo.558.1"> to recognize the backslash formatting options, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.559.1">\v</span></code><span class="koboSpan" id="kobo.560.1">, by default.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.561.1">The best way to have consistent output from your scripts is to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.562.1">printf</span></code><span class="koboSpan" id="kobo.563.1"> instead of </span><code class="inlineCode"><span class="koboSpan" id="kobo.564.1">echo</span></code><span class="koboSpan" id="kobo.565.1">. </span><span class="koboSpan" id="kobo.565.2">Here’s what that looks like on </span><code class="inlineCode"><span class="koboSpan" id="kobo.566.1">dash</span></code><span class="koboSpan" id="kobo.567.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.568.1">donnie@debian12:~$ dash
$ printf "%b\n" "I want to fly \vto the moon."
</span><span class="koboSpan" id="kobo.568.2">I want to fly
                    to the moon.
</span><span class="koboSpan" id="kobo.568.3">$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.569.1">When using </span><code class="inlineCode"><span class="koboSpan" id="kobo.570.1">printf</span></code><span class="koboSpan" id="kobo.571.1">, you need to place the formatting options ahead of the string that you want to output. </span><span class="koboSpan" id="kobo.571.2">In this case, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.572.1">%b</span></code><span class="koboSpan" id="kobo.573.1"> enables the use of the backslash formatting options within the output string, and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.574.1">\n</span></code><span class="koboSpan" id="kobo.575.1"> means to append a newline to the end of the output. </span><span class="koboSpan" id="kobo.575.2">You see that I’ve combined these two options within the </span><code class="inlineCode"><span class="koboSpan" id="kobo.576.1">"%b\n"</span></code><span class="koboSpan" id="kobo.577.1"> construct. </span><span class="koboSpan" id="kobo.577.2">The cool part is that you can run this command on any of your virtual machines, with any shell, and the output will always be consistent.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.578.1">Finally, let’s look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.579.1">ip-5.sh</span></code><span class="koboSpan" id="kobo.580.1"> script, which uses </span><code class="inlineCode"><span class="koboSpan" id="kobo.581.1">printf</span></code><span class="koboSpan" id="kobo.582.1"> instead of echo:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.583.1">#!/bin/sh
set 192.168.3.78 192.168.3.4 192.168.3.9
printf '%s\n' "$1 is the first item in the list."
</span><span class="koboSpan" id="kobo.583.2">printf '%s\n' "$3 is the third item in the list."
</span><span class="koboSpan" id="kobo.583.3">printf '%s\n' "**********************************"
printf '%b\n' "The most dangerous intruder is \v$2,\v which is the second item of the list."
</span><span class="koboSpan" id="kobo.583.4">printf '%s\n' "*********************************"
printf '%s\n' "Here is the entire list of IP addresses in the array:"
printf '%s\n' "$@"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.584.1">For all but one</span><a id="_idIndexMarker1147"/><span class="koboSpan" id="kobo.585.1"> of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.586.1">printf</span></code><span class="koboSpan" id="kobo.587.1"> lines, I used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.588.1">"%s\n"</span></code><span class="koboSpan" id="kobo.589.1"> formatting</span><a id="_idIndexMarker1148"/><span class="koboSpan" id="kobo.590.1"> option, which just means to print out the specified text string with a newline at the end. </span><span class="koboSpan" id="kobo.590.2">In the fourth </span><code class="inlineCode"><span class="koboSpan" id="kobo.591.1">printf</span></code><span class="koboSpan" id="kobo.592.1"> line, I used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.593.1">"%b\n"</span></code><span class="koboSpan" id="kobo.594.1"> option, which means to allow the use of backslash formatting options in the text. </span><span class="koboSpan" id="kobo.594.2">You then see that I surrounded the </span><code class="inlineCode"><span class="koboSpan" id="kobo.595.1">$2</span></code><span class="koboSpan" id="kobo.596.1"> positional parameter with a pair of </span><code class="inlineCode"><span class="koboSpan" id="kobo.597.1">\v</span></code><span class="koboSpan" id="kobo.598.1"> options in order to insert a pair of vertical tabs. </span><span class="koboSpan" id="kobo.598.2">Here’s how it looks when I run the script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.599.1">donnie@fedora:~$ ./ip-5.sh
192.168.3.78 is the first item in the list.
</span><span class="koboSpan" id="kobo.599.2">192.168.3.9 is the third item in the list.
</span><span class="koboSpan" id="kobo.599.3">**********************************
The most dangerous intruder is
                                                  192.168.3.4,
                                                                       which is the second item of the list.
</span><span class="koboSpan" id="kobo.599.4">*********************************
Here is the entire list of IP addresses in the array:
192.168.3.78
192.168.3.4
192.168.3.9
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.600.1">The cool part is, as I said before, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.601.1">printf</span></code><span class="koboSpan" id="kobo.602.1"> output </span><a id="_idIndexMarker1149"/><span class="koboSpan" id="kobo.603.1">will be consistent</span><a id="_idIndexMarker1150"/><span class="koboSpan" id="kobo.604.1"> on all shells.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.605.1">Okay, now that you’ve seen some examples of bashisms, let’s look at how to test our scripts for POSIX compliance.</span></p>
    <h1 id="_idParaDest-397" class="heading 1"><span class="koboSpan" id="kobo.606.1">Testing Scripts for POSIX Compliance</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.607.1">It’s always important to test</span><a id="_idIndexMarker1151"/><span class="koboSpan" id="kobo.608.1"> your shell scripts before putting</span><a id="_idIndexMarker1152"/><span class="koboSpan" id="kobo.609.1"> them into production. </span><span class="koboSpan" id="kobo.609.2">This becomes even more important when you create scripts that need to run on a wide variety of operating systems and shells. </span><span class="koboSpan" id="kobo.609.3">In this section, we’ll look at a few ways to perform that testing.</span></p>
    <h2 id="_idParaDest-398" class="heading 2"><span class="koboSpan" id="kobo.610.1">Creating Scripts on a POSIX-compliant Shell</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.611.1">When you first start creating</span><a id="_idIndexMarker1153"/><span class="koboSpan" id="kobo.612.1"> your scripts, you might</span><a id="_idIndexMarker1154"/><span class="koboSpan" id="kobo.613.1"> want to use an interpreter shell that’s completely POSIX-compliant. </span><span class="koboSpan" id="kobo.613.2">Be aware though, that some POSIX-compliant shells still allow you to use certain bashisms. </span><span class="koboSpan" id="kobo.613.3">That’s because POSIX defines a </span><em class="italic"><span class="koboSpan" id="kobo.614.1">minimum</span></em><span class="koboSpan" id="kobo.615.1"> standard that an operating system or shell must meet, and doesn’t prohibit adding extensions. </span><span class="koboSpan" id="kobo.615.2">For example, </span><code class="inlineCode"><span class="koboSpan" id="kobo.616.1">sh</span></code><span class="koboSpan" id="kobo.617.1"> on FreeBSD allows these two bashisms:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.618.1">Using </span><code class="inlineCode"><span class="koboSpan" id="kobo.619.1">echo -e</span></code><span class="koboSpan" id="kobo.620.1"> for output.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.621.1">Using </span><code class="inlineCode"><span class="koboSpan" id="kobo.622.1">==</span></code><span class="koboSpan" id="kobo.623.1"> for text string comparisons.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.624.1">Now, I haven’t extensively tested </span><code class="inlineCode"><span class="koboSpan" id="kobo.625.1">sh</span></code><span class="koboSpan" id="kobo.626.1"> on FreeBSD to see exactly how many bashisms it allows. </span><span class="koboSpan" id="kobo.626.2">But, the fact that it allows at least these two means that we can’t use it to determine if our scripts will work on our entire network.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.627.1">The most fully POSIX-compliant shell that comes already installed on any operating system is </span><code class="inlineCode"><span class="koboSpan" id="kobo.628.1">dash</span></code><span class="koboSpan" id="kobo.629.1">. </span><span class="koboSpan" id="kobo.629.2">I’ve already mentioned that if you run a </span><code class="inlineCode"><span class="koboSpan" id="kobo.630.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.631.1"> script on a Debian/Ubuntu-type system, it will use </span><code class="inlineCode"><span class="koboSpan" id="kobo.632.1">dash</span></code><span class="koboSpan" id="kobo.633.1"> as the script interpreter. </span><span class="koboSpan" id="kobo.633.2">The benefit is that if you create a script that will run on </span><code class="inlineCode"><span class="koboSpan" id="kobo.634.1">dash</span></code><span class="koboSpan" id="kobo.635.1">, it will most likely also run correctly on every other shell.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.636.1">Well, almost. </span><span class="koboSpan" id="kobo.636.2">Remember what I showed you just a while ago with </span><code class="inlineCode"><span class="koboSpan" id="kobo.637.1">echo -e</span></code><span class="koboSpan" id="kobo.638.1">. </span><span class="koboSpan" id="kobo.638.2">I showed you that on </span><code class="inlineCode"><span class="koboSpan" id="kobo.639.1">bash</span></code><span class="koboSpan" id="kobo.640.1">, you must use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.641.1">-e</span></code><span class="koboSpan" id="kobo.642.1"> option to include any backslash formatting options. </span><span class="koboSpan" id="kobo.642.2">Here’s what I mean:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.643.1">donnie@fedora:~$ echo -e "I want to fly \vto the moon."
</span><span class="koboSpan" id="kobo.643.2">I want to fly
                    to the moon.
</span><span class="koboSpan" id="kobo.643.3">donnie@fedora:~$ echo "I want to fly \vto the moon."
</span><span class="koboSpan" id="kobo.643.4">I want to fly \vto the moon.
</span><span class="koboSpan" id="kobo.643.5">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.644.1">So on </span><code class="inlineCode"><span class="koboSpan" id="kobo.645.1">bash</span></code><span class="koboSpan" id="kobo.646.1">, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.647.1">\v</span></code><span class="koboSpan" id="kobo.648.1"> formatting option</span><a id="_idIndexMarker1155"/><span class="koboSpan" id="kobo.649.1"> doesn’t work unless</span><a id="_idIndexMarker1156"/><span class="koboSpan" id="kobo.650.1"> you use </span><code class="inlineCode"><span class="koboSpan" id="kobo.651.1">echo</span></code><span class="koboSpan" id="kobo.652.1"> with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.653.1">-e</span></code><span class="koboSpan" id="kobo.654.1"> switch. </span><span class="koboSpan" id="kobo.654.2">On </span><code class="inlineCode"><span class="koboSpan" id="kobo.655.1">dash</span></code><span class="koboSpan" id="kobo.656.1">, it’s the opposite, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.657.1">donnie@debian12:~$ dash
$ echo -e "I want to fly \vto the moon."
</span><span class="koboSpan" id="kobo.657.2">-e I want to fly
                 to the moon.
</span><span class="koboSpan" id="kobo.657.3">$ echo "I want to fly \vto the moon."
</span><span class="koboSpan" id="kobo.657.4">I want to fly
              to the moon.
</span><span class="koboSpan" id="kobo.657.5">$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.658.1">So, if you use </span><code class="inlineCode"><span class="koboSpan" id="kobo.659.1">echo</span></code><span class="koboSpan" id="kobo.660.1"> commands in your scripts, they might work properly on </span><code class="inlineCode"><span class="koboSpan" id="kobo.661.1">dash</span></code><span class="koboSpan" id="kobo.662.1">, but not on </span><code class="inlineCode"><span class="koboSpan" id="kobo.663.1">bash</span></code><span class="koboSpan" id="kobo.664.1">. </span><span class="koboSpan" id="kobo.664.2">Your best bet, as I’ve mentioned before, is to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.665.1">printf</span></code><span class="koboSpan" id="kobo.666.1"> instead of </span><code class="inlineCode"><span class="koboSpan" id="kobo.667.1">echo</span></code><span class="koboSpan" id="kobo.668.1">. </span><span class="koboSpan" id="kobo.668.2">Aside from that though, if you do create scripts that will run on </span><code class="inlineCode"><span class="koboSpan" id="kobo.669.1">dash</span></code><span class="koboSpan" id="kobo.670.1">, you’ll also want to test them on </span><code class="inlineCode"><span class="koboSpan" id="kobo.671.1">bash</span></code><span class="koboSpan" id="kobo.672.1">. </span><span class="koboSpan" id="kobo.672.2">I don’t know how many POSIX-specific things there are that will run on </span><code class="inlineCode"><span class="koboSpan" id="kobo.673.1">dash</span></code><span class="koboSpan" id="kobo.674.1"> but not on </span><code class="inlineCode"><span class="koboSpan" id="kobo.675.1">bash</span></code><span class="koboSpan" id="kobo.676.1">. </span><span class="koboSpan" id="kobo.676.2">But, we do know about this </span><code class="inlineCode"><span class="koboSpan" id="kobo.677.1">echo -e</span></code><span class="koboSpan" id="kobo.678.1"> thing.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.679.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.680.1">Policy-compliant Ordinary Shell</span></strong><span class="koboSpan" id="kobo.681.1"> (</span><code class="inlineCode"><span class="koboSpan" id="kobo.682.1">posh</span></code><span class="koboSpan" id="kobo.683.1">) is a shell that’s even more</span><a id="_idIndexMarker1157"/><span class="koboSpan" id="kobo.684.1"> strictly POSIX-compliant than </span><code class="inlineCode"><span class="koboSpan" id="kobo.685.1">dash</span></code><span class="koboSpan" id="kobo.686.1">. </span><span class="koboSpan" id="kobo.686.2">The main problem with it is that the Debian/Ubuntu-type distros appear to be the only ones that have it in their repositories. </span><span class="koboSpan" id="kobo.686.3">On the other hand, you can easily install </span><code class="inlineCode"><span class="koboSpan" id="kobo.687.1">dash</span></code><span class="koboSpan" id="kobo.688.1"> on pretty much any Linux distro, as well as on some of the Unix-like</span><a id="_idIndexMarker1158"/><span class="koboSpan" id="kobo.689.1"> distros, such</span><a id="_idIndexMarker1159"/><span class="koboSpan" id="kobo.690.1"> as FreeBSD.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.691.1">At any rate, you can read more about </span><code class="inlineCode"><span class="koboSpan" id="kobo.692.1">posh</span></code><span class="koboSpan" id="kobo.693.1"> here:</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.694.1">How to check your shell scripts for portability: </span><a href="https://people.redhat.com/~thuth/blog/general/2021/04/27/portable-shell.html"><span class="url"><span class="koboSpan" id="kobo.695.1">https://people.redhat.com/~thuth/blog/general/2021/04/27/portable-shell.html</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.696.1">And, speaking of testing, let’s look at ways to do that.</span></p>
    <h2 id="_idParaDest-399" class="heading 2"><span class="koboSpan" id="kobo.697.1">Using checkbashisms</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.698.1">This cool </span><code class="inlineCode"><span class="koboSpan" id="kobo.699.1">checkbashisms</span></code><span class="koboSpan" id="kobo.700.1"> utility will look</span><a id="_idIndexMarker1160"/><span class="koboSpan" id="kobo.701.1"> through your scripts for anything that might not work on non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.702.1">bash</span></code><span class="koboSpan" id="kobo.703.1"> shells. </span><span class="koboSpan" id="kobo.703.2">First though, you’ll need to install it. </span><span class="koboSpan" id="kobo.703.3">Here’s how to do it:</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.704.1">On Fedora:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.705.1">donnie@fedora:~$ sudo dnf install devscripts-checkbashisms
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.706.1">On Debian/Ubuntu:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.707.1">donnie@debian12:~$ sudo apt install devscripts
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.708.1">On FreeBSD:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.709.1">donnie@freebsd14:~ $ sudo pkg install checkbashisms
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.710.1">On macOS:</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.711.1">Install the Homebrew system, and then install the </span><code class="inlineCode"><span class="koboSpan" id="kobo.712.1">checkbashisms</span></code><span class="koboSpan" id="kobo.713.1"> package with:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.714.1">macmini@MacMinis-Mac-mini ~ % brew install checkbashisms
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.715.1">For directions on how</span><a id="_idIndexMarker1161"/><span class="koboSpan" id="kobo.716.1"> to install the Homebrew system on your Mac, go to: </span><a href="https://brew.sh"><span class="url"><span class="koboSpan" id="kobo.717.1">https://brew.sh</span></span></a></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.718.1">Basic usage of </span><code class="inlineCode"><span class="koboSpan" id="kobo.719.1">checkbashisms</span></code><span class="koboSpan" id="kobo.720.1"> is easy. </span><span class="koboSpan" id="kobo.720.2">If the script</span><a id="_idIndexMarker1162"/><span class="koboSpan" id="kobo.721.1"> that you want to test has </span><code class="inlineCode"><span class="koboSpan" id="kobo.722.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.723.1"> as its shebang line, then just enter:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.724.1">donnie@fedora:~$ checkbashisms scriptname.sh
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.725.1">By default, </span><code class="inlineCode"><span class="koboSpan" id="kobo.726.1">checkbashims</span></code><span class="koboSpan" id="kobo.727.1"> only checks scripts that have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.728.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.729.1"> shebang line. </span><span class="koboSpan" id="kobo.729.2">If your script uses something else as the shebang line, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.730.1">#!/bin/bash</span></code><span class="koboSpan" id="kobo.731.1">, then use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.732.1">-f </span></code><span class="koboSpan" id="kobo.733.1">option to force it to check the script, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.734.1">donnie@fedora:~$ checkbashisms -f scriptbashname.sh
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.735.1">For the first example, let’s take another look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.736.1">ip-2.sh</span></code><span class="koboSpan" id="kobo.737.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.738.1">#!/bin/sh
echo "IP Addresses of intruder attempts"
declare -a ip
ip=( 192.168.3.78 192.168.3.4 192.168.3.9 )
echo "ip[0] is ${ip[0]}, the first item in the list."
</span><span class="koboSpan" id="kobo.738.2">echo "ip[2] is ${ip[2]}, the third item in the list."
</span><span class="koboSpan" id="kobo.738.3">echo "***********************************"
echo "The most dangerous intruder is ${ip[1]}, which is in ip[1]."
</span><span class="koboSpan" id="kobo.738.4">echo "***********************************"
echo "Here is the entire list of IP addresses in the array."
</span><span class="koboSpan" id="kobo.738.5">echo ${ip[*]}
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.739.1">Now, let’s see what </span><code class="inlineCode"><span class="koboSpan" id="kobo.740.1">checkbashisms</span></code><span class="koboSpan" id="kobo.741.1"> has to say about it:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.742.1">donnie@fedora:~$ checkbashisms ip-2.sh
possible bashism in ip-2.sh line 3 (declare):
declare -a ip
possible bashism in ip-2.sh line 5 (bash arrays, ${name[0|*|@]}):
echo "ip[0] is ${ip[0]}, the first item in the list."
</span><span class="koboSpan" id="kobo.742.2">possible bashism in ip-2.sh line 6 (bash arrays, ${name[0|*|@]}):
echo "ip[2] is ${ip[2]}, the third item in the list."
</span><span class="koboSpan" id="kobo.742.3">possible bashism in ip-2.sh line 8 (bash arrays, ${name[0|*|@]}):
echo "The most dangerous intruder is ${ip[1]}, which is in ip[1]."
</span><span class="koboSpan" id="kobo.742.4">possible bashism in ip-2.sh line 11 (bash arrays, ${name[0|*|@]}):
echo ${ip[*]}
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.743.1">Well, that’s certainly no surprise, because we already established that some non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.744.1">bash</span></code><span class="koboSpan" id="kobo.745.1"> shells can’t do arrays. </span><span class="koboSpan" id="kobo.745.2">And, I’ve already shown you how to deal with that.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.746.1">Okay, here’s a bashism that you haven’t seen yet, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.747.1">math6.sh</span></code><span class="koboSpan" id="kobo.748.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.749.1">#!/bin/sh
start=0
limit=10
while [ "$start" -le "$limit" ]; do
  echo "$start... </span><span class="koboSpan" id="kobo.749.2">"
  start=$["$start"+1]
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.750.1">This is a while loop that echoes</span><a id="_idIndexMarker1163"/><span class="koboSpan" id="kobo.751.1"> the number 0 through 10, followed by a string of three dots, each on its own line. </span><span class="koboSpan" id="kobo.751.2">Here’s how its output looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.752.1">donnie@fedora:~$ ./math6.sh
0...
</span><span class="koboSpan" id="kobo.752.2">1...
</span><span class="koboSpan" id="kobo.752.3">2...
</span><span class="koboSpan" id="kobo.752.4">3...
</span><span class="koboSpan" id="kobo.752.5">4...
</span><span class="koboSpan" id="kobo.752.6">5...
</span><span class="koboSpan" id="kobo.752.7">6...
</span><span class="koboSpan" id="kobo.752.8">7...
</span><span class="koboSpan" id="kobo.752.9">8...
</span><span class="koboSpan" id="kobo.752.10">9...
</span><span class="koboSpan" id="kobo.752.11">10...
</span><span class="koboSpan" id="kobo.752.12">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.753.1">It looks good here on Fedora with </span><code class="inlineCode"><span class="koboSpan" id="kobo.754.1">bash</span></code><span class="koboSpan" id="kobo.755.1">. </span><span class="koboSpan" id="kobo.755.2">But, will it work on Debian with </span><code class="inlineCode"><span class="koboSpan" id="kobo.756.1">dash</span></code><span class="koboSpan" id="kobo.757.1">? </span><span class="koboSpan" id="kobo.757.2">Let’s see:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.758.1">donnie@debian12:~$ ./math6.sh
0...
</span><span class="koboSpan" id="kobo.758.2">./math6.sh: 4: [: Illegal number: $[0+1]
donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.759.1">What’s the problem? </span><span class="koboSpan" id="kobo.759.2">Perhaps </span><code class="inlineCode"><span class="koboSpan" id="kobo.760.1">checkbashisms</span></code><span class="koboSpan" id="kobo.761.1"> can tell us:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.762.1">donnie@debian12:~$ checkbashisms math6.sh
possible bashism in math6.sh line 6 ('$[' should be '$(('):
  start=$["$start"+1]
donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.763.1">The problem is in line 6. </span><span class="koboSpan" id="kobo.763.2">It’s just</span><a id="_idIndexMarker1164"/><span class="koboSpan" id="kobo.764.1"> that </span><code class="inlineCode"><span class="koboSpan" id="kobo.765.1">bash</span></code><span class="koboSpan" id="kobo.766.1"> can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.767.1">[. </span><span class="koboSpan" id="kobo.767.2">. </span><span class="koboSpan" id="kobo.767.3">.]</span></code><span class="koboSpan" id="kobo.768.1"> construct for performing integer math. </span><span class="koboSpan" id="kobo.768.2">But, other shells have to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.769.1">((. </span><span class="koboSpan" id="kobo.769.2">. </span><span class="koboSpan" id="kobo.769.3">.))</span></code><span class="koboSpan" id="kobo.770.1"> construct. </span><span class="koboSpan" id="kobo.770.2">So, let’s fix that in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.771.1">math7.sh</span></code><span class="koboSpan" id="kobo.772.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.773.1">#!/bin/sh
start=0
limit=10
while [ "$start" -le "$limit" ]; do
  echo "$start... </span><span class="koboSpan" id="kobo.773.2">"
  start=$(("$start"+1))
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.774.1">That should work much better, right? </span><span class="koboSpan" id="kobo.774.2">Well, let’s see:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.775.1">donnie@debian12:~$ ./math7.sh
0...
</span><span class="koboSpan" id="kobo.775.2">./math7.sh: 6: arithmetic expression: expecting primary: ""0"+1"
donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.776.1">No, it’s still broken. </span><span class="koboSpan" id="kobo.776.2">So, let’s give it another </span><code class="inlineCode"><span class="koboSpan" id="kobo.777.1">checkbashisms</span></code><span class="koboSpan" id="kobo.778.1"> scan:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.779.1">donnie@debian12:~$ checkbashisms math7.sh
donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.780.1">Whoa, now. </span><span class="koboSpan" id="kobo.780.2">What’s going on here? </span><span class="koboSpan" id="kobo.780.3">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.781.1">checkbashisms</span></code><span class="koboSpan" id="kobo.782.1"> scan says that my code is good, yet the script is still clearly broken when running on </span><code class="inlineCode"><span class="koboSpan" id="kobo.783.1">dash</span></code><span class="koboSpan" id="kobo.784.1">. </span><span class="koboSpan" id="kobo.784.2">What’s up with that? </span><span class="koboSpan" id="kobo.784.3">Well, after a bit of experimentation, I discovered that surrounding the variable name that’s within the math expression with a pair of quotes is also a bashism. </span><span class="koboSpan" id="kobo.784.4">But, it’s one that </span><code class="inlineCode"><span class="koboSpan" id="kobo.785.1">checkbashisms</span></code><span class="koboSpan" id="kobo.786.1"> doesn’t catch. </span><span class="koboSpan" id="kobo.786.2">Let’s fix that in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.787.1">math8.sh</span></code><span class="koboSpan" id="kobo.788.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.789.1">#!/bin/sh
start=0
limit=10
while [ "$start" -le "$limit" ]; do
  echo "$start... </span><span class="koboSpan" id="kobo.789.2">"
  start=$(($start+1))
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.790.1">Okay, will this now finally work? </span><span class="koboSpan" id="kobo.790.2">Drum roll, please!</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.791.1">donnie@debian12:~$ ./math8.sh
0...
</span><span class="koboSpan" id="kobo.791.2">1...
</span><span class="koboSpan" id="kobo.791.3">2...
</span><span class="koboSpan" id="kobo.791.4">3...
</span><span class="koboSpan" id="kobo.791.5">4...
</span><span class="koboSpan" id="kobo.791.6">5...
</span><span class="koboSpan" id="kobo.791.7">6...
</span><span class="koboSpan" id="kobo.791.8">7...
</span><span class="koboSpan" id="kobo.791.9">8...
</span><span class="koboSpan" id="kobo.791.10">9...
</span><span class="koboSpan" id="kobo.791.11">10...
</span><span class="koboSpan" id="kobo.791.12">donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.792.1">Indeed, it now works like a champ.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.793.1">So, you’ve seen that </span><code class="inlineCode"><span class="koboSpan" id="kobo.794.1">checkbashisms</span></code><span class="koboSpan" id="kobo.795.1"> is a great utility</span><a id="_idIndexMarker1165"/><span class="koboSpan" id="kobo.796.1"> that can really help you out. </span><span class="koboSpan" id="kobo.796.2">But, as with most things that mankind has invented, it isn’t perfect. </span><span class="koboSpan" id="kobo.796.3">It can flag a lot of problematic, non-POSIX code, but it does allow some </span><code class="inlineCode"><span class="koboSpan" id="kobo.797.1">bash</span></code><span class="koboSpan" id="kobo.798.1">-specific things to slip through. </span><span class="koboSpan" id="kobo.798.2">(It would be nice if there were a list </span><a id="_idIndexMarker1166"/><span class="koboSpan" id="kobo.799.1">of things that </span><code class="inlineCode"><span class="koboSpan" id="kobo.800.1">checkbashisms</span></code><span class="koboSpan" id="kobo.801.1"> misses, but there isn’t.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.802.1">All right, let’s move on to our next code-checking utility.</span></p>
    <h2 id="_idParaDest-400" class="heading 2"><span class="koboSpan" id="kobo.803.1">Using shellcheck</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.804.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.805.1">shellcheck</span></code><span class="koboSpan" id="kobo.806.1"> utility is another</span><a id="_idIndexMarker1167"/><span class="koboSpan" id="kobo.807.1"> great code-checking tool that can</span><a id="_idIndexMarker1168"/><span class="koboSpan" id="kobo.808.1"> also check for bashisms. </span><span class="koboSpan" id="kobo.808.2">It’s available on most Linux and BSD distros. </span><span class="koboSpan" id="kobo.808.3">Here’s how to install it:</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.809.1">On Fedora:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.810.1">donnie@fedora:~$ sudo dnf install ShellCheck
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.811.1">On Debian/Ubuntu:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.812.1">donnie@debian12:~$ sudo apt install shellcheck
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.813.1">On FreeBSD:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.814.1">donnie@freebsd14:~ $ sudo pkg install hs-ShellCheck
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.815.1">On macOS with Homebrew installed:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.816.1">macmini@MacMinis-Mac-mini ~ % brew install shellcheck
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.817.1">To demo this, let’s go back to the Debian machine, and scan the same scripts that we scanned with </span><code class="inlineCode"><span class="koboSpan" id="kobo.818.1">checkbashisms</span></code><span class="koboSpan" id="kobo.819.1">. </span><span class="koboSpan" id="kobo.819.2">We’ll begin with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.820.1">ip-2.sh</span></code><span class="koboSpan" id="kobo.821.1"> script. </span><span class="koboSpan" id="kobo.821.2">Here are the relevant parts of the output:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.822.1">donnie@debian12:~$ shellcheck ip-2.sh
In ip-2.sh line 4:
ip=( 192.168.3.78 192.168.3.4 192.168.3.9 )
   ^-- SC3030 (warning): In POSIX sh, arrays are undefined.
</span><span class="koboSpan" id="kobo.822.2">In ip-2.sh line 5:
echo "ip[0] is ${ip[0]}, the first item in the list."
               </span><span class="koboSpan" id="kobo.822.3">^------^ SC3054 (warning): In POSIX sh, array references are undefined.
</span><span class="koboSpan" id="kobo.822.4">. </span><span class="koboSpan" id="kobo.822.5">. </span><span class="koboSpan" id="kobo.822.6">.
</span><span class="koboSpan" id="kobo.822.7">In ip-2.sh line 11:
echo ${ip[*]}
     ^------^ SC2048 (warning): Use "${array[@]}" (with quotes) to prevent whitespace problems.
     </span><span class="koboSpan" id="kobo.822.8">^------^ SC3054 (warning): In POSIX sh, array references are undefined.
     </span><span class="koboSpan" id="kobo.822.9">^------^ SC2086 (info): Double quote to prevent globbing and word splitting.
</span><span class="koboSpan" id="kobo.822.10">. </span><span class="koboSpan" id="kobo.822.11">. </span><span class="koboSpan" id="kobo.822.12">.
</span><span class="koboSpan" id="kobo.822.13">donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.823.1">You see that </span><code class="inlineCode"><span class="koboSpan" id="kobo.824.1">shellcheck</span></code><span class="koboSpan" id="kobo.825.1"> does warn</span><a id="_idIndexMarker1169"/><span class="koboSpan" id="kobo.826.1"> us that we can’t use arrays in POSIX-compliant</span><a id="_idIndexMarker1170"/><span class="koboSpan" id="kobo.827.1"> scripts. </span><span class="koboSpan" id="kobo.827.2">It also warns us about issues involving good programming practices that aren’t necessarily POSIX issues. </span><span class="koboSpan" id="kobo.827.3">In this case, it reminds us that we should surround variable expansion constructs, </span><code class="inlineCode"><span class="koboSpan" id="kobo.828.1">${ip[0]}</span></code><span class="koboSpan" id="kobo.829.1"> in this case, with a pair of double quotes in order to prevent whitespace problems. </span><span class="koboSpan" id="kobo.829.2">Of course, that’s a moot point here, because the </span><code class="inlineCode"><span class="koboSpan" id="kobo.830.1">${ip[0]}</span></code><span class="koboSpan" id="kobo.831.1"> construct here is part of the array definition that we can’t use anyway.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.832.1">Now, let’s try the </span><code class="inlineCode"><span class="koboSpan" id="kobo.833.1">math6.sh</span></code><span class="koboSpan" id="kobo.834.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.835.1">donnie@debian12:~$ shellcheck math6.sh
In math6.sh line 6:
  start=$["$start"+1]
        ^-----------^ SC3007 (warning): In POSIX sh, $[..] in place of $((..)) is undefined.
        </span><span class="koboSpan" id="kobo.835.2">^-----------^ SC2007 (style): Use $((..)) instead of deprecated $[..]
For more information:
  https://www.shellcheck.net/wiki/SC3007 -- In POSIX sh, $[..] in place of $(...
  </span><span class="koboSpan" id="kobo.835.3">https://www.shellcheck.net/wiki/SC2007 -- Use $((..)) instead of 
deprecated...
</span><span class="koboSpan" id="kobo.835.4">donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.836.1">As expected, </span><code class="inlineCode"><span class="koboSpan" id="kobo.837.1">shellcheck</span></code><span class="koboSpan" id="kobo.838.1"> detects the non-POSIX way of doing math. </span><span class="koboSpan" id="kobo.838.2">So, that’s good.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.839.1">Scanning </span><code class="inlineCode"><span class="koboSpan" id="kobo.840.1">math7.sh</span></code><span class="koboSpan" id="kobo.841.1"> gives us this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.842.1">donnie@debian12:~$ shellcheck math7.sh
donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.843.1">Here, we see the same problem</span><a id="_idIndexMarker1171"/><span class="koboSpan" id="kobo.844.1"> that we saw with </span><code class="inlineCode"><span class="koboSpan" id="kobo.845.1">checkbashisms</span></code><span class="koboSpan" id="kobo.846.1">. </span><span class="koboSpan" id="kobo.846.2">That is, </span><code class="inlineCode"><span class="koboSpan" id="kobo.847.1">math7.sh</span></code><span class="koboSpan" id="kobo.848.1"> has the variable</span><a id="_idIndexMarker1172"/><span class="koboSpan" id="kobo.849.1"> name that’s within the math construct surrounded by a pair of double quotes, as you see in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.850.1">start=$(("$start"+1))</span></code><span class="koboSpan" id="kobo.851.1"> line. </span><span class="koboSpan" id="kobo.851.2">We’ve already established that this works on </span><code class="inlineCode"><span class="koboSpan" id="kobo.852.1">bash</span></code><span class="koboSpan" id="kobo.853.1"> but not on </span><code class="inlineCode"><span class="koboSpan" id="kobo.854.1">dash</span></code><span class="koboSpan" id="kobo.855.1">, yet </span><code class="inlineCode"><span class="koboSpan" id="kobo.856.1">shellcheck</span></code><span class="koboSpan" id="kobo.857.1"> doesn’t flag this as a problem.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.858.1">Finally, let’s try this with </span><code class="inlineCode"><span class="koboSpan" id="kobo.859.1">math8.sh</span></code><span class="koboSpan" id="kobo.860.1">. </span><span class="koboSpan" id="kobo.860.2">As you’ll recall, this is the script that we finally got to work on </span><code class="inlineCode"><span class="koboSpan" id="kobo.861.1">dash</span></code><span class="koboSpan" id="kobo.862.1">. </span><span class="koboSpan" id="kobo.862.2">Here’s how that looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.863.1">donnie@debian12:~$ shellcheck math8.sh
In math8.sh line 6:
  start=$(($start+1))
           ^----^ SC2004 (style): $/${} is unnecessary on arithmetic variables.
</span><span class="koboSpan" id="kobo.863.2">For more information:
  https://www.shellcheck.net/wiki/SC2004 -- $/${} is unnecessary on arithmeti...
</span><span class="koboSpan" id="kobo.863.3">donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.864.1">In this case, the script works perfectly well on our Debian/</span><code class="inlineCode"><span class="koboSpan" id="kobo.865.1">dash</span></code><span class="koboSpan" id="kobo.866.1"> machine. </span><span class="koboSpan" id="kobo.866.2">Here, </span><code class="inlineCode"><span class="koboSpan" id="kobo.867.1">shellcheck</span></code><span class="koboSpan" id="kobo.868.1"> is pointing out a stylistic issue that doesn’t affect whether the script will actually work. </span><span class="koboSpan" id="kobo.868.2">If you recall from </span><em class="chapterRef"><span class="koboSpan" id="kobo.869.1">Chapter 11, Performing Mathematical Operations</span></em><span class="koboSpan" id="kobo.870.1">, I showed you that when recalling the value of a variable that’s within a math construct, it’s not necessary to preface the variable name with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.871.1">$</span></code><span class="koboSpan" id="kobo.872.1">. </span><span class="koboSpan" id="kobo.872.2">I mean, it doesn’t hurt anything if you do, but it’s not necessary.</span></p>
    <h3 id="_idParaDest-401" class="heading 3"><span class="koboSpan" id="kobo.873.1">Specifying a Shell with the -s Option</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.874.1">Another benefit</span><a id="_idIndexMarker1173"/><span class="koboSpan" id="kobo.875.1"> of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.876.1">shellcheck</span></code><span class="koboSpan" id="kobo.877.1"> is that you can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.878.1">-s</span></code><span class="koboSpan" id="kobo.879.1"> option to specify which shell that you want to use for testing your script. </span><span class="koboSpan" id="kobo.879.2">Even if the shebang line in your script is </span><code class="inlineCode"><span class="koboSpan" id="kobo.880.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.881.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.882.1">sh</span></code><span class="koboSpan" id="kobo.883.1"> on your machine points</span><a id="_idIndexMarker1174"/><span class="koboSpan" id="kobo.884.1"> to a non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.885.1">bash</span></code><span class="koboSpan" id="kobo.886.1"> shell, you can still test it against </span><code class="inlineCode"><span class="koboSpan" id="kobo.887.1">bash</span></code><span class="koboSpan" id="kobo.888.1">, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.889.1">donnie@debian12:~$ shellcheck -s bash ip-2.sh
In ip-2.sh line 11:
echo ${ip[*]}
     ^------^ SC2048 (warning): Use "${array[@]}" (with quotes) to prevent whitespace problems.
     </span><span class="koboSpan" id="kobo.889.2">^------^ SC2086 (info): Double quote to prevent globbing and word splitting.
</span><span class="koboSpan" id="kobo.889.3">Did you mean:
echo "${ip[*]}"
For more information:
  https://www.shellcheck.net/wiki/SC2048 -- Use "${array[@]}" (with quotes) t...
  </span><span class="koboSpan" id="kobo.889.4">https://www.shellcheck.net/wiki/SC2086 -- Double quote to prevent globbing ...
</span><span class="koboSpan" id="kobo.889.5">donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.890.1">By testing against </span><code class="inlineCode"><span class="koboSpan" id="kobo.891.1">bash</span></code><span class="koboSpan" id="kobo.892.1">, we no longer get the warning about how we can’t use arrays. </span><span class="koboSpan" id="kobo.892.2">All we get this time is just a reminder that we should surround variable names with double quotes.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.893.1">With the </span><code class="inlineCode"><span class="koboSpan" id="kobo.894.1">-s</span></code><span class="koboSpan" id="kobo.895.1"> option, you can specify </span><code class="inlineCode"><span class="koboSpan" id="kobo.896.1">sh</span></code><span class="koboSpan" id="kobo.897.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.898.1">bash</span></code><span class="koboSpan" id="kobo.899.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.900.1">dash</span></code><span class="koboSpan" id="kobo.901.1">, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.902.1">ksh</span></code><span class="koboSpan" id="kobo.903.1">. </span><span class="koboSpan" id="kobo.903.2">(Curiously, it doesn’t work with </span><code class="inlineCode"><span class="koboSpan" id="kobo.904.1">zsh</span></code><span class="koboSpan" id="kobo.905.1">.)</span></p>
    </div>
    <h3 id="_idParaDest-402" class="heading 3"><span class="koboSpan" id="kobo.906.1">Hands-on Lab – Using -s to Scan Function Libraries</span></h3>
    <p class="normal"><span class="koboSpan" id="kobo.907.1">You can also use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.908.1">-s</span></code><span class="koboSpan" id="kobo.909.1"> option</span><a id="_idIndexMarker1175"/><span class="koboSpan" id="kobo.910.1"> to scan function library files that don’t have a shebang line. </span><span class="koboSpan" id="kobo.910.2">To see how that’s done, let’s scan the </span><code class="inlineCode"><span class="koboSpan" id="kobo.911.1">sysinfo.lib</span></code><span class="koboSpan" id="kobo.912.1"> file that we last encountered back in </span><em class="chapterRef"><span class="koboSpan" id="kobo.913.1">Chapter 14, Using awk-Part 1</span></em><span class="koboSpan" id="kobo.914.1">.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.915.1">The scripts and library files in this section are too large to show here in their entirety. </span><span class="koboSpan" id="kobo.915.2">So, be sure to download them from the GitHub repository.</span></p>
    </div>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.916.1">First, copy the </span><code class="inlineCode"><span class="koboSpan" id="kobo.917.1">sysinfo.lib</span></code><span class="koboSpan" id="kobo.918.1"> file to </span><code class="inlineCode"><span class="koboSpan" id="kobo.919.1">sysinfo_posix.lib</span></code><span class="koboSpan" id="kobo.920.1">, like so:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.921.1">donnie@debian12:~$ cp sysinfo.lib sysinfo_posix.lib
donnie@debian12:~$
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.922.1">Then, scan it for </span><code class="inlineCode"><span class="koboSpan" id="kobo.923.1">bash</span></code><span class="koboSpan" id="kobo.924.1">, since it was originally</span><a id="_idIndexMarker1176"/><span class="koboSpan" id="kobo.925.1"> only meant to be used on </span><code class="inlineCode"><span class="koboSpan" id="kobo.926.1">bash</span></code><span class="koboSpan" id="kobo.927.1">. </span><span class="koboSpan" id="kobo.927.2">Here’s the relevant output:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.928.1">donnie@debian12:~$ shellcheck -s bash sysinfo_posix.lib
In sysinfo_posix.lib line 19:
            if [ $(uname) = SunOS ]; then
                 ^------^ SC2046 (warning): Quote this to prevent word splitting.
</span><span class="koboSpan" id="kobo.928.2">. </span><span class="koboSpan" id="kobo.928.3">. </span><span class="koboSpan" id="kobo.928.4">.
</span><span class="koboSpan" id="kobo.928.5">In sysinfo_posix.lib line 48:
                cd /Users
                ^-------^ SC2164 (warning): Use 'cd ... </span><span class="koboSpan" id="kobo.928.6">|| exit' or 'cd ... </span><span class="koboSpan" id="kobo.928.7">|| return' in case cd fails.
</span><span class="koboSpan" id="kobo.928.8">Did you mean:
                cd /Users || exit
. </span><span class="koboSpan" id="kobo.928.9">. </span><span class="koboSpan" id="kobo.928.10">.
</span><span class="koboSpan" id="kobo.928.11">donnie@debian12:~$
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.929.1">For </span><code class="inlineCode"><span class="koboSpan" id="kobo.930.1">bash</span></code><span class="koboSpan" id="kobo.931.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.932.1">shellcheck</span></code><span class="koboSpan" id="kobo.933.1"> didn’t find any show-stopping problems. </span><span class="koboSpan" id="kobo.933.2">But, it does suggest some improvements that could prevent problems. </span><span class="koboSpan" id="kobo.933.3">First, it suggests that I surround the </span><code class="inlineCode"><span class="koboSpan" id="kobo.934.1">uname</span></code><span class="koboSpan" id="kobo.935.1"> command substitutions with double quotes, in case </span><code class="inlineCode"><span class="koboSpan" id="kobo.936.1">uname</span></code><span class="koboSpan" id="kobo.937.1"> returns a text string that contains either white space or special characters that the shell could misinterpret. </span><span class="koboSpan" id="kobo.937.2">In reality, though, this will never be a problem in this script, because we know that </span><code class="inlineCode"><span class="koboSpan" id="kobo.938.1">uname</span></code><span class="koboSpan" id="kobo.939.1"> will never return anything except for a plain-text, purely alphabetic string. </span><span class="koboSpan" id="kobo.939.2">But, let’s fix it anyway. </span><span class="koboSpan" id="kobo.939.3">In this case, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.940.1">if [ $(uname) = SunOS ]; then</span></code><span class="koboSpan" id="kobo.941.1"> line will become:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.942.1">if [ "$(uname)" = SunOS ]; then
</span></code></pre>
      </li>
    </ol>
    <p class="normal one"><span class="koboSpan" id="kobo.943.1">We’ll do the same thing for every occurrence of the </span><span class="url"><span class="koboSpan" id="kobo.944.1">uname</span></span><span class="koboSpan" id="kobo.945.1"> command substitution.</span></p>
    <ol>
      <li class="numberedList" value="4"><span class="koboSpan" id="kobo.946.1">The second suggestion we see is to insert a graceful exit mechanism in case the script can’t </span><code class="inlineCode"><span class="koboSpan" id="kobo.947.1">cd</span></code><span class="koboSpan" id="kobo.948.1"> into the /</span><code class="inlineCode"><span class="koboSpan" id="kobo.949.1">Users/</span></code><span class="koboSpan" id="kobo.950.1"> directory. </span><span class="koboSpan" id="kobo.950.2">Again, we know that this won’t be a problem in this script, because we know that the specified directory will always be present. </span><span class="koboSpan" id="kobo.950.3">But again, let’s fix it anyway. </span><span class="koboSpan" id="kobo.950.4">Let’s take that </span><code class="inlineCode"><span class="koboSpan" id="kobo.951.1">cd /Users</span></code><span class="koboSpan" id="kobo.952.1"> line and change it to:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.953.1">cd /Users || return
</span></code></pre>
      </li>
    </ol>
    <p class="normal one"><span class="koboSpan" id="kobo.954.1">We’ll do the same thing for all of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.955.1">cd</span></code><span class="koboSpan" id="kobo.956.1"> commands in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.957.1">open_files_users()</span></code><span class="koboSpan" id="kobo.958.1"> function. </span><span class="koboSpan" id="kobo.958.2">That way, if a </span><code class="inlineCode"><span class="koboSpan" id="kobo.959.1">cd</span></code><span class="koboSpan" id="kobo.960.1"> command fails, the script will just continue running without this function.</span></p>
    <ol>
      <li class="numberedList" value="5"><span class="koboSpan" id="kobo.961.1">Now, let’s say that we want</span><a id="_idIndexMarker1177"/><span class="koboSpan" id="kobo.962.1"> to make this script portable, so that we won’t have to install </span><code class="inlineCode"><span class="koboSpan" id="kobo.963.1">bash</span></code><span class="koboSpan" id="kobo.964.1"> on all of our systems. </span><span class="koboSpan" id="kobo.964.2">As I mentioned before, </span><code class="inlineCode"><span class="koboSpan" id="kobo.965.1">dash</span></code><span class="koboSpan" id="kobo.966.1"> is the most POSIX-compliant shell that’s widely available for most Linux and BSD-type distros. </span><span class="koboSpan" id="kobo.966.2">So, let’s use </span><code class="inlineCode"><span class="koboSpan" id="kobo.967.1">-s dash</span></code><span class="koboSpan" id="kobo.968.1"> to scan the file again:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.969.1">donnie@debian12:~$ shellcheck -s dash sysinfo_posix.lib
. </span><span class="koboSpan" id="kobo.969.2">. </span><span class="koboSpan" id="kobo.969.3">.
</span><span class="koboSpan" id="kobo.969.4">. </span><span class="koboSpan" id="kobo.969.5">. </span><span class="koboSpan" id="kobo.969.6">.
</span><span class="koboSpan" id="kobo.969.7">In sysinfo_posix.lib line 55:
           if [[ $user != "lost+found" ]] &amp;&amp; [[ $user != "Shared" ]]; then
              ^-------------------------^ SC3010 (error): In dash, [[ ]] is not supported.
                                             </span><span class="koboSpan" id="kobo.969.8">^---------------------^ SC3010 (error): In dash, [[ ]] is not supported.
</span><span class="koboSpan" id="kobo.969.9">. </span><span class="koboSpan" id="kobo.969.10">. </span><span class="koboSpan" id="kobo.969.11">.
</span><span class="koboSpan" id="kobo.969.12">. </span><span class="koboSpan" id="kobo.969.13">. </span><span class="koboSpan" id="kobo.969.14">.
</span><span class="koboSpan" id="kobo.969.15">In sysinfo.lib line 71:
                   echo "${os:12}"
                         ^------^ SC3057 (error): In dash, string indexing is not supported.
</span><span class="koboSpan" id="kobo.969.16">. </span><span class="koboSpan" id="kobo.969.17">. </span><span class="koboSpan" id="kobo.969.18">.
</span><span class="koboSpan" id="kobo.969.19">. </span><span class="koboSpan" id="kobo.969.20">. </span><span class="koboSpan" id="kobo.969.21">.
</span><span class="koboSpan" id="kobo.969.22">donnie@debian12:~$
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.970.1"> We’ve seen the first problem in previous scripts. </span><span class="koboSpan" id="kobo.970.2">It’s just that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.971.1">[[. </span><span class="koboSpan" id="kobo.971.2">. </span><span class="koboSpan" id="kobo.971.3">.]]</span></code><span class="koboSpan" id="kobo.972.1"> construct isn’t supported on some non-</span><code class="inlineCode"><span class="koboSpan" id="kobo.973.1">bash</span></code><span class="koboSpan" id="kobo.974.1"> shells, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.975.1">dash</span></code><span class="koboSpan" id="kobo.976.1">. </span><span class="koboSpan" id="kobo.976.2">Fortunately, there’s no reason that requires us to use the double square brackets in this case, so we can just replace them with single square brackets. </span><span class="koboSpan" id="kobo.976.3">So, we’ll change the offending line to:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.977.1">if [ $user != "lost+found" ] &amp;&amp; [ $user != "Shared" ]; then
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.978.1">The second problem is one that we haven’t seen yet. </span><span class="koboSpan" id="kobo.978.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.979.1">"${os:12}"</span></code><span class="koboSpan" id="kobo.980.1"> type of variable expansion is another bashism that won’t work on either Bourne shell or </span><code class="inlineCode"><span class="koboSpan" id="kobo.981.1">dash</span></code><span class="koboSpan" id="kobo.982.1">. </span><span class="koboSpan" id="kobo.982.2">To refresh your memory, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.983.1">os</span></code><span class="koboSpan" id="kobo.984.1"> variable is defined in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.985.1">system_info()</span></code><span class="koboSpan" id="kobo.986.1"> function that’s toward the end of the file. </span><span class="koboSpan" id="kobo.986.2">The variable definition, when done from the command-line, looks like this:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.987.1">donnie@debian12:~$ os=$(grep "PRETTY_NAME" /etc/os-release)
donnie@debian12:~$ echo $os
PRETTY_NAME="Debian GNU/Linux 12 (bookworm)"
donnie@debian12:~$
</span></code></pre>
      </li>
    </ol>
    <p class="normal one"><span class="koboSpan" id="kobo.988.1">But, we don’t want the </span><code class="inlineCode"><span class="koboSpan" id="kobo.989.1">PRETTY_NAME=</span></code><span class="koboSpan" id="kobo.990.1"> part to show up in the report. </span><span class="koboSpan" id="kobo.990.2">All we want is just the name</span><a id="_idIndexMarker1178"/><span class="koboSpan" id="kobo.991.1"> of the operating system. </span><span class="koboSpan" id="kobo.991.2">This </span><code class="inlineCode"><span class="koboSpan" id="kobo.992.1">PRETTY_NAME=</span></code><span class="koboSpan" id="kobo.993.1"> string consists of 12 characters. </span><span class="koboSpan" id="kobo.993.2">On </span><code class="inlineCode"><span class="koboSpan" id="kobo.994.1">bash</span></code><span class="koboSpan" id="kobo.995.1">, we can strip those 12 characters away by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.996.1">donnie@debian12:~$ echo "${os:12}"
"Debian GNU/Linux 12 (bookworm)"
donnie@debian12:~$
</span></code></pre>
    <p class="normal one"><span class="koboSpan" id="kobo.997.1">It looks good there, but watch what happens when I try this in a </span><code class="inlineCode"><span class="koboSpan" id="kobo.998.1">dash</span></code><span class="koboSpan" id="kobo.999.1"> session:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1000.1">donnie@debian12:~$ dash
$ os=$(grep "PRETTY_NAME" /etc/os-release)
$ echo "${os:12}"
dash: 2: Bad substitution
$
</span></code></pre>
    <p class="normal one"><span class="koboSpan" id="kobo.1001.1">Oh dear, that doesn’t work at all. </span><span class="koboSpan" id="kobo.1001.2">Fortunately, this is an easy fix. </span><span class="koboSpan" id="kobo.1001.3">We’ll just use a POSIX-compliant form of variable expansion, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1002.1">$ echo "${os#PRETTY_NAME=}"
"Debian GNU/Linux 12 (bookworm)"
$
</span></code></pre>
    <p class="normal one"><span class="koboSpan" id="kobo.1003.1">Instead of specifying the number of characters to strip from the beginning of the text string, we just specify the actual portion of the text string to strip. </span><span class="koboSpan" id="kobo.1003.2">And, I replaced the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1004.1">:</span></code><span class="koboSpan" id="kobo.1005.1"> with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1006.1">#</span></code><span class="koboSpan" id="kobo.1007.1">. </span><span class="koboSpan" id="kobo.1007.2">Easy, right?</span></p>
    <div class="note one">
      <p class="normal"><span class="koboSpan" id="kobo.1008.1">This is one of the great mysteries of life that I haven’t yet figured out. </span><span class="koboSpan" id="kobo.1008.2">Most bashisms were created as either a simpler way to do things, or to allow </span><code class="inlineCode"><span class="koboSpan" id="kobo.1009.1">bash</span></code><span class="koboSpan" id="kobo.1010.1"> to do things that other shells can’t do at all. </span><span class="koboSpan" id="kobo.1010.2">In this case, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1011.1">bash</span></code><span class="koboSpan" id="kobo.1012.1"> way of performing variable expansion isn’t any easier than the POSIX way. </span><span class="koboSpan" id="kobo.1012.2">So why did the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1013.1">bash</span></code><span class="koboSpan" id="kobo.1014.1"> developers even bother to give us this new, non-POSIX way? </span><span class="koboSpan" id="kobo.1014.2">Your guess is as good as mine.</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.1015.1">At any rate, you can read</span><a id="_idIndexMarker1179"/><span class="koboSpan" id="kobo.1016.1"> more about POSIX-compliant variable expansion here:</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.1017.1">POSIX shell cheat sheet: </span><a href="https://steinbaugh.com/posts/posix.html"><span class="url"><span class="koboSpan" id="kobo.1018.1">https://steinbaugh.com/posts/posix.html</span></span></a> </p>
    </div>
    <ol>
      <li class="numberedList" value="8"><span class="koboSpan" id="kobo.1019.1">Next, we need to scan</span><a id="_idIndexMarker1180"/><span class="koboSpan" id="kobo.1020.1"> the script that uses this function library. </span><span class="koboSpan" id="kobo.1020.2">Start by copying the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1021.1">system_info.sh</span></code><span class="koboSpan" id="kobo.1022.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1023.1">system_info_posix.sh</span></code><span class="koboSpan" id="kobo.1024.1">:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1025.1">donnie@debian12:~$ cp system_info.sh system_info_posix.sh
donnie@debian12:~$
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1026.1">Now, scan the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1027.1">system_info_posix.sh</span></code><span class="koboSpan" id="kobo.1028.1"> script for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1029.1">dash</span></code><span class="koboSpan" id="kobo.1030.1"> compatibility:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1031.1">donnie@debian12:~$ shellcheck -s dash system_info.sh
. </span><span class="koboSpan" id="kobo.1031.2">. </span><span class="koboSpan" id="kobo.1031.3">.
</span><span class="koboSpan" id="kobo.1031.4">. </span><span class="koboSpan" id="kobo.1031.5">. </span><span class="koboSpan" id="kobo.1031.6">.
</span><span class="koboSpan" id="kobo.1031.7">In system_info_posix.sh line 5:
title="System Information for $HOSTNAME"
                              ^-------^ SC3028 (error): In dash, HOSTNAME is not supported.
</span><span class="koboSpan" id="kobo.1031.8">In system_info_posix.sh line 31:
if [[ -f /usr/local/bin/pandoc ]] || [[ -f /usr/bin/pandoc ]]; then
   ^----------------------------^ SC3010 (error): In dash, [[ ]] is not supported.
                                     </span><span class="koboSpan" id="kobo.1031.9">^----------------------^ SC3010 (error): In dash, [[ ]] is not supported.
</span><span class="koboSpan" id="kobo.1031.10">. </span><span class="koboSpan" id="kobo.1031.11">. </span><span class="koboSpan" id="kobo.1031.12">.
</span><span class="koboSpan" id="kobo.1031.13">. </span><span class="koboSpan" id="kobo.1031.14">. </span><span class="koboSpan" id="kobo.1031.15">.
</span><span class="koboSpan" id="kobo.1031.16">donnie@debian12:~$
</span></code></pre>
      </li>
    </ol>
    <p class="normal one"><span class="koboSpan" id="kobo.1032.1">The first thing we see is that “In dash, HOSTNAME is not supported.” </span><span class="koboSpan" id="kobo.1032.2">That seems strange, because all I’m doing here is calling the value of an environmental variable. </span><span class="koboSpan" id="kobo.1032.3">But, it says that it doesn’t work, so I’ll change it to use command substitution with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1033.1">hostname</span></code><span class="koboSpan" id="kobo.1034.1"> command, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1035.1">title="System Information for $(hostname)"
</span></code></pre>
    <p class="normal one"><span class="koboSpan" id="kobo.1036.1">The next problem</span><a id="_idIndexMarker1181"/><span class="koboSpan" id="kobo.1037.1"> is the same old problem that we’ve seen before with the double square brackets. </span><span class="koboSpan" id="kobo.1037.2">It’s another case where double square brackets aren’t necessary anyway, so I’ll change it to single square brackets, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1038.1">if [ -f /usr/local/bin/pandoc ] || [ -f /usr/bin/pandoc ]; then
</span></code></pre>
    <ol>
      <li class="numberedList" value="10"><span class="koboSpan" id="kobo.1039.1">Next, let’s copy the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1040.1">sysinfo_posix.lib</span></code><span class="koboSpan" id="kobo.1041.1"> file to its proper place in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1042.1">/usr/local/lib/</span></code><span class="koboSpan" id="kobo.1043.1"> directory:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1044.1">donnie@debian12:~$ sudo cp sysinfo_posix.lib /usr/local/lib/
donnie@debian12:~$
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1045.1">Now, edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1046.1">system_info_posix.sh</span></code><span class="koboSpan" id="kobo.1047.1"> script so that it will source the new function library, and use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1048.1">sh</span></code><span class="koboSpan" id="kobo.1049.1"> as the interpreter shell. </span><span class="koboSpan" id="kobo.1049.2">Make the top part of the script look like this:
        </span><pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1050.1">#!/bin/sh
# sysinfo_page - A script to produce an HTML file
. </span><span class="koboSpan" id="kobo.1050.2">/usr/local/lib/sysinfo_posix.lib
</span></code></pre>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1051.1">Finally, copy the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1052.1">system_info_posix.sh</span></code><span class="koboSpan" id="kobo.1053.1"> script and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1054.1">sysinfo_posix.lib</span></code><span class="koboSpan" id="kobo.1055.1"> file to other machines with other operating systems. </span><span class="koboSpan" id="kobo.1055.2">You should find that this script and function library will work well on other Linux distros, as well</span><a id="_idIndexMarker1182"/><span class="koboSpan" id="kobo.1056.1"> as on FreeBSD, OpenIndiana, and macOS.</span></li>
    </ol>
    <p class="normal"><span class="koboSpan" id="kobo.1057.1">End of lab</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1058.1">So, we’ve covered </span><code class="inlineCode"><span class="koboSpan" id="kobo.1059.1">checkbashisms</span></code><span class="koboSpan" id="kobo.1060.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1061.1">shellcheck</span></code><span class="koboSpan" id="kobo.1062.1">. </span><span class="koboSpan" id="kobo.1062.2">Shall we cover one more handy script-checking utility? </span><span class="koboSpan" id="kobo.1062.3">Indeed we shall, and we shall do it now.</span></p>
    <h2 id="_idParaDest-403" class="heading 2"><span class="koboSpan" id="kobo.1063.1">Using shall</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.1064.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1065.1">checkbashisms</span></code><span class="koboSpan" id="kobo.1066.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1067.1">shellcheck</span></code><span class="koboSpan" id="kobo.1068.1"> utilities act as </span><strong class="keyWord"><span class="koboSpan" id="kobo.1069.1">static code checkers</span></strong><span class="koboSpan" id="kobo.1070.1">. </span><span class="koboSpan" id="kobo.1070.2">This means that instead</span><a id="_idIndexMarker1183"/><span class="koboSpan" id="kobo.1071.1"> of actually running</span><a id="_idIndexMarker1184"/><span class="koboSpan" id="kobo.1072.1"> the scripts to see if they work, these two utilities just look through the code to detect problems. </span><span class="koboSpan" id="kobo.1072.2">Sometimes</span><a id="_idIndexMarker1185"/><span class="koboSpan" id="kobo.1073.1"> though, it’s helpful to have a </span><strong class="keyWord"><span class="koboSpan" id="kobo.1074.1">dynamic code checker</span></strong><span class="koboSpan" id="kobo.1075.1"> that will actually run the code to see what happens. </span><span class="koboSpan" id="kobo.1075.2">That’s where </span><code class="inlineCode"><span class="koboSpan" id="kobo.1076.1">shall</span></code><span class="koboSpan" id="kobo.1077.1"> comes in.</span></p>
    <p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.1078.1">shall</span></code><span class="koboSpan" id="kobo.1079.1"> is a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1080.1">bash</span></code><span class="koboSpan" id="kobo.1081.1"> script that you can download from the author’s GitHub repository. </span><span class="koboSpan" id="kobo.1081.2">The easiest way to install it is to clone the repository, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1082.1">donnie@debian12:~$ git clone https://github.com/mklement0/shall.git
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1083.1">Then, go into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1084.1">shall/bin/</span></code><span class="koboSpan" id="kobo.1085.1"> directory, and copy the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1086.1">shall</span></code><span class="koboSpan" id="kobo.1087.1"> script to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1088.1">/usr/local/bin/</span></code><span class="koboSpan" id="kobo.1089.1"> directory, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1090.1">donnie@debian12:~$ cd shall/bin
donnie@debian12:~/shall/bin$ ls -l
total 28
-rwxr-xr-x. </span><span class="koboSpan" id="kobo.1090.2">1 donnie donnie 27212 May 27 18:20 shall
donnie@debian12:~/shall/bin$ sudo cp shall /usr/local/bin
donnie@debian12:~/shall/bin$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1091.1">Now, here’s the cool part. </span><span class="koboSpan" id="kobo.1091.2">With only a single command, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1092.1">shall</span></code><span class="koboSpan" id="kobo.1093.1"> can test your scripts against </span><code class="inlineCode"><span class="koboSpan" id="kobo.1094.1">sh</span></code><span class="koboSpan" id="kobo.1095.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1096.1">bash</span></code><span class="koboSpan" id="kobo.1097.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1098.1">dash</span></code><span class="koboSpan" id="kobo.1099.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1100.1">zsh</span></code><span class="koboSpan" id="kobo.1101.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1102.1">ksh</span></code><span class="koboSpan" id="kobo.1103.1">. </span><span class="koboSpan" id="kobo.1103.2">(It doesn’t matter which interpreter shell you specify in the scripts’ shebang line.) Most Linux and BSD distros have these various shells in their package repositories, so you can install ones that aren’t installed already. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1104.1">Of course, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1105.1">dash</span></code><span class="koboSpan" id="kobo.1106.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1107.1">bash</span></code><span class="koboSpan" id="kobo.1108.1"> are already installed on our Debian machine, so let’s install </span><code class="inlineCode"><span class="koboSpan" id="kobo.1109.1">zsh</span></code><span class="koboSpan" id="kobo.1110.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1111.1">ksh</span></code><span class="koboSpan" id="kobo.1112.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1113.1">donnie@debian12:~$ sudo apt install zsh ksh
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1114.1">Let’s begin by testing our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1115.1">ip-2.sh</span></code><span class="koboSpan" id="kobo.1116.1"> script. </span><span class="koboSpan" id="kobo.1116.2">The output is too long to show in its entirety, so I’ll just show some relevant sections. </span><span class="koboSpan" id="kobo.1116.3">Here’s the top part:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1117.1">donnie@debian12:~$ shall ip-2.sh
✗ sh@ (-&gt; dash)                           [0.00s]
  IP Addresses of intruder attempts
  ip-2.sh: 4: Syntax error: "(" unexpected
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1118.1">The first check was for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1119.1">sh</span></code><span class="koboSpan" id="kobo.1120.1">, which on Debian</span><a id="_idIndexMarker1186"/><span class="koboSpan" id="kobo.1121.1"> really means </span><code class="inlineCode"><span class="koboSpan" id="kobo.1122.1">dash</span></code><span class="koboSpan" id="kobo.1123.1">. </span><span class="koboSpan" id="kobo.1123.2">You see here that the script couldn’t run, because </span><code class="inlineCode"><span class="koboSpan" id="kobo.1124.1">dash</span></code><span class="koboSpan" id="kobo.1125.1"> can’t work with arrays. </span><span class="koboSpan" id="kobo.1125.2">The next check is for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1126.1">bash</span></code><span class="koboSpan" id="kobo.1127.1">, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1128.1">✓ bash                                    [0.00s]
  IP Addresses of intruder attempts
  ip[0] is 192.168.3.78, the first item in the list.
  </span><span class="koboSpan" id="kobo.1128.2">ip[2] is 192.168.3.9, the third item in the list.
  </span><span class="koboSpan" id="kobo.1128.3">***********************************
  The most dangerous intruder is 192.168.3.4, which is in ip[1].
  </span><span class="koboSpan" id="kobo.1128.4">***********************************
  Here is the entire list of IP addresses in the array.
  </span><span class="koboSpan" id="kobo.1128.5">192.168.3.78 192.168.3.4 192.168.3.9
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1129.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1130.1">zsh</span></code><span class="koboSpan" id="kobo.1131.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1132.1">ksh</span></code><span class="koboSpan" id="kobo.1133.1"> checks that follow look the same. </span><span class="koboSpan" id="kobo.1133.2">At the very bottom of the output, you’ll see this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1134.1">FAILED - 1 shell (sh) reports failure, 3 (bash, zsh, ksh) report success.
</span><span class="koboSpan" id="kobo.1134.2">donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1135.1">This means that our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1136.1">ip-2.sh</span></code><span class="koboSpan" id="kobo.1137.1"> script runs fine on </span><code class="inlineCode"><span class="koboSpan" id="kobo.1138.1">bash</span></code><span class="koboSpan" id="kobo.1139.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1140.1">zsh</span></code><span class="koboSpan" id="kobo.1141.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1142.1">ksh</span></code><span class="koboSpan" id="kobo.1143.1">, but it won’t run on </span><code class="inlineCode"><span class="koboSpan" id="kobo.1144.1">dash</span></code><span class="koboSpan" id="kobo.1145.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1146.1">But, as cool as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1147.1">shall</span></code><span class="koboSpan" id="kobo.1148.1"> is, it isn’t quite perfect. </span><span class="koboSpan" id="kobo.1148.2">To see what I mean, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1149.1">fly.sh</span></code><span class="koboSpan" id="kobo.1150.1"> script, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1151.1">#!/bin/sh
#
echo -e "I want to fly to the \v moon."
</span><span class="koboSpan" id="kobo.1151.2">printf "%b\n" "I want to fly to the \v moon."
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1152.1">This is just a simple little script that demonstrates the problem with using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1153.1">echo -e</span></code><span class="koboSpan" id="kobo.1154.1"> in your scripts, as I showed you a few pages back. </span><span class="koboSpan" id="kobo.1154.2">Here’s what happens when I test </span><code class="inlineCode"><span class="koboSpan" id="kobo.1155.1">fly.sh</span></code><span class="koboSpan" id="kobo.1156.1"> with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1157.1">shall</span></code><span class="koboSpan" id="kobo.1158.1">:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.1159.1">donnie@debian12:~$ shall fly.sh
✓ sh@ (-&gt; dash)                           [0.00s]
  -e I want to fly to the
                           	moon.
  </span><span class="koboSpan" id="kobo.1159.2">I want to fly to the
                        	moon.
</span><span class="koboSpan" id="kobo.1159.3">✓ bash                                    [0.00s]
  I want to fly to the
                        	moon.
  </span><span class="koboSpan" id="kobo.1159.4">I want to fly to the
                        	moon.
</span><span class="koboSpan" id="kobo.1159.5">. </span><span class="koboSpan" id="kobo.1159.6">. </span><span class="koboSpan" id="kobo.1159.7">.
</span><span class="koboSpan" id="kobo.1159.8">OK - All 4 shells (sh, bash, zsh, ksh) report success.
</span><span class="koboSpan" id="kobo.1159.9">donnie@debian12:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.1160.1">So, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1161.1">shall</span></code><span class="koboSpan" id="kobo.1162.1"> says that the script</span><a id="_idIndexMarker1187"/><span class="koboSpan" id="kobo.1163.1"> ran correctly on all four shells. </span><span class="koboSpan" id="kobo.1163.2">But, at the top of the output, you see that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1164.1">-e</span></code><span class="koboSpan" id="kobo.1165.1"> shows up in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1166.1">echo</span></code><span class="koboSpan" id="kobo.1167.1"> output with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1168.1">dash</span></code><span class="koboSpan" id="kobo.1169.1">, which is the problem that I showed you before. </span><span class="koboSpan" id="kobo.1169.2">The bottom line here is that when you use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1170.1">shall</span></code><span class="koboSpan" id="kobo.1171.1">, don’t just depend on what the status line at the bottom of the output says. </span><span class="koboSpan" id="kobo.1171.2">Look at the output for all of the shells, and ensure that the output is what you really want to see.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1172.1">The only other problem with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1173.1">shall</span></code><span class="koboSpan" id="kobo.1174.1"> isn’t really with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1175.1">shall</span></code><span class="koboSpan" id="kobo.1176.1">, but with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1177.1">sh</span></code><span class="koboSpan" id="kobo.1178.1">. </span><span class="koboSpan" id="kobo.1178.2">Remember that </span><code class="inlineCode"><span class="koboSpan" id="kobo.1179.1">sh</span></code><span class="koboSpan" id="kobo.1180.1"> points to a different shell on different Linux, BSD, and Unix distros. </span><span class="koboSpan" id="kobo.1180.2">You can install </span><code class="inlineCode"><span class="koboSpan" id="kobo.1181.1">shall</span></code><span class="koboSpan" id="kobo.1182.1"> on any of these distros, as long as you can install </span><code class="inlineCode"><span class="koboSpan" id="kobo.1183.1">bash</span></code><span class="koboSpan" id="kobo.1184.1"> on them. </span><span class="koboSpan" id="kobo.1184.2">Then, just copy the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1185.1">shall</span></code><span class="koboSpan" id="kobo.1186.1"> script to the machine on which you want to test </span><code class="inlineCode"><span class="koboSpan" id="kobo.1187.1">sh</span></code><span class="koboSpan" id="kobo.1188.1"> scripts.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.1189.1">A man page is embedded into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1190.1">shall</span></code><span class="koboSpan" id="kobo.1191.1"> script. </span><span class="koboSpan" id="kobo.1191.2">To see it, just do:</span></p>
      <p class="normal"><code style="font-weight: bold;" class="codeHighlighted"><span class="koboSpan" id="kobo.1192.1">shall --man</span></code></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.1193.1">Okay, I think that about does</span><a id="_idIndexMarker1188"/><span class="koboSpan" id="kobo.1194.1"> it for this chapter. </span><span class="koboSpan" id="kobo.1194.2">Let’s summarize and move on.</span></p>
    <h1 id="_idParaDest-404" class="heading 1"><span class="koboSpan" id="kobo.1195.1">Summary</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.1196.1">Script portability is important if you need to create scripts that will run on a wide variety of Linux, Unix, or Unix-like operating systems. </span><span class="koboSpan" id="kobo.1196.2">I began by showing you how to install bash on various BSD-type distros, and how to ensure that your scripts will find </span><code class="inlineCode"><span class="koboSpan" id="kobo.1197.1">bash</span></code><span class="koboSpan" id="kobo.1198.1"> on them. </span><span class="koboSpan" id="kobo.1198.2">After that, I explained the POSIX standard, and why it’s needed. </span><span class="koboSpan" id="kobo.1198.3">Then, I showed you some bashisms, and some cool utilities that can test your scripts for them.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1199.1">In the next chapter, we’ll talk about shell script security. </span><span class="koboSpan" id="kobo.1199.2">I’ll see you there.</span></p>
    <h1 id="_idParaDest-405" class="heading 1"><span class="koboSpan" id="kobo.1200.1">Questions</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.1201.1">For shell scripters, what is the most important reason for following the POSIX standard?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.1202.1">To ensure that scripts will only run on Linux operating systems.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1203.1">To ensure that scripts can run on a wide variety of Linux, Unix, and Unix-like operating systems.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1204.1">To ensure that all operating systems are running </span><code class="inlineCode"><span class="koboSpan" id="kobo.1205.1">bash</span></code><span class="koboSpan" id="kobo.1206.1">.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1207.1">To ensure that scripts can use the advanced features of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1208.1">bash</span></code><span class="koboSpan" id="kobo.1209.1">.</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1210.1">Which of the following is a dynamic code checker?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.1211.1">checkbashisms</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1212.1">shellcheck</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1213.1">shall</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1214.1">will</span></code></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1215.1">Which of the following statements about </span><code class="inlineCode"><span class="koboSpan" id="kobo.1216.1">sh</span></code><span class="koboSpan" id="kobo.1217.1"> is true?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.1218.1">On every operating system, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1219.1">sh</span></code><span class="koboSpan" id="kobo.1220.1"> is always the Bourne shell.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.1221.1">On every operating system, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1222.1">sh</span></code><span class="koboSpan" id="kobo.1223.1"> is a symbolic link that points to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1224.1">bash</span></code><span class="koboSpan" id="kobo.1225.1">.</span></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1226.1">sh</span></code><span class="koboSpan" id="kobo.1227.1"> represents a different shell on different operating systems.</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1228.1">You want to solve a math problem, and assign its value to a variable. </span><span class="koboSpan" id="kobo.1228.2">Which of the following constructs would you use for best portability?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.1229.1">var=$(3*4)</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1230.1">var=$[3*4]</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1231.1">var=$[[3*4]]</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.1232.1">var=$((3*4))</span></code></li>
        </ol>
      </li>
    </ol>
    <h1 id="_idParaDest-406" class="heading 1"><span class="koboSpan" id="kobo.1233.1">Further Reading</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.1234.1">UNIX Vs Linux: How Are They Different?: </span><a href="https://www.maketecheasier.com/unix-vs-linux-how-are-they-different/"><span class="url"><span class="koboSpan" id="kobo.1235.1">https://www.maketecheasier.com/unix-vs-linux-how-are-they-different/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1236.1">What is the difference between “#!/usr/bin/env bash” and “#!/usr/bin/bash”?: </span><a href="https://stackoverflow.com/questions/16365130/what-is-the-difference-between-usr-bin-env-bash-and-usr-bin-bash"><span class="url"><span class="koboSpan" id="kobo.1237.1">https://stackoverflow.com/questions/16365130/what-is-the-difference-between-usr-bin-env-bash-and-usr-bin-bash</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1238.1">Writing Bash Scripts that aren’t Only Bash: Checking for Bashisms and Using Dash: </span><a href="https://www.bowmanjd.com/bash-not-bash-posix/"><span class="url"><span class="koboSpan" id="kobo.1239.1">https://www.bowmanjd.com/bash-not-bash-posix/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1240.1">A Brief POSIX Advocacy: </span><a href="https://www.usenix.org/system/files/login/articles/login_spring16_09_tomei.pdf"><span class="url"><span class="koboSpan" id="kobo.1241.1">https://www.usenix.org/system/files/login/articles/login_spring16_09_tomei.pdf</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1242.1">A Guide to POSIX: </span><a href="https://www.baeldung.com/linux/posix"><span class="url"><span class="koboSpan" id="kobo.1243.1">https://www.baeldung.com/linux/posix</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1244.1">How can I test for POSIX compliance of shell scripts?: </span><a href="https://unix.stackexchange.com/questions/48786/how-can-i-test-for-posix-compliance-of-shell-scripts"><span class="url"><span class="koboSpan" id="kobo.1245.1">https://unix.stackexchange.com/questions/48786/how-can-i-test-for-posix-compliance-of-shell-scripts</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1246.1">Making Unix Shell Scripts POSIX-compliant: </span><a href="https://stackoverflow.com/questions/40916071/making-unix-shell-scripts-posix-compliant"><span class="url"><span class="koboSpan" id="kobo.1247.1">https://stackoverflow.com/questions/40916071/making-unix-shell-scripts-posix-compliant</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1248.1">Rich’s sh (POSIX shell) Tricks: </span><a href="http://www.etalabs.net/sh_tricks.html"><span class="url"><span class="koboSpan" id="kobo.1249.1">http://www.etalabs.net/sh_tricks.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1250.1">Dash–ArchWiki: </span><a href="https://wiki.archlinux.org/title/Dash"><span class="url"><span class="koboSpan" id="kobo.1251.1">https://wiki.archlinux.org/title/Dash</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1252.1">POSIX shell cheat sheet: </span><a href="https://steinbaugh.com/posts/posix.html"><span class="url"><span class="koboSpan" id="kobo.1253.1">https://steinbaugh.com/posts/posix.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.1254.1">Is there a minimally POSIX.2 compliant shell?: </span><a href="https://stackoverflow.com/questions/11376975/is-there-a-minimally-posix-2-compliant-shell"><span class="url"><span class="koboSpan" id="kobo.1255.1">https://stackoverflow.com/questions/11376975/is-there-a-minimally-posix-2-compliant-shell</span></span></a></li>
    </ul>
    <h1 id="_idParaDest-407" class="heading 1"><span class="koboSpan" id="kobo.1256.1">Answers</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.1257.1">b</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1258.1">c</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1259.1">c</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.1260.1">d</span></li>
    </ol>
    <h1 id="_idParaDest-408" class="heading 1"><span class="koboSpan" id="kobo.1261.1">Join our community on Discord!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.1262.1">Read this book alongside other users, Linux experts, and the author himself. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.1263.1">Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. </span><span class="koboSpan" id="kobo.1263.2">Scan the QR code or visit the link to join the community.</span></p>
    <p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.1264.1">https://packt.link/SecNet</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.1265.1"><img src="../Images/QR_Code10596186092701843.png" alt=""/></span></p>
  </div>
</body></html>