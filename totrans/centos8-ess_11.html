<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer137" class="_idGenObjectStyleOverride-1">&#13;
			<p id="_idParaDest-112" class="Chapter-Title"><span class="ChapterMarker">13. </span><a id="_idTextAnchor158"/>Basic CentOS 8 Firewall Configuration with firewalld</p>&#13;
			<p class="My-Basic-Paragraph">A firewall is a vital component in protecting a computer system or network of computers from external attack (typically from an external source via an internet connection). Any computer connected directly to an internet connection must run a firewall to protect against malicious activity. Similarly, any internal network must have some form of firewall between it and an external internet connection.</p>&#13;
			<p class="My-Basic-Paragraph">All Linux distributions are provided with a firewall solution of some form. In the case of CentOS 8 this takes the form of a service named <span class="My-Italic _idGenCharOverride-1">firewalld</span>. </p>&#13;
			<p class="My-Basic-Paragraph">While the subject of firewall configuration can be complex, fortunately CentOS 8 provides command-line, web-based and graphical tools that ease the firewall configuration process. This chapter will introduce the basic concepts of firewalld and cover the steps necessary to configure a firewall using the tools provided with the operating system.</p>&#13;
			<p id="_idParaDest-113" class="Heading-1-1"><span class="Heading11Marker">13.1 </span><a id="_idTextAnchor159"/>An Introduction to <a id="_idIndexMarker267"/><a id="_idIndexMarker268"/>firewalld</p>&#13;
			<p class="My-Basic-Paragraph">The firewalld service uses a set a rules to control incoming network traffic and define which traffic is to be blocked and which is to be allowed to pass through to the system and is built on top of a more complex firewall tool named <a id="_idIndexMarker269"/><span class="My-Italic _idGenCharOverride-1">iptables</span>. </p>&#13;
			<p class="My-Basic-Paragraph">The firewalld system provides a flexible way to manage incoming traffic. The firewall could, for example, be configured to block traffic arriving from a specific external IP address, or to prevent all traffic arriving on a particular TCP/IP port. Rules may also be defined to forward incoming traffic to different systems or to act as an internet gateway to protect other computers on a network.</p>&#13;
			<p class="My-Basic-Paragraph">In keeping with common security practices, a default firewalld installation is configured to block all access with the exception of SSH remote login and the DHCP service used by the system to obtain a dynamic IP address (both of which are essential if the system administrator is to be able to gain access to the system after completing the installation).</p>&#13;
			<p class="My-Basic-Paragraph">The key elements of firewall configuration on CentOS 8 are <a id="_idIndexMarker270"/><a id="_idIndexMarker271"/><a id="_idIndexMarker272"/><a id="_idIndexMarker273"/><span class="My-Italic _idGenCharOverride-1">zones</span>, <span class="My-Italic _idGenCharOverride-1">interfaces</span>, <span class="My-Italic _idGenCharOverride-1">services</span> and <span class="My-Italic _idGenCharOverride-1">ports</span>.</p>&#13;
			<p id="_idParaDest-114" class="Heading-1-1-1"><span class="Heading111Marker">13.1.1 </span><a id="_idTextAnchor160"/><a id="_idIndexMarker274"/>Zones</p>&#13;
			<p class="My-Basic-Paragraph">By default, firewalld is installed with a range of pre-configured <span class="My-Italic _idGenCharOverride-1">zones. </span>A zone is a preconfigured set of rules which can be applied to the system at any time to quickly implement firewall configurations for specific scenarios. The <span class="My-Italic _idGenCharOverride-1">block</span> zone, for example, blocks all incoming traffic, while the <span class="My-Italic _idGenCharOverride-1">home</span> zone imposes less strict rules on the assumption that the system is running in a safer environment where a greater level of trust is expected. New zones may be added to the system, and existing zones modified to add or remove rules. Zones may also be deleted entirely from the system. <a href="../Text/Firewall_Configuration.xhtml#_idTextAnchor161">Table 13-1</a> lists the set of zones available by default on a CentOS 8 system:</p>&#13;
			<table id="table001-2" class="Basic-Table TableOverride-1">&#13;
				<colgroup>&#13;
					<col/>&#13;
					<col/>&#13;
				</colgroup>&#13;
				<thead>&#13;
					<tr class="Basic-Table">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph"><span class="My-Bold _idGenCharOverride-1">Zone</span></p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph"><span class="My-Bold _idGenCharOverride-1">Description</span></p>&#13;
						</td>&#13;
					</tr>&#13;
				</thead>&#13;
				<tbody>&#13;
					<tr class="Basic-Table _idGenTableRowColumn-1">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">drop</p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">The most secure zone. Only outgoing connections are permitted and all incoming connections are dropped without any notification to the connecting client.</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="Basic-Table">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">block</p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">Similar to the drop zone with the exception that incoming connections are rejected with an icmp-host-prohibited or icmp6-adm-prohibited notification.</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="Basic-Table _idGenTableRowColumn-1">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">public</p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">Intended for use when connected to public networks or the internet where other computers are not known to be trustworthy. Allows select incoming connections.</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="Basic-Table">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">external</p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">When a system is acting as the internet gateway for a network of computers, the external zone is applied to the interface that is connected to the internet.</p>&#13;
							<p class="My-Basic-Paragraph">This zone is used in conjunction with the <span class="My-Italic _idGenCharOverride-1">internal</span> zone when implementing masquerading or network address translation (NAT) as outlined later in this chapter. Allows select incoming connections</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="Basic-Table _idGenTableRowColumn-1">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">internal</p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">Used with the <span class="My-Italic _idGenCharOverride-1">external</span> zone and applied to the interface that is connected to the internal network. Assumes that the computers on the internal network are trusted. Allows select incoming connections.</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="Basic-Table">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">dmz</p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">For use when the system is running in the demilitarized zone (DMZ). These are generally computers that are publicly accessible but isolated from other parts of your internal network. Allows select incoming connections.</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="Basic-Table _idGenTableRowColumn-1">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">work</p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">For use when running a system on a network in a work environment where other computers are trusted. Allows select incoming connections.</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="Basic-Table">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">home</p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">For use when running a system on a home network where other computers are trusted. Allows select incoming connections.</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="Basic-Table _idGenTableRowColumn-1">&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">trusted</p>&#13;
						</td>&#13;
						<td class="Basic-Table">&#13;
							<p class="My-Basic-Paragraph">The least secure zone. All incoming connections are accepted.</p>&#13;
						</td>&#13;
					</tr>&#13;
				</tbody>&#13;
			</table>&#13;
			<p class="Table-Caption"><span class="TableCaptionMarker">Table 13-1</span><a id="_idTextAnchor161"/></p>&#13;
			<p id="_idParaDest-115" class="Heading-1-1-1"><span class="Heading111Marker">13.1.2 </span><a id="_idTextAnchor162"/><a id="_idIndexMarker275"/>Interfaces</p>&#13;
			<p class="My-Basic-Paragraph">Any CentOS 8 system connected to the internet or a network (or both) will contain at least one <span class="My-Italic _idGenCharOverride-1">interface</span> in the form of either a physical or virtual network device. When firewalld is active, each of these interfaces is assigned to a zone allowing different levels of firewall security to be assigned to different interfaces. Consider a server containing two interfaces, one connected externally to the internet and the other to an internal network. In such a scenario, the external facing interface would most likely be assigned to the more restrictive <span class="My-Italic _idGenCharOverride-1">external</span> zone while the internal interface might use the <span class="My-Italic _idGenCharOverride-1">internal</span> zone.</p>&#13;
			<p id="_idParaDest-116" class="Heading-1-1-1"><span class="Heading111Marker">13.1.3 </span><a id="_idTextAnchor163"/>Services</p>&#13;
			<p class="My-Basic-Paragraph">TCP/IP defines a set of services that communicate on standard ports. Secure HTTPS web connections, for example, use port 443, while the SMTP email service uses port 25. To selectively enable incoming traffic for specific services, firewalld rules can be added to zones. The <span class="My-Italic _idGenCharOverride-1">home</span> zone, for example, does not permit incoming HTTPS connections by default. This traffic can be enabled by adding rules to a zone to allow incoming HTTPS connections without having to reference the specific port number.</p>&#13;
			<p id="_idParaDest-117" class="Heading-1-1-1"><span class="Heading111Marker">13.1.4 </span><a id="_idTextAnchor164"/><a id="_idIndexMarker276"/><a id="_idIndexMarker277"/>Ports</p>&#13;
			<p class="My-Basic-Paragraph">Although common TCP/IP services can be referenced when adding firewalld rules, situations will arise where incoming connections need to be allowed on a specific port that is not allocated to a service. This can be achieved by adding rules that reference specific ports instead of services. This technique was used in the chapter entitled <a href="../Text/Cockpit_Overview.xhtml#_idTextAnchor081"><span class="My-Italic _idGenCharOverride-1">“An Overview of the CentOS 8 Cockpit Web Interface”</span></a> when port 9090 was opened to allow access to the Cockpit web interface.</p>&#13;
			<p id="_idParaDest-118" class="Heading-1-1"><span class="Heading11Marker">13.2 </span><a id="_idTextAnchor165"/>Checking <a id="_idIndexMarker278"/>firewalld Status </p>&#13;
			<p class="My-Basic-Paragraph">The firewalld service is installed and enabled by default on all CentOS 8 installations. The status of the service can be checked via the following command:</p>&#13;
			<p class="Code"># systemctl status firewalld</p>&#13;
			<p class="Code"> firewalld.service - firewalld - dynamic firewall daemon</p>&#13;
			<p class="Code">   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; enabled; vendor preset: enabled)</p>&#13;
			<p class="Code">   Active: active (running) since Thu 2019-02-14 14:24:31 EST; 3 days ago</p>&#13;
			<p class="Code">     Docs: man:firewalld(1)<a id="_idIndexMarker279"/></p>&#13;
			<p class="Code"> Main PID: 816 (firewalld)</p>&#13;
			<p class="Code">    Tasks: 2 (limit: 25026)</p>&#13;
			<p class="Code">   Memory: 30.6M</p>&#13;
			<p class="Code">   CGroup: /system.slice/firewalld.service</p>&#13;
			<p class="Code">           816 /usr/libexec/platform-python -s /usr/sbin/firewalld --nofork --nopid</p>&#13;
			<p class="My-Basic-Paragraph">If necessary, the firewalld service may be installed as follows:</p>&#13;
			<p class="Code"># dnf install firewalld</p>&#13;
			<p class="My-Basic-Paragraph">The firewalld service is enabled by default so will start automatically both after installation is complete and each time the system boots.</p>&#13;
			<p id="_idParaDest-119" class="Heading-1-1"><span class="Heading11Marker">13.3 </span><a id="_idTextAnchor166"/>Configuring Firewall Rules with <a id="_idIndexMarker280"/><a id="_idIndexMarker281"/>firewall-cmd</p>&#13;
			<p class="My-Basic-Paragraph">The <span class="My-Italic _idGenCharOverride-1">firewall-cmd</span> command-line utility allows information about the firewalld configuration to be viewed and changes to be made to zones and rules from within a terminal window. </p>&#13;
			<p class="My-Basic-Paragraph">When making changes to the <a id="_idIndexMarker282"/><a id="_idIndexMarker283"/>firewall settings, it is important to be aware of the concepts of <span class="My-Italic _idGenCharOverride-1">runtim</span>e and <span class="My-Italic _idGenCharOverride-1">permanent</span> configurations. By default, any rule changes are considered to be runtime configuration changes. This means that while the changes will take effect immediately, they will be lost next time the system restarts or the firewalld service reloads, for example by issuing the following command:</p>&#13;
			<p class="Code"># <a id="_idIndexMarker284"/>firewall-cmd --reload</p>&#13;
			<p class="My-Basic-Paragraph">To make a change permanent, the <span class="My-Italic _idGenCharOverride-1">--permanent</span> command-line option must be used. Permanent changes do not take effect until the firewalld service reloads but will remain in place until manually changed.</p>&#13;
			<p id="_idParaDest-120" class="Heading-1-1-1"><span class="Heading111Marker">13.3.1 </span><a id="_idTextAnchor167"/>Identifying and Changing the Default Zone</p>&#13;
			<p class="My-Basic-Paragraph"><a id="_idIndexMarker285"/><a id="_idIndexMarker286"/>To identify the default zone (in other words the zone to which all interfaces will be assigned unless a different zone is specifically selected) use the <span class="My-Italic _idGenCharOverride-1">firewall-cmd</span> tool as follows:</p>&#13;
			<p class="Code"># firewall-cmd --get-default-zone</p>&#13;
			<p class="Code">public</p>&#13;
			<p class="My-Basic-Paragraph">To change the default to a different zone:</p>&#13;
			<p class="Code"># firewall-cmd --set-default-zone=home</p>&#13;
			<p class="Code">success</p>&#13;
			<p id="_idParaDest-121" class="Heading-1-1-1"><span class="Heading111Marker">13.3.2 </span><a id="_idTextAnchor168"/>Displaying Zone Information</p>&#13;
			<p class="My-Basic-Paragraph"><a id="_idIndexMarker287"/><a id="_idIndexMarker288"/>To list all of the zones available on the system:</p>&#13;
			<p class="Code"># firewall-cmd --get-zones</p>&#13;
			<p class="Code">block dmz drop external home internal libvirt public trusted work</p>&#13;
			<p class="My-Basic-Paragraph">Obtain a list of zones currently active together with the interfaces to which they are assigned as follows:</p>&#13;
			<p class="Code"># firewall-cmd --get-active-zones</p>&#13;
			<p class="Code">external</p>&#13;
			<p class="Code">  interfaces: eth0</p>&#13;
			<p class="Code">internal</p>&#13;
			<p class="Code"> interfaces: eth1</p>&#13;
			<p class="My-Basic-Paragraph">All of the rules currently configured for a specific zone may be listed as follows:</p>&#13;
			<p class="Code"># firewall-cmd --zone=home --list-all</p>&#13;
			<p class="Code">home (active)</p>&#13;
			<p class="Code">  target: default</p>&#13;
			<p class="Code">  icmp-block-inversion: no</p>&#13;
			<p class="Code">  interfaces: eth0</p>&#13;
			<p class="Code">  sources: </p>&#13;
			<p class="Code">  services: cockpit dhcpv6-client http mdns samba-client ssh</p>&#13;
			<p class="Code">  ports: </p>&#13;
			<p class="Code">  protocols: </p>&#13;
			<p class="Code">  masquerade: no</p>&#13;
			<p class="Code">  forward-ports: </p>&#13;
			<p class="Code">  source-ports: </p>&#13;
			<p class="Code">  icmp-blocks: </p>&#13;
			<p class="Code">  rich rules: </p>&#13;
			<p class="My-Basic-Paragraph"><a id="_idIndexMarker289"/><a id="_idIndexMarker290"/>Use the following command to list the services currently available for inclusion in a firewalld rule:</p>&#13;
			<p class="Code"># firewall-cmd --get-services</p>&#13;
			<p class="Code">RH-Satellite-6 amanda-client amanda-k5-client amqp amqps apcupsd audit bacula bacula-client bgp bitcoin bitcoin-rpc bitcoin-testnet bitcoin-testnet-rpc ceph ceph-mon cfengine cockpit ...</p>&#13;
			<p class="My-Basic-Paragraph">To list the services currently enabled for a zone:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --list-services</p>&#13;
			<p class="Code">cockpit dhcpv6-client ssh</p>&#13;
			<p class="My-Basic-Paragraph"><a id="_idIndexMarker291"/><a id="_idIndexMarker292"/>A list of port rules can be obtained as follows:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --list-ports</p>&#13;
			<p class="Code">9090/tcp</p>&#13;
			<p id="_idParaDest-122" class="Heading-1-1-1"><span class="Heading111Marker">13.3.3 </span><a id="_idTextAnchor169"/>Adding and Removing Zone Services</p>&#13;
			<p class="My-Basic-Paragraph"><a id="_idIndexMarker293"/><a id="_idIndexMarker294"/>To add a service to a zone, in this case adding HTTPS to the public zone, the following command would be used:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --add-service=https</p>&#13;
			<p class="Code">success</p>&#13;
			<p class="My-Basic-Paragraph">By default this is a <span class="My-Italic _idGenCharOverride-1">runtime</span> change, so the added rule will be lost after a system reboot. To add a service permanently so that it remains in effect next time the system restarts, use the <span class="My-Italic _idGenCharOverride-1">--permanent</span> flag:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --permanent --add-service=https</p>&#13;
			<p class="Code">success</p>&#13;
			<p class="My-Basic-Paragraph">To verify that a service has been added permanently, be sure to include the <span class="My-Italic _idGenCharOverride-1">--permanent</span> flag when requesting the service list:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --permanent --list-services</p>&#13;
			<p class="Code">cockpit dhcpv6-client http https ssh</p>&#13;
			<p class="My-Basic-Paragraph">Note that as a permanent change, this new rule will not take effect until the system restarts or firewalld reloads:</p>&#13;
			<p class="Code"># firewall-cmd --reload </p>&#13;
			<p class="My-Basic-Paragraph">Remove a service from a zone using the <span class="My-Italic _idGenCharOverride-1">--remove-service</span> option. Since this is a runtime change, the rule will be re-instated the next time the system restarts:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --remove-service=https</p>&#13;
			<p class="My-Basic-Paragraph">To remove a service permanently use the <span class="My-Italic _idGenCharOverride-1">--permanent</span> flag, remembering to reload firewalld if the change is required to take immediate effect.:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --permanent --remove-service=https</p>&#13;
			<p id="_idParaDest-123" class="Heading-1-1-1"><span class="Heading111Marker">13.3.4 </span><a id="_idTextAnchor170"/><a id="_idIndexMarker295"/><a id="_idIndexMarker296"/>Working with Port-based Rules</p>&#13;
			<p class="My-Basic-Paragraph">To enable a specific port, use the <span class="My-Italic _idGenCharOverride-1">--add-port</span> option. Note that when manually defining the port, both the port number and protocol (TCP or UDP) will need to be provided:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --permanent --add-port=5000/tcp</p>&#13;
			<p class="My-Basic-Paragraph">It is also possible to specify a range of ports when adding a rule to a zone:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --permanent --add-port=5900-5999/udp</p>&#13;
			<p id="_idParaDest-124" class="Heading-1-1-1"><span class="Heading111Marker">13.3.5 </span><a id="_idTextAnchor171"/><a id="_idIndexMarker297"/><a id="_idIndexMarker298"/>Creating a New Zone</p>&#13;
			<p class="My-Basic-Paragraph">An entirely new zone may be created by running the following command. Once created, the zone may be managed in the same way as any of the predefined zones:</p>&#13;
			<p class="Code"># firewall-cmd --permanent --new-zone=myoffice</p>&#13;
			<p class="Code">success</p>&#13;
			<p class="My-Basic-Paragraph">After adding a new zone, firewalld will need to be restarted before the zone becomes available:</p>&#13;
			<p class="Code"># firewall-cmd --reload</p>&#13;
			<p class="Code">success</p>&#13;
			<p id="_idParaDest-125" class="Heading-1-1-1"><span class="Heading111Marker">13.3.6 </span><a id="_idTextAnchor172"/>Changing Zone/Interface Assignments</p>&#13;
			<p class="My-Basic-Paragraph"><a id="_idIndexMarker299"/><a id="_idIndexMarker300"/>As previously discussed, each interface on the system must be assigned to a zone. The zone to which an interface is assigned can also be changed using the <span class="My-Italic _idGenCharOverride-1">firewall-cmd</span> tool. In the following example, the eth0 interface is assigned to the <span class="My-Italic _idGenCharOverride-1">public</span> zone:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --change-interface=eth0</p>&#13;
			<p class="Code">success</p>&#13;
			<p id="_idParaDest-126" class="Heading-1-1-1"><span class="Heading111Marker">13.3.7 </span><a id="_idTextAnchor173"/>Masquerading </p>&#13;
			<p class="My-Basic-Paragraph">Masquerading is better known in networking administration circles as Network Address Translation (NAT). When using a CentOS 8 system as a gateway to the internet for a network of computers, masquerading allows all of the internal systems to use the IP address of that CentOS 8 system when communicating over the internet. This has the advantage of hiding the internal IP addresses of any systems from malicious external entities and also avoids the necessity to allocate a public IP address to every computer on the network. </p>&#13;
			<p class="My-Basic-Paragraph">Use the following command to check whether masquerading is already enabled on the firewall:</p>&#13;
			<p class="Code"># firewall-cmd --zone=external --query-masquerade</p>&#13;
			<p class="My-Basic-Paragraph">Use the following command to enable masquerading (remembering to use the <span class="My-Italic _idGenCharOverride-1">--permanent</span> flag if the change is to be permanent):</p>&#13;
			<p class="Code">firewall-cmd --zone=external --add-masquerade</p>&#13;
			<p id="_idParaDest-127" class="Heading-1-1-1"><span class="Heading111Marker">13.3.8 </span><a id="_idTextAnchor174"/>Adding ICMP Rules<a id="_idIndexMarker301"/></p>&#13;
			<p class="My-Basic-Paragraph">The Internet Control Message Protocol (ICMP) is used by client systems on networks to send information such as error messages to each other. It is also the foundation of the <span class="My-Italic _idGenCharOverride-1">ping</span> command which is used by network administrators and users alike to detect whether a particular client is alive on a network. The ICMP category allows for the blocking of specific ICMP message types. For example, an administrator might choose to block incoming ping (Echo Request) ICMP messages to prevent the possibility of a ping based denial of service (DoS) attack (where a server is maliciously bombarded with so many ping messages that it becomes unable to respond to legitimate requests). </p>&#13;
			<p class="My-Basic-Paragraph">To view the ICMP types available for inclusion in firewalld rules, run the following command:</p>&#13;
			<p class="Code"># firewall-cmd --get-icmptypes</p>&#13;
			<p class="Code">address-unreachable bad-header beyond-scope communication-prohibited destination-unreachable echo-reply ...</p>&#13;
			<p class="My-Basic-Paragraph">The following command, for example, permanently adds a rule to block echo-reply (ping request) messages for the public zone:</p>&#13;
			<p class="Code"># firewall-cmd --zone=public --permanent --add-icmp-block=echo-reply</p>&#13;
			<p id="_idParaDest-128" class="Heading-1-1-1"><span class="Heading111Marker">13.3.9 </span><a id="_idTextAnchor175"/>Implementing <a id="_idIndexMarker302"/><a id="_idIndexMarker303"/>Port Forwarding</p>&#13;
			<p class="My-Basic-Paragraph">Port forwarding is used in conjunction with masquerading when the CentOS 8 system is acting as a gateway to the internet for an internal network of computer systems. Port forwarding allows traffic arriving at the firewall via the internet on a specific port to be forwarded to a particular system on the internal network. This is perhaps best described by way of an example. </p>&#13;
			<p class="My-Basic-Paragraph">Suppose that a CentOS 8 system is acting as the firewall for an internal network of computers and one of the systems on the network is configured as a web server. Let’s assume the web server system has an IP address of 192.168.2.20. The domain record for the web site hosted on this system is configured with the public IP address behind which the CentOS 8 firewall system sits. When an HTTP web page request arrives on port 80 the CentOS 8 system acting as the firewall needs to know what to do with it. By configuring port forwarding it is possible to direct all web traffic to the internal system hosting the web server (in this case, IP address 192.168.2.20), either continuing to use port 80 or diverting the traffic to a different port on the destination server. In fact, port forwarding can even be configured to forward the traffic to a different port on the same system as the firewall (a concept known as local forwarding). </p>&#13;
			<p class="My-Basic-Paragraph">To use port forwarding, begin by enabling masquerading as follows (in this case the assumption is made that the interface connected to the internet has been assigned to the <span class="My-Italic _idGenCharOverride-1">external</span> zone):</p>&#13;
			<p class="Code"># firewall-cmd --zone=external --add-masquerade</p>&#13;
			<p class="My-Basic-Paragraph">To forward from a port to a different local port, a command similar to the following would be used:</p>&#13;
			<p class="Code"># firewall-cmd --zone=external --add-forward-port=port=22:proto=tcp:toport=2750</p>&#13;
			<p class="My-Basic-Paragraph">In the above example, any TCP traffic arriving on port 22 will be forwarded to port 2750 on the local system. The following command, on the other hand, forwards port 20 on the local system to port 22 on the system with the IP address of 192.168.0.19:</p>&#13;
			<p class="Code"># firewall-cmd --zone=external \</p>&#13;
			<p class="Code">          --add-forward-port=port=20:proto=tcp:toport=22:toaddr=192.168.0.19</p>&#13;
			<p class="My-Basic-Paragraph">Similarly, the following command forwards local port 20 to port 2750 on the system with IP address 192.168.0.18:</p>&#13;
			<p class="Code"># firewall-cmd --zone=external --add-forward-port=port=20:proto=tcp:toport=2750:toaddr=192.168.0.18</p>&#13;
			<p id="_idParaDest-129" class="Heading-1-1"><span class="Heading11Marker">13.4 </span><a id="_idTextAnchor176"/>Managing firewalld from the <a id="_idIndexMarker304"/>Cockpit Interface</p>&#13;
			<p class="My-Basic-Paragraph">So far this chapter has provided an overview of firewalld and explored the use of the <span class="My-Italic _idGenCharOverride-1">firewall-cmd </span>command-line tool to manage firewall zones and interfaces. While <span class="My-Italic _idGenCharOverride-1">firewall-cmd</span> provides the most flexible way to manage the firewalld configuration, it is also possible to view and manage the services for the default zone within the Cockpit web console. </p>&#13;
			<p class="My-Basic-Paragraph">To access the firewalld settings, sign into the Cockpit interface and select <span class="My-Italic _idGenCharOverride-1">Networking</span> from the navigation panel. On the networking page, select the <span class="My-Italic _idGenCharOverride-1">Firewall</span> option as highlighted in <a href="../Text/Firewall_Configuration.xhtml#_idTextAnchor177">Figure 13-1</a> below:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-2"><img class="_idGenObjectAttribute-1" src="Images/rhel_8_firewall_link_cockpit.png" alt="" width="949" height="263"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 13-1</span><a id="_idTextAnchor177"/></p>&#13;
			<p class="My-Basic-Paragraph">The Firewall page displays the current service rules configured for the default zone (and allows services to be removed using the trash can buttons), new services to be added to the zone and for the firewall to be turned on and off:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-2"><img class="_idGenObjectAttribute-2" src="Images/rhel_8_firewall_cockpit_page.png" alt="" width="958" height="327"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 13-2</span></p>&#13;
			<p id="_idParaDest-130" class="Heading-1-1"><span class="Heading11Marker">13.5 </span><a id="_idTextAnchor178"/>Managing firewalld using <a id="_idIndexMarker305"/><a id="_idIndexMarker306"/>firewall-config</p>&#13;
			<p class="My-Basic-Paragraph">If you have access to the graphical desktop environment, the firewall may also be configured using the <span class="My-Italic _idGenCharOverride-1">firewall-config</span> tool. Though not installed by default, <span class="My-Italic _idGenCharOverride-1">firewall-config</span> may be installed as follows:</p>&#13;
			<p class="Code"># dnf install firewall-config</p>&#13;
			<p class="My-Basic-Paragraph">When launched, the main <span class="My-Italic _idGenCharOverride-1">firewall-config</span> screen appears as illustrated in <a href="../Text/Firewall_Configuration.xhtml#_idTextAnchor179">Figure 13-3</a>:</p>&#13;
			<p class="Centered-Image"><img class="_idGenObjectAttribute-3" src="Images/rhel_8_firewall-config.png" alt="" width="1024" height="736"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 13-3</span><a id="_idTextAnchor179"/></p>&#13;
			<p class="My-Basic-Paragraph">The key areas of the tool can be summarized as follows:</p>&#13;
			<p class="My-Basic-Paragraph"><span class="My-Bold _idGenCharOverride-1">A</span> - Displays all of the currently active interfaces and the zones to which they are assigned. To assign an interface to a different zone, select it from this panel, click on the <span class="My-Italic _idGenCharOverride-1">Change Zone</span> button and select the required zone from the resulting dialog.</p>&#13;
			<p class="My-Basic-Paragraph"><span class="My-Bold _idGenCharOverride-1">B</span> - Controls whether the information displayed and any changes made within the tool apply to the runtime or permanent rules.</p>&#13;
			<p class="My-Basic-Paragraph"><span class="My-Bold _idGenCharOverride-1">C</span> - The list of zones, services or IPSets configured on the system. The information listed in this panel depends on the selection made from toolbar F. Selecting an item from the list in this panel updates the main panel marked D.</p>&#13;
			<p class="My-Basic-Paragraph"><span class="My-Bold _idGenCharOverride-1">D</span> - The main panel containing information about the current category selection in toolbar E. In this example, the panel is displaying services for the <span class="My-Italic _idGenCharOverride-1">public</span> zone. The checkboxes next to each service control whether the service is enabled or not within the firewall. It is within these category panels that new rules can be added or existing rules configured or removed.</p>&#13;
			<p class="My-Basic-Paragraph"><span class="My-Bold _idGenCharOverride-1">E</span> - Controls the content displayed in panel D. Selecting items from this bar displays the current rule for the chosen category.</p>&#13;
			<p class="My-Basic-Paragraph"><span class="My-Bold _idGenCharOverride-1">F</span> - Controls the list displayed in panel C.</p>&#13;
			<p class="My-Basic-Paragraph">The <span class="My-Italic _idGenCharOverride-1">firewall-config</span> tool is straightforward and intuitive to use and allows many of the tasks available with <span class="My-Italic _idGenCharOverride-1">firewall-cmd</span> to be performed in a visual environment. </p>&#13;
			<p id="_idParaDest-131" class="Heading-1-1"><span class="Heading11Marker">13.6 </span><a id="_idTextAnchor180"/>Summary</p>&#13;
			<p class="My-Basic-Paragraph">A carefully planned and implemented firewall is a vital component of any secure system. In the case of CentOS 8, the firewalld service provides a firewall system that is both flexible and easy to administer. </p>&#13;
			<p class="My-Basic-Paragraph">The firewalld service uses the concept of zones to group together sets of firewall rules and includes a suite of pre-defined zones designed to meet a range of firewall protection requirements. These zones may be modified to add or remove rules, or entirely new zones created and configured. The network devices on the system that connect to networks or the internet are referred to as interfaces. Each interface, in turn, is assigned to a zone. The primary tools for working with firewalld are the <span class="My-Italic _idGenCharOverride-1">firewall-cmd </span>command-line tool and the <span class="My-Italic _idGenCharOverride-1">firewall-config</span> graphical utility. Minimal firewall management options are also available via the Cockpit web interface.</p>&#13;
		</div>&#13;
</div>



  </body></html>