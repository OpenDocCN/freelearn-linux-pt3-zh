<html><head></head><body>
<div class="_idGenObjectStyleOverride-1" id="_idContainer386">
<p class="Chapter-Title" id="_idParaDest-303" lang="en-US" xml:lang="en-US"><span class="ChapterMarker"><span class="koboSpan" id="kobo.1.1">33. </span></span><a id="_idTextAnchor494"/><span class="koboSpan" id="kobo.2.1">Adding a New Disk Drive to an Ubuntu 23.04 System</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.3.1">One of the first problems users and system administrators encounter is that systems need more disk space to store data. </span><span class="koboSpan" id="kobo.3.2">Fortunately, disk space is now one of the cheapest IT commodities. </span><span class="koboSpan" id="kobo.3.3">In this and the next chapter, we will look at configuring Ubuntu to use the space provided when a new physical or virtual disk drive is installed. </span></p>
<p class="Heading-1-1" id="_idParaDest-304" lang="en-US" xml:lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.4.1">33.1 </span></span><a id="_idTextAnchor495"/><span class="koboSpan" id="kobo.5.1">Mounted File Systems or Logical Volumes </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.6.1">There are two ways to configure a new disk drive on an Ubuntu system. </span><span class="koboSpan" id="kobo.6.2">One straightforward method is to create one or more Linux partitions on the new drive, create Linux file systems on those partitions and then mount them at specific mount points to be accessed. </span><span class="koboSpan" id="kobo.6.3">This approach will be covered in this chapter. </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.7.1">Another approach is adding new space to an existing volume group or creating a new one. </span><span class="koboSpan" id="kobo.7.2">When Ubuntu is installed, a volume group named  is created. </span><span class="koboSpan" id="kobo.7.3">Within this volume group are three logical volumes named </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.8.1">root</span></span><span class="koboSpan" id="kobo.9.1">, </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.10.1">home</span></span><span class="koboSpan" id="kobo.11.1">, and </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.12.1">swap</span></span><span class="koboSpan" id="kobo.13.1">, used to store the / and /home file systems and swap partitions, respectively. </span><span class="koboSpan" id="kobo.13.2">We can increase the disk space available to the existing logical volumes by configuring the new disk as part of a volume group. </span><span class="koboSpan" id="kobo.13.3">For example, using this approach, we can increase the size of the /home file system by allocating some or all of the space on the new disk to the home volume. </span><span class="koboSpan" id="kobo.13.4">This topic will be discussed in detail in </span><a href="Volume_Groups.xhtml#_idTextAnchor506"><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.14.1">“Adding a New Disk to an Ubuntu 23.04 Volume Group and Logical Volume”</span></span></a><span class="koboSpan" id="kobo.15.1">. </span></p>
<p class="Heading-1-1" id="_idParaDest-305" lang="en-US" xml:lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.16.1">33.2 </span></span><a id="_idTextAnchor496"/><span class="koboSpan" id="kobo.17.1">Finding the New Hard Drive</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.18.1">This tutorial assumes that a new physical or virtual hard drive has been installed and is visible to the operating system. </span><span class="koboSpan" id="kobo.18.2">Once added, the operating system should automatically detect the new </span><a id="_idIndexMarker758"/><span class="koboSpan" id="kobo.19.1">drive. </span><span class="koboSpan" id="kobo.19.2">Typically, the disk drives in a system are assigned device names beginning hd, sd, or </span><a id="_idIndexMarker759"/><span class="koboSpan" id="kobo.20.1">nvme, followed by a letter to indicate the device number. </span><span class="koboSpan" id="kobo.20.2">The first device might be </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.21.1">/dev/sda</span></span><span class="koboSpan" id="kobo.22.1">, the second </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.23.1">/dev/sdb</span></span><span class="koboSpan" id="kobo.24.1">, etc. </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.25.1">The following is the output from a typical system with only one disk drive connected to a </span><a id="_idIndexMarker760"/><span class="koboSpan" id="kobo.26.1">SATA controller: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.27.1"># ls /dev/sd*</span></p>
<p class="Code"><span class="koboSpan" id="kobo.28.1">/dev/sda  /dev/sda1  /dev/sda2</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.29.1">This shows that the disk drive represented by </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.30.1">/dev/sda</span></span><span class="koboSpan" id="kobo.31.1"> is divided into two partitions, represented by </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.32.1">/dev/sda1</span></span><span class="koboSpan" id="kobo.33.1"> and </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.34.1">/dev/sda2</span></span><span class="koboSpan" id="kobo.35.1">. </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.36.1">The following output is from the same system after a second hard disk drive has been installed: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.37.1"># ls /dev/sd*</span></p>
<p class="Code"><span class="koboSpan" id="kobo.38.1">/dev/sda /dev/sda1 /dev/sda2 /dev/sdb</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.39.1">The new hard drive has been assigned to the device file </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.40.1">/dev/sdb</span></span><span class="koboSpan" id="kobo.41.1">. </span><span class="koboSpan" id="kobo.41.2">The drive has no partitions shown (because we have yet to create any). </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.42.1">At this point, we can create partitions and file systems on the new drive and mount them for access or add the disk as a physical volume as part of a volume group. </span><span class="koboSpan" id="kobo.42.2">To perform the former continue with this chapter; otherwise, read </span><a href="Volume_Groups.xhtml#_idTextAnchor506"><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.43.1">“Adding a New Disk to an Ubuntu 23.04 Volume Group and Logical Volume”</span></span></a><span class="koboSpan" id="kobo.44.1"> for details on configuring Logical Volumes. </span></p>
<p class="Heading-1-1" id="_idParaDest-306" lang="en-US" xml:lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.45.1">33.3 </span></span><a id="_idTextAnchor497"/><span class="koboSpan" id="kobo.46.1">Creating Linux Partitions </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.47.1">The next step is to create one or more Linux partitions on the new disk drive. </span><span class="koboSpan" id="kobo.47.2">This is achieved using the </span><a id="_idIndexMarker761"/><a id="_idIndexMarker762"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.48.1">fdisk</span></span><span class="koboSpan" id="kobo.49.1"> utility, which takes as a command-line argument the device to be partitioned: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.50.1"># fdisk /dev/sdb</span></p>
<p class="Code"><span class="koboSpan" id="kobo.51.1">Welcome to fdisk (util-linux 2.37.4).</span></p>
<p class="Code"><span class="koboSpan" id="kobo.52.1">Changes will remain in memory only, until you decide to write them.</span></p>
<p class="Code"><span class="koboSpan" id="kobo.53.1">Be careful before using the write command.</span></p>
<p class="Code"><span class="koboSpan" id="kobo.54.1">Device does not contain a recognized partition table.</span></p>
<p class="Code"><span class="koboSpan" id="kobo.55.1">Created a new DOS disklabel with disk identifier 0x64d68d00.</span></p>
<p class="Code"><span class="koboSpan" id="kobo.56.1">Command (m for help): </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.57.1">To view the current partitions on the disk, enter the p command: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.58.1">Command (m for help): p</span></p>
<p class="Code"><span class="koboSpan" id="kobo.59.1">Disk /dev/sdb: 14.46 GiB, 15525216256 bytes, 30322688 sectors</span></p>
<p class="Code"><span class="koboSpan" id="kobo.60.1">Disk model: USB 2.0 FD      </span></p>
<p class="Code"><span class="koboSpan" id="kobo.61.1">Units: sectors of 1 * 512 = 512 bytes</span></p>
<p class="Code"><span class="koboSpan" id="kobo.62.1">Sector size (logical/physical): 512 bytes / 512 bytes</span></p>
<p class="Code"><span class="koboSpan" id="kobo.63.1">I/O size (minimum/optimal): 512 bytes / 512 bytes</span></p>
<p class="Code"><span class="koboSpan" id="kobo.64.1">Disklabel type: dos</span></p>
<p class="Code"><span class="koboSpan" id="kobo.65.1">Disk identifier: 0x64d68d00</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.66.1">As we can see from the above </span><a id="_idIndexMarker763"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.67.1">fdisk</span></span><span class="koboSpan" id="kobo.68.1"> output, the disk currently has no partitions because it was previously unused. </span><span class="koboSpan" id="kobo.68.2">The next step is to create a new partition on the disk, a task which is performed by entering n (for a new partition) and p (for a primary partition): </span></p>
<p class="Code"><span class="koboSpan" id="kobo.69.1">Command (m for help): n</span></p>
<p class="Code"><span class="koboSpan" id="kobo.70.1">Partition type</span></p>
<p class="Code"><span class="koboSpan" id="kobo.71.1">   p   primary (0 primary, 0 extended, 4 free)</span></p>
<p class="Code"><span class="koboSpan" id="kobo.72.1">   e   extended (container for logical partitions)</span></p>
<p class="Code"><span class="koboSpan" id="kobo.73.1">Select (default p): p</span></p>
<p class="Code"><span class="koboSpan" id="kobo.74.1">Partition number (1-4, default 1):  </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.75.1">In this example, we only plan to create one partition, which will be partition 1. </span><span class="koboSpan" id="kobo.75.2">Next, we need to specify where the partition will begin and end. </span><span class="koboSpan" id="kobo.75.3">Since this is the first partition, we need it to start at the first available sector, and since we want to use the entire disk, we specify the last sector as the end. </span><span class="koboSpan" id="kobo.75.4">Note that if you wish to create multiple partitions, you can specify the size of each partition by sectors, bytes, kilobytes, or megabytes: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.76.1">Partition number (1-4, default 1): 1</span></p>
<p class="Code"><span class="koboSpan" id="kobo.77.1">First sector (2048-30322687, default 2048): </span></p>
<p class="Code"><span class="koboSpan" id="kobo.78.1">Last sector, +/-sectors or +/-size{K,M,G,T,P} (2048-30322687, default 30322687): </span></p>
<p class="Code"><span class="koboSpan" id="kobo.79.1">Created a new partition 1 of type 'Linux' and of size 14.5 GiB.</span></p>
<p class="Code"><span class="koboSpan" id="kobo.80.1">Command (m for help):  </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.81.1">Now that we have specified the partition, we need to write it to the disk using the w command: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.82.1">Command (m for help): w</span></p>
<p class="Code"><span class="koboSpan" id="kobo.83.1">The partition table has been altered.</span></p>
<p class="Code"><span class="koboSpan" id="kobo.84.1">Calling ioctl() to re-read partition table.</span></p>
<p class="Code"><span class="koboSpan" id="kobo.85.1">Syncing disks.</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.86.1">If we now look at the devices again, we will see that the new partition is visible as </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.87.1">/dev/sdb1</span></span><span class="koboSpan" id="kobo.88.1">: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.89.1"># ls /dev/sd*</span></p>
<p class="Code"><span class="koboSpan" id="kobo.90.1">/dev/sda /dev/sda1 /dev/sda2 /dev/sdb /dev/sdb1</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.91.1">The next step is to create a file system on our new partition. </span></p>
<p class="Heading-1-1" id="_idParaDest-307" lang="en-US" xml:lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.92.1">33.4 </span></span><a id="_idTextAnchor498"/><span class="koboSpan" id="kobo.93.1">Creating a </span><a id="_idIndexMarker764"/><span class="koboSpan" id="kobo.94.1">File System on an Ubuntu Disk Partition </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.95.1">We now have a new disk installed, it is visible to Ubuntu, and we have configured a Linux partition on the disk. </span><span class="koboSpan" id="kobo.95.2">The next step is to create a Linux file system on the partition so that the operating system can use it to store files and data. </span><span class="koboSpan" id="kobo.95.3">The easiest way to create a file system on a partition is to use the </span><a id="_idIndexMarker765"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.96.1">mkfs.xfs</span></span><span class="koboSpan" id="kobo.97.1"> utility: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.98.1"># apt install xfsprogs</span></p>
<p class="Code"><span class="koboSpan" id="kobo.99.1"># umount /dev/sdb1</span></p>
<p class="Code"><span class="koboSpan" id="kobo.100.1"># mkfs.xfs -f /dev/sdb1</span></p>
<p class="Code"><span class="koboSpan" id="kobo.101.1">meta-data=/dev/sdb1              isize=512    agcount=4, agsize=947520 blks</span></p>
<p class="Code"><span class="koboSpan" id="kobo.102.1">         =                       sectsz=512   attr=2, projid32bit=1</span></p>
<p class="Code"><span class="koboSpan" id="kobo.103.1">         =                       crc=1        finobt=1, sparse=1, rmapbt=0</span></p>
<p class="Code"><span class="koboSpan" id="kobo.104.1">         =                       reflink=1    bigtime=1 inobtcount=1</span></p>
<p class="Code"><span class="koboSpan" id="kobo.105.1">data     =                       bsize=4096   blocks=3790080, imaxpct=25</span></p>
<p class="Code"><span class="koboSpan" id="kobo.106.1">         =                       sunit=0      swidth=0 blks</span></p>
<p class="Code"><span class="koboSpan" id="kobo.107.1">naming   =version 2              bsize=4096   ascii-ci=0, ftype=1</span></p>
<p class="Code"><span class="koboSpan" id="kobo.108.1">log      =internal log           bsize=4096   blocks=2560, version=2</span></p>
<p class="Code"><span class="koboSpan" id="kobo.109.1">         =                       sectsz=512   sunit=0 blks, lazy-count=1</span></p>
<p class="Code"><span class="koboSpan" id="kobo.110.1">realtime =none                   extsz=4096   blocks=0, rtextents=0</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.111.1">In this case, we have created an </span><a id="_idIndexMarker766"/><span class="koboSpan" id="kobo.112.1">XFS file system. </span><span class="koboSpan" id="kobo.112.2">XFS is a high-performance file system that is the default filesystem type on Ubuntu and includes several advantages in terms of parallel I/O performance and the use of journaling.</span></p>
<p class="Heading-1-1" id="_idParaDest-308" lang="en-US" xml:lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.113.1">33.5 </span></span><a id="_idTextAnchor499"/><span class="koboSpan" id="kobo.114.1">An Overview of </span><a id="_idIndexMarker767"/><span class="koboSpan" id="kobo.115.1">Journaled File Systems</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.116.1">A journaling filesystem keeps a journal or log of the changes being made to the filesystem during disk writing that can be used to rapidly reconstruct corruptions that may occur due to events such as a system crash or power outage. </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.117.1">There are several advantages to using a journaling file system. </span><span class="koboSpan" id="kobo.117.2">First, the size and volume of data stored on disk drives have grown exponentially over the years. </span><span class="koboSpan" id="kobo.117.3">The problem with a non-journaled file system is that following a crash, the </span><a id="_idIndexMarker768"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.118.1">fsck</span></span><span class="koboSpan" id="kobo.119.1"> (filesystem consistency check) utility has to be run. </span><span class="koboSpan" id="kobo.119.2">The </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.120.1">fsck</span></span><span class="koboSpan" id="kobo.121.1"> utility will scan the entire filesystem validating all entries and ensuring that blocks are allocated and referenced correctly. </span><span class="koboSpan" id="kobo.121.2">It will attempt to fix the problem if it finds a corrupt entry. </span><span class="koboSpan" id="kobo.121.3">The issues here are two-fold. </span><span class="koboSpan" id="kobo.121.4">First, the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.122.1">fsck</span></span><span class="koboSpan" id="kobo.123.1"> utility will not always be able to repair the damage, and you will end up with data in the </span><a id="_idIndexMarker769"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.124.1">lost+found</span></span><span class="koboSpan" id="kobo.125.1"> directory. </span><span class="koboSpan" id="kobo.125.2">An application uses this data, but the system no longer knows where it was referenced from. </span><span class="koboSpan" id="kobo.125.3">The other problem is the issue of time. </span><span class="koboSpan" id="kobo.125.4">Completing the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.126.1">fsck</span></span><span class="koboSpan" id="kobo.127.1"> process on an extensive file system can take a long time, potentially leading to unacceptable downtime.</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.128.1">On the other hand, a journaled file system records information in a log area on a disk (the journal and log do not need to be on the same device) during each write. </span><span class="koboSpan" id="kobo.128.2">This is essentially an “intent to commit” data to the filesystem. </span><span class="koboSpan" id="kobo.128.3">The amount of information logged is configurable and ranges from not logging anything to logging what is known as the “metadata” (i.e., ownership, date stamp information, etc.) to logging the “metadata” and the data blocks that are to be written to the file. </span><span class="koboSpan" id="kobo.128.4">Once the log is updated, the system writes the actual data to the appropriate filesystem areas and marks an entry to say the data is committed.</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.129.1">After a crash, the filesystem can quickly be brought back online using the journal log, thereby reducing what could take minutes using </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.130.1">fsck</span></span><span class="koboSpan" id="kobo.131.1"> to seconds with the added advantage that there is considerably less chance of data loss or corruption.</span></p>
<p class="Heading-1-1" id="_idParaDest-309" lang="en-US" xml:lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.132.1">33.6 </span></span><a id="_idTextAnchor500"/><span class="koboSpan" id="kobo.133.1">Mounting a </span><a id="_idIndexMarker770"/><span class="koboSpan" id="kobo.134.1">File System </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.135.1">Now that we have created a new file system on the Linux partition of our new disk drive, we need to mount it to be accessible and usable. </span><span class="koboSpan" id="kobo.135.2">To do this, we need to create a mount point. </span><span class="koboSpan" id="kobo.135.3">A mount point is simply a directory or folder into which the file system will be mounted. </span><span class="koboSpan" id="kobo.135.4">For this example, we will create a </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.136.1">/backup</span></span><span class="koboSpan" id="kobo.137.1"> directory to match our file system label (although these values don’t need to match): </span></p>
<p class="Code"><span class="koboSpan" id="kobo.138.1"># mkdir /backup</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.139.1">The file system may then be manually mounted using the </span><a id="_idIndexMarker771"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.140.1">mount</span></span><span class="koboSpan" id="kobo.141.1"> command: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.142.1"># mount /dev/sdb1 /backup</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.143.1">Running the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.144.1">mount</span></span><span class="koboSpan" id="kobo.145.1"> command with no arguments shows us all currently mounted file systems (including our new file system): </span></p>
<p class="Code"><span class="koboSpan" id="kobo.146.1"># mount</span></p>
<p class="Code"><span class="koboSpan" id="kobo.147.1">proc on /proc type proc (rw,nosuid,nodev,noexec,relatime)</span></p>
<p class="Code"><span class="koboSpan" id="kobo.148.1">sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime,seclabel)</span></p>
<p class="Code"><span class="koboSpan" id="kobo.149.1">.</span></p>
<p class="Code"><span class="koboSpan" id="kobo.150.1">.</span></p>
<p class="Code"><span class="koboSpan" id="kobo.151.1">/dev/sdb1 on /backup type xfs (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)</span></p>
<p class="Heading-1-1" id="_idParaDest-310" lang="en-US" xml:lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.152.1">33.7 </span></span><a id="_idTextAnchor501"/><span class="koboSpan" id="kobo.153.1">Configuring Ubuntu to Mount a File System Automatically </span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.154.1">To set up the system so that the new file system is automatically mounted at boot time, an entry needs to be added to the </span><a id="_idIndexMarker772"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.155.1">/etc/fstab</span></span><span class="koboSpan" id="kobo.156.1"> file. </span><span class="koboSpan" id="kobo.156.2">The format for an </span><a id="_idIndexMarker773"/><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.157.1">fstab</span></span><span class="koboSpan" id="kobo.158.1"> entry is as follows:</span></p>
<p class="Code"><span class="koboSpan" id="kobo.159.1">&lt;device&gt;	&lt;dir&gt;	&lt;type&gt;	&lt;options&gt;	&lt;dump&gt;	&lt;fsck&gt;</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.160.1">These entries can be summarized as follows:</span></p>
<p class="Bullet-List" lang="en-US" xml:lang="en-US"><span class="_idGenBNMarker-3"><span class="koboSpan" id="kobo.161.1">•</span></span><span class="My-Bold _idGenCharOverride-1"><span class="koboSpan" id="kobo.162.1">&lt;device&gt;</span></span><span class="koboSpan" id="kobo.163.1"> - The device on which the filesystem will be mounted.</span></p>
<p class="Bullet-List" lang="en-US" xml:lang="en-US"><span class="_idGenBNMarker-3"><span class="koboSpan" id="kobo.164.1">•</span></span><span class="My-Bold _idGenCharOverride-1"><span class="koboSpan" id="kobo.165.1">&lt;dir&gt;</span></span><span class="koboSpan" id="kobo.166.1"> - The directory that is to act as the mount point for the filesystem.</span></p>
<p class="Bullet-List" lang="en-US" xml:lang="en-US"><span class="_idGenBNMarker-3"><span class="koboSpan" id="kobo.167.1">•</span></span><span class="My-Bold _idGenCharOverride-1"><span class="koboSpan" id="kobo.168.1">&lt;type&gt;</span></span><span class="koboSpan" id="kobo.169.1"> - The filesystem type (xfs, ext4 etc.)</span></p>
<p class="Bullet-List" lang="en-US" xml:lang="en-US"><span class="_idGenBNMarker-3"><span class="koboSpan" id="kobo.170.1">•</span></span><span class="My-Bold _idGenCharOverride-1"><span class="koboSpan" id="kobo.171.1">&lt;options&gt;</span></span><span class="koboSpan" id="kobo.172.1"> - Additional filesystem mount options, for example, making the filesystem read-only or controlling whether any user can mount the filesystem. </span><span class="koboSpan" id="kobo.172.2">Run man mount to review a complete list of options. </span><span class="koboSpan" id="kobo.172.3">Setting this value to defaults will use the default settings for the filesystem (rw, suid, dev, exec, auto, nouser, async).</span></p>
<p class="Bullet-List" lang="en-US" xml:lang="en-US"><span class="_idGenBNMarker-3"><span class="koboSpan" id="kobo.173.1">•</span></span><span class="My-Bold _idGenCharOverride-1"><span class="koboSpan" id="kobo.174.1">&lt;dump&gt;</span></span><span class="koboSpan" id="kobo.175.1"> - Dictates whether the content of the filesystem is to be included in any backups performed by the dump utility. </span><span class="koboSpan" id="kobo.175.2">This setting is rarely used and can be disabled with a 0 value.</span></p>
<p class="Bullet-List" lang="en-US" xml:lang="en-US"><span class="_idGenBNMarker-3"><span class="koboSpan" id="kobo.176.1">•</span></span><span class="My-Bold _idGenCharOverride-1"><span class="koboSpan" id="kobo.177.1">&lt;fsck&gt;</span></span><span class="koboSpan" id="kobo.178.1"> - Whether the filesystem is checked by </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.179.1">fsck</span></span><span class="koboSpan" id="kobo.180.1"> after a system crash and the order in which filesystems are to be checked. </span><span class="koboSpan" id="kobo.180.2">For journaled filesystems such as XFS this should be set to 0 to indicate that the check is not required.</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.181.1">The following example shows a </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.182.1">fstab</span></span><span class="koboSpan" id="kobo.183.1"> entry to automount our </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.184.1">/backup</span></span><span class="koboSpan" id="kobo.185.1"> partition on the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.186.1">/dev/sdb1</span></span><span class="koboSpan" id="kobo.187.1"> partition: </span></p>
<p class="Code"><span class="koboSpan" id="kobo.188.1">/dev/sdb1                   /backup  xfs     defaults         0       0</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.189.1">The </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.190.1">/backup</span></span><span class="koboSpan" id="kobo.191.1"> filesystem will now automount each time the system restarts. </span></p>
<p class="Heading-1-1" id="_idParaDest-311" lang="en-US" xml:lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.192.1">33.8 </span></span><a id="_idTextAnchor502"/><span class="koboSpan" id="kobo.193.1">Adding a Disk Using Cockpit</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.194.1">In addition to working with storage using the command-line utilities outlined in this chapter, it is also possible to configure a new storage device using the </span><a id="_idIndexMarker774"/><span class="koboSpan" id="kobo.195.1">Cockpit web console. </span><span class="koboSpan" id="kobo.195.2">To view the current storage configuration, log into the Cockpit console and select the Storage option as shown in </span><a href="Adding_New_DIsk.xhtml#_idTextAnchor503"><span class="koboSpan" id="kobo.196.1">Figure 33-1</span></a><span class="koboSpan" id="kobo.197.1">:</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.198.1"><img alt="" class="_idGenObjectAttribute-1" src="image/centos_cockpit_storage1.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US" xml:lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.199.1">Figure 33-1</span></span><a id="_idTextAnchor503"/></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.200.1">To locate the newly added storage, scroll to the bottom of the Storage page until the Drives section comes into view (note that the </span><a id="_idIndexMarker775"/><span class="koboSpan" id="kobo.201.1">Drives section may also be located in the top right-hand corner of the screen):</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.202.1"><img alt="" class="_idGenObjectAttribute-2" src="image/cockpit_drives.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US" xml:lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.203.1">Figure 33-2</span></span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.204.1">In the case of the above figure, the new drive is the 15.5 GB drive. </span><span class="koboSpan" id="kobo.204.2">Select the new drive to display the Drive screen as shown in </span><a href="Adding_New_DIsk.xhtml#_idTextAnchor504"><span class="koboSpan" id="kobo.205.1">Figure 33-3</span></a><span class="koboSpan" id="kobo.206.1">:</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.207.1"><img alt="" class="_idGenObjectAttribute-3" src="image/cockpit_drive_details.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US" xml:lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.208.1">Figure 33-3</span></span><a id="_idTextAnchor504"/></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.209.1">Click on the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.210.1">Create partition</span></span><span class="koboSpan" id="kobo.211.1"> button and use the dialog to specify how much space will be allocated to this partition, the filesystem type (XFS is recommended), and an optional label, filesystem mount point, and mount options. </span><span class="koboSpan" id="kobo.211.2">Note that additional partitions may be added to the drive if this new partition does not use all the available space. </span><span class="koboSpan" id="kobo.211.3">To change settings such as whether the filesystem is read-only or mounted at boot time, change the settings in the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.212.1">Mount options</span></span><span class="koboSpan" id="kobo.213.1"> section:</span></p>
<p class="My-Basic-Paragraph ParaOverride-1" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.214.1"><img alt="" class="_idGenObjectAttribute-4" src="image/cockpit_drive_create_partition.jpg"/></span></p>
<p class="Figure-Caption" lang="en-US" xml:lang="en-US"><span class="FigureCaptionMarker"><span class="koboSpan" id="kobo.215.1">Figure 33-4</span></span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.216.1">Once the settings have been selected, click the Create partition button to commit the change. </span><span class="koboSpan" id="kobo.216.2">Upon completion of the creation process, the new partition will be added to the disk, the corresponding filesystem will be created and mounted at the designated mount point, and appropriate changes will be made to the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.217.1">/etc/fstab</span></span><span class="koboSpan" id="kobo.218.1"> file.</span></p>
<p class="Heading-1-1" id="_idParaDest-312" lang="en-US" xml:lang="en-US"><span class="Heading11Marker"><span class="koboSpan" id="kobo.219.1">33.9 </span></span><a id="_idTextAnchor505"/><span class="koboSpan" id="kobo.220.1">Summary</span></p>
<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.221.1">This chapter has covered adding a physical or virtual disk drive to an existing Ubuntu system. </span><span class="koboSpan" id="kobo.221.2">This is a relatively simple process of ensuring the new drive has been detected by the operating system, creating one or more partitions on the drive, and then making filesystems on those partitions. </span><span class="koboSpan" id="kobo.221.3">Although several filesystem types are available on Ubuntu, XFS is generally recommended. </span><span class="koboSpan" id="kobo.221.4">Once the filesystems are ready, they can be mounted using the mount command. </span><span class="koboSpan" id="kobo.221.5">So that the newly created filesystems mount automatically on system startup, additions can be made to the </span><span class="My-Italic _idGenCharOverride-1"><span class="koboSpan" id="kobo.222.1">/etc/fstab</span></span><span class="koboSpan" id="kobo.223.1"> configuration file.</span></p>
</div>
</body></html>