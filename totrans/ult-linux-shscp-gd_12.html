<html><head></head><body>
  <div id="_idContainer165" class="Basic-Text-Frame">
    <h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">12</span></h1>
    <h1 id="_idParaDest-277" class="chapterTitle"><span class="koboSpan" id="kobo.2.1">Automating Scripts with here Documents and expect</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.3.1">So, exactly where is </span><em class="italic"><span class="koboSpan" id="kobo.4.1">here</span></em><span class="koboSpan" id="kobo.5.1">? </span><span class="koboSpan" id="kobo.5.2">Well, I suppose that it’s just where I happen to be, or from your own perspective, wherever you happen to be. </span><span class="koboSpan" id="kobo.5.3">The bigger mystery, which nobody seems to have figured out, is why a very useful shell scripting construct has such a strange name.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.6.1">A </span><strong class="keyWord"><span class="koboSpan" id="kobo.7.1">here document</span></strong><span class="koboSpan" id="kobo.8.1">, which can also be called a </span><strong class="keyWord"><span class="koboSpan" id="kobo.9.1">here script</span></strong><span class="koboSpan" id="kobo.10.1"> or a </span><strong class="keyWord"><span class="koboSpan" id="kobo.11.1">heredoc</span></strong><span class="koboSpan" id="kobo.12.1">, isn’t really a document, and it has nothing to do with </span><a id="_idIndexMarker775"/><span class="koboSpan" id="kobo.13.1">anyone’s current location. </span><span class="koboSpan" id="kobo.13.2">But, as you shall soon see, it’s extremely useful in a number of different ways, such as in automating your scripts.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.14.1">The second automation method I’ll show you is </span><strong class="keyWord"><span class="koboSpan" id="kobo.15.1">expect</span></strong><span class="koboSpan" id="kobo.16.1">, which is a scripting environment with its own scripting language.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.17.1">Topics in this chapter include:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.18.1">Using here Documents</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.19.1">Automating responses with expect</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.20.1">All right, let’s get ready to automate!</span></p>
    <h1 id="_idParaDest-278" class="heading 1"><span class="koboSpan" id="kobo.21.1">Technical Requirements</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.22.1">You can use any Linux virtual machine for this chapter. </span><span class="koboSpan" id="kobo.22.2">Also, as always, you can grab the script and text files from GitHub by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.23.1">git clone https://github.com/PacktPublishing/The-Ultimate-Linux-Shell-Scripting-Guide.git
</span></code></pre>
    <h1 id="_idParaDest-279" class="heading 1"><span class="koboSpan" id="kobo.24.1">Using here Documents</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.25.1">A </span><em class="italic"><span class="koboSpan" id="kobo.26.1">here document</span></em><span class="koboSpan" id="kobo.27.1"> is a block </span><a id="_idIndexMarker776"/><span class="koboSpan" id="kobo.28.1">of code that you place into a script to perform a certain task. </span><span class="koboSpan" id="kobo.28.2">Yeah, I know, I said the same thing about functions. </span><span class="koboSpan" id="kobo.28.3">But, </span><em class="italic"><span class="koboSpan" id="kobo.29.1">here documents</span></em><span class="koboSpan" id="kobo.30.1"> are completely different. </span><span class="koboSpan" id="kobo.30.2">They’ve been around since the early days of Unix, and can be used in various different programming languages.</span></p>
    <div class="note">
      <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.31.1">Formatting note</span></strong><span class="koboSpan" id="kobo.32.1">: The accepted Unix and Linux convention for writing out the term “here document” is to do so in all lower-case letters. </span><span class="koboSpan" id="kobo.32.2">That can get a bit confusing, though. </span><span class="koboSpan" id="kobo.32.3">So, to eliminate the confusion, I’ll just italicize the term throughout the rest of this book, like this: </span><em class="italic"><span class="koboSpan" id="kobo.33.1">here document</span></em><span class="koboSpan" id="kobo.34.1">.</span></p>
    </div>
    <p class="normal"><em class="italic"><span class="koboSpan" id="kobo.35.1">Here documents</span></em><span class="koboSpan" id="kobo.36.1"> work by providing another way to redirect input into a particular command. </span><span class="koboSpan" id="kobo.36.2">The code that performs this redirection is enclosed by a pair of </span><strong class="keyWord"><span class="koboSpan" id="kobo.37.1">limit strings</span></strong><span class="koboSpan" id="kobo.38.1">, which look something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.39.1">command &lt;&lt; _EOF_
. </span><span class="koboSpan" id="kobo.39.2">. </span><span class="koboSpan" id="kobo.39.3">.
</span><span class="koboSpan" id="kobo.39.4">Code to execute or data to display
. </span><span class="koboSpan" id="kobo.39.5">. </span><span class="koboSpan" id="kobo.39.6">.
</span><span class="koboSpan" id="kobo.39.7">_EOF_
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.40.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.41.1">&lt;&lt;</span></code><span class="koboSpan" id="kobo.42.1"> sequence is a special type of redirector. </span><span class="koboSpan" id="kobo.42.2">It takes input from whatever code or text is between the two limit strings, which in this case are called </span><code class="inlineCode"><span class="koboSpan" id="kobo.43.1">_EOF_</span></code><span class="koboSpan" id="kobo.44.1">. </span><span class="koboSpan" id="kobo.44.2">It’s traditional to use either </span><code class="inlineCode"><span class="koboSpan" id="kobo.45.1">_EOF_</span></code><span class="koboSpan" id="kobo.46.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.47.1">EOF</span></code><span class="koboSpan" id="kobo.48.1"> as the limit strings, but you can actually use pretty much any text string you want, as long as they’re the same at both the beginning and end of the code block, and also as long as they don’t conflict with the names of any variables or functions. </span><span class="koboSpan" id="kobo.48.2">In fact, it can often help make the script more readable if you give descriptive names to your limit strings. </span><span class="koboSpan" id="kobo.48.3">(Some tutorials that you’ll find use the</span><a id="_idIndexMarker777"/><span class="koboSpan" id="kobo.49.1"> term </span><strong class="keyWord"><span class="koboSpan" id="kobo.50.1">token</span></strong><span class="koboSpan" id="kobo.51.1"> instead </span><a id="_idIndexMarker778"/><span class="koboSpan" id="kobo.52.1">of </span><strong class="keyWord"><span class="koboSpan" id="kobo.53.1">limit string</span></strong><span class="koboSpan" id="kobo.54.1">, but it’s still the</span><a id="_idIndexMarker779"/><span class="koboSpan" id="kobo.55.1"> same thing.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.56.1">Instead of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.57.1">&lt;&lt;</span></code><span class="koboSpan" id="kobo.58.1"> as the redirector, you can also use </span><code class="inlineCode"><span class="koboSpan" id="kobo.59.1">&lt;&lt;-</span></code><span class="koboSpan" id="kobo.60.1">, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.61.1">command &lt;&lt;- _EOF_
. </span><span class="koboSpan" id="kobo.61.2">. </span><span class="koboSpan" id="kobo.61.3">.
</span><span class="koboSpan" id="kobo.61.4">Code to execute or data to display
. </span><span class="koboSpan" id="kobo.61.5">. </span><span class="koboSpan" id="kobo.61.6">.
</span><span class="koboSpan" id="kobo.61.7">_EOF_
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.62.1">Adding the dash prevents any leading tab characters from indenting any displayed text. </span><span class="koboSpan" id="kobo.62.2">(Leading spaces will still indent the text, but tabs won’t. </span><span class="koboSpan" id="kobo.62.3">I’ll explain more about this in just a bit.) This makes it so that you can indent the code in the script to make it more readable, without causing the output to be indented.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.63.1">Here are some of the things that you can do with </span><em class="italic"><span class="koboSpan" id="kobo.64.1">here documents</span></em><span class="koboSpan" id="kobo.65.1">:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.66.1">Display multi-line comments from a shell script.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.67.1">Create a simple look-up directory.</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.68.1">Automate the creation of documents, such as web content files or reports.</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.69.1">Your </span><em class="italic"><span class="koboSpan" id="kobo.70.1">here documents</span></em><span class="koboSpan" id="kobo.71.1"> can work with either static or dynamic data. </span><span class="koboSpan" id="kobo.71.2">Let’s start with the static ones, since they’re the simplest.</span></p>
    <h2 id="_idParaDest-280" class="heading 2"><span class="koboSpan" id="kobo.72.1">Creating here Documents with Static Data</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.73.1">There may be times</span><a id="_idIndexMarker780"/><span class="koboSpan" id="kobo.74.1"> when you’ll want your scripts to display some sort of a multi-line message when users invoke them. </span><span class="koboSpan" id="kobo.74.2">This </span><a id="_idIndexMarker781"/><span class="koboSpan" id="kobo.75.1">message could be a help message, a copyright message, or a licensing message. </span><span class="koboSpan" id="kobo.75.2">You could do that with a series of </span><code class="inlineCode"><span class="koboSpan" id="kobo.76.1">echo</span></code><span class="koboSpan" id="kobo.77.1"> commands, which would look something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.78.1">#!/bin/bash
echo "This software is released under the GNU GPL 3 license."
</span><span class="koboSpan" id="kobo.78.2">echo "Anyone who uses this software must respect the terms"
echo "of this license."
</span><span class="koboSpan" id="kobo.78.3">echo
echo "GNU GPL 3 is a license that aims to protect software freedom."
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.79.1">This works, but if you need to display a long message, typing in many individual echo commands can</span><a id="_idIndexMarker782"/><span class="koboSpan" id="kobo.80.1"> get a bit tedious. </span><span class="koboSpan" id="kobo.80.2">Using a </span><em class="italic"><span class="koboSpan" id="kobo.81.1">here document</span></em><span class="koboSpan" id="kobo.82.1"> to display the message can make things much easier. </span><span class="koboSpan" id="kobo.82.2">Here’s how that looks in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.83.1">here-doc1.sh</span></code><span class="koboSpan" id="kobo.84.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.85.1">#!/bin/bash
cat &lt;&lt; licensing
This software is released under the GNU GPL 3 license.
</span><span class="koboSpan" id="kobo.85.2">Anyone who uses this software must respect the terms
of this license.
</span><span class="koboSpan" id="kobo.85.3">GNU GPL 3 is a license that aims to protect software freedom.
</span><span class="koboSpan" id="kobo.85.4">licensing
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.86.1">In this case, I’m using </span><code class="inlineCode"><span class="koboSpan" id="kobo.87.1">licensing</span></code><span class="koboSpan" id="kobo.88.1"> as the limit strings, instead of the more traditional </span><code class="inlineCode"><span class="koboSpan" id="kobo.89.1">_EOF_</span></code><span class="koboSpan" id="kobo.90.1">. </span><span class="koboSpan" id="kobo.90.2">This way, I </span><a id="_idIndexMarker783"/><span class="koboSpan" id="kobo.91.1">can tell at a glance what the </span><em class="italic"><span class="koboSpan" id="kobo.92.1">here document</span></em><span class="koboSpan" id="kobo.93.1"> is doing for me. </span><span class="koboSpan" id="kobo.93.2">Here’s what happens when I run the script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.94.1">[donnie@fedora ~]$ ./here-doc1.sh
This software is released under the GNU GPL 3 license.
</span><span class="koboSpan" id="kobo.94.2">Anyone who uses this software must respect the terms
of this license.
</span><span class="koboSpan" id="kobo.94.3">GNU GPL 3 is a license that aims to protect software freedom.
</span><span class="koboSpan" id="kobo.94.4">[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.95.1">As you see, the text that’s between the two </span><code class="inlineCode"><span class="koboSpan" id="kobo.96.1">licensing</span></code><span class="koboSpan" id="kobo.97.1"> strings gets redirected into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.98.1">cat</span></code><span class="koboSpan" id="kobo.99.1"> command, which then displays the text on screen.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.100.1">There may be times when you’ll need to choose a license for any free-as-in-freedom software or shell scripts that you need to create. </span><span class="koboSpan" id="kobo.100.2">There are many free software licenses from which to choose, and you’ll need to choose the one that best fits your needs. </span><span class="koboSpan" id="kobo.100.3">Basically though, you can classify the various licenses as either permissive or non-permissive. </span><span class="koboSpan" id="kobo.100.4">Permissive licenses, such as the MIT and BSD licenses, allow licensed code to be embedded into proprietary software, and don’t require that the source code for the finished product be provided to the customer. </span><span class="koboSpan" id="kobo.100.5">(This is why Apple can include FreeBSD code in its proprietary OS X and macOS operating systems.) Non-permissive licenses, such as the various GNU Public Licenses, prohibit the use of licensed code in proprietary software, and require that software vendors make the source code of the finished product available to customers. </span><span class="koboSpan" id="kobo.100.6">Anyway, you can read all about the various free software licenses here: </span><a href="https://opensource.org/licenses/"><span class="url"><span class="koboSpan" id="kobo.101.1">https://opensource.org/licenses/</span></span></a></p>
      <p class="normal"><span class="koboSpan" id="kobo.102.1">By the way, MIT stands for Massachusetts Institute of Technology, BSD stands for Berkeley Software Distribution, and GNU is a recursive acronym that stands for GNU is not Unix.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.103.1">There may be times when you’ll want to indent the code in your </span><em class="italic"><span class="koboSpan" id="kobo.104.1">here documents</span></em><span class="koboSpan" id="kobo.105.1"> to make the script more</span><a id="_idIndexMarker784"/><span class="koboSpan" id="kobo.106.1"> readable. </span><span class="koboSpan" id="kobo.106.2">That’s not the case with this </span><code class="inlineCode"><span class="koboSpan" id="kobo.107.1">here-doc1.sh</span></code><span class="koboSpan" id="kobo.108.1"> script, but let’s</span><a id="_idIndexMarker785"/><span class="koboSpan" id="kobo.109.1"> pretend that it is. </span><span class="koboSpan" id="kobo.109.2">Let’s create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.110.1">here-doc1-tabs.sh</span></code><span class="koboSpan" id="kobo.111.1"> script, and make it look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.112.1">#!/bin/bash
cat &lt;&lt; licensing  
                This software is released under the GNU GPL 3 license.
        </span><span class="koboSpan" id="kobo.112.2">Anyone who uses this software must respect the terms
        of this license.
   </span><span class="koboSpan" id="kobo.112.3">GNU GPL 3 is a license that aims to protect software freedom.
</span><span class="koboSpan" id="kobo.112.4">licensing
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.113.1">This is the same as </span><code class="inlineCode"><span class="koboSpan" id="kobo.114.1">here-doc1.sh</span></code><span class="koboSpan" id="kobo.115.1">, except that I placed two tabs in front of the “This software. </span><span class="koboSpan" id="kobo.115.2">. </span><span class="koboSpan" id="kobo.115.3">.” </span><span class="koboSpan" id="kobo.115.4">line, one tab in front of the “Anyone who. </span><span class="koboSpan" id="kobo.115.5">. </span><span class="koboSpan" id="kobo.115.6">.” </span><span class="koboSpan" id="kobo.115.7">and “. </span><span class="koboSpan" id="kobo.115.8">. </span><span class="koboSpan" id="kobo.115.9">.of this license” lines, and three blank spaces in front of the “GNU GPL 3. </span><span class="koboSpan" id="kobo.115.10">. </span><span class="koboSpan" id="kobo.115.11">.” </span><span class="koboSpan" id="kobo.115.12">line. </span><span class="koboSpan" id="kobo.115.13">Watch what happens when I run this new script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.116.1">donnie@fedora:~$ ./here-doc1-tabs.sh
		This software is released under the GNU GPL 3 license.
	    </span><span class="koboSpan" id="kobo.116.2">Anyone who uses this software must respect the terms
	    of this license.
   </span><span class="koboSpan" id="kobo.116.3">GNU GPL 3 is a license that aims to protect software freedom.
</span><span class="koboSpan" id="kobo.116.4">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.117.1">Now, let’s say that we want to leave the tabs and the blank space in the script, but we don’t want</span><a id="_idIndexMarker786"/><span class="koboSpan" id="kobo.118.1"> the tabs to show up in the output. </span><span class="koboSpan" id="kobo.118.2">All we have need to do is to change the </span><code class="inlineCode"><span class="koboSpan" id="kobo.119.1">&lt;&lt;</span></code><span class="koboSpan" id="kobo.120.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.121.1">&lt;&lt;-</span></code><span class="koboSpan" id="kobo.122.1">, as you see here in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.123.1">here-doc1-tabs-dash.sh</span></code><span class="koboSpan" id="kobo.124.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.125.1">#!/bin/bash
cat &lt;&lt;- licensing  
                This software is released under the GNU GPL 3 license.
        </span><span class="koboSpan" id="kobo.125.2">Anyone who uses this software must respect the terms
        of this license.
   </span><span class="koboSpan" id="kobo.125.3">GNU GPL 3 is a license that aims to protect software freedom.
</span><span class="koboSpan" id="kobo.125.4">licensing
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.126.1">Now, watch what happens when I run it:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.127.1">donnie@fedora:~$ ./here-doc1-tabs-dash.sh
This software is released under the GNU GPL 3 license.
</span><span class="koboSpan" id="kobo.127.2">Anyone who uses this software must respect the terms
of this license.
   </span><span class="koboSpan" id="kobo.127.3">GNU GPL 3 is a license that aims to protect software freedom.
</span><span class="koboSpan" id="kobo.127.4">donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.128.1">This time, all of the lines that begin with tabs in the script now output text that is flush with the left margin. </span><span class="koboSpan" id="kobo.128.2">However, the line that begins with three blank spaces outputs text with three blank </span><a id="_idIndexMarker787"/><span class="koboSpan" id="kobo.129.1">spaces.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.130.1">As I mentioned in the opening paragraph of this section, using </span><code class="inlineCode"><span class="koboSpan" id="kobo.131.1">&lt;&lt;-</span></code><span class="koboSpan" id="kobo.132.1"> instead of </span><code class="inlineCode"><span class="koboSpan" id="kobo.133.1">&lt;&lt;</span></code><span class="koboSpan" id="kobo.134.1"> prevents any leading tabs in your </span><em class="italic"><span class="koboSpan" id="kobo.135.1">here document</span></em><span class="koboSpan" id="kobo.136.1"> from showing up in the script’s output. </span><span class="koboSpan" id="kobo.136.2">But, it allows any leading blank spaces to show up.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.137.1">It’s important to remember that you can’t have any blank spaces in front of the closing limit string. </span><span class="koboSpan" id="kobo.137.2">If I were to insert a blank space in front of the closing </span><code class="inlineCode"><span class="koboSpan" id="kobo.138.1">licensing</span></code><span class="koboSpan" id="kobo.139.1"> string in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.140.1">here-doc1.sh</span></code><span class="koboSpan" id="kobo.141.1"> script, I would get an error message that looks something like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.142.1">[donnie@fedora ~]$ ./here-doc1.sh
./here-doc1.sh: line 10: warning: here-document at line 3 delimited by end-of-file (wanted `licensing')
This software is released under the GNU GPL 3 license.
</span><span class="koboSpan" id="kobo.142.2">Anyone who uses this software must respect the terms
of this license.
</span><span class="koboSpan" id="kobo.142.3">GNU GPL 3 is a license that aims to protect software freedom.
 </span><span class="koboSpan" id="kobo.142.4">licensing
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.143.1">Of course, this isn’t what you want.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.144.1">This </span><code class="inlineCode"><span class="koboSpan" id="kobo.145.1">here-doc1.sh</span></code><span class="koboSpan" id="kobo.146.1"> script isn’t very useful as-is, because the only thing it does is display a message. </span><span class="koboSpan" id="kobo.146.2">So normally, you’d </span><a id="_idIndexMarker788"/><span class="koboSpan" id="kobo.147.1">place the rest of your code after the </span><em class="italic"><span class="koboSpan" id="kobo.148.1">here document</span></em><span class="koboSpan" id="kobo.149.1">. </span><span class="koboSpan" id="kobo.149.2">One cool trick you can</span><a id="_idIndexMarker789"/><span class="koboSpan" id="kobo.150.1"> do is to place a </span><code class="inlineCode"><span class="koboSpan" id="kobo.151.1">sleep</span></code><span class="koboSpan" id="kobo.152.1"> command and a </span><code class="inlineCode"><span class="koboSpan" id="kobo.153.1">clear</span></code><span class="koboSpan" id="kobo.154.1"> command immediately after the </span><em class="italic"><span class="koboSpan" id="kobo.155.1">here document</span></em><span class="koboSpan" id="kobo.156.1">, so that the opening message will display for a specified number of seconds before the main part of the script begins to execute.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.157.1">Also, you’re not limited to using this type of </span><em class="italic"><span class="koboSpan" id="kobo.158.1">here document</span></em><span class="koboSpan" id="kobo.159.1"> at the beginning of the script. </span><span class="koboSpan" id="kobo.159.2">You can place one anywhere in the script where you might need to impart some sort of information to a user.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.160.1">Next, let’s create a simple look-up directory with a list of phone numbers. </span><span class="koboSpan" id="kobo.160.2">Here’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.161.1">here-doc2.sh</span></code><span class="koboSpan" id="kobo.162.1"> script that does that:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.163.1">#!/bin/bash
grep $1 &lt;&lt;directory
lionel          555-1234
maggie          555-2344
katelyn         555-4555
cleopatra       555-4818
vicky           555-1919
charlie         555-2020
frank           555-2190
goldie          555-8340       
directory
exit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.164.1">In this script, I’m passing a name as a positional parameter to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.165.1">grep</span></code><span class="koboSpan" id="kobo.166.1"> command. </span><span class="koboSpan" id="kobo.166.2">The phone directory entries are between the two </span><code class="inlineCode"><span class="koboSpan" id="kobo.167.1">directory</span></code><span class="koboSpan" id="kobo.168.1"> limit strings. </span><span class="koboSpan" id="kobo.168.2">Note that in this script, I didn’t </span><a id="_idIndexMarker790"/><span class="koboSpan" id="kobo.169.1">place a blank space between the </span><code class="inlineCode"><span class="koboSpan" id="kobo.170.1">&lt;&lt;</span></code><span class="koboSpan" id="kobo.171.1"> and the first limit string, as I did in the</span><a id="_idIndexMarker791"/><span class="koboSpan" id="kobo.172.1"> previous example. </span><span class="koboSpan" id="kobo.172.2">This just shows you that the blank space is optional, and that either way works. </span><span class="koboSpan" id="kobo.172.3">Anyway, here’s what happens when I look up Lionel’s phone number:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.173.1">[donnie@fedora ~]$ ./here-doc2.sh lionel
lionel		555-1234
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.174.1">If your </span><em class="italic"><span class="koboSpan" id="kobo.175.1">here document</span></em><span class="koboSpan" id="kobo.176.1"> includes any metacharacters that cause the shell to take some sort of action, you’ll need to escape them with a backslash, as you see here in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.177.1">here-doc3.sh</span></code><span class="koboSpan" id="kobo.178.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.179.1">#!/bin/bash
grep $1 &lt;&lt;donations
lionel             \$5.00
maggie             \$2.50
katelyn            \$10.00
cleopatra          \$7.35
vicky              \$20.00
charlie            \$3.00
frank              \$8.25
goldie             \$9.05
donations
exit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.180.1">Surrounding strings that contain special characters with quotes won’t work, because </span><em class="italic"><span class="koboSpan" id="kobo.181.1">here documents</span></em><span class="koboSpan" id="kobo.182.1"> treat all quote symbols as literal characters.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.183.1">This method of dealing with special characters works, but there’s an easier way. </span><span class="koboSpan" id="kobo.183.2">Just place a backslash in front of the limit string, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.184.1">#!/bin/bash
grep $1 &lt;&lt;\donations
lionel          $5.00
maggie          $2.50
katelyn         $10.00
cleopatra       $7.35
vicky           $20.00
charlie         $3.00
frank           $8.25
goldie          $9.05
donations
exit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.185.1">You can also surround the</span><a id="_idIndexMarker792"/><span class="koboSpan" id="kobo.186.1"> limit string with a pair of single quotes, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.187.1">#!/bin/bash
grep $1 &lt;&lt;'donations'
lionel          $5.00
maggie          $2.50
katelyn         $10.00
cleopatra       $7.35
vicky           $20.00
charlie         $3.00
frank           $8.25
goldie          $9.05
donations
exit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.188.1">Although these latter two</span><a id="_idIndexMarker793"/><span class="koboSpan" id="kobo.189.1"> methods work well and are easier than having to escape every special character individually, they can mess you up if you need to use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.190.1">$</span></code><span class="koboSpan" id="kobo.191.1"> to obtain the value of a variable. </span><span class="koboSpan" id="kobo.191.2">That’s because everything will get treated as a literal string, even if you don’t want that. </span><span class="koboSpan" id="kobo.191.3">To see how that works, let’s look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.192.1">here-doc3-wrong.sh</span></code><span class="koboSpan" id="kobo.193.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.194.1">#!/bin/bash
grep $1 &lt;&lt;\donations
lionel          $5.00
maggie          $2.50
katelyn         $10.00
cleopatra       $7.35
vicky           $20.00
charlie         $3.00
frank           $8.25
goldie          $9.05
$1
donations
exit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.195.1">You see that I’ve placed a backslash in front of the opening </span><code class="inlineCode"><span class="koboSpan" id="kobo.196.1">donations</span></code><span class="koboSpan" id="kobo.197.1"> limit string in order to escape all of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.198.1">$</span></code><span class="koboSpan" id="kobo.199.1"> metacharacters. </span><span class="koboSpan" id="kobo.199.2">I’ve also placed a </span><code class="inlineCode"><span class="koboSpan" id="kobo.200.1">$1</span></code><span class="koboSpan" id="kobo.201.1"> on a line by itself, just before the closing </span><code class="inlineCode"><span class="koboSpan" id="kobo.202.1">donations</span></code><span class="koboSpan" id="kobo.203.1"> limit string. </span><span class="koboSpan" id="kobo.203.2">What I want to happen is for the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.204.1">$1</span></code><span class="koboSpan" id="kobo.205.1"> positional parameter to print out at the end of the output. </span><span class="koboSpan" id="kobo.205.2">But, watch what happens when I run this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.206.1">donnie@fedora:~$ ./here-doc3-wrong.sh lionel
lionel		$5.00
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.207.1">Now, let’s remove the </span><a id="_idIndexMarker794"/><span class="koboSpan" id="kobo.208.1">backslash from in front of the opening</span><a id="_idIndexMarker795"/><span class="koboSpan" id="kobo.209.1"> limit string, and escape all of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.210.1">$</span></code><span class="koboSpan" id="kobo.211.1"> metacharacters individually, except for the one that’s in the positional parameter. </span><span class="koboSpan" id="kobo.211.2">This script should now look like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.212.1">#!/bin/bash
grep $1 &lt;&lt;donations
lionel          \$5.00
maggie          \$2.50
katelyn         \$10.00
cleopatra       \$7.35
vicky           \$20.00
charlie         \$3.00
frank           \$8.25
goldie          \$9.05
$1
donations
exit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.213.1">When I run the script now, the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.214.1">$1</span></code><span class="koboSpan" id="kobo.215.1"> at the bottom should print out, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.216.1">donnie@fedora:~$ ./here-doc3-wrong.sh lionel
lionel		$5.00
lionel
donnie@fedora:~$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.217.1">The lesson here is that</span><a id="_idIndexMarker796"/><span class="koboSpan" id="kobo.218.1"> even though some of our programming shortcuts can be very handy, it might </span><a id="_idIndexMarker797"/><span class="koboSpan" id="kobo.219.1">not always be appropriate to use them.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.220.1">That pretty much covers the static angle. </span><span class="koboSpan" id="kobo.220.2">Now, let’s get dynamic.</span></p>
    <h2 id="_idParaDest-281" class="heading 2"><span class="koboSpan" id="kobo.221.1">Creating here documents with Dynamic Data</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.222.1">In addition to including</span><a id="_idIndexMarker798"/><span class="koboSpan" id="kobo.223.1"> normal data in </span><em class="italic"><span class="koboSpan" id="kobo.224.1">here documents</span></em><span class="koboSpan" id="kobo.225.1">, you can also include the programming constructs and commands that you’d </span><a id="_idIndexMarker799"/><span class="koboSpan" id="kobo.226.1">use normally. </span><span class="koboSpan" id="kobo.226.2">Then, just redirect the output into a dynamically-generated document. </span><span class="koboSpan" id="kobo.226.3">Here’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.227.1">here-doc4.sh</span></code><span class="koboSpan" id="kobo.228.1"> script, which shows a simple example of redirecting output into a </span><code class="inlineCode"><span class="koboSpan" id="kobo.229.1">.html</span></code><span class="koboSpan" id="kobo.230.1"> file:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.231.1">#!/bin/bash
title="System Information for $HOSTNAME"
current_date=$(date +%F)
cat &lt;&lt;- _system-info_ &gt; sysinfo.html
&lt;title&gt;
$title
&lt;/title&gt;
&lt;body&gt;
$(uname -opr) &lt;br&gt;
Updated on:  $current_date
&lt;/body&gt;
_system-info_
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.232.1">To prove that it works, just open the resultant file in a web browser. </span><span class="koboSpan" id="kobo.232.2">The web page should look something like this:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.233.1"><img src="../Images/B21693_12_01.png" alt="B21693_12_1"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.234.1">Figure 12.1: The web page that was generated by the here-doc4.sh script</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.235.1">Of course, I’m keeping things</span><a id="_idIndexMarker800"/><span class="koboSpan" id="kobo.236.1"> simple here by creating a very simple document with only a few simple </span><a id="_idIndexMarker801"/><span class="koboSpan" id="kobo.237.1">HTML tags to format it. </span><span class="koboSpan" id="kobo.237.2">But, if you’re clever with HTML coding, you can make the document as fancy as you want.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.238.1">In case you’re wondering, HTML stands for </span><strong class="keyWord"><span class="koboSpan" id="kobo.239.1">Hypertext Markup Language</span></strong><span class="koboSpan" id="kobo.240.1">. </span><span class="koboSpan" id="kobo.240.2">Long ago, when the public Internet</span><a id="_idIndexMarker802"/><span class="koboSpan" id="kobo.241.1"> was brand new and I still had a full head of hair, the only way to create websites was to hand-code them in HTML. </span><span class="koboSpan" id="kobo.241.2">(Ah, yes. </span><span class="koboSpan" id="kobo.241.3">Those were the days.)</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.242.1">You can also create documents in other formats. </span><span class="koboSpan" id="kobo.242.2">For example, if you want to create a </span><code class="inlineCode"><span class="koboSpan" id="kobo.243.1">.pdf</span></code><span class="koboSpan" id="kobo.244.1"> document, there are a couple of ways to do that. </span><span class="koboSpan" id="kobo.244.2">The simplest way is to install the appropriate </span><code class="inlineCode"><span class="koboSpan" id="kobo.245.1">pandoc</span></code><span class="koboSpan" id="kobo.246.1"> packages from either your Linux or FreeBSD distro’s repository. </span><span class="koboSpan" id="kobo.246.2">(It’s also available for macOS, but you’ll need to download the installer package from the Pandoc website.) The slight catch with this is that you’ll also need to install a </span><strong class="keyWord"><span class="koboSpan" id="kobo.247.1">PDF engine</span></strong><span class="koboSpan" id="kobo.248.1">, and </span><a id="_idIndexMarker803"/><span class="koboSpan" id="kobo.249.1">some PDF engines aren’t available for all distros. </span><span class="koboSpan" id="kobo.249.2">Your</span><a id="_idIndexMarker804"/><span class="koboSpan" id="kobo.250.1"> best bet is to stick with the </span><strong class="keyWord"><span class="koboSpan" id="kobo.251.1">pdflatex engine</span></strong><span class="koboSpan" id="kobo.252.1">, because it’s available for pretty much all Linux distros, as </span><a id="_idIndexMarker805"/><span class="koboSpan" id="kobo.253.1">well as for FreeBSD and macOS. </span><span class="koboSpan" id="kobo.253.2">(Sadly, there are no </span><code class="inlineCode"><span class="koboSpan" id="kobo.254.1">pandoc</span></code><span class="koboSpan" id="kobo.255.1"> or PDF engine packages available </span><a id="_idIndexMarker806"/><span class="koboSpan" id="kobo.256.1">for OpenIndiana.) On your Fedora virtual machine, install </span><code class="inlineCode"><span class="koboSpan" id="kobo.257.1">pandoc</span></code><span class="koboSpan" id="kobo.258.1"> and the pdflatex engine with this simple command:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.259.1">[donnie@fedora ~]$ sudo dnf install pandoc-pdf
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.260.1">This same command will also install </span><code class="inlineCode"><span class="koboSpan" id="kobo.261.1">pandoc</span></code><span class="koboSpan" id="kobo.262.1"> on Red Hat Enterprise Linux-type distros, but you’ll first need to install the EPEL repository. </span><span class="koboSpan" id="kobo.262.2">On AlmaLinux and Rocky Linux, install EPEL like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.263.1">[donnie@rocky ~]$ sudo dnf install epel-release
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.264.1">On Debian or Ubuntu-type distros, just do:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.265.1">donnie@ubuntu2204:~$ sudo apt install pandoc texlive-latex-recommended
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.266.1">On FreeBSD do:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.267.1">donnie@freebsd-1:~ $ sudo pkg install hs-pandoc texlive-full
</span></code></pre>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.268.1">Note that for FreeBSD, I’m assuming that you’ve already installed the </span><code class="inlineCode"><span class="koboSpan" id="kobo.269.1">sudo</span></code><span class="koboSpan" id="kobo.270.1"> package, added yourself to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.271.1">wheel</span></code><span class="koboSpan" id="kobo.272.1"> group, and have configured </span><code class="inlineCode"><span class="koboSpan" id="kobo.273.1">visudo</span></code><span class="koboSpan" id="kobo.274.1">. </span><span class="koboSpan" id="kobo.274.2">If you haven’t, you can just log in as the root user for now, in order to perform the installation. </span><span class="koboSpan" id="kobo.274.3">Also, if you haven’t done so already, be sure to install the </span><code class="inlineCode"><span class="koboSpan" id="kobo.275.1">bash</span></code><span class="koboSpan" id="kobo.276.1"> package, and create a symbolic link to </span><code class="inlineCode"><span class="koboSpan" id="kobo.277.1">bash</span></code><span class="koboSpan" id="kobo.278.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.279.1">/bin/</span></code><span class="koboSpan" id="kobo.280.1"> directory, like this:</span></p>
      <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.281.1">donnie@freebsd-1:~ $ sudo ln -s /usr/local/bin/bash /bin/bash
</span></code></pre>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.282.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.283.1">here-doc</span></code><span class="koboSpan" id="kobo.284.1"> scripts that I’ve shown you so far will work on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.285.1">/bin/sh</span></code><span class="koboSpan" id="kobo.286.1"> shell that FreeBSD uses by default, but I’ll </span><a id="_idIndexMarker807"/><span class="koboSpan" id="kobo.287.1">soon be showing you a script that will require actual </span><code class="inlineCode"><span class="koboSpan" id="kobo.288.1">bash</span></code><span class="koboSpan" id="kobo.289.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.290.1">For macOS, you’ll need to </span><a id="_idIndexMarker808"/><span class="koboSpan" id="kobo.291.1">download the Pandoc and MacTeX installers from their respective websites.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.292.1">If you’re running OpenIndiana, you’re out of luck, because there are no </span><code class="inlineCode"><span class="koboSpan" id="kobo.293.1">pandoc</span></code><span class="koboSpan" id="kobo.294.1"> or pdf engine packages available for it. </span><span class="koboSpan" id="kobo.294.2">That’s okay though, because as you’ll see in a few moments, I’ve made the upcoming demo script so that it will still run on it.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.295.1">In any case, the installation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.296.1">pandoc</span></code><span class="koboSpan" id="kobo.297.1"> and the pdf engine packages takes a while, because a lot of dependencies also need to be installed. </span><span class="koboSpan" id="kobo.297.2">So, you might as well go grab your favorite beverage while you’re waiting.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.298.1">Once you have </span><code class="inlineCode"><span class="koboSpan" id="kobo.299.1">pandoc</span></code><span class="koboSpan" id="kobo.300.1"> installed, on everything except for OpenIndiana, add the following lines to the end of your </span><code class="inlineCode"><span class="koboSpan" id="kobo.301.1">here-doc4.sh</span></code><span class="koboSpan" id="kobo.302.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.303.1">pandoc -o sysinfo.pdf sysinfo.html
rm sysinfo.html
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.304.1">Now when you run the </span><code class="inlineCode"><span class="koboSpan" id="kobo.305.1">here-doc4.sh</span></code><span class="koboSpan" id="kobo.306.1"> script, you’ll end up with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.307.1">sysinfo.pdf</span></code><span class="koboSpan" id="kobo.308.1"> file as the result. </span><span class="koboSpan" id="kobo.308.2">You can either open the file in your favorite document viewer, or add a line of code to have the file automatically print out. </span><span class="koboSpan" id="kobo.308.3">Assuming that you’ve installed the appropriate printer drivers and have set a default printer, the command that you would add to the end of the script to do this would be:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.309.1">lpr sysinfo.pdf
</span></code></pre>
    <div class="packt_tip">
      <p class="normal"><span class="koboSpan" id="kobo.310.1">Tip</span></p>
      <p class="normal"><span class="koboSpan" id="kobo.311.1">I showed you how to set up a default printer and use </span><code class="inlineCode"><span class="koboSpan" id="kobo.312.1">lpr</span></code><span class="koboSpan" id="kobo.313.1"> in </span><em class="chapterRef"><span class="koboSpan" id="kobo.314.1">Chapter 7, Text Stream Filters - Part 2</span></em><span class="koboSpan" id="kobo.315.1">.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.316.1">The reason I’m using HTML in this </span><em class="italic"><span class="koboSpan" id="kobo.317.1">here document</span></em><span class="koboSpan" id="kobo.318.1"> example is simply because HTML is so easy. </span><span class="koboSpan" id="kobo.318.2">If you’re clever with any other document markup language, such as Postscript, Markdown, Troff or LaTeX, feel free to use one of them in place of HTML. </span><span class="koboSpan" id="kobo.318.3">In all cases, you can convert the resultant file to a </span><code class="inlineCode"><span class="koboSpan" id="kobo.319.1">.pdf</span></code><span class="koboSpan" id="kobo.320.1"> file, if that’s what you need. </span><span class="koboSpan" id="kobo.320.2">On the other hand, if you don’t need anything this fancy, you could omit all markup</span><a id="_idIndexMarker809"/><span class="koboSpan" id="kobo.321.1"> language tags, and just save your output to a plain-text file. </span><span class="koboSpan" id="kobo.321.2">Then, use the </span><a id="_idIndexMarker810"/><span class="koboSpan" id="kobo.322.1">appropriate text stream filters, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.323.1">fmt</span></code><span class="koboSpan" id="kobo.324.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.325.1">pr</span></code><span class="koboSpan" id="kobo.326.1">, to prepare the file for print out. </span><span class="koboSpan" id="kobo.326.2">The possibilities are only limited by your own imagination.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.327.1">Now that we’ve covered the basics, let’s look at something that’s a bit more complex.</span></p>
    <h2 id="_idParaDest-282" class="heading 2"><span class="koboSpan" id="kobo.328.1">Using Functions in here Documents</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.329.1">For this section, I created the </span><code class="inlineCode"><span class="koboSpan" id="kobo.330.1">sysinfo.lib</span></code><span class="koboSpan" id="kobo.331.1"> file, which you can download from Github. </span><span class="koboSpan" id="kobo.331.2">Then, copy it to your </span><code class="inlineCode"><span class="koboSpan" id="kobo.332.1">/usr/local/lib/</span></code><span class="koboSpan" id="kobo.333.1"> directory. </span><span class="koboSpan" id="kobo.333.2">Finally, download the </span><code class="inlineCode"><span class="koboSpan" id="kobo.334.1">system-info.sh</span></code><span class="koboSpan" id="kobo.335.1"> script from</span><a id="_idIndexMarker811"/><span class="koboSpan" id="kobo.336.1"> Github. </span><span class="koboSpan" id="kobo.336.2">I can’t show you either the library file or the shell script in their entirety here, but I can show you some </span><a id="_idIndexMarker812"/><span class="koboSpan" id="kobo.337.1">snippets and provide some explanation.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.338.1">In this demo, you’ll see what I had to do to make this script work on Linux, FreeBSD, macOS, and OpenIndiana.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.339.1">The first two functions in the library, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.340.1">show_uptime()</span></code><span class="koboSpan" id="kobo.341.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.342.1">drive_space()</span></code><span class="koboSpan" id="kobo.343.1"> functions, are quite easy. </span><span class="koboSpan" id="kobo.343.2">Each of them executes just one simple system information command and then adds some HTML tags, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.344.1">show_uptime() {
                echo "&lt;h2&gt;System uptime&lt;/h2&gt;"
                echo "&lt;pre&gt;"
                uptime
                echo "&lt;/pre&gt;"
        }
        drive_space() {
            echo "&lt;h2&gt;Filesystem space&lt;/h2&gt;"
            echo "&lt;pre&gt;"
            df -P
            echo "&lt;/pre&gt;"
        }
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.345.1">I used </span><code class="inlineCode"><span class="koboSpan" id="kobo.346.1">df -P</span></code><span class="koboSpan" id="kobo.347.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.348.1">drive_space()</span></code><span class="koboSpan" id="kobo.349.1"> function so that the output would format properly on macOS. </span><span class="koboSpan" id="kobo.349.2">(The </span><code class="inlineCode"><span class="koboSpan" id="kobo.350.1">-P</span></code><span class="koboSpan" id="kobo.351.1"> isn’t needed</span><a id="_idIndexMarker813"/><span class="koboSpan" id="kobo.352.1"> for Linux, FreeBSD, or OpenIndiana, but it doesn’t hurt anything</span><a id="_idIndexMarker814"/><span class="koboSpan" id="kobo.353.1"> to have it.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.354.1">Now, take a look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.355.1">home_space()</span></code><span class="koboSpan" id="kobo.356.1"> function:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.357.1">home_space() {
            echo "&lt;h2&gt;Home directory space by user&lt;/h2&gt;"
            echo "&lt;pre&gt;"
            echo "Bytes Directory"
            if [ $(uname) = SunOS ]; then
                    du -sh /export/home/* | sort -nr
            elif [ $(uname) = Darwin ]; then
                    du -sh /Users/* | sort -nr
            else
                    du -sh /home/* | sort -nr
            fi
            echo "&lt;/pre&gt;"
        }
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.358.1">This function uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.359.1">du</span></code><span class="koboSpan" id="kobo.360.1"> utility to report the amount of drive space that each user’s home directory is using. </span><span class="koboSpan" id="kobo.360.2">The slight problem is that OpenIndiana and macOS don’t have users’ home directories in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.361.1">/home/</span></code><span class="koboSpan" id="kobo.362.1"> directory, as Linux and FreeBSD do. </span><span class="koboSpan" id="kobo.362.2">So, I included code that would determine where </span><code class="inlineCode"><span class="koboSpan" id="kobo.363.1">du</span></code><span class="koboSpan" id="kobo.364.1"> is to look, as determined by the operating system.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.365.1">Next are the </span><code class="inlineCode"><span class="koboSpan" id="kobo.366.1">open_files()</span></code><span class="koboSpan" id="kobo.367.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.368.1">open_files_root()</span></code><span class="koboSpan" id="kobo.369.1"> functions, which report the number of files that the apache and root users have open. </span><span class="koboSpan" id="kobo.369.2">Both functions are the same except for the specified user, so I’ll just show you one of them here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.370.1">open_files_root() {
            echo "&lt;h2&gt;Number of open files for root&lt;/h2&gt;"
            echo "&lt;pre&gt;"
            lsof -u root | wc -l
            echo "&lt;/pre&gt;"
        }
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.371.1">You see that it’s very simple, and just pipes the </span><code class="inlineCode"><span class="koboSpan" id="kobo.372.1">lsof -u</span></code><span class="koboSpan" id="kobo.373.1"> output into </span><code class="inlineCode"><span class="koboSpan" id="kobo.374.1">wc -l</span></code><span class="koboSpan" id="kobo.375.1"> to count the number of open files for the specified user.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.376.1">The next function is </span><code class="inlineCode"><span class="koboSpan" id="kobo.377.1">open_files_users()</span></code><span class="koboSpan" id="kobo.378.1">, which is a bit more complex. </span><span class="koboSpan" id="kobo.378.2">I once again need to take</span><a id="_idIndexMarker815"/><span class="koboSpan" id="kobo.379.1"> the difference in home directory locations</span><a id="_idIndexMarker816"/><span class="koboSpan" id="kobo.380.1"> into account, which you see here in the first half of the function:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.381.1">open_files_users() {
            echo "&lt;h2&gt; Number of open files for normal users&lt;/h2&gt;"
            if [ $(uname) = SunOS ]; then
                 cd /export/home
            elif [ $(uname) = Darwin ]; then
                cd /Users
            else
                cd /home
            fi
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.382.1">The second half of the function is a </span><em class="italic"><span class="koboSpan" id="kobo.383.1">for</span></em><span class="koboSpan" id="kobo.384.1"> loop that reads the names of the users’ home directories, and then uses those names in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.385.1">lsof</span></code><span class="koboSpan" id="kobo.386.1"> commands. </span><span class="koboSpan" id="kobo.386.2">But, there’s another wrinkle here that we need to iron out. </span><span class="koboSpan" id="kobo.386.3">It’s that if your Linux machine has the </span><code class="inlineCode"><span class="koboSpan" id="kobo.387.1">/home/</span></code><span class="koboSpan" id="kobo.388.1"> directory mounted on its own partition, and the partition is formatted with either the </span><code class="inlineCode"><span class="koboSpan" id="kobo.389.1">ext3</span></code><span class="koboSpan" id="kobo.390.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.391.1">ext4</span></code><span class="koboSpan" id="kobo.392.1"> filesystem, there will be a </span><code class="inlineCode"><span class="koboSpan" id="kobo.393.1">lost+found</span></code><span class="koboSpan" id="kobo.394.1"> directory that’s not a user’s home directory. </span><span class="koboSpan" id="kobo.394.2">On macOS, you’ll see a </span><code class="inlineCode"><span class="koboSpan" id="kobo.395.1">Shared</span></code><span class="koboSpan" id="kobo.396.1"> directory that’s also not a user’s home directory. </span><span class="koboSpan" id="kobo.396.2">If you try to use either of these two directory names as an argument for </span><code class="inlineCode"><span class="koboSpan" id="kobo.397.1">lsof</span></code><span class="koboSpan" id="kobo.398.1">, you’ll receive an error. </span><span class="koboSpan" id="kobo.398.2">So, I had to add some code to exclude those two directory names from being used, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.399.1">for user in *
           do
           if [[ $user != "lost+found" ]] &amp;&amp; [[ $user != "Shared" ]]; then
                   echo "There are $(lsof -u $(id -u $user) | wc -l) open files for $user. </span><span class="koboSpan" id="kobo.399.2">"
                   echo "&lt;br&gt;"
           fi
           done
           cd
        }
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.400.1">You see that I’m using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.401.1">&amp;&amp;</span></code><span class="koboSpan" id="kobo.402.1"> sequence as an </span><code class="inlineCode"><span class="koboSpan" id="kobo.403.1">and</span></code><span class="koboSpan" id="kobo.404.1"> operator so that I can place both test conditions into just one </span><code class="inlineCode"><span class="koboSpan" id="kobo.405.1">if..then</span></code><span class="koboSpan" id="kobo.406.1"> construct. </span><span class="koboSpan" id="kobo.406.2">One reference that I found states that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.407.1">and</span></code><span class="koboSpan" id="kobo.408.1"> (</span><code class="inlineCode"><span class="koboSpan" id="kobo.409.1">&amp;&amp;</span></code><span class="koboSpan" id="kobo.410.1">) and </span><code class="inlineCode"><span class="koboSpan" id="kobo.411.1">or</span></code><span class="koboSpan" id="kobo.412.1"> (</span><code class="inlineCode"><span class="koboSpan" id="kobo.413.1">||</span></code><span class="koboSpan" id="kobo.414.1">) operators work better with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.415.1">[[..]]</span></code><span class="koboSpan" id="kobo.416.1"> test construct than they </span><a id="_idIndexMarker817"/><span class="koboSpan" id="kobo.417.1">do with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.418.1">[..]</span></code><span class="koboSpan" id="kobo.419.1"> test construct. </span><span class="koboSpan" id="kobo.419.2">However, I just tested the function both ways, and both work for me here. </span><span class="koboSpan" id="kobo.419.3">I’ve also shown you</span><a id="_idIndexMarker818"/><span class="koboSpan" id="kobo.420.1"> something that I don’t remember having shown you before. </span><span class="koboSpan" id="kobo.420.2">That is, you can nest one command substitution construct within another command substitution construct, as you see in the first </span><code class="inlineCode"><span class="koboSpan" id="kobo.421.1">echo</span></code><span class="koboSpan" id="kobo.422.1"> line.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.423.1">Finally, there’s the </span><code class="inlineCode"><span class="koboSpan" id="kobo.424.1">system_info()</span></code><span class="koboSpan" id="kobo.425.1"> function, which again will work differently on different operating systems. </span><span class="koboSpan" id="kobo.425.2">That’s because system information is in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.426.1">/etc/os-release</span></code><span class="koboSpan" id="kobo.427.1"> file on Linux and FreeBSD and in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.428.1">/etc/release</span></code><span class="koboSpan" id="kobo.429.1"> file on OpenIndiana. </span><span class="koboSpan" id="kobo.429.2">On macOS, there’s no kind of release file at all, so I had to use another method. </span><span class="koboSpan" id="kobo.429.3">Anyway, here’s the top portion of the function, which is for Linux and FreeBSD:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.430.1">system_info() {
           # Find any release files in /etc
           if [ -f /etc/os-release ]; then
                   os=$(grep "PRETTY_NAME" /etc/os-release)
                   echo "&lt;h2&gt;System release info&lt;/h2&gt;"
                   echo "&lt;pre&gt;"
                   echo "${os:12}"
                   echo "&lt;br&gt;"
                   uname -orp
                   echo "&lt;/pre&gt;"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.431.1">If the </span><code class="inlineCode"><span class="koboSpan" id="kobo.432.1">/etc/os-release</span></code><span class="koboSpan" id="kobo.433.1"> file is present, the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.434.1">os</span></code><span class="koboSpan" id="kobo.435.1"> variable will be the </span><code class="inlineCode"><span class="koboSpan" id="kobo.436.1">PRETTY_NAME</span></code><span class="koboSpan" id="kobo.437.1"> line from that file. </span><span class="koboSpan" id="kobo.437.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.438.1">echo "${os:12}"</span></code><span class="koboSpan" id="kobo.439.1"> line strips off the </span><code class="inlineCode"><span class="koboSpan" id="kobo.440.1">PRETTY_NAME</span></code><span class="koboSpan" id="kobo.441.1"> part, so that only the actual version name of the Linux or FreeBSD distro is left. </span><span class="koboSpan" id="kobo.441.2">I then used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.442.1">uname -orp</span></code><span class="koboSpan" id="kobo.443.1"> command to show the system information that I want everyone to see. </span><span class="koboSpan" id="kobo.443.2">(I’ll let you look in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.444.1">uname</span></code><span class="koboSpan" id="kobo.445.1"> man page to see what all of the option switches are doing.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.446.1">The next part of the function is for OpenIndiana, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.447.1">elif [ $(uname) = SunOS ]; then
                   echo "&lt;h2&gt;System release info&lt;/h2&gt;"
                   echo "&lt;pre&gt;"
                   head -1 /etc/release
                   echo "&lt;br&gt;"
                   uname -orp
                   echo "&lt;/pre&gt;"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.448.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.449.1">/etc/release</span></code><span class="koboSpan" id="kobo.450.1"> file on OpenIndiana isn’t the </span><a id="_idIndexMarker819"/><span class="koboSpan" id="kobo.451.1">same as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.452.1">/etc/os-release</span></code><span class="koboSpan" id="kobo.453.1"> file on Linux and FreeBSD. </span><span class="koboSpan" id="kobo.453.2">So, I used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.454.1">head -1</span></code><span class="koboSpan" id="kobo.455.1"> command to read the first line of the file, which contains</span><a id="_idIndexMarker820"/><span class="koboSpan" id="kobo.456.1"> the version name of the distro.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.457.1">The final portion of this function is for OS X/macOS, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.458.1">elif [ $(uname) = Darwin ]; then
                   echo "&lt;h2&gt;System release info&lt;/h2&gt;"
                   echo "&lt;pre&gt;"
                   sw_vers
                   echo "&lt;br&gt;"
                   uname -sprm
                   echo "&lt;/pre&gt;"
else
                   echo "Unknown operating system"
}
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.459.1">Since there’s no release file of any kind, I used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.460.1">sw_vers</span></code><span class="koboSpan" id="kobo.461.1"> command instead, which is only available on OS X and macOS. </span><span class="koboSpan" id="kobo.461.2">The output from this command looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.462.1">Donald-Tevaults-Mac-Pro:~ donnie$ sw_vers
ProductName:    Mac OS X
ProductVersion: 10.14.6
BuildVersion:   18G9323
Donald-Tevaults-Mac-Pro:~
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.463.1">And yes, that is a very old version of the Mac operating system. </span><span class="koboSpan" id="kobo.463.2">But, the machine is a mid-2010 model Mac Pro, and this is the newest version that it will run. </span><span class="koboSpan" id="kobo.463.3">(Well, it can run a more </span><a id="_idIndexMarker821"/><span class="koboSpan" id="kobo.464.1">recent version, but I’ll have to perform some unnatural acts that aren’t authorized by Apple in order to do it. </span><span class="koboSpan" id="kobo.464.2">This involves installing the OpenCore Legacy</span><a id="_idIndexMarker822"/><span class="koboSpan" id="kobo.465.1"> Patcher, which will modify the Mac’s bootloader so that you can install a newer version of macOS. </span><span class="koboSpan" id="kobo.465.2">Be aware though that things can go wrong with this, which could render your Mac unbootable. </span><span class="koboSpan" id="kobo.465.3">Trust me, I know.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.466.1">I also had to use a different combination of option switches for </span><code class="inlineCode"><span class="koboSpan" id="kobo.467.1">uname</span></code><span class="koboSpan" id="kobo.468.1">, because macOS uses a different implementation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.469.1">uname</span></code><span class="koboSpan" id="kobo.470.1">. </span><span class="koboSpan" id="kobo.470.2">(Again, look at the man page for </span><code class="inlineCode"><span class="koboSpan" id="kobo.471.1">uname</span></code><span class="koboSpan" id="kobo.472.1"> on your Mac machine to see what the option switches are doing.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.473.1">That’s it for the function library file. </span><span class="koboSpan" id="kobo.473.2">Now, we need to look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.474.1">system_info.sh</span></code><span class="koboSpan" id="kobo.475.1"> script that uses this library. </span><span class="koboSpan" id="kobo.475.2">Here’s the top part:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.476.1">#!/bin/bash
# sysinfo_page - A script to produce an HTML file
. </span><span class="koboSpan" id="kobo.476.2">/usr/local/lib/sysinfo.lib
title="System Information for $HOSTNAME"
right_now=$(date +"%x %r %Z")
time_stamp="Updated on $right_now by $USER"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.477.1">The shebang line, which we first talked about in </span><em class="chapterRef"><span class="koboSpan" id="kobo.478.1">Chapter 8, Basic Shell Script Construction</span></em><span class="koboSpan" id="kobo.479.1">, has to be </span><code class="inlineCode"><span class="koboSpan" id="kobo.480.1">#!/bin/bash</span></code><span class="koboSpan" id="kobo.481.1">, because some of the alternate shells that are referenced by </span><code class="inlineCode"><span class="koboSpan" id="kobo.482.1">#!/bin/sh</span></code><span class="koboSpan" id="kobo.483.1"> aren’t compatible with some of the programming constructs that I need to use. </span><span class="koboSpan" id="kobo.483.2">So, if you’re running this script on either Alpine Linux or FreeBSD, you’ll need to install </span><code class="inlineCode"><span class="koboSpan" id="kobo.484.1">bash</span></code><span class="koboSpan" id="kobo.485.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.486.1">The rest of this top portion just reads in the function library and sets up the variables that I’ll use in the rest of the script. </span><span class="koboSpan" id="kobo.486.2">So, there’s nothing hard there.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.487.1">The next portion consists of the </span><em class="italic"><span class="koboSpan" id="kobo.488.1">here document</span></em><span class="koboSpan" id="kobo.489.1">, which inserts the proper HTML tags and invokes several functions, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.490.1">cat &lt;&lt;- _system-info_ &gt; sysinfo.html
    &lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;
. </span><span class="koboSpan" id="kobo.490.2">. </span><span class="koboSpan" id="kobo.490.3">.
</span><span class="koboSpan" id="kobo.490.4">. </span><span class="koboSpan" id="kobo.490.5">. </span><span class="koboSpan" id="kobo.490.6">.
    </span><span class="koboSpan" id="kobo.490.7">$(home_space)
    $(open_files_root)
    $(open_files_users)
    &lt;/body&gt;
    &lt;/html&gt;
_system-info_
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.491.1">So again, there’s nothing hard here.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.492.1">The final portion of the</span><a id="_idIndexMarker823"/><span class="koboSpan" id="kobo.493.1"> script converts the </span><code class="inlineCode"><span class="koboSpan" id="kobo.494.1">.html</span></code><span class="koboSpan" id="kobo.495.1"> output file to a </span><code class="inlineCode"><span class="koboSpan" id="kobo.496.1">.pdf</span></code><span class="koboSpan" id="kobo.497.1"> file, if the </span><code class="inlineCode"><span class="koboSpan" id="kobo.498.1">pandoc</span></code><span class="koboSpan" id="kobo.499.1"> package is</span><a id="_idIndexMarker824"/><span class="koboSpan" id="kobo.500.1"> installed. </span><span class="koboSpan" id="kobo.500.2">If it’s not, then it will just leave the </span><code class="inlineCode"><span class="koboSpan" id="kobo.501.1">.html</span></code><span class="koboSpan" id="kobo.502.1"> file alone. </span><span class="koboSpan" id="kobo.502.2">Here’s how that looks:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.503.1">if [[ -f /usr/local/bin/pandoc ]] || [[ -f /usr/bin/pandoc ]]; then
        pandoc -o sysinfo.pdf sysinfo.html
        rm sysinfo.html
fi
exit
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.504.1">As much as I’d like to always have a </span><code class="inlineCode"><span class="koboSpan" id="kobo.505.1">.pdf</span></code><span class="koboSpan" id="kobo.506.1"> file, that’s not possible on OpenIndiana. </span><span class="koboSpan" id="kobo.506.2">As I’ve mentioned before, </span><code class="inlineCode"><span class="koboSpan" id="kobo.507.1">pandoc</span></code><span class="koboSpan" id="kobo.508.1"> isn’t in the OpenIndiana repository. </span><span class="koboSpan" id="kobo.508.2">The only other </span><code class="inlineCode"><span class="koboSpan" id="kobo.509.1">.pdf</span></code><span class="koboSpan" id="kobo.510.1"> creation tool I’ve seen for OpenIndiana is </span><code class="inlineCode"><span class="koboSpan" id="kobo.511.1">groff</span></code><span class="koboSpan" id="kobo.512.1">, but that involves using a whole different markup language.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.513.1">When you run this script, you’ll need to use your </span><code class="inlineCode"><span class="koboSpan" id="kobo.514.1">sudo</span></code><span class="koboSpan" id="kobo.515.1"> privileges in order to access information about other users. </span><span class="koboSpan" id="kobo.515.2">Also, don’t be alarmed if you get error messages about directories that the script can’t access, because that happens even with </span><code class="inlineCode"><span class="koboSpan" id="kobo.516.1">sudo</span></code><span class="koboSpan" id="kobo.517.1">. </span><span class="koboSpan" id="kobo.517.2">For example, here on my Fedora workstation, the script can’t access the </span><code class="inlineCode"><span class="koboSpan" id="kobo.518.1">pCloud</span></code><span class="koboSpan" id="kobo.519.1"> directory that’s in my home directory, because it’s a mount point for a remote drive.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.520.1">This is all I’ll say about </span><em class="italic"><span class="koboSpan" id="kobo.521.1">here documents</span></em><span class="koboSpan" id="kobo.522.1"> for now. </span><span class="koboSpan" id="kobo.522.2">But, in </span><em class="chapterRef"><span class="koboSpan" id="kobo.523.1">Chapter 20, Shell Script Portability</span></em><span class="koboSpan" id="kobo.524.1">, I’ll show you more </span><a id="_idIndexMarker825"/><span class="koboSpan" id="kobo.525.1">about them, and will also show you more ways to make scripts run across a</span><a id="_idIndexMarker826"/><span class="koboSpan" id="kobo.526.1"> variety of operating systems and shells. </span><span class="koboSpan" id="kobo.526.2">For now though, let’s look at what to expect next.</span></p>
    <h1 id="_idParaDest-283" class="heading 1"><span class="koboSpan" id="kobo.527.1">Automating Responses with expect</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.528.1">There may be times when you’ll need to run a script that stops multiple times to prompt you for some sort of input. </span><span class="koboSpan" id="kobo.528.2">That can get a bit tedious after a while, especially if you need to run</span><a id="_idIndexMarker827"/><span class="koboSpan" id="kobo.529.1"> the script multiple times on multiple servers or </span><a id="_idIndexMarker828"/><span class="koboSpan" id="kobo.530.1">workstations. </span><span class="koboSpan" id="kobo.530.2">Wouldn’t it be nice to automate the responses? </span><span class="koboSpan" id="kobo.530.3">Well, with all due respect, you can with </span><code class="inlineCode"><span class="koboSpan" id="kobo.531.1">expect</span></code><span class="koboSpan" id="kobo.532.1">.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.533.1">So, what is </span><code class="inlineCode"><span class="koboSpan" id="kobo.534.1">expect</span></code><span class="koboSpan" id="kobo.535.1">? </span><span class="koboSpan" id="kobo.535.2">Well, it’s a programming environment, similar to what you have with </span><code class="inlineCode"><span class="koboSpan" id="kobo.536.1">bash</span></code><span class="koboSpan" id="kobo.537.1">. </span><span class="koboSpan" id="kobo.537.2">If you have an interactive shell script that </span><em class="italic"><span class="koboSpan" id="kobo.538.1">expects</span></em><span class="koboSpan" id="kobo.539.1"> certain responses, you can use </span><code class="inlineCode"><span class="koboSpan" id="kobo.540.1">expect</span></code><span class="koboSpan" id="kobo.541.1"> to automatically send the correct responses. </span><span class="koboSpan" id="kobo.541.2">Let’s begin with the simplest of examples. </span><span class="koboSpan" id="kobo.541.3">First, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.542.1">interactive_script.sh</span></code><span class="koboSpan" id="kobo.543.1"> script, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.544.1">#!/bin/bash
echo "Hello. </span><span class="koboSpan" id="kobo.544.2">What is your name?"
</span><span class="koboSpan" id="kobo.544.3">read $reply
echo "What's your favorite operating system?"
</span><span class="koboSpan" id="kobo.544.4">read $reply
echo "How many cats to you have?"
</span><span class="koboSpan" id="kobo.544.5">read $reply
echo "How many dogs do you have?"
</span><span class="koboSpan" id="kobo.544.6">read $reply
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.545.1">When you run this script, it will pause at each </span><code class="inlineCode"><span class="koboSpan" id="kobo.546.1">read $reply</span></code><span class="koboSpan" id="kobo.547.1"> command so that you can type in a response. </span><span class="koboSpan" id="kobo.547.2">Of course, that’s not a big deal for this simple script. </span><span class="koboSpan" id="kobo.547.3">But now, pretend that you’ve written some sort of software testing script that’s long and complex, and that requires the software tester to constantly enter responses. </span><span class="koboSpan" id="kobo.547.4">Unless you enjoy pain, and I doubt that you do, you probably don’t want to be glued to your workstation, constantly entering responses for those long tests. </span><span class="koboSpan" id="kobo.547.5">So, your best bet is to automate the process, and your best bet for that is to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.548.1">expect</span></code><span class="koboSpan" id="kobo.549.1">. </span><span class="koboSpan" id="kobo.549.2">You should find it already</span><a id="_idIndexMarker829"/><span class="koboSpan" id="kobo.550.1"> installed on a Mac, but for everything else you’ll have to install it </span><a id="_idIndexMarker830"/><span class="koboSpan" id="kobo.551.1">yourself.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.552.1">Verify whether it’s installed by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.553.1">which expect
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.554.1">If it’s not installed, it should be in your distro’s repository as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.555.1">expect</span></code><span class="koboSpan" id="kobo.556.1"> package. </span><span class="koboSpan" id="kobo.556.2">On FreeBSD, you’ll need to take the additional step of creating a symbolic link, so that you won’t have to modify your scripts to run on FreeBSD. </span><span class="koboSpan" id="kobo.556.3">Do it like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.557.1">donnie@freebsd-1:~ $ sudo ln -s /usr/local/bin/expect /bin/expect
donnie@freebsd-1:~ $
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.558.1">Now that it’s installed, create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.559.1">interactive_script.exp</span></code><span class="koboSpan" id="kobo.560.1"> companion script. </span><span class="koboSpan" id="kobo.560.2">The easiest way to do that is to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.561.1">autoexpect</span></code><span class="koboSpan" id="kobo.562.1">, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.563.1">[donnie@fedora ~]$ autoexpect -f interactive_script.exp ./interactive_script.sh
autoexpect started, file is script.exp
Hello. </span><span class="koboSpan" id="kobo.563.2">What is your name?
</span><span class="koboSpan" id="kobo.563.3">Donnie
What's your favorite operating system?
</span><span class="koboSpan" id="kobo.563.4">Linux
How many cats do you have?
</span><span class="koboSpan" id="kobo.563.5">1
How many dogs do you have?
</span><span class="koboSpan" id="kobo.563.6">0
autoexpect done, file is script.exp
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.564.1">As you see, </span><code class="inlineCode"><span class="koboSpan" id="kobo.565.1">autoexpect</span></code><span class="koboSpan" id="kobo.566.1"> runs the original </span><code class="inlineCode"><span class="koboSpan" id="kobo.567.1">interactive_script.sh</span></code><span class="koboSpan" id="kobo.568.1"> script, and prompts you for responses. </span><span class="koboSpan" id="kobo.568.2">The responses get saved to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.569.1">interactive_script.exp</span></code><span class="koboSpan" id="kobo.570.1"> script that you specified with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.571.1">-f</span></code><span class="koboSpan" id="kobo.572.1"> option. </span><span class="koboSpan" id="kobo.572.2">Note that if the original script is in your home directory, you’ll need to precede its name with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.573.1">./</span></code><span class="koboSpan" id="kobo.574.1"> so that </span><code class="inlineCode"><span class="koboSpan" id="kobo.575.1">autoexpect</span></code><span class="koboSpan" id="kobo.576.1"> can find it. </span><span class="koboSpan" id="kobo.576.2">The entire </span><code class="inlineCode"><span class="koboSpan" id="kobo.577.1">interactive_script.exp</span></code><span class="koboSpan" id="kobo.578.1"> script is too long to show, so I’ll show you some snippets, along with some explanation.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.579.1">The first thing to note is</span><a id="_idIndexMarker831"/><span class="koboSpan" id="kobo.580.1"> that expect scripts have their own shebang line, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.581.1">#!/bin/expect -f
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.582.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.583.1">-f</span></code><span class="koboSpan" id="kobo.584.1"> means that responses will be read from this file.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.585.1">The next thing I want to show you is the spawn command, which looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.586.1">spawn ./interactive_script.sh
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.587.1">When I run the </span><code class="inlineCode"><span class="koboSpan" id="kobo.588.1">expect</span></code><span class="koboSpan" id="kobo.589.1"> script, it will automatically start the original shell script.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.590.1">Next, let’s look at how </span><a id="_idIndexMarker832"/><span class="koboSpan" id="kobo.591.1">the expect script provides responses:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.592.1">expect -exact "Hello. </span><span class="koboSpan" id="kobo.592.2">What is your name?\r
"
send -- "Donnie\r"
expect -exact "Donnie\r
What's your favorite operating system?\r
"
send -- "Linux\r"
expect -exact "Linux\r
How many cats to you have?\r
"
send -- "1\r"
expect -exact "1\r
How many dogs do you have?\r
"
send -- "0\r"
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.593.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.594.1">expect</span></code><span class="koboSpan" id="kobo.595.1"> commands duplicate the questions from the original shell script. </span><span class="koboSpan" id="kobo.595.2">By including the </span><code class="inlineCode"><span class="koboSpan" id="kobo.596.1">-exact</span></code><span class="koboSpan" id="kobo.597.1"> option, the questions must be identical to the originals. </span><span class="koboSpan" id="kobo.597.2">The first </span><code class="inlineCode"><span class="koboSpan" id="kobo.598.1">expect</span></code><span class="koboSpan" id="kobo.599.1"> command only asks for my name, and all of the others both send back the response and then pull in the next question. </span><span class="koboSpan" id="kobo.599.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.600.1">\r</span></code><span class="koboSpan" id="kobo.601.1"> at the end of each line provides a carriage return, so that the next response or question will show on a new line. </span><span class="koboSpan" id="kobo.601.2">(Note that this isn’t the Windows-type of carriage return that can cause so much trouble in text files or configuration files.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.602.1">The very last line of the </span><a id="_idIndexMarker833"/><span class="koboSpan" id="kobo.603.1">expect script looks like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.604.1">expect eof
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.605.1">As you might expect, this indicates the End of File.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.606.1">Another cool thing </span><a id="_idIndexMarker834"/><span class="koboSpan" id="kobo.607.1">about </span><code class="inlineCode"><span class="koboSpan" id="kobo.608.1">autoexpect</span></code><span class="koboSpan" id="kobo.609.1"> is that it automatically sets the executable permission on the script files that it generates. </span><span class="koboSpan" id="kobo.609.2">So, you won’t have to do that yourself. </span><span class="koboSpan" id="kobo.609.3">Now, here’s what happens when I run this </span><code class="inlineCode"><span class="koboSpan" id="kobo.610.1">expect</span></code><span class="koboSpan" id="kobo.611.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.612.1">[donnie@fedora ~]$ ./interactive_script.exp
spawn ./interactive_script.sh
Hello. </span><span class="koboSpan" id="kobo.612.2">What is your name?
</span><span class="koboSpan" id="kobo.612.3">Donnie
What's your favorite operating system?
</span><span class="koboSpan" id="kobo.612.4">Linux
How many cats to you have?
</span><span class="koboSpan" id="kobo.612.5">1
How many dogs do you have?
</span><span class="koboSpan" id="kobo.612.6">0
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.613.1">All of the questions got answered automatically, without me having to interact with the script at all.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.614.1">Now, as cool as </span><code class="inlineCode"><span class="koboSpan" id="kobo.615.1">autoexpect</span></code><span class="koboSpan" id="kobo.616.1"> is, there are some drawbacks. </span><span class="koboSpan" id="kobo.616.2">First, it only comes with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.617.1">expect</span></code><span class="koboSpan" id="kobo.618.1"> packages that are in the repositories for the various Linux distros. </span><span class="koboSpan" id="kobo.618.2">For some strange reason, it’s not available for FreeBSD, OpenIndiana, or macOS. </span><span class="koboSpan" id="kobo.618.3">So, if you ever need to create an </span><code class="inlineCode"><span class="koboSpan" id="kobo.619.1">expect</span></code><span class="koboSpan" id="kobo.620.1"> script for any of those operating systems, your best bet is to create it on a Linux machine, and then transfer it over to the non-Linux machine. </span><span class="koboSpan" id="kobo.620.2">Secondly, if you use it with a software installation script that uses </span><code class="inlineCode"><span class="koboSpan" id="kobo.621.1">curl</span></code><span class="koboSpan" id="kobo.622.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.623.1">wget</span></code><span class="koboSpan" id="kobo.624.1"> to download the software, the output from </span><code class="inlineCode"><span class="koboSpan" id="kobo.625.1">curl</span></code><span class="koboSpan" id="kobo.626.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.627.1">wget</span></code><span class="koboSpan" id="kobo.628.1"> that shows the status of the download will become part of the expect script. </span><span class="koboSpan" id="kobo.628.2">You’ll need to remove all of that from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.629.1">expect</span></code><span class="koboSpan" id="kobo.630.1"> script by hand so that the script will work correctly. </span><span class="koboSpan" id="kobo.630.2">And </span><a id="_idIndexMarker835"/><span class="koboSpan" id="kobo.631.1">lastly, you can’t expect </span><code class="inlineCode"><span class="koboSpan" id="kobo.632.1">autoexpect</span></code><span class="koboSpan" id="kobo.633.1"> to do everything. </span><span class="koboSpan" id="kobo.633.2">Sometimes, you’ll just </span><a id="_idIndexMarker836"/><span class="koboSpan" id="kobo.634.1">need to hand-code the </span><code class="inlineCode"><span class="koboSpan" id="kobo.635.1">expect</span></code><span class="koboSpan" id="kobo.636.1"> scripts yourself.</span></p>
    <h2 id="_idParaDest-284" class="heading 2"><span class="koboSpan" id="kobo.637.1">Security Implications with expect</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.638.1">There are lots of ways to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.639.1">expect</span></code><span class="koboSpan" id="kobo.640.1">, but in my own opinion, it’s most useful for the automation of</span><a id="_idIndexMarker837"/><span class="koboSpan" id="kobo.641.1"> software testing or installation. </span><span class="koboSpan" id="kobo.641.2">Most other tutorials you’ll find show you how to automate either </span><code class="inlineCode"><span class="koboSpan" id="kobo.642.1">ssh</span></code><span class="koboSpan" id="kobo.643.1"> login sessions or </span><code class="inlineCode"><span class="koboSpan" id="kobo.644.1">scp</span></code><span class="koboSpan" id="kobo.645.1"> file transfers, but you need to be careful if you use </span><code class="inlineCode"><span class="koboSpan" id="kobo.646.1">expect</span></code><span class="koboSpan" id="kobo.647.1"> for anything like that. </span><span class="koboSpan" id="kobo.647.2">The problem is that the password of the destination machine will get stored in plain-text format in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.648.1">expect</span></code><span class="koboSpan" id="kobo.649.1"> script, which is also plain text. </span><span class="koboSpan" id="kobo.649.2">Making things even worse, is that some of these tutorials have you access the root user account of the destination machine like this. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.650.1">Now, my own general rule is to never enable the root user account when setting up a server, as long as the operating system installer gives me that choice. </span><span class="koboSpan" id="kobo.650.2">When setting up something like FreeBSD, where that isn’t a choice, I like to install and configure </span><code class="inlineCode"><span class="koboSpan" id="kobo.651.1">sudo</span></code><span class="koboSpan" id="kobo.652.1"> as my first post-installation step, and then disable the root account. </span><span class="koboSpan" id="kobo.652.2">However, there are times when it’s necessary to enable the root user account, as well as to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.653.1">scp</span></code><span class="koboSpan" id="kobo.654.1"> to transfer files to the root user’s account. </span><span class="koboSpan" id="kobo.654.2">If that is ever necessary, it’s more secure to disable password authentication on the server, and instead use key-based authentication.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.655.1">Even then, I only feel comfortable accessing the root user account from within a tightly-controlled local network, rather than from across the Internet. </span><span class="koboSpan" id="kobo.655.2">Having said all this, if you still ever find it necessary to store plain-text </span><code class="inlineCode"><span class="koboSpan" id="kobo.656.1">ssh</span></code><span class="koboSpan" id="kobo.657.1"> passwords in an expect script, be sure to store the script in a location that only you or trusted members of your team can access. </span><span class="koboSpan" id="kobo.657.2">(But hopefully though, you’ll find another way to do things that won’t require placing passwords into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.658.1">expect</span></code><span class="koboSpan" id="kobo.659.1"> scripts.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.660.1">The only other thing I’ll say about </span><code class="inlineCode"><span class="koboSpan" id="kobo.661.1">expect</span></code><span class="koboSpan" id="kobo.662.1"> is that it is a vast topic, and at least one entire book has been written about it. </span><span class="koboSpan" id="kobo.662.2">(I’ll leave a link for it in the </span><em class="chapterRef"><span class="koboSpan" id="kobo.663.1">Further Reading</span></em><span class="koboSpan" id="kobo.664.1"> section for anyone</span><a id="_idIndexMarker838"/><span class="koboSpan" id="kobo.665.1"> who might be interested.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.666.1">Okay, let’s wrap this chapter up and move on.</span></p>
    <h1 id="_idParaDest-285" class="heading 1"><span class="koboSpan" id="kobo.667.1">Summary</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.668.1">In this chapter, I’ve shown you some cool tricks to help automate your scripts. </span><span class="koboSpan" id="kobo.668.2">I first showed you </span><em class="italic"><span class="koboSpan" id="kobo.669.1">here documents</span></em><span class="koboSpan" id="kobo.670.1">, and how to use them in a few different ways. </span><span class="koboSpan" id="kobo.670.2">Then, I showed you expect, which is a whole scripting language unto itself. </span><span class="koboSpan" id="kobo.670.3">I showed you some ways to use expect, and then talked about some of its security implications.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.671.1">In the next chapter, I’ll show you some scripting tricks for ImageMagick. </span><span class="koboSpan" id="kobo.671.2">I’ll see you there.</span></p>
    <h1 id="_idParaDest-286" class="heading 1"><span class="koboSpan" id="kobo.672.1">Questions</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.673.1">What is a here document?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.674.1">It shows your current location.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.675.1">It’s a block of code for a specific purpose.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.676.1">It’s a type of executable script.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.677.1">It’s a block of static data.</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.678.1">Which of the following statements is true?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.679.1">A here document uses its own scripting language.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.680.1">A here document can only be used in bash scripts.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.681.1">A here document can be used with a variety of programming and scripting languages.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.682.1">A here document can only be used to display comments or other static data.</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.683.1">How do you define a here document?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.684.1">Place </span><code class="inlineCode"><span class="koboSpan" id="kobo.685.1">#!/</span></code><span class="koboSpan" id="kobo.686.1">bin/here in the script as the shebang line.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.687.1">Surround the entire here document with a pair of double quotes.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.688.1">Surround the entire here document with a pair of single quote.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.689.1">Surround the entire </span><em class="italic"><span class="koboSpan" id="kobo.690.1">here document</span></em><span class="koboSpan" id="kobo.691.1"> with a pair of limit strings.</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.692.1">Which of the following statements is true?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.693.1">You can use </span><code class="inlineCode"><span class="koboSpan" id="kobo.694.1">autoexpect</span></code><span class="koboSpan" id="kobo.695.1"> for any situation, and then use the resultant </span><code class="inlineCode"><span class="koboSpan" id="kobo.696.1">expect</span></code><span class="koboSpan" id="kobo.697.1"> scripts without any editing.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.698.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.699.1">expect</span></code><span class="koboSpan" id="kobo.700.1"> scripts that </span><code class="inlineCode"><span class="koboSpan" id="kobo.701.1">autoexpect</span></code><span class="koboSpan" id="kobo.702.1"> creates might need to be hand-edited to make them work correctly.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.703.1">You can use </span><code class="inlineCode"><span class="koboSpan" id="kobo.704.1">autoexpect</span></code><span class="koboSpan" id="kobo.705.1"> on any operating system, including Linux, FreeBSD, macOS, and OpenIndiana.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.706.1">You should never use </span><code class="inlineCode"><span class="koboSpan" id="kobo.707.1">autoexpect</span></code><span class="koboSpan" id="kobo.708.1"> for anything.</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.709.1">What is one implication of using </span><code class="inlineCode"><span class="koboSpan" id="kobo.710.1">expect</span></code><span class="koboSpan" id="kobo.711.1">?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.712.1">When using </span><code class="inlineCode"><span class="koboSpan" id="kobo.713.1">expect</span></code><span class="koboSpan" id="kobo.714.1"> to automate </span><code class="inlineCode"><span class="koboSpan" id="kobo.715.1">ssh</span></code><span class="koboSpan" id="kobo.716.1"> logins or </span><code class="inlineCode"><span class="koboSpan" id="kobo.717.1">scp</span></code><span class="koboSpan" id="kobo.718.1"> transfers, the password for the destination server will be stored in plain-text within the </span><code class="inlineCode"><span class="koboSpan" id="kobo.719.1">expect</span></code><span class="koboSpan" id="kobo.720.1"> script.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.721.1">There are no implications.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.722.1">It’s not very efficient.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.723.1">It’s too hard to create an expect script.</span></li>
        </ol>
      </li>
    </ol>
    <h1 id="_idParaDest-287" class="heading 1"><span class="koboSpan" id="kobo.724.1">Further Reading</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.725.1">How to Use “Here Documents” in Bash on Linux: </span><a href="https://www.howtogeek.com/719058/how-to-use-here-documents-in-bash-on-linux/"><span class="url"><span class="koboSpan" id="kobo.726.1">https://www.howtogeek.com/719058/how-to-use-here-documents-in-bash-on-linux/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.727.1">How to Create TXT Template Scripts in BASH: </span><a href="https://www.maketecheasier.com/create-txt-template-scripts-bash/"><span class="url"><span class="koboSpan" id="kobo.728.1">https://www.maketecheasier.com/create-txt-template-scripts-bash/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.729.1">Here Documents: </span><a href="https://tldp.org/LDP/abs/html/here-docs.html"><span class="url"><span class="koboSpan" id="kobo.730.1">https://tldp.org/LDP/abs/html/here-docs.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.731.1">How to Use Heredoc in Shell Scripting: </span><a href="https://www.tecmint.com/use-heredoc-in-shell-scripting/"><span class="url"><span class="koboSpan" id="kobo.732.1">https://www.tecmint.com/use-heredoc-in-shell-scripting/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.733.1">Writing Shell Scripts-Lesson 3: Here scripts: </span><a href="http://linuxcommand.org/lc3_wss0030.php"><span class="url"><span class="koboSpan" id="kobo.734.1">http://linuxcommand.org/lc3_wss0030.php</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.735.1">How to Use Here Document (heredoc) in Linux Shell Script: </span><a href="https://linuxtldr.com/heredoc/"><span class="url"><span class="koboSpan" id="kobo.736.1">https://linuxtldr.com/heredoc/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.737.1">Linux expect Command with Examples: </span><a href="https://phoenixnap.com/kb/linux-expect"><span class="url"><span class="koboSpan" id="kobo.738.1">https://phoenixnap.com/kb/linux-expect</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.739.1">Automate Input to Linux Scripts with the expect Command: </span><a href="https://www.howtogeek.com/devops/automate-inputs-to-linux-scripts-with-the-expect-command/"><span class="url"><span class="koboSpan" id="kobo.740.1">https://www.howtogeek.com/devops/automate-inputs-to-linux-scripts-with-the-expect-command/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.741.1">Expect Command in Linux with Examples: </span><a href="https://www.geeksforgeeks.org/expect-command-in-linux-with-examples/"><span class="url"><span class="koboSpan" id="kobo.742.1">https://www.geeksforgeeks.org/expect-command-in-linux-with-examples/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.743.1">Expect Command and How to Automate Shell Scripts like Magic: </span><a href="https://likegeeks.com/expect-command/"><span class="url"><span class="koboSpan" id="kobo.744.1">https://likegeeks.com/expect-command/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.745.1">Automating Responses to Scripts on Linux Using expect and autoexpect: </span><a href="https://www.networkworld.com/article/969513/automating-responses-to-scripts-on-linux-using-expect-and-autoexpect.html"><span class="url"><span class="koboSpan" id="kobo.746.1">https://www.networkworld.com/article/969513/automating-responses-to-scripts-on-linux-using-expect-and-autoexpect.html</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.747.1">Exploring Expect: </span><a href="https://amzn.to/3MSNqAV"><span class="url"><span class="koboSpan" id="kobo.748.1">https://amzn.to/3MSNqAV</span></span></a></li>
    </ul>
    <h1 id="_idParaDest-288" class="heading 1"><span class="koboSpan" id="kobo.749.1">Answers</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.750.1">b</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.751.1">c</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.752.1">d</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.753.1">b</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.754.1">a</span></li>
    </ol>
    <h1 id="_idParaDest-289" class="heading 1"><span class="koboSpan" id="kobo.755.1">Join our community on Discord!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.756.1">Read this book alongside other users, Linux experts, and the author himself. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.757.1">Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. </span><span class="koboSpan" id="kobo.757.2">Scan the QR code or visit the link to join the community.</span></p>
    <p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.758.1">https://packt.link/SecNet</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.759.1"><img src="../Images/QR_Code10596186092701843.png" alt=""/></span></p>
  </div>
</body></html>