<html><head></head><body>
<div id="_idContainer148">
<h1 class="chapter-number" id="_idParaDest-117"><a id="_idTextAnchor135"/><span class="koboSpan" id="kobo.1.1">5</span></h1>
<h1 id="_idParaDest-118"><a id="_idTextAnchor136"/><span class="koboSpan" id="kobo.2.1">Software Management with DNF</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Without packages, a fresh Linux installation is about as useful as a car with no tires! </span><span class="koboSpan" id="kobo.3.2">You need to be able to add software to the system to make it useful. </span><span class="koboSpan" id="kobo.3.3">This can be done in several ways. </span><span class="koboSpan" id="kobo.3.4">Back in the old days (hey, I am a true gray-bearded Unix/Linux guy), you used to download the source files and then build and install them manually. </span><span class="koboSpan" id="kobo.3.5">On occasion, you could get prebuilt packages but, often, the dependencies that were required would take hours to run down manually. </span><span class="koboSpan" id="kobo.3.6">Then, in 1997, along came </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Red Hat Package Manager</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.6.1">RPM</span></strong><span class="koboSpan" id="kobo.7.1">) files. </span><span class="koboSpan" id="kobo.7.2">These</span><a id="_idIndexMarker367"/><span class="koboSpan" id="kobo.8.1"> really simplified the process, as all you needed to do was track down all the RPM files needed to install an application, and off </span><span class="No-Break"><span class="koboSpan" id="kobo.9.1">you went.</span></span></p>
<p><span class="koboSpan" id="kobo.10.1">Then, the applications started getting more complex; an example is the Apache HTTP server – all of its optional features went from 2-3 RPMs to a dozen, plus all the required dependencies. </span><span class="koboSpan" id="kobo.10.2">Tracking down all the RPMs and their dependencies became a chore… and due to mismatched versions, chaos</span><a id="_idIndexMarker368"/><span class="koboSpan" id="kobo.11.1"> quickly took control. </span><span class="koboSpan" id="kobo.11.2">This came to a screeching halt when </span><strong class="bold"><span class="koboSpan" id="kobo.12.1">Yellowdog Updater, Modified</span></strong><span class="koboSpan" id="kobo.13.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.14.1">YUM</span></strong><span class="koboSpan" id="kobo.15.1">) was released in 2003. </span><span class="koboSpan" id="kobo.15.2">Now you could have a centralized location for all of the RPMs, with an easy way to install and patch the packages and all of the dependencies. </span><strong class="bold"><span class="koboSpan" id="kobo.16.1">Red Hat Enterprise Linux</span></strong><span class="koboSpan" id="kobo.17.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.18.1">RHEL</span></strong><span class="koboSpan" id="kobo.19.1">) moved to</span><a id="_idIndexMarker369"/><span class="koboSpan" id="kobo.20.1"> YUM, and life </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">was goo</span><a id="_idTextAnchor137"/><span class="koboSpan" id="kobo.22.1">d.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.23.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.24.1">YUM </span><a id="_idIndexMarker370"/><span class="koboSpan" id="kobo.25.1">replaced </span><strong class="bold"><span class="koboSpan" id="kobo.26.1">Yellowdog Update Program</span></strong><span class="koboSpan" id="kobo.27.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.28.1">YUP</span></strong><span class="koboSpan" id="kobo.29.1">), which was the original tool used by Yellowdog Linux for the installer. </span><span class="koboSpan" id="kobo.29.2">Yellowdog Linux was a Linux distribution built for the POWER7 CPU used on the PlayStation 3 and IBM systems and was CentOS/RHEL based. </span><span class="koboSpan" id="kobo.29.3">While it died in 2012, it lives on </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">with YUM.</span></span></p>
<p><span class="koboSpan" id="kobo.31.1">Linux distributions (such as RHEL and Oracle Linux) maintained YUM servers specific to their distribution online, but what if you could build your own RPM packages and maintain your own RPM repositories? </span><span class="koboSpan" id="kobo.31.2">What if these custom RPMs could be used to deploy internally built applications, and also make the required configuration changes so they run as expected? </span><span class="koboSpan" id="kobo.31.3">This chapter covers the management of RPM files, from moving from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.32.1">yum</span></strong><span class="koboSpan" id="kobo.33.1"> command to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.34.1">dnf</span></strong><span class="koboSpan" id="kobo.35.1"> command to managing RPMs, creating private RPM repositories, and making </span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">new RPMs.</span></span></p>
<p><span class="koboSpan" id="kobo.37.1">This chapter contains the </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">following recipes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.39.1">What have they done to YUM, moving </span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">to DNF?</span></span></li>
<li><span class="koboSpan" id="kobo.41.1">Using the DNF </span><span class="No-Break"><span class="koboSpan" id="kobo.42.1">time machine</span></span></li>
<li><span class="koboSpan" id="kobo.43.1">Building a DNF/YUM mirror </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">from ULN</span></span></li>
<li><span class="koboSpan" id="kobo.45.1">Creating a new </span><span class="No-Break"><span class="koboSpan" id="kobo.46.1">RPM package</span></span></li>
</ul>
<h1 id="_idParaDest-119"><a id="_idTextAnchor138"/><span class="koboSpan" id="kobo.47.1">What have they done to YUM, moving to DNF?</span></h1>
<p><span class="koboSpan" id="kobo.48.1">YUM was </span><a id="_idIndexMarker371"/><span class="koboSpan" id="kobo.49.1">good – it worked and it allowed admins to easily install and patch software. </span><span class="koboSpan" id="kobo.49.2">You could even use it to roll back a bad installation. </span><span class="koboSpan" id="kobo.49.3">So, what happened to it? </span><span class="koboSpan" id="kobo.49.4">Why was DNF released? </span><span class="koboSpan" id="kobo.49.5">What is DNF and how hard will it be to learn a </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">new tool?</span></span></p>
<p><span class="koboSpan" id="kobo.51.1">First, </span><strong class="bold"><span class="koboSpan" id="kobo.52.1">DNF</span></strong><span class="koboSpan" id="kobo.53.1"> stands</span><a id="_idIndexMarker372"/><span class="koboSpan" id="kobo.54.1"> for </span><strong class="bold"><span class="koboSpan" id="kobo.55.1">Dandified YUM</span></strong><span class="koboSpan" id="kobo.56.1"> and is a rewrite of the YUM software. </span><span class="koboSpan" id="kobo.56.2">It was released in 2013 in Fedora 18 and was built to address many issues that YUM was starting </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">to face.</span></span></p>
<p><span class="koboSpan" id="kobo.58.1">The two most common problems with YUM were performance and </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">RAM usage:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.60.1">Poor performance</span></strong><span class="koboSpan" id="kobo.61.1">: YUM </span><a id="_idIndexMarker373"/><span class="koboSpan" id="kobo.62.1">had performance issues. </span><span class="koboSpan" id="kobo.62.2">A lot of this was caused by dependency resolution, the process in which all the packages and their dependencies are put together. </span><span class="koboSpan" id="kobo.62.3">This process could take as long as 10 minutes. </span><span class="koboSpan" id="kobo.62.4">DNF moved to libsolv, which significantly decreased the time to resolve complex dependencies. </span><span class="koboSpan" id="kobo.62.5">This is now more common that ever, with some applications requiring </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">30+ RPMs.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.64.1">High RAM usage</span></strong><span class="koboSpan" id="kobo.65.1">: YUM uses a lot of RAM; this really started to become an issue with RHEL/CentOS 7, with smaller servers often running out of RAM </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">while updating.</span></span></li>
</ul>
<h2 id="_idParaDest-120"><a id="_idTextAnchor139"/><span class="koboSpan" id="kobo.67.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.68.1">DNF </span><a id="_idIndexMarker374"/><span class="koboSpan" id="kobo.69.1">changes are not just in performance; there are also some key differences in its behavior. </span><span class="koboSpan" id="kobo.69.2">In order to test these changes, you will need an Oracle Linux 8 system and access to at least the free public repos, such as </span><a href="https://yum.oracle.com"><span class="koboSpan" id="kobo.70.1">https://yum.oracle.com</span></a><span class="koboSpan" id="kobo.71.1">. </span><span class="koboSpan" id="kobo.71.2">You may also want to be running Oracle Linux in a virtualized environment where you can leverage snapshots to keep copies of the OS before and after a change. </span><span class="koboSpan" id="kobo.71.3">Oracle VM VirtualBox is a great way to </span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">do this.</span></span></p>
<h2 id="_idParaDest-121"><a id="_idTextAnchor140"/><span class="koboSpan" id="kobo.73.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.74.1">For the most part, DNF and </span><a id="_idIndexMarker375"/><span class="koboSpan" id="kobo.75.1">YUM work the same: </span><strong class="source-inline"><span class="koboSpan" id="kobo.76.1">dnf install</span></strong><span class="koboSpan" id="kobo.77.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.78.1">yum install</span></strong><span class="koboSpan" id="kobo.79.1"> appear to work the same way, but with DNF being faster. </span><span class="koboSpan" id="kobo.79.2">The same applies to </span><strong class="source-inline"><span class="koboSpan" id="kobo.80.1">dnf upgrade</span></strong><span class="koboSpan" id="kobo.81.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.82.1">yum upgrade</span></strong><span class="koboSpan" id="kobo.83.1">, so you probably already know </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">the basics.</span></span></p>
<p><span class="koboSpan" id="kobo.85.1">In YUM, </span><strong class="source-inline"><span class="koboSpan" id="kobo.86.1">update</span></strong><span class="koboSpan" id="kobo.87.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.88.1">upgrade</span></strong><span class="koboSpan" id="kobo.89.1"> have slightly different behaviors, with </span><strong class="source-inline"><span class="koboSpan" id="kobo.90.1">yum update</span></strong><span class="koboSpan" id="kobo.91.1"> removing the older packages from the system. </span><span class="koboSpan" id="kobo.91.2">With DNF, both </span><strong class="source-inline"><span class="koboSpan" id="kobo.92.1">update</span></strong><span class="koboSpan" id="kobo.93.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.94.1">upgrade</span></strong><span class="koboSpan" id="kobo.95.1"> will update the installed software but the </span><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">upgrade</span></strong><span class="koboSpan" id="kobo.97.1"> option will also remove the obsolete packages. </span><span class="koboSpan" id="kobo.97.2">Additionally, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.98.1">auto-remove</span></strong><span class="koboSpan" id="kobo.99.1"> option will remove packages that are no longer required on </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">the system.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.101.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.102.1">Starting with Oracle </span><a id="_idIndexMarker376"/><span class="koboSpan" id="kobo.103.1">Linux 8, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.104.1">yum</span></strong><span class="koboSpan" id="kobo.105.1"> command is a </span><strong class="bold"><span class="koboSpan" id="kobo.106.1">symbolic link</span></strong><span class="koboSpan" id="kobo.107.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.108.1">symlink</span></strong><span class="koboSpan" id="kobo.109.1">) to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.110.1">dnf</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.111.1"> command.</span></span></p>
<p><span class="koboSpan" id="kobo.112.1">At this point in the development of DNF, most of the commands are the same, but DNF does have a few tricks up its sleeve, such as automatically running </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">an update.</span></span></p>
<h3><span class="koboSpan" id="kobo.114.1">DNF automatic updates</span></h3>
<p><span class="koboSpan" id="kobo.115.1">You can set up DNS to run </span><a id="_idIndexMarker377"/><span class="koboSpan" id="kobo.116.1">automatically. </span><span class="koboSpan" id="kobo.116.2">To do this, install the </span><strong class="source-inline"><span class="koboSpan" id="kobo.117.1">dnf-automatic</span></strong><span class="koboSpan" id="kobo.118.1"> package, and enable the service with the </span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">following commands:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.120.1">
yum install dnf-automatic
systemctl enable dnf-automatic.timer
systemctl start dnf-automatic.timer</span></pre> <p><span class="koboSpan" id="kobo.121.1">Next, edit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.122.1">/etc/dnf/automatic.conf</span></strong><span class="koboSpan" id="kobo.123.1"> file. </span><span class="koboSpan" id="kobo.123.2">There are a few tricks in this file. </span><span class="koboSpan" id="kobo.123.3">You can override whether patches are applied when downloaded by setting the </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">apply_updates</span></strong><span class="koboSpan" id="kobo.125.1"> parameter to </span><strong class="source-inline"><span class="koboSpan" id="kobo.126.1">yes</span></strong><span class="koboSpan" id="kobo.127.1">. </span><span class="koboSpan" id="kobo.127.2">This will force patches to be applied when the </span><span class="No-Break"><span class="koboSpan" id="kobo.128.1">job runs.</span></span></p>
<p><span class="koboSpan" id="kobo.129.1">Don’t forget to set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.130.1">system_name</span></strong><span class="koboSpan" id="kobo.131.1"> parameter so that emails and notifications will have the </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">correct name.</span></span></p>
<p><span class="koboSpan" id="kobo.133.1">You can also set up the system to email you a report of what was installed. </span><span class="koboSpan" id="kobo.133.2">Set up email in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.134.1">[email]</span></strong><span class="koboSpan" id="kobo.135.1"> stanza. </span><span class="koboSpan" id="kobo.135.2">If using an email relay, make sure it does not require authentication, or add that to the configuration </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">if needed.</span></span></p>
<p><span class="koboSpan" id="kobo.137.1">As a final trick, you can</span><a id="_idIndexMarker378"/><span class="koboSpan" id="kobo.138.1"> change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.139.1">emit_via</span></strong><span class="koboSpan" id="kobo.140.1"> parameter from </span><strong class="source-inline"><span class="koboSpan" id="kobo.141.1">stdio</span></strong><span class="koboSpan" id="kobo.142.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.143.1">motd</span></strong><span class="koboSpan" id="kobo.144.1">. </span><span class="koboSpan" id="kobo.144.2">When set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.145.1">motd</span></strong><span class="koboSpan" id="kobo.146.1">, the system </span><strong class="source-inline"><span class="koboSpan" id="kobo.147.1">motd</span></strong><span class="koboSpan" id="kobo.148.1"> file is updated to reflect what patches were installed. </span><span class="koboSpan" id="kobo.148.2">When users log in to the system, they will see a complete list of what patches were installed and when, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer116">
<span class="koboSpan" id="kobo.150.1"><img alt="Figure 5.1 – MOTD on login" src="image/B18349_05_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.151.1">Figure 5.1 – MOTD on login</span></p>
<p><span class="koboSpan" id="kobo.152.1">By default, the </span><a id="_idIndexMarker379"/><span class="koboSpan" id="kobo.153.1">service checks for updates at 6 A.M. </span><span class="koboSpan" id="kobo.153.2">This can be changed by editing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.154.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.155.1">etc/systemd/system/timers.target.wants/dnf-automatic.timer</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.156.1"> file:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer117">
<span class="koboSpan" id="kobo.157.1"><img alt="Figure 5.2 – The dnf-automatic.timer file" src="image/B18349_05_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.158.1">Figure 5.2 – The dnf-automatic.timer file</span></p>
<p><span class="koboSpan" id="kobo.159.1">In this file, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.160.1">[Timer]</span></strong><span class="koboSpan" id="kobo.161.1"> stanza</span><a id="_idIndexMarker380"/><span class="koboSpan" id="kobo.162.1"> controls the time, as well as a randomized delay. </span><span class="koboSpan" id="kobo.162.2">To change when this runs, replace </span><strong class="source-inline"><span class="koboSpan" id="kobo.163.1">6:00</span></strong><span class="koboSpan" id="kobo.164.1"> with whatever time you want, in a 24-hour format. </span><span class="koboSpan" id="kobo.164.2">For example, if you want the check to run at 10 P.M., the time should </span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">be 22:00.</span></span></p>
<p><span class="koboSpan" id="kobo.166.1">Since this uses the standard </span><strong class="source-inline"><span class="koboSpan" id="kobo.167.1">OnCalendar</span></strong><span class="koboSpan" id="kobo.168.1"> function, you have other options. </span><strong class="source-inline"><span class="koboSpan" id="kobo.169.1">OnCalendar</span></strong><span class="koboSpan" id="kobo.170.1"> is a very flexible method; the following are some of the most commonly </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">used examples:</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-5">
<colgroup>
<col/>
<col/>
</colgroup>
<thead>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.172.1">OnCalendar Example</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.173.1">Description</span></strong></span></p>
</td>
</tr>
</thead>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.174.1">DOW </span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">YYYY-MM-DD HH:MM:SS</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.176.1">Generic time </span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">formatting methods.</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.178.1">*-*-* </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">2:00</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.180.1">Runs every day at </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">2:00 A.M.</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.182.1">Weekly</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.183.1">Every Monday </span><span class="No-Break"><span class="koboSpan" id="kobo.184.1">at midnight.</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.185.1">Sat *-*-* </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">2:00</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.187.1">Every Saturday at </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">2:00 A.M.</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.189.1">Sat</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.190.1">Every Saturday </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">at midnight.</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><span class="koboSpan" id="kobo.192.1">Sun 2022-*-*</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.193.1">Every Sunday in 2022 </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">at midnight.</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.195.1">*-*-</span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">1,15 22:15</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.197.1">The 1st and 15th of every month at </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">10:15 P.M.</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.199.1">*-</span><span class="No-Break"><span class="koboSpan" id="kobo.200.1">05-03/2</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.201.1">Runs on the third day of the month in May, and then on the second day of every other month. </span><span class="koboSpan" id="kobo.201.2">Runs every year with the same cycle. </span><span class="koboSpan" id="kobo.201.3">This date format expression uses the dash </span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">for formatting.</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.203.1">Table 5.1 – OnCalendar example date rules</span></p>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">RandomizedDelaySec</span></strong><span class="koboSpan" id="kobo.205.1"> is also an important setting. </span><span class="koboSpan" id="kobo.205.2">This will add a random delay to the clock, which is helpful in enterprise environments where large numbers of systems are running. </span><span class="koboSpan" id="kobo.205.3">Having 200 servers hitting a YUM repo at 6 A.M. </span><span class="koboSpan" id="kobo.205.4">can be a little overwhelming to the server. </span><span class="koboSpan" id="kobo.205.5">Adding a randomized delay in </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">/etc/dnf/automatic.conf</span></strong><span class="koboSpan" id="kobo.207.1"> of maybe 600 seconds would spread the load across a </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">few minutes.</span></span></p>
<p><span class="koboSpan" id="kobo.209.1">DNF is an</span><a id="_idIndexMarker381"/><span class="koboSpan" id="kobo.210.1"> upgraded version of YUM, with a few enhancements. </span><span class="koboSpan" id="kobo.210.2">As seen in the recipe, it does have a few tricks up its sleeve, but it still does a great job of providing an easy way for admins to install and patch software on an Oracle </span><span class="No-Break"><span class="koboSpan" id="kobo.211.1">Linux system.</span></span></p>
<h1 id="_idParaDest-122"><a id="_idTextAnchor141"/><span class="koboSpan" id="kobo.212.1">Using the DNF time machine</span></h1>
<p><span class="koboSpan" id="kobo.213.1">DNF has a time</span><a id="_idIndexMarker382"/><span class="koboSpan" id="kobo.214.1"> machine built into it! </span><span class="koboSpan" id="kobo.214.2">This isn’t just a way to look back through the cosmos; it actually allows you to see the history of what was installed and also allows you to roll back a single change, or all changes up to </span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">a point.</span></span></p>
<h2 id="_idParaDest-123"><a id="_idTextAnchor142"/><span class="koboSpan" id="kobo.216.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.217.1">To do this, you will need a test system, running Oracle Linux 8, with access to an </span><span class="No-Break"><span class="koboSpan" id="kobo.218.1">RPM repo.</span></span></p>
<h2 id="_idParaDest-124"><a id="_idTextAnchor143"/><span class="koboSpan" id="kobo.219.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.220.1">When </span><a id="_idIndexMarker383"/><span class="koboSpan" id="kobo.221.1">DNF installs software, it keeps a history of all the actions performed. </span><span class="koboSpan" id="kobo.221.2">This includes upgrades to the software, installed software, and removal of the software. </span><span class="koboSpan" id="kobo.221.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">dnf history</span></strong><span class="koboSpan" id="kobo.223.1"> command shows </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">this history:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer118">
<span class="koboSpan" id="kobo.225.1"><img alt="Figure 5.3 – The dnf history command" src="image/B18349_05_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.226.1">Figure 5.3 – The dnf history command</span></p>
<p><span class="koboSpan" id="kobo.227.1">There are five columns – </span><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">ID</span></strong><span class="koboSpan" id="kobo.229.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.230.1">Command line</span></strong><span class="koboSpan" id="kobo.231.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.232.1">Date and time</span></strong><span class="koboSpan" id="kobo.233.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.234.1">Action(s)</span></strong><span class="koboSpan" id="kobo.235.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.236.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.237.1">Altered</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.238.1">:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.239.1">ID</span></strong><span class="koboSpan" id="kobo.240.1">: This is the identifier for the history, and is used in commands that will show info, roll back, undo, or store </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">a transaction</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.242.1">Command line</span></strong><span class="koboSpan" id="kobo.243.1">: This is the option passed to DNF when the command was run that added to the </span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">transaction history</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.245.1">Date and time</span></strong><span class="koboSpan" id="kobo.246.1">: This is the timestamp of when the transaction </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">was run</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.248.1">Action(s)</span></strong><span class="koboSpan" id="kobo.249.1">: This is what actions were taken; multiple actions can performed in the </span><span class="No-Break"><span class="koboSpan" id="kobo.250.1">same transaction:</span></span><ul><li><span class="koboSpan" id="kobo.251.1">(</span><strong class="source-inline"><span class="koboSpan" id="kobo.252.1">D</span></strong><span class="koboSpan" id="kobo.253.1">) </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">Downgrade</span></strong><span class="koboSpan" id="kobo.255.1">: A package </span><span class="No-Break"><span class="koboSpan" id="kobo.256.1">was downgraded</span></span></li><li><span class="koboSpan" id="kobo.257.1">(</span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">E</span></strong><span class="koboSpan" id="kobo.259.1">) </span><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">Erase</span></strong><span class="koboSpan" id="kobo.261.1">: A package </span><span class="No-Break"><span class="koboSpan" id="kobo.262.1">was removed</span></span></li><li><span class="koboSpan" id="kobo.263.1">(</span><strong class="source-inline"><span class="koboSpan" id="kobo.264.1">I</span></strong><span class="koboSpan" id="kobo.265.1">) </span><strong class="source-inline"><span class="koboSpan" id="kobo.266.1">Installed</span></strong><span class="koboSpan" id="kobo.267.1">: A package </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">was installed</span></span></li><li><span class="koboSpan" id="kobo.269.1">(</span><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">R</span></strong><span class="koboSpan" id="kobo.271.1">) </span><strong class="source-inline"><span class="koboSpan" id="kobo.272.1">Reinstall</span></strong><span class="koboSpan" id="kobo.273.1">: A package </span><span class="No-Break"><span class="koboSpan" id="kobo.274.1">was reinstalled</span></span></li><li><span class="koboSpan" id="kobo.275.1">(</span><strong class="source-inline"><span class="koboSpan" id="kobo.276.1">O</span></strong><span class="koboSpan" id="kobo.277.1">) </span><strong class="source-inline"><span class="koboSpan" id="kobo.278.1">Obsoleting</span></strong><span class="koboSpan" id="kobo.279.1">: A package was flagged </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">as obsolete</span></span></li><li><span class="koboSpan" id="kobo.281.1">(</span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">U</span></strong><span class="koboSpan" id="kobo.283.1">) </span><strong class="source-inline"><span class="koboSpan" id="kobo.284.1">Update</span></strong><span class="koboSpan" id="kobo.285.1">: A package </span><span class="No-Break"><span class="koboSpan" id="kobo.286.1">was updated</span></span></li></ul></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.287.1">Altered</span></strong><span class="koboSpan" id="kobo.288.1">: This is the number of packages altered when the command was run, in addition to several </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">exception flags:</span></span><ul><li><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">E</span></strong><span class="koboSpan" id="kobo.291.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.292.1">EE</span></strong><span class="koboSpan" id="kobo.293.1">: The transaction was completed but had an output generated. </span><span class="koboSpan" id="kobo.293.2">Not all outputs </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">are errors!</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.295.1">P</span></strong><span class="koboSpan" id="kobo.296.1">: The transaction was completed but problems exist in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.297.1">rpm</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.298.1"> database.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.299.1">s</span></strong><span class="koboSpan" id="kobo.300.1">: The transaction was completed but since the </span><strong class="source-inline"><span class="koboSpan" id="kobo.301.1">--skip-broken</span></strong><span class="koboSpan" id="kobo.302.1"> parameter was enabled, some packages </span><span class="No-Break"><span class="koboSpan" id="kobo.303.1">were skipped.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.304.1">&gt;</span></strong><span class="koboSpan" id="kobo.305.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.306.1">rpm</span></strong><span class="koboSpan" id="kobo.307.1"> database was changed outside of DNF after the </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">transaction ran.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.309.1">&lt;</span></strong><span class="koboSpan" id="kobo.310.1">: The </span><strong class="source-inline"><span class="koboSpan" id="kobo.311.1">rpm</span></strong><span class="koboSpan" id="kobo.312.1"> database was changed outside of DNF before the </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">transaction ran.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.314.1">*</span></strong><span class="koboSpan" id="kobo.315.1">: The</span><a id="_idIndexMarker384"/><span class="koboSpan" id="kobo.316.1"> transaction was aborted </span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">before completion.</span></span></li><li><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">#</span></strong><span class="koboSpan" id="kobo.319.1">: The transaction was completed but returned a </span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">non-zero status.</span></span></li></ul></li>
</ul>
<p><span class="koboSpan" id="kobo.321.1">When there are error codes, you can see the details with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">dnf history info {ID}</span></strong><span class="koboSpan" id="kobo.323.1"> command, as seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.324.1">Figure 5</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.325.1">.4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer119">
<span class="koboSpan" id="kobo.327.1"><img alt="Figure 5.4 – The dnf history info command" src="image/B18349_05_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.328.1">Figure 5.4 – The dnf history info command</span></p>
<p><span class="koboSpan" id="kobo.329.1">In this</span><a id="_idIndexMarker385"/><span class="koboSpan" id="kobo.330.1"> example, the output is more informational, with no actual errors. </span><span class="koboSpan" id="kobo.330.2">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">not uncommon.</span></span></p>
<p><span class="koboSpan" id="kobo.332.1">You can also use </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">dnf history</span></strong><span class="koboSpan" id="kobo.334.1"> to uninstall a package. </span><span class="koboSpan" id="kobo.334.2">There are two ways to do this: </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">rollback</span></strong><span class="koboSpan" id="kobo.336.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">undo</span></strong><span class="koboSpan" id="kobo.338.1">. </span><span class="koboSpan" id="kobo.338.2">A </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">rollback</span></strong><span class="koboSpan" id="kobo.340.1"> command attempts to reverse out all of the DNF transactions from the current point to the transaction ID specified. </span><span class="koboSpan" id="kobo.340.2">An </span><strong class="source-inline"><span class="koboSpan" id="kobo.341.1">undo</span></strong><span class="koboSpan" id="kobo.342.1"> command simply undoes the transactions in the </span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">ID identified.</span></span></p>
<p><span class="koboSpan" id="kobo.344.1">On the test system, let’s undo the installation of Nmap from 4/17/2022, which was ID 34, using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">dnf history undo </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.346.1">34</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.347.1"> command:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer120">
<span class="koboSpan" id="kobo.348.1"><img alt="Figure 5.5 – The dnf history undo command" src="image/B18349_05_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.349.1">Figure 5.5 – The dnf history undo command</span></p>
<p><span class="koboSpan" id="kobo.350.1">This </span><a id="_idIndexMarker386"/><span class="koboSpan" id="kobo.351.1">was a fairly simple undo, with Nmap being uninstalled. </span><span class="koboSpan" id="kobo.351.2">When the DNF history is looked at after the transaction, you will see a new ID of </span><strong class="source-inline"><span class="koboSpan" id="kobo.352.1">40</span></strong><span class="koboSpan" id="kobo.353.1">, showing the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">undo</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.355.1"> command:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer121">
<span class="koboSpan" id="kobo.356.1"><img alt="Figure 5.6 – DNF history after the undo" src="image/B18349_05_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.357.1">Figure 5.6 – DNF history after the undo</span></p>
<p><span class="koboSpan" id="kobo.358.1">Now, if the goal was to roll back all of the changes, let’s say to ID </span><strong class="source-inline"><span class="koboSpan" id="kobo.359.1">37</span></strong><span class="koboSpan" id="kobo.360.1">, the command would be </span><strong class="source-inline"><span class="koboSpan" id="kobo.361.1">dnf history rollback 37</span></strong><span class="koboSpan" id="kobo.362.1">. </span><span class="koboSpan" id="kobo.362.2">This will roll back the system to match the state it was in when transaction 37 </span><span class="No-Break"><span class="koboSpan" id="kobo.363.1">was completed.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer122">
<span class="koboSpan" id="kobo.364.1"><img alt="Figure 5.7 – DNF rollback" src="image/B18349_05_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.365.1">Figure 5.7 – DNF rollback</span></p>
<p><span class="koboSpan" id="kobo.366.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">rollback</span></strong><span class="koboSpan" id="kobo.368.1"> command</span><a id="_idIndexMarker387"/><span class="koboSpan" id="kobo.369.1"> rolls back the transitions, so Nmap is actually reinstalled, and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.370.1">oracle-cloud-agent</span></strong><span class="koboSpan" id="kobo.371.1"> RPM is downgraded. </span><span class="koboSpan" id="kobo.371.2">This is reflected in the new history summary as ID </span><strong class="source-inline"><span class="koboSpan" id="kobo.372.1">41</span></strong><span class="koboSpan" id="kobo.373.1"> (shown in the following screenshot) where we see the install and downgrade actions in </span><span class="No-Break"><span class="koboSpan" id="kobo.374.1">ID 41:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer123">
<span class="koboSpan" id="kobo.375.1"><img alt="Figure 5.8 – DNF history post rollback" src="image/B18349_05_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.376.1">Figure 5.8 – DNF history post rollback</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.377.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.378.1">While the </span><strong class="source-inline"><span class="koboSpan" id="kobo.379.1">rollback</span></strong><span class="koboSpan" id="kobo.380.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.381.1">undo</span></strong><span class="koboSpan" id="kobo.382.1"> commands often work well, it is still good practice to keep OS snapshots using hypervisor or cloud-native tooling. </span><span class="koboSpan" id="kobo.382.2">You can also take snapshots using Btrfs. </span><span class="koboSpan" id="kobo.382.3">Sometimes, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.383.1">rollback</span></strong><span class="koboSpan" id="kobo.384.1"> scripts in the RPMs do not undo all the changes to the system. </span><span class="koboSpan" id="kobo.384.2">When leveraging a storage-based snapshot, you reduce the risk of having issues due </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">to this.</span></span></p>
<p><span class="koboSpan" id="kobo.386.1">The </span><a id="_idIndexMarker388"/><span class="koboSpan" id="kobo.387.1">DNF system maintains a database of all transactions, with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.388.1">dnf history</span></strong><span class="koboSpan" id="kobo.389.1"> command and its options giving you access to the database to examine what happened, as well as the ability to undo a single transaction or roll back from the latest transaction to a specific ID in the history. </span><span class="koboSpan" id="kobo.389.2">This is a very helpful tool for admins when they need to back out of patches and </span><span class="No-Break"><span class="koboSpan" id="kobo.390.1">software installation.</span></span></p>
<h1 id="_idParaDest-125"><a id="_idTextAnchor144"/><span class="koboSpan" id="kobo.391.1">Building a DNF/YUM mirror from ULN</span></h1>
<p><span class="koboSpan" id="kobo.392.1">It is very common for admins to not enable internet access for the systems running in a secure network, like banking of Government networks. </span><span class="koboSpan" id="kobo.392.2">A local mirror of Oracle’s </span><strong class="bold"><span class="koboSpan" id="kobo.393.1">Unbreakable Linux Network</span></strong><span class="koboSpan" id="kobo.394.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.395.1">ULN</span></strong><span class="koboSpan" id="kobo.396.1">) is a</span><a id="_idIndexMarker389"/><span class="koboSpan" id="kobo.397.1"> great way to allow systems to access patches without having to reach out across the internet to </span><span class="No-Break"><span class="koboSpan" id="kobo.398.1">access them.</span></span></p>
<h2 id="_idParaDest-126"><a id="_idTextAnchor145"/><span class="koboSpan" id="kobo.399.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.400.1">To do this, you</span><a id="_idIndexMarker390"/><span class="koboSpan" id="kobo.401.1"> will need a </span><a id="_idIndexMarker391"/><span class="koboSpan" id="kobo.402.1">YUM server system running Oracle Linux 8. </span><span class="koboSpan" id="kobo.402.2">The local system should have internet access to be able to reach the ULN servers via direct access or a proxy server. </span><span class="koboSpan" id="kobo.402.3">Only the system (often called a YUM server) synchronizing to ULN will require this access; all the systems using this system will not need access to the internet, they will use this system to </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">access patches.</span></span></p>
<p><span class="koboSpan" id="kobo.404.1">The system is not CPU- or RAM-intensive – 2 cores and 4 GB of RAM are often more than enough for the server, but the system will use a lot of disk space. </span><span class="koboSpan" id="kobo.404.2">You can check how much space is needed by running the </span><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">dnf repolist -</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.406.1">v</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.407.1"> command.</span></span></p>
<p><span class="koboSpan" id="kobo.408.1">A terabyte can go quickly, depending on how many repos the server is subscribed to. </span><span class="koboSpan" id="kobo.408.2">The good news on space is that high-performance storage is not required. </span><span class="koboSpan" id="kobo.408.3">You will also need a valid support contract with Oracle, which is included with the hardware support contract if you are running on Oracle servers. </span><span class="koboSpan" id="kobo.408.4">On my local repos, I keep the repo in </span><strong class="source-inline"><span class="koboSpan" id="kobo.409.1">/var/www</span></strong><span class="koboSpan" id="kobo.410.1"> and mount it as a separate filesystem under </span><strong class="bold"><span class="koboSpan" id="kobo.411.1">Logical Volume Management</span></strong><span class="koboSpan" id="kobo.412.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.413.1">LVM</span></strong><span class="koboSpan" id="kobo.414.1">). </span><span class="koboSpan" id="kobo.414.2">This way, additional </span><a id="_idIndexMarker392"/><span class="koboSpan" id="kobo.415.1">space can easily be added </span><span class="No-Break"><span class="koboSpan" id="kobo.416.1">when needed.</span></span></p>
<p><span class="koboSpan" id="kobo.417.1">Additionally, an HTTP server should be installed and you must ensure that the firewall ports are opened. </span><span class="koboSpan" id="kobo.417.2">If you need help doing that, go back to </span><a href="B18349_02.xhtml#_idTextAnchor052"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.418.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.419.1">, </span><em class="italic"><span class="koboSpan" id="kobo.420.1">Installing with and without Automation Magic</span></em><span class="koboSpan" id="kobo.421.1">, where setting up a HTTP server </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">is covered.</span></span></p>
<h2 id="_idParaDest-127"><a id="_idTextAnchor146"/><span class="koboSpan" id="kobo.423.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.424.1">To</span><a id="_idIndexMarker393"/><span class="koboSpan" id="kobo.425.1"> build the mirror, follow</span><a id="_idIndexMarker394"/> <span class="No-Break"><span class="koboSpan" id="kobo.426.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.427.1">The first step is to validate that enough space is in </span><strong class="source-inline"><span class="koboSpan" id="kobo.428.1">/var/www</span></strong><span class="koboSpan" id="kobo.429.1">. </span><span class="koboSpan" id="kobo.429.2">For even a small mirror, 600 GB is recommended as a starting point. </span><span class="koboSpan" id="kobo.429.3">Watch the disk space carefully, as more will be needed down the road. </span><span class="koboSpan" id="kobo.429.4">Larger mirrors can easily consume </span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">2 TB.</span></span></li>
<li><span class="koboSpan" id="kobo.431.1">Next, install the </span><strong class="source-inline"><span class="koboSpan" id="kobo.432.1">uln-yum-mirror</span></strong><span class="koboSpan" id="kobo.433.1"> package using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.434.1">dnf install uln-yum-mirror -y</span></strong><span class="koboSpan" id="kobo.435.1"> command. </span><span class="koboSpan" id="kobo.435.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.436.1">uln-yum-mirror</span></strong><span class="koboSpan" id="kobo.437.1"> package includes the scripts that automate the replication of the Oracle ULN repository to a local server. </span><span class="koboSpan" id="kobo.437.2">Make sure that the system has access to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">ol8_addons</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.439.1"> repo:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer124">
<span class="koboSpan" id="kobo.440.1"><img alt="Figure 5.9 – The uln-yum-mirror install" src="image/B18349_05_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.441.1">Figure 5.9 – The uln-yum-mirror install</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.442.1">This will</span><a id="_idIndexMarker395"/><span class="koboSpan" id="kobo.443.1"> install the </span><a id="_idIndexMarker396"/><span class="koboSpan" id="kobo.444.1">scripts from Oracle. </span><span class="koboSpan" id="kobo.444.2">Next, let’s register the system with ULN. </span><span class="koboSpan" id="kobo.444.3">This is done using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.445.1">uln_register</span></strong><span class="koboSpan" id="kobo.446.1"> command. </span><span class="koboSpan" id="kobo.446.2">You will need to know the </span><strong class="bold"><span class="koboSpan" id="kobo.447.1">support identifier</span></strong><span class="koboSpan" id="kobo.448.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.449.1">SI</span></strong><span class="koboSpan" id="kobo.450.1">) you</span><a id="_idIndexMarker397"/><span class="koboSpan" id="kobo.451.1"> will be using for the system, as well as your </span><a id="_idIndexMarker398"/><span class="koboSpan" id="kobo.452.1">Oracle </span><strong class="bold"><span class="koboSpan" id="kobo.453.1">single sign-on</span></strong><span class="koboSpan" id="kobo.454.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.455.1">SSO</span></strong><span class="koboSpan" id="kobo.456.1">) credentials. </span><span class="koboSpan" id="kobo.456.2">As a note, SIs are also</span><a id="_idIndexMarker399"/><span class="koboSpan" id="kobo.457.1"> often called by an older term, </span><strong class="bold"><span class="koboSpan" id="kobo.458.1">customer support identifier</span></strong><span class="koboSpan" id="kobo.459.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.460.1">CSI</span></strong><span class="koboSpan" id="kobo.461.1">). </span><span class="koboSpan" id="kobo.461.2">To start the process of registering the server, run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.462.1">uln_register</span></strong><span class="koboSpan" id="kobo.463.1"> command. </span><span class="koboSpan" id="kobo.463.2">From there, you will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.464.1">main</span><a id="_idTextAnchor147"/><span class="koboSpan" id="kobo.465.1"> screen:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer125">
<span class="koboSpan" id="kobo.466.1"><img alt="Figure 5.10 – The uln_register start screen" src="image/B18349_05_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.467.1">Figure 5.10 – The uln_register start screen</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.468.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.469.1">Next</span></strong><span class="koboSpan" id="kobo.470.1"> to</span><a id="_idIndexMarker400"/><span class="koboSpan" id="kobo.471.1"> continue. </span><span class="koboSpan" id="kobo.471.2">On</span><a id="_idIndexMarker401"/><span class="koboSpan" id="kobo.472.1"> the next screen, you will be prompted to put in your Oracle SSO credentials. </span><span class="koboSpan" id="kobo.472.2">The CSI is the support identifier. </span><span class="koboSpan" id="kobo.472.3">Use the CSI assigned to you with your Premier hardware support, or your Oracle Linux subscription. </span><span class="koboSpan" id="kobo.472.4">Do </span><em class="italic"><span class="koboSpan" id="kobo.473.1">not</span></em><span class="koboSpan" id="kobo.474.1"> use a CSI for the Oracle database, WebLogic, E-Business Suite, and so on. </span><span class="koboSpan" id="kobo.474.2">The CSI should be for </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">Oracle Linux.</span></span></li>
</ol>
<p class="callout-heading"><span class="koboSpan" id="kobo.476.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.477.1">In production environments, you may want to consider creating a shared account to register all your servers using ULN directly. </span><span class="koboSpan" id="kobo.477.2">This makes it easier to manage the servers as staff members come </span><span class="No-Break"><span class="koboSpan" id="kobo.478.1">and go.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer126">
<span class="koboSpan" id="kobo.479.1"><img alt="Figure 5.11 – The uln_register credentials" src="image/B18349_05_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.480.1">Figure 5.11 – The uln_register credentials</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.481.1">Next, you </span><a id="_idIndexMarker402"/><span class="koboSpan" id="kobo.482.1">will need to</span><a id="_idIndexMarker403"/><span class="koboSpan" id="kobo.483.1"> identify the server for ULN. </span><span class="koboSpan" id="kobo.483.2">Normally, you would use the </span><strong class="bold"><span class="koboSpan" id="kobo.484.1">Fully Qualified Domain Name</span></strong><span class="koboSpan" id="kobo.485.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.486.1">FQDN</span></strong><span class="koboSpan" id="kobo.487.1">) of the</span><a id="_idIndexMarker404"/><span class="koboSpan" id="kobo.488.1"> server, but the choice is yours. </span><span class="koboSpan" id="kobo.488.2">You can also choose to upload the hardware details, but this </span><span class="No-Break"><span class="koboSpan" id="kobo.489.1">is optional.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer127">
<span class="koboSpan" id="kobo.490.1"><img alt="Figure 5.12 – The uln_register system name" src="image/B18349_05_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.491.1">Figure 5.12 – The uln_register system name</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.492.1">Next, the system will update ULN with the software installed on the server, which will let you track installed RPMs via ULN but </span><em class="italic"><span class="koboSpan" id="kobo.493.1">only</span></em><span class="koboSpan" id="kobo.494.1"> for systems directly registered with </span><a id="_idIndexMarker405"/><span class="koboSpan" id="kobo.495.1">ULN. </span><span class="koboSpan" id="kobo.495.2">When</span><a id="_idIndexMarker406"/><span class="koboSpan" id="kobo.496.1"> using a local repository, you may want to consider using a tool such as Oracle Linux Manager to track software installed on systems not registered </span><span class="No-Break"><span class="koboSpan" id="kobo.497.1">with ULN:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer128">
<span class="koboSpan" id="kobo.498.1"><img alt="Figure 5.13 – The uln_register initial packages" src="image/B18349_05_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.499.1">Figure 5.13 – The uln_register initial packages</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.500.1">Registering the</span><a id="_idIndexMarker407"/><span class="koboSpan" id="kobo.501.1"> server with</span><a id="_idIndexMarker408"/><span class="koboSpan" id="kobo.502.1"> ULN is almost complete. </span><span class="koboSpan" id="kobo.502.2">The last step is to send the info to ULN to register the server, this is done automatically in the </span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">next step:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer129">
<span class="koboSpan" id="kobo.504.1"><img alt="Figure 5.14 – uln_register send" src="image/B18349_05_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.505.1">Figure 5.14 – uln_register send</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.506.1">The upload </span><a id="_idIndexMarker409"/><span class="koboSpan" id="kobo.507.1">can take up</span><a id="_idIndexMarker410"/><span class="koboSpan" id="kobo.508.1"> to a minute, depending on your </span><span class="No-Break"><span class="koboSpan" id="kobo.509.1">internet speed.</span></span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.510.1">After the upload, the system is now registered in ULN. </span><span class="koboSpan" id="kobo.510.2">The next step is optional. </span><span class="koboSpan" id="kobo.510.3">It will set up Ksplice for the server. </span><span class="koboSpan" id="kobo.510.4">If you do not want to use Ksplice, you are done. </span><span class="koboSpan" id="kobo.510.5">Ksplice also requires that you have an Oracle Linux Premier Support subscription. </span><span class="koboSpan" id="kobo.510.6">This is included with Oracle hardware support and Oracle Cloud VMs. </span><span class="koboSpan" id="kobo.510.7">You can also purchase this for third-party systems, often at a cheaper price than other commercial </span><span class="No-Break"><span class="koboSpan" id="kobo.511.1">Linux distributions.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer130">
<span class="koboSpan" id="kobo.512.1"><img alt="Figure 5.15 – uln_register ksplice" src="image/B18349_05_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.513.1">Figure 5.15 – uln_register ksplice</span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.514.1">Ksplice</span><a id="_idIndexMarker411"/><span class="koboSpan" id="kobo.515.1"> is a </span><a id="_idIndexMarker412"/><span class="koboSpan" id="kobo.516.1">quick step; just review the settings, as seen in the following screenshot, and </span><a id="_idIndexMarker413"/><span class="No-Break"><span class="koboSpan" id="kobo.517.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.518.1">OK</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.519.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer131">
<span class="koboSpan" id="kobo.520.1"><img alt="Figure 5.16 – The uln_register settings" src="image/B18349_05_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.521.1">Figure 5.16 – The uln_register settings</span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.522.1">The registration is</span><a id="_idIndexMarker414"/><span class="koboSpan" id="kobo.523.1"> now complete. </span><span class="koboSpan" id="kobo.523.2">You </span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.524.1">should now patch the server with </span><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">dnf -y update</span></strong><span class="koboSpan" id="kobo.526.1"> (as recommended in the tool) </span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">b</span><a id="_idTextAnchor148"/><span class="koboSpan" id="kobo.528.1">efore continuing:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer132">
<span class="koboSpan" id="kobo.529.1"><img alt="Figure 5.17 – Completed uln_register" src="image/B18349_05_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.530.1">Figure 5.17 – Completed uln_register</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.531.1">Next, go</span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.532.1"> ahead and patch the system with </span><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">dnf update -y</span></strong><span class="koboSpan" id="kobo.534.1"> and reboot the system. </span><span class="koboSpan" id="kobo.534.2">As a note, the position of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.535.1">-y</span></strong><span class="koboSpan" id="kobo.536.1"> option does not matter for the command. </span><span class="koboSpan" id="kobo.536.2">Once the </span><a id="_idIndexMarker417"/><span class="koboSpan" id="kobo.537.1">system is back online, you need to log in to </span><a href="https://linux.oracle.com/"><span class="koboSpan" id="kobo.538.1">https://linux.oracle.com/</span></a><span class="koboSpan" id="kobo.539.1">. </span><span class="koboSpan" id="kobo.539.2">While this server is registered to ULN now, it is not a local repo yet! </span><span class="koboSpan" id="kobo.539.3">We need to tell ULN this is a local repo and select what repos we need </span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">to mirror.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.541.1">To do this, head over to </span><a href="https://linux.oracle.com"><span class="koboSpan" id="kobo.542.1">https://linux.oracle.com</span></a><span class="koboSpan" id="kobo.543.1"> and click the </span><strong class="bold"><span class="koboSpan" id="kobo.544.1">Sign </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.545.1">In</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.546.1"> button:</span></span></p></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer133">
<span class="koboSpan" id="kobo.547.1"><img alt="Figure 5.18 – ULN main page" src="image/B18349_05_18.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.548.1">Figure 5.18 – ULN main page</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.549.1">When managing the server, use the same login used to register </span><span class="No-Break"><span class="koboSpan" id="kobo.550.1">the server.</span></span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.551.1">Once you </span><a id="_idIndexMarker418"/><span class="koboSpan" id="kobo.552.1">are logged in to ULN, you will see all the servers registered to your account. </span><span class="koboSpan" id="kobo.552.2">You will also see </span><a id="_idIndexMarker419"/><span class="koboSpan" id="kobo.553.1">what channels have been recently updated and added to </span><span class="No-Break"><span class="koboSpan" id="kobo.554.1">the system:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer134">
<span class="koboSpan" id="kobo.555.1"><img alt="Figure 5.19 – Managed servers" src="image/B18349_05_19.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.556.1">Figure 5.19 – Managed servers</span></p>
<ol>
<li value="12"><span class="koboSpan" id="kobo.557.1">From here, we </span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.558.1">need to </span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.559.1">promote a server to be a YUM repo. </span><span class="koboSpan" id="kobo.559.2">This will tell ULN to allow this server to have any channel assigned to it, allowing it to download RPMs not required by the specific servers. </span><span class="koboSpan" id="kobo.559.3">This includes patches for different major versions of Oracle Linux, different CPU architectures such as AArch64, and special patches for platforms such as Exadata. </span><span class="koboSpan" id="kobo.559.4">To do this, click on the server name, and then the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.560.1">Edit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.561.1"> button:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer135">
<span class="koboSpan" id="kobo.562.1"><img alt="Figure 5.20 – Editing the server" src="image/B18349_05_20.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.563.1">Figure 5.20 – Editing the server</span></p>
<ol>
<li value="13"><span class="koboSpan" id="kobo.564.1">On this page, we</span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.565.1"> will update the server properties to make it a YUM server. </span><span class="koboSpan" id="kobo.565.2">Select the </span><strong class="bold"><span class="koboSpan" id="kobo.566.1">Yum Server</span></strong><span class="koboSpan" id="kobo.567.1"> checkbox </span><a id="_idIndexMarker423"/><span class="koboSpan" id="kobo.568.1">and then click </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.569.1">Apply Changes</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.570.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer136">
<span class="koboSpan" id="kobo.571.1"><img alt="Figure 5.21 – Making it a repo" src="image/B18349_05_21.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.572.1">Figure 5.21 – Making it a repo</span></p>
<ol>
<li value="14"><span class="koboSpan" id="kobo.573.1">Next, we need to </span><a id="_idIndexMarker424"/><span class="koboSpan" id="kobo.574.1">assign additional channels to the server. </span><span class="koboSpan" id="kobo.574.2">This will allow the server to serve up any </span><a id="_idIndexMarker425"/><span class="koboSpan" id="kobo.575.1">channel it is subscribed to. </span><span class="koboSpan" id="kobo.575.2">To manage the RPM channels that contain a grouping of related RPMs, click the </span><strong class="bold"><span class="koboSpan" id="kobo.576.1">Manage </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.577.1">Subscriptions</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.578.1"> button:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer137">
<span class="koboSpan" id="kobo.579.1"><img alt="Figure 5.22 – Manage Subscriptions" src="image/B18349_05_22.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.580.1">Figure 5.22 – Manage Subscriptions</span></p>
<ol>
<li value="15"><span class="koboSpan" id="kobo.581.1">Next, you will </span><a id="_idIndexMarker426"/><span class="koboSpan" id="kobo.582.1">see all the available channels on the left and the channels assigned to the server on the right. </span><span class="koboSpan" id="kobo.582.2">While you can bulk-select all channels, it is better to only select the channels you </span><a id="_idIndexMarker427"/><span class="koboSpan" id="kobo.583.1">need. </span><span class="koboSpan" id="kobo.583.2">In this example, </span><strong class="bold"><span class="koboSpan" id="kobo.584.1">Oracle Linux 8 Addons x86_64</span></strong><span class="koboSpan" id="kobo.585.1"> is being added. </span><span class="koboSpan" id="kobo.585.2">You can also add channels for a different major release number, such as Oracle Linux 7. </span><span class="koboSpan" id="kobo.585.3">When selecting a channel, make sure to select the </span><strong class="bold"><span class="koboSpan" id="kobo.586.1">&lt;</span></strong><span class="koboSpan" id="kobo.587.1"> or </span><strong class="bold"><span class="koboSpan" id="kobo.588.1">&gt;</span></strong><span class="koboSpan" id="kobo.589.1"> symbol to subscribe to or unsubscribe from the local server. </span><span class="koboSpan" id="kobo.589.2">This is seen in step 2 in the following figure. </span><span class="koboSpan" id="kobo.589.3">Also, once you are done with the selection, you must click on the </span><strong class="bold"><span class="koboSpan" id="kobo.590.1">Save Subscriptions</span></strong><span class="koboSpan" id="kobo.591.1"> option to update the subscription. </span><span class="koboSpan" id="kobo.591.2">Exiting without saving the subscription will cause any changes made to </span><span class="No-Break"><span class="koboSpan" id="kobo.592.1">be lost.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer138">
<span class="koboSpan" id="kobo.593.1"><img alt="Figure 5.23 – Adding more repos" src="image/B18349_05_23.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.594.1">Figure 5.23 – Adding more repos</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.595.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.596.1">When adding channels, only add what you need to conserve space and bandwidth. </span><span class="koboSpan" id="kobo.596.2">You can easily download a few terabytes if not careful. </span><span class="koboSpan" id="kobo.596.3">Also, the archived channels can be very large and are normally not needed for most sites, as they contain older releases. </span><span class="koboSpan" id="kobo.596.4">Expect multiple terabytes of disk space if you start using these </span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">channels locally.</span></span></p>
<ol>
<li value="16"><span class="koboSpan" id="kobo.598.1">Make </span><a id="_idIndexMarker428"/><span class="koboSpan" id="kobo.599.1">sure you </span><a id="_idIndexMarker429"/><span class="koboSpan" id="kobo.600.1">see the </span><strong class="bold"><span class="koboSpan" id="kobo.601.1">Subscriptions </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.602.1">saved</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.603.1"> message:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer139">
<span class="koboSpan" id="kobo.604.1"><img alt="Figure 5.24 – Saving the config" src="image/B18349_05_24.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.605.1">Figure 5.24 – Saving the config</span></p>
<p><span class="koboSpan" id="kobo.606.1">Now, we</span><a id="_idIndexMarker430"/><span class="koboSpan" id="kobo.607.1"> finally have that local</span><a id="_idIndexMarker431"/><span class="koboSpan" id="kobo.608.1"> repo set. </span><span class="koboSpan" id="kobo.608.2">Next up is to run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.609.1">uln-yum-mirror</span></strong><span class="koboSpan" id="kobo.610.1"> command as root, and the repo will start to sync. </span><span class="koboSpan" id="kobo.610.2">This process can take several hours, depending on your internet speed and how many channels you are subscribed to. </span><span class="koboSpan" id="kobo.610.3">The system will also run daily automatically, keeping your local </span><span class="No-Break"><span class="koboSpan" id="kobo.611.1">copy current.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.612.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.613.1">When doing your first sync, watch your disk space closely. </span><span class="koboSpan" id="kobo.613.2">You may need to add more space quickly the first time. </span><span class="koboSpan" id="kobo.613.3">If this happens, add the space, and manually restart the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.614.1">uln-yum-mirror</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.615.1"> command.</span></span></p>
<p><span class="koboSpan" id="kobo.616.1">When you finish a manual run, the script will let you know how much data was copied for </span><span class="No-Break"><span class="koboSpan" id="kobo.617.1">each repo:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer140">
<span class="koboSpan" id="kobo.618.1"><img alt="Figure 5.25 – Completed mirror" src="image/B18349_05_25.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.619.1">Figure 5.25 – Completed mirror</span></p>
<p><span class="koboSpan" id="kobo.620.1">Once </span><a id="_idIndexMarker432"/><span class="koboSpan" id="kobo.621.1">configured, the </span><a id="_idIndexMarker433"/><span class="koboSpan" id="kobo.622.1">system will automatically synchronize your local repository with ULN. </span><span class="koboSpan" id="kobo.622.2">As you add new channels, they will automatically be downloaded when the </span><strong class="source-inline"><span class="koboSpan" id="kobo.623.1">cron</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.624.1">job runs.</span></span></p>
<h1 id="_idParaDest-128"><a id="_idTextAnchor149"/><span class="koboSpan" id="kobo.625.1">Creating a new RPM package</span></h1>
<p><span class="koboSpan" id="kobo.626.1">While Oracle provides a </span><a id="_idIndexMarker434"/><span class="koboSpan" id="kobo.627.1">large number of RPMs, sometimes you just need to create a custom RPM package that allows you to easily deploy your own software. </span><span class="koboSpan" id="kobo.627.2">Creating an RPM file is easy </span><span class="No-Break"><span class="koboSpan" id="kobo.628.1">to do!</span></span></p>
<h2 id="_idParaDest-129"><a id="_idTextAnchor150"/><span class="koboSpan" id="kobo.629.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.630.1">To do this, you will need a development</span><a id="_idIndexMarker435"/><span class="koboSpan" id="kobo.631.1"> system, running Oracle Linux 8, with access to the </span><strong class="bold"><span class="koboSpan" id="kobo.632.1">Extra Packages for Enterprise Linux</span></strong><span class="koboSpan" id="kobo.633.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.634.1">EPEL</span></strong><span class="koboSpan" id="kobo.635.1">) channel. </span><span class="koboSpan" id="kobo.635.2">It is highly recommended to have a dedicated system to build RPMs on, and to not build RPMs on production systems. </span><span class="koboSpan" id="kobo.635.3">You will also need a system to test installing the </span><span class="No-Break"><span class="koboSpan" id="kobo.636.1">RPM on.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.637.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.638.1">Depending on the package being built, you may need additional channels, such as CodeReady or </span><span class="No-Break"><span class="koboSpan" id="kobo.639.1">Distro Builder.</span></span></p>
<p><span class="koboSpan" id="kobo.640.1">There are a few things we need to do first – mainly, installing the RPM developer tools. </span><span class="koboSpan" id="kobo.640.2">In order to do this, we also need to add the EPEL repo to </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">the system.</span></span></p>
<p><span class="koboSpan" id="kobo.642.1">While most of the recipes in this book use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.643.1">root</span></strong><span class="koboSpan" id="kobo.644.1"> user for most of the work, this recipe will only use root for the installation of the software. </span><span class="koboSpan" id="kobo.644.2">Perform the next few steps </span><span class="No-Break"><span class="koboSpan" id="kobo.645.1">as </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.646.1">root</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.647.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.648.1">To add the EPEL repo, run the </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.650.1">
dnf install oracle-epel-release-el8</span></pre> <p><span class="koboSpan" id="kobo.651.1">Next, run the following commands to enable EPEL and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.652.1">codeready</span></strong><span class="koboSpan" id="kobo.653.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.654.1">distro_builder</span></strong><span class="koboSpan" id="kobo.655.1"> repos. </span><span class="koboSpan" id="kobo.655.2">Having all of these on your build system will make it easier down the road to take advantage of more advanced build tools such </span><span class="No-Break"><span class="koboSpan" id="kobo.656.1">as Mock:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.657.1">
dnf config-manager --enable ol8_developer_EPEL
dnf config-manager --enable ol8_codeready_builder
dnf config-manager --enable ol8_distro_builder</span></pre> <p><span class="koboSpan" id="kobo.658.1">Next, we will install the basic utilities to build </span><strong class="source-inline"><span class="koboSpan" id="kobo.659.1">rpm</span></strong><span class="koboSpan" id="kobo.660.1"> files. </span><span class="koboSpan" id="kobo.660.2">Run the following command to </span><span class="No-Break"><span class="koboSpan" id="kobo.661.1">install these:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.662.1">
dnf install -y rpm-build yum-utils rpmdevtools</span></pre> <p><span class="koboSpan" id="kobo.663.1">If you are pulling software</span><a id="_idIndexMarker436"/><span class="koboSpan" id="kobo.664.1"> from Git, you may need to install </span><strong class="source-inline"><span class="koboSpan" id="kobo.665.1">git</span></strong><span class="koboSpan" id="kobo.666.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.667.1">git-lfs</span></strong><span class="koboSpan" id="kobo.668.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.669.1">Git Large File Storage</span></strong><span class="koboSpan" id="kobo.670.1">) software. </span><span class="koboSpan" id="kobo.670.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.671.1">gcc</span></strong><span class="koboSpan" id="kobo.672.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.673.1">make</span></strong><span class="koboSpan" id="kobo.674.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.675.1">python3-service-identity</span></strong><span class="koboSpan" id="kobo.676.1"> RPMs are </span><a id="_idIndexMarker437"/><span class="koboSpan" id="kobo.677.1">also common. </span><span class="koboSpan" id="kobo.677.2">You can install all of these with the </span><span class="No-Break"><span class="koboSpan" id="kobo.678.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.679.1">
dnf install -y git git-lfs make gcc python3-service-identity</span></pre> <h2 id="_idParaDest-130"><a id="_idTextAnchor151"/><span class="koboSpan" id="kobo.680.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.681.1">Now that we have all the tools installed, switch to your </span><span class="No-Break"><span class="koboSpan" id="kobo.682.1">non-root user:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.683.1">Make a directory for the RPM. </span><span class="koboSpan" id="kobo.683.2">Here, we will have a source file for the software, plus all of the files and directories required to make it an RPM. </span><span class="koboSpan" id="kobo.683.3">In my case, I am putting everything </span><span class="No-Break"><span class="koboSpan" id="kobo.684.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.685.1">/home/erik/</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.686.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.687.1">Next, we need to make the RPM directory tree. </span><span class="koboSpan" id="kobo.687.2">This is done by running the </span><strong class="source-inline"><span class="koboSpan" id="kobo.688.1">rpmdev-setuptree</span></strong><span class="koboSpan" id="kobo.689.1"> command. </span><span class="koboSpan" id="kobo.689.2">Once you run the command, the tree is created in your </span><strong class="source-inline"><span class="koboSpan" id="kobo.690.1">$HOME</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.691.1">under </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.692.1">rpmbuild</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.693.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer141">
<span class="koboSpan" id="kobo.694.1"><img alt="Figure 5.26 – The rpmbuild directories" src="image/B18349_05_26.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.695.1">Figure 5.26 – The rpmbuild directories</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.696.1">Five </span><a id="_idIndexMarker438"/><span class="koboSpan" id="kobo.697.1">directories are also built, each with a </span><span class="No-Break"><span class="koboSpan" id="kobo.698.1">specific purpose:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.699.1">BUILD</span></strong><span class="koboSpan" id="kobo.700.1">: This is where binaries are saved after </span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">being compiled.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.702.1">RPMS</span></strong><span class="koboSpan" id="kobo.703.1">: RPMs are created here, with </span><strong class="source-inline"><span class="koboSpan" id="kobo.704.1">rpm</span></strong><span class="koboSpan" id="kobo.705.1"> files ready for use. </span><span class="koboSpan" id="kobo.705.2">There will be subdirectories for different </span><span class="No-Break"><span class="koboSpan" id="kobo.706.1">CPU architectures.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.707.1">SOURCES</span></strong><span class="koboSpan" id="kobo.708.1">: This is where the source code is put, usually a </span><span class="No-Break"><span class="koboSpan" id="kobo.709.1">tar file.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.710.1">SPECS</span></strong><span class="koboSpan" id="kobo.711.1">: This is where the </span><strong class="source-inline"><span class="koboSpan" id="kobo.712.1">.spec</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.713.1">files live.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.714.1">SRPMS</span></strong><span class="koboSpan" id="kobo.715.1">: Source RPMs are built here – usually, packages containing the source code for </span><span class="No-Break"><span class="koboSpan" id="kobo.716.1">the software.</span></span></li>
</ul>
<ol>
<li value="3"><span class="koboSpan" id="kobo.717.1">Create a simple Bash shell script to distribute as an RPM. </span><span class="koboSpan" id="kobo.717.2">This will live in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.718.1">xyzzy</span></strong><span class="koboSpan" id="kobo.719.1"> directory in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.720.1">rpmbuild</span></strong><span class="koboSpan" id="kobo.721.1"> directory. </span><span class="koboSpan" id="kobo.721.2">A simpl</span><a id="_idTextAnchor152"/><span class="koboSpan" id="kobo.722.1">e Bash script is </span><span class="No-Break"><span class="koboSpan" id="kobo.723.1">also created:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer142">
<span class="koboSpan" id="kobo.724.1"><img alt="Figure 5.27 – The xyzzy.sh script" src="image/B18349_05_27.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.725.1">Figure 5.27 – The xyzzy.sh script</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.726.1">Next, create a compressed tar file with the contents of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.727.1">xyzzy</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.728.1"> directory:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.729.1">[erik@ol8 rpmbuild]$ tar -cvf SOURCES/xyzzy-1.0.tar.gz xyzzy</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.730.1">xyzzy/</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.731.1">xyzzy/xyzzy.sh</span></strong></pre></li> <li><span class="koboSpan" id="kobo.732.1">Now that we have our simple shell script, we need to create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.733.1">.spec</span></strong><span class="koboSpan" id="kobo.734.1"> file. </span><span class="koboSpan" id="kobo.734.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.735.1">.spec</span></strong><span class="koboSpan" id="kobo.736.1"> file contains the name of the program, a description of the program, licensing information, project URL, build architecture, and more. </span><span class="koboSpan" id="kobo.736.2">The following command will create a default </span><strong class="source-inline"><span class="koboSpan" id="kobo.737.1">.spec</span></strong><span class="koboSpan" id="kobo.738.1"> file in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.739.1">SPECS</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.740.1"> directory:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.741.1">rpmdev-newspec SPECS/xyzzy.spec</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.742.1">The </span><a id="_idIndexMarker439"/><span class="koboSpan" id="kobo.743.1">skeleton is very sparse and will need </span><span class="No-Break"><span class="koboSpan" id="kobo.744.1">information added.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.745.1">The sampl</span><a id="_idTextAnchor153"/><span class="koboSpan" id="kobo.746.1">e skeleton is seen </span><span class="No-Break"><span class="koboSpan" id="kobo.747.1">as follows:</span></span></p></li> </ol>
<div>
<div class="IMG---Figure" id="_idContainer143">
<span class="koboSpan" id="kobo.748.1"><img alt="Figure 5.28 – Basic .spec file" src="image/B18349_05_28.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.749.1">Figure 5.28 – Basic .spec file</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.750.1">Much</span><a id="_idIndexMarker440"/><span class="koboSpan" id="kobo.751.1"> has to be done to make </span><span class="No-Break"><span class="koboSpan" id="kobo.752.1">this functional.</span></span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.753.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.754.1">Version</span></strong><span class="koboSpan" id="kobo.755.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.756.1">Summary</span></strong><span class="koboSpan" id="kobo.757.1"> sections need to be filled in, as well as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.758.1">License</span></strong><span class="koboSpan" id="kobo.759.1"> details and a URL for the project. </span><span class="koboSpan" id="kobo.759.2">Additionally, set the build architecture to </span><strong class="source-inline"><span class="koboSpan" id="kobo.760.1">noarch</span></strong><span class="koboSpan" id="kobo.761.1">, as this will install on both ARM and X64 systems. </span><span class="koboSpan" id="kobo.761.2">It is important to make sure</span><a id="_idIndexMarker441"/><span class="koboSpan" id="kobo.762.1"> that you include the </span><strong class="bold"><span class="koboSpan" id="kobo.763.1">Name, Epoch, Version, Release, and Architecture</span></strong><span class="koboSpan" id="kobo.764.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.765.1">NEVRA</span></strong><span class="koboSpan" id="kobo.766.1">) information. </span><span class="koboSpan" id="kobo.766.2">This is used to help make sure the correct RPMs are installed on </span><span class="No-Break"><span class="koboSpan" id="kobo.767.1">the system.</span></span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.768.1">A description is set, and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">%install</span></strong><span class="koboSpan" id="kobo.770.1"> section is updated to reflect the script being installed in the normal </span><span class="No-Break"><span class="koboSpan" id="kobo.771.1">binary directory.</span></span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.772.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.773.1">%files</span></strong><span class="koboSpan" id="kobo.774.1"> section shows that </span><strong class="source-inline"><span class="koboSpan" id="kobo.775.1">/usr/bin/xyzzy.sh</span></strong><span class="koboSpan" id="kobo.776.1"> because all </span><strong class="source-inline"><span class="koboSpan" id="kobo.777.1">.sh</span></strong><span class="koboSpan" id="kobo.778.1"> files are added to the installer. </span><span class="koboSpan" id="kobo.778.2">Unused sections are </span><span class="No-Break"><span class="koboSpan" id="kobo.779.1">also removed.</span></span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.780.1">The final </span><a id="_idIndexMarker442"/><span class="koboSpan" id="kobo.781.1">result is </span><span class="No-Break"><span class="koboSpan" id="kobo.782.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer144">
<span class="koboSpan" id="kobo.783.1"><img alt="Figure 5.29 – Finished .spec file" src="image/B18349_05_29.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.784.1">Figure 5.29 – Finished .spec file</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.785.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.786.1">rpm</span></strong><span class="koboSpan" id="kobo.787.1"> file will be built using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.788.1">rpmbuild</span></strong><span class="koboSpan" id="kobo.789.1"> command, passing it the location of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.790.1">.spec</span></strong><span class="koboSpan" id="kobo.791.1"> file. </span><span class="koboSpan" id="kobo.791.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.792.1">rpmbuild -bb -v SPECS/xyzzy.spec</span></strong><span class="koboSpan" id="kobo.793.1"> command is used, with the </span><span class="No-Break"><span class="koboSpan" id="kobo.794.1">following output:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer145">
<span class="koboSpan" id="kobo.795.1"><img alt="Figure 5.30 – The output of rpmbuild" src="image/B18349_05_30.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.796.1">Figure 5.30 – The output of rpmbuild</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.797.1">The </span><a id="_idIndexMarker443"/><span class="koboSpan" id="kobo.798.1">RPM file is now in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.799.1">RPMS</span></strong><span class="koboSpan" id="kobo.800.1"> directory, under the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.801.1">noarch</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.802.1"> directory:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer146">
<span class="koboSpan" id="kobo.803.1"><img alt="Figure 5.31 – The RPM file" src="image/B18349_05_31.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.804.1">Figure 5.31 – The RPM file</span></p>
<p class="list-inset"><span class="koboSpan" id="kobo.805.1">This RPM file can now be copied over to systems to be manually installed, or it can be added to a </span><span class="No-Break"><span class="koboSpan" id="kobo.806.1">YUM repo.</span></span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.807.1">Once </span><a id="_idIndexMarker444"/><span class="koboSpan" id="kobo.808.1">installed, you can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.809.1">rpm -qi xyzzy-1.0</span></strong><span class="koboSpan" id="kobo.810.1"> command to see the details from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.811.1">.spec</span></strong><span class="koboSpan" id="kobo.812.1"> file for license, description, and </span><span class="No-Break"><span class="koboSpan" id="kobo.813.1">so on:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer147">
<span class="koboSpan" id="kobo.814.1"><img alt="Figure 5.32 – RPM file details" src="image/B18349_05_32.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.815.1">Figure 5.32 – RPM file details</span></p>
<p><span class="koboSpan" id="kobo.816.1">The RPM tool allows you to easily build custom RPM files for distribution. </span><span class="koboSpan" id="kobo.816.2">This is driven by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.817.1">.spec</span></strong><span class="koboSpan" id="kobo.818.1"> file, which contains all the dependencies, descriptions, file locations, and even build info to create the </span><span class="No-Break"><span class="koboSpan" id="kobo.819.1">RPM file.</span></span></p>
</div>
</body></html>