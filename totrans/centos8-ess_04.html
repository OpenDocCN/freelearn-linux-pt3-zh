<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer047" class="_idGenObjectStyleOverride-1">&#13;
			<p id="_idParaDest-34" class="Chapter-Title" lang="en-US" xml:lang="en-US"><span class="ChapterMarker">5. </span><a id="_idTextAnchor056"/>Allocating Windows Disk Partitions to CentOS 8</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">In the previous chapter we looked at how to install CentOS 8 on the same disk as Windows. This so called “<a id="_idIndexMarker061"/>dual boot” configuration allows the user to have both operating systems installed on a single disk drive with the option to boot one or the other when the system is powered on. </p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">This chapter is intended for users who have decided they like CentOS 8 enough to delete Windows entirely from the disk, and use the resulting space for Linux. In the following sections we will work through this process step by step.</p>&#13;
			<p id="_idParaDest-35" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">5.1 </span><a id="_idTextAnchor057"/>Unmounting the <a id="_idIndexMarker062"/><a id="_idIndexMarker063"/>Windows Partition</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">If the steps in the <a href="../Text/Installation_Dual_Boot.xhtml#_idTextAnchor046"><span class="My-Italic _idGenCharOverride-1">“Dual Booting CentOS 8 with Windows”</span></a> chapter were followed to mount the Windows partition from within CentOS 8, steps should be taken to unmount the partition before continuing with this chapter. Assuming that the Windows partition was mounted as <span class="My-Italic _idGenCharOverride-1">/mnt/windows</span>, it can be unmounted as follows:</p>&#13;
			<p class="Code"># umount /mnt/windows</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">The <a id="_idIndexMarker064"/><span class="My-Italic _idGenCharOverride-1">/etc/fstab</span> file should also be edited to remove the<span class="My-Italic _idGenCharOverride-1"> /mnt/windows</span> auto-mount if it was previously added.</p>&#13;
			<p id="_idParaDest-36" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">5.2 </span><a id="_idTextAnchor058"/>Deleting the Windows Partitions from the Disk </p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">The first step in freeing up the Windows partition for use by CentOS is to delete that partition. Before doing so, however, it is imperative that any data you need to keep is backed up from both the Windows and CentOS partitions. Having done that, it is safe to proceed with this chapter. </p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">In order to remove the Windows partitions we first need to identify the disk on which they reside using the <a id="_idIndexMarker065"/><span class="My-Italic _idGenCharOverride-1">fdisk</span> tool:</p>&#13;
			<p class="Code"># fdisk -l</p>&#13;
			<p class="Code">Disk /dev/sda: 50 GiB, 53687091200 bytes, 104857600 sectors</p>&#13;
			<p class="Code">Units: sectors of 1 * 512 = 512 bytes</p>&#13;
			<p class="Code">Sector size (logical/physical): 512 bytes / 512 bytes</p>&#13;
			<p class="Code">I/O size (minimum/optimal): 512 bytes / 512 bytes</p>&#13;
			<p class="Code">Disklabel type: dos</p>&#13;
			<p class="Code">Disk identifier: 0xe3673009</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Device     Boot    Start       End  Sectors  Size Id Type</p>&#13;
			<p class="Code">/dev/sda1  *        2048   1126399  1124352  549M  7 HPFS/NTFS/exFAT</p>&#13;
			<p class="Code">/dev/sda2        1126400  53655551 52529152   25G  7 HPFS/NTFS/exFAT</p>&#13;
			<p class="Code">/dev/sda3       53655552  55752703  2097152    1G 83 Linux</p>&#13;
			<p class="Code">/dev/sda4       55752704 104857599 49104896 23.4G  5 Extended</p>&#13;
			<p class="Code">/dev/sda5       55754752 104857599 49102848 23.4G 8e Linux LVM</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">In the above example output the system contains one physical disk drive referenced by device name <span class="My-Italic _idGenCharOverride-1">/dev/sda</span>. On that disk drive are five partitions accessed via the device names <span class="My-Italic _idGenCharOverride-1">/dev/sda1</span> through <span class="My-Italic _idGenCharOverride-1">/dev/sda5</span> respectively. Based on the values in the System column, there are two NTFS partitions. The first is the Windows system partition while the second, much larger, <a id="_idIndexMarker066"/>NTFS partition is the Windows boot partition containing the Windows operating system and user data. </p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">To remove the partitions, start the <span class="My-Italic _idGenCharOverride-1">fdisk</span> tool using the device name of the disk containing the partition (<span class="My-Italic _idGenCharOverride-1">/dev/sda </span>in this instance) and follow the instructions to once again display the partition and sector information:</p>&#13;
			<p class="Code"># fdisk /dev/sda</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Welcome to fdisk (util-linux 2.32.1).</p>&#13;
			<p class="Code">Changes will remain in memory only, until you decide to write them.</p>&#13;
			<p class="Code">Be careful before using the write command.</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Command (m for help): p</p>&#13;
			<p class="Code">Disk /dev/sda: 50 GiB, 53687091200 bytes, 104857600 sectors</p>&#13;
			<p class="Code">Units: sectors of 1 * 512 = 512 bytes</p>&#13;
			<p class="Code">Sector size (logical/physical): 512 bytes / 512 bytes</p>&#13;
			<p class="Code">I/O size (minimum/optimal): 512 bytes / 512 bytes</p>&#13;
			<p class="Code">Disklabel type: dos</p>&#13;
			<p class="Code">Disk identifier: 0xe3673009</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Device     Boot    Start       End  Sectors  Size Id Type</p>&#13;
			<p class="Code">/dev/sda1  *        2048   1126399  1124352  549M  7 HPFS/NTFS/exFAT</p>&#13;
			<p class="Code">/dev/sda2        1126400  53655551 52529152   25G  7 HPFS/NTFS/exFAT</p>&#13;
			<p class="Code">/dev/sda3       53655552  55752703  2097152    1G 83 Linux</p>&#13;
			<p class="Code">/dev/sda4       55752704 104857599 49104896 23.4G  5 Extended</p>&#13;
			<p class="Code">/dev/sda5       55754752 104857599 49102848 23.4G 8e Linux LVM</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Command (m for help):</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Currently, the <a id="_idIndexMarker067"/>Windows system partition is listed as being the bootable partition. Since we will be deleting this partition, the Linux boot partition needs to be marked as bootable. In the above configuration, this is represented by <span class="My-Italic _idGenCharOverride-1">/dev/sda3</span>. Remaining within the<span class="My-Italic _idGenCharOverride-1"> fdisk</span> tool, make this the bootable partition as follows:</p>&#13;
			<p class="Code">Command (m for help): a</p>&#13;
			<p class="Code">Partition number (1,3-5, default 5): 3</p>&#13;
			<p class="Code">The bootable flag on partition 3 is enabled now.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Before proceeding, make a note of the start and end addresses of the partitions we will be deleting (in other words the start of <span class="My-Italic _idGenCharOverride-1">/dev/sda1</span> and the end of <span class="My-Italic _idGenCharOverride-1">/dev/sda2</span>).</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">At the command prompt, delete the Windows partitions (these being partitions 1 and 2 on our example system):</p>&#13;
			<p class="Code">Command (m for help): d</p>&#13;
			<p class="Code">Partition number (1-5, default 5): 1</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Partition 1 has been deleted.</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Command (m for help): d </p>&#13;
			<p class="Code">Partition number (2-5, default 5): 2</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Partition 2 has been deleted.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Now that we have deleted the Windows partitions we need to create the new CentOS partition in the vacated disk space. The partition number must match the number of the partition removed (in this case 1) and is going to be a primary partition. It will also be necessary to enter the Start and End sectors of the partition exactly as reported for the old partition (<span class="My-Italic _idGenCharOverride-1">fdisk</span> will typically offer the correct values by default, though it is wise to double check). If you are prompted to remove the NTFS signature, enter Y:</p>&#13;
			<p class="Code">Command (m for help): n</p>&#13;
			<p class="Code">Partition type</p>&#13;
			<p class="Code">   p   primary (1 primary, 1 extended, 2 free)</p>&#13;
			<p class="Code">   l   logical (numbered from 5)</p>&#13;
			<p class="Code">Select (default p): p</p>&#13;
			<p class="Code">Partition number (1,2, default 1): 1</p>&#13;
			<p class="Code">First sector (2048-104857599, default 2048): </p>&#13;
			<p class="Code">Last sector, +sectors or +size{K,M,G,T,P} (2048-53655551, default 53655551): </p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Created a new partition 1 of type 'Linux' and of size 25.6 GiB.</p>&#13;
			<p class="Code">Partition #1 contains a ntfs signature.</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Do you want to remove the signature? [Y]es/[N]o: y</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">The signature will be removed by a write command.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Having made these changes the next step is to check that the settings are correct (taking this opportunity to double check that the Linux boot partition is bootable):</p>&#13;
			<p class="Code">Command (m for help): p</p>&#13;
			<p class="Code">Disk /dev/sda: 50 GiB, 53687091200 bytes, 104857600 sectors</p>&#13;
			<p class="Code">Units: sectors of 1 * 512 = 512 bytes</p>&#13;
			<p class="Code">Sector size (logical/physical): 512 bytes / 512 bytes</p>&#13;
			<p class="Code">I/O size (minimum/optimal): 512 bytes / 512 bytes</p>&#13;
			<p class="Code">Disklabel type: dos</p>&#13;
			<p class="Code">Disk identifier: 0xe3673009</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Device     Boot    Start       End  Sectors  Size Id Type</p>&#13;
			<p class="Code">/dev/sda1           2048  53655551 53653504 25.6G 83 Linux</p>&#13;
			<p class="Code">/dev/sda3  *    53655552  55752703  2097152    1G 83 Linux</p>&#13;
			<p class="Code">/dev/sda4       55752704 104857599 49104896 23.4G  5 Extended</p>&#13;
			<p class="Code">/dev/sda5       55754752 104857599 49102848 23.4G 8e Linux LVM</p>&#13;
			<p class="Code"> </p>&#13;
			<p class="Code">Filesystem/RAID signature on partition 1 will be wiped.</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">To commit the changes we now need to write the new partition information to disk and quit from the <span class="My-Italic _idGenCharOverride-1">fdisk</span> tool:</p>&#13;
			<p class="Code">Command (m for help): w</p>&#13;
			<p class="Code">The partition table has been altered.</p>&#13;
			<p class="Code">Syncing disks.</p>&#13;
			<p id="_idParaDest-37" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">5.3 </span><a id="_idTextAnchor059"/>Formatting the Unallocated <a id="_idIndexMarker068"/>Disk Partition </p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">In order to make the new partition suitable for use by CentOS 8, it needs to have a file system created on it. The default file system type for the current release of CentOS is XFS and will be covered in greater detail in the chapter entitled <a href="../Text/Adding_New_DIsk.xhtml#_idTextAnchor363"><span class="My-Italic _idGenCharOverride-1">“Adding a New Disk Drive to a CentOS 8 System”</span></a>. Creation of the file system is performed using the <a id="_idIndexMarker069"/><span class="My-Italic _idGenCharOverride-1">mkfs.xfs</span> command as follows:</p>&#13;
			<p class="Code"># mkfs.xfs -f /dev/sda1</p>&#13;
			<p class="Code">meta-data=/dev/sda1              isize=512    agcount=4, agsize=1676672 blks</p>&#13;
			<p class="Code">         =                       sectsz=512   attr=2, projid32bit=1</p>&#13;
			<p class="Code">         =                       crc=1        finobt=1, sparse=1, rmapbt=0</p>&#13;
			<p class="Code">         =                       reflink=1</p>&#13;
			<p class="Code">data     =                       bsize=4096   blocks=6706688, imaxpct=25</p>&#13;
			<p class="Code">         =                       sunit=0      swidth=0 blks</p>&#13;
			<p class="Code">naming   =version 2              bsize=4096   ascii-ci=0, ftype=1</p>&#13;
			<p class="Code">log      =internal log           bsize=4096   blocks=3274, version=2</p>&#13;
			<p class="Code">         =                       sectsz=512   sunit=0 blks, lazy-count=1</p>&#13;
			<p class="Code">realtime =none                   extsz=4096   blocks=0, rtextents=0</p>&#13;
			<p id="_idParaDest-38" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">5.4 </span><a id="_idTextAnchor060"/>Mounting the New <a id="_idIndexMarker070"/>Partition </p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Next, we need to mount the new partition. In this example we will mount it in a directory named <span class="My-Italic _idGenCharOverride-1">/data</span>. You are free, however, to mount the new partition using any valid mount point you desire or to use it as part of a logical volume (details of which are covered in the chapter entitled <a href="../Text/Volume_Groups.xhtml#_idTextAnchor375"><span class="My-Italic _idGenCharOverride-1">“Adding a New Disk to a CentOS 8 Volume Group and Logical Volume”</span></a>). First we need to create the directory to act as the mount point: </p>&#13;
			<p class="Code"># mkdir /data</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Secondly, we need to edit the mount table in <span class="My-Italic _idGenCharOverride-1">/etc/fstab</span> so that the partition is automatically mounted each time the system starts. At the bottom of the <span class="My-Italic _idGenCharOverride-1">/etc/fstab</span> file, add the following line to mount the new partition (modifying the <span class="My-Italic _idGenCharOverride-1">/dev/sda1</span> device to match your environment): </p>&#13;
			<p class="Code">/dev/sda1 /data xfs  defaults 0 0</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Finally, we can manually mount the new partition (note that on subsequent reboots this will not be necessary as the partition will automount as a result of the setting we added to the /<span class="My-Italic _idGenCharOverride-1">etc/fstab</span> file above). </p>&#13;
			<p class="Code"># mount /data</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">To check the partition, run the following command to display the available space: </p>&#13;
			<p class="Code"># df -h /data</p>&#13;
			<p class="Code">Filesystem      Size  Used Avail Use% Mounted on</p>&#13;
			<p class="Code">/dev/sda1        26G  215M   26G   1% /data</p>&#13;
			<p id="_idParaDest-39" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">5.5 </span><a id="_idTextAnchor061"/>Editing the <a id="_idIndexMarker071"/>Boot Menu</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">The next step is to modify the CentOS boot menu. Since this was originally a dual boot system, the menu is configured to provide the option of booting either Windows or CentOS. Now that the Windows partition is gone, we need to remove this boot option. Start by editing the <span class="My-Italic _idGenCharOverride-1">/etc/grub.d/40_custom</span> file and removing the Windows menu entry:</p>&#13;
			<p class="Code">#!/bin/sh</p>&#13;
			<p class="Code">exec tail -n +3 $0</p>&#13;
			<p class="Code"># This file provides an easy way to add custom menu entries.  Simply type the</p>&#13;
			<p class="Code"># menu entries you want to add after this comment.  Be careful not to change</p>&#13;
			<p class="Code"># the 'exec tail' line above.</p>&#13;
			<p class="Code"><span class="My-Strikethrough">menuentry "Windows 10" {</span></p>&#13;
			<p class="Code"><span class="My-Strikethrough">         set root=(hd0,1)</span></p>&#13;
			<p class="Code"><span class="My-Strikethrough">         chainloader +1</span></p>&#13;
			<p class="Code"><span class="My-Strikethrough">         }</span></p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Save the file and use the <span class="My-Italic _idGenCharOverride-1">grub2-mkconfig</span> tool to generate the <span class="My-Italic _idGenCharOverride-1">/boot/grub2/grub.cfg</span> file as follows:</p>&#13;
			<p class="Code"># grub2-mkconfig --output=/boot/grub2/grub.cfg</p>&#13;
			<p class="Code">Generating grub configuration file ...</p>&#13;
			<p class="Code">done</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">Next time the system restarts, the Windows 10 option will no longer be provided by the boot menu.</p>&#13;
			<p id="_idParaDest-40" class="Heading-1-1" lang="en-US" xml:lang="en-US"><span class="Heading11Marker">5.6 </span><a id="_idTextAnchor062"/>Summary</p>&#13;
			<p class="My-Basic-Paragraph" lang="en-US" xml:lang="en-US">The Windows partitions in a dual boot configuration can be removed at any time to free up space for a CentOS system by identifying which partitions belong to Windows and then deleting them using the <span class="My-Italic _idGenCharOverride-1">fdisk</span> tool. Once deleted, the unallocated space can be used to create a new filesystem and mounted to make it available to the CentOS system. The final task is to remove the Windows option from the boot menu configuration. </p>&#13;
		</div>&#13;
</div>



  </body></html>