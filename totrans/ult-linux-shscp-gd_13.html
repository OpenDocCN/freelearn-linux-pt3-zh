<html><head></head><body>
  <div id="_idContainer178" class="Basic-Text-Frame">
    <h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">13</span></h1>
    <h1 id="_idParaDest-290" class="chapterTitle"><span class="koboSpan" id="kobo.2.1">Scripting with ImageMagick</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.3.1">ImageMagick is an awesome package of graphics manipulation tools. </span><span class="koboSpan" id="kobo.3.2">You can use these tools to perform many of the same jobs that you’d perform with GUI-type tools such as The GIMP and Adobe Photoshop. </span><span class="koboSpan" id="kobo.3.3">But, the ImageMagick tools are command-line tools, which allows you to use them in scripts in order to automate many types of jobs. </span><span class="koboSpan" id="kobo.3.4">These scripts can either be normal shell scripts, or scripts that use the ImageMagick scripting environment.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.4.1">Topics in this chapter include:</span></p>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.5.1">Converting non-standard filename extensions</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.6.1">Installing ImageMagick</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.7.1">Displaying images</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.8.1">Viewing image properties</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.9.1">Resizing and customizing images</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.10.1">Batch-processing image files</span></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.11.1">Using Fred’s ImageMagick scripts</span></li>
    </ul>
    <p class="normal"><span class="koboSpan" id="kobo.12.1">If you’re ready, let’s get started.</span></p>
    <h1 id="_idParaDest-291" class="heading 1"><span class="koboSpan" id="kobo.13.1">Technical Requirements</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.14.1">For this chapter, I’m using a desktop implementation of Fedora, because it comes with the newest version of ImageMagick. </span><span class="koboSpan" id="kobo.14.2">Debian 12 comes with an older version, but the commands and techniques that I present here also work on it.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.15.1">Also, as always, you can download the scripts for this chapter by doing:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.16.1">git clone https://github.com/PacktPublishing/The-Ultimate-Linux-Shell-Scripting-Guide.git
</span></code></pre>
    <h1 id="_idParaDest-292" class="heading 1"><span class="koboSpan" id="kobo.17.1">Converting Non-standard Filename Extensions</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.18.1">Before I even get to ImageMagick, I need to address something that’s a bit of a bugaboo with me. </span><span class="koboSpan" id="kobo.18.2">It’s </span><a id="_idIndexMarker839"/><span class="koboSpan" id="kobo.19.1">that Linux and Unix operating systems are all case-sensitive, while other operating systems aren’t. </span><span class="koboSpan" id="kobo.19.2">So on Linux and Unix, </span><code class="inlineCode"><span class="koboSpan" id="kobo.20.1">somegraphic.png</span></code><span class="koboSpan" id="kobo.21.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.22.1">somegraphic.PNG</span></code><span class="koboSpan" id="kobo.23.1"> are two different files, while on Windows they both represent the same file. </span><span class="koboSpan" id="kobo.23.2">On Linux and Unix, it’s more proper to use lower-case letters in filename extensions. </span><span class="koboSpan" id="kobo.23.3">If you’re running a desktop implementation of either Linux or Unix, you might find that your GUI file manager won’t automatically open your graphics files in the graphics file viewer if the filename extensions for those files consist of upper-case letters. </span><span class="koboSpan" id="kobo.23.4">This wouldn’t be that big of a problem, except for the fact that certain Windows utilities and certain digital cameras always create graphics files with all upper-case letters in their filenames. </span><span class="koboSpan" id="kobo.23.5">Also, if you create a script to perform a batch operation on a whole directory full of images, having some filename extensions in upper-case letters and some in lower-case letters will mess you up. </span><span class="koboSpan" id="kobo.23.6">So, you’ll want to rename those files to match the Linux/Unix convention. </span><span class="koboSpan" id="kobo.23.7">If you have a whole directory full of files to convert, you’ll want to automate the process. </span><span class="koboSpan" id="kobo.23.8">So, check out this nifty </span><code class="inlineCode"><span class="koboSpan" id="kobo.24.1">rename_extension.sh</span></code><span class="koboSpan" id="kobo.25.1"> script that can help you out:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.26.1">#!/bin/bash
for file in *.JPG; do
        mv -- "$file" "${file%.JPG}.jpg"
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.27.1">As you see, this is just a simple </span><code class="inlineCode"><span class="koboSpan" id="kobo.28.1">for</span></code><span class="koboSpan" id="kobo.29.1"> loop that searches for all files in the current directory that have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.30.1">.JPG</span></code><span class="koboSpan" id="kobo.31.1"> filename extension. </span><span class="koboSpan" id="kobo.31.2">The real magic is performed by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.32.1">mv</span></code><span class="koboSpan" id="kobo.33.1"> command that’s within the loop. </span><span class="koboSpan" id="kobo.33.2">(Remember that </span><code class="inlineCode"><span class="koboSpan" id="kobo.34.1">mv</span></code><span class="koboSpan" id="kobo.35.1"> can be used to rename files and directories, as well as to move them to other locations.) The </span><code class="inlineCode"><span class="koboSpan" id="kobo.36.1">--</span></code><span class="koboSpan" id="kobo.37.1"> sequence marks the end of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.38.1">mv</span></code><span class="koboSpan" id="kobo.39.1"> options list, and prevents problems with any files with filenames that begin with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.40.1">-</span></code><span class="koboSpan" id="kobo.41.1">. </span><span class="koboSpan" id="kobo.41.2">At the end of the line, you see a variable expansion construct</span><a id="_idIndexMarker840"/><span class="koboSpan" id="kobo.42.1"> that replaces </span><code class="inlineCode"><span class="koboSpan" id="kobo.43.1">.JPG</span></code><span class="koboSpan" id="kobo.44.1"> with </span><code class="inlineCode"><span class="koboSpan" id="kobo.45.1">.jpg</span></code><span class="koboSpan" id="kobo.46.1"> for all filenames. </span><span class="koboSpan" id="kobo.46.2">And here, I need to add a word of caution.</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.47.1">Always be sure that your variable substitution constructs are built with a pair of curly braces, and not with a pair of parentheses. </span><span class="koboSpan" id="kobo.47.2">If you accidentally use parentheses instead of curly braces, the script will delete all of the files it finds, which probably isn’t what you want.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.48.1">Anyway, let’s test the script to see what happens. </span><span class="koboSpan" id="kobo.48.2">Here are the contents of my graphics directory before I run the script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.49.1">[donnie@fedora script_test]$ ls
rename_extension2.sh  S1180001.JPG  S1340001.JPG  S1340003.JPG
rename_extension.sh   S1180002.JPG  S1340002.JPG
[donnie@fedora script_test]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.50.1">Now, let’s run the script and then view the directory contents:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.51.1">[donnie@fedora script_test]$ ./rename_extension.sh
[donnie@fedora script_test]$ ls
rename_extension2.sh  S1180001.jpg  S1340001.jpg  S1340003.jpg
rename_extension.sh   S1180002.jpg  S1340002.jpg
[donnie@fedora script_test]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.52.1">If you don’t want to deal with variable expansion or if you’re using a shell that doesn’t support it, you can instead use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.53.1">basename</span></code><span class="koboSpan" id="kobo.54.1"> utility, as you see here in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.55.1">rename_extension2.sh</span></code><span class="koboSpan" id="kobo.56.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.57.1">#!/bin/bash
for file in *.JPG; do
        mv -- $file "$(basename -- "$file" .JPG).jpg"
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.58.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.59.1">basename</span></code><span class="koboSpan" id="kobo.60.1"> utility works by stripping the directory path from a filename and, if specified, the filename extension as well. </span><span class="koboSpan" id="kobo.60.2">Here’s how it works when I just want to strip away the directory path:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.61.1">[donnie@fedora ~]$ basename Pictures/script_test/rename_extension.sh
rename_extension.sh
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.62.1">And, here’s how it </span><a id="_idIndexMarker841"/><span class="koboSpan" id="kobo.63.1">works when I want to strip away both the directory path and the filename extension:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.64.1">[donnie@fedora ~]$ basename Pictures/script_test/rename_extension.sh .sh
rename_extension
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.65.1">Of course, this works with any filename extension, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.66.1">[donnie@fedora ~]$ basename Pictures/script_test/S1340001.JPG .JPG
S1340001
[donnie@fedora ~]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.67.1">For me, </span><code class="inlineCode"><span class="koboSpan" id="kobo.68.1">.JPG</span></code><span class="koboSpan" id="kobo.69.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.70.1">.MP4</span></code><span class="koboSpan" id="kobo.71.1"> files are the biggest problems, because my little Panasonic camcorder/camera saves its files with these naming formats. </span><span class="koboSpan" id="kobo.71.2">If you ever need to work with screenshots from a Windows machine, you’ll be working with </span><code class="inlineCode"><span class="koboSpan" id="kobo.72.1">.PNG</span></code><span class="koboSpan" id="kobo.73.1"> files. </span><span class="koboSpan" id="kobo.73.2">It’s an easy matter to adapt either of the two scripts that I’ve just shown you to convert any of these filename extensions to all lower-case letters.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.74.1">Now, with these preliminaries out of the way, let’s look at ImageMagick.</span></p>
    <h1 id="_idParaDest-293" class="heading 1"><span class="koboSpan" id="kobo.75.1">Installing ImageMagick</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.76.1">You’ll find ImageMagick in the repositories of OpenIndiana and pretty much every Linux distro. </span><span class="koboSpan" id="kobo.76.2">You’ll also find it in the repositories of FreeBSD and its desktop-oriented derivatives, such as GhostBSD and MidnightBSD. </span><span class="koboSpan" id="kobo.76.3">With only a couple of slight caveats, installation is quick and easy.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.77.1">The first caveat </span><a id="_idIndexMarker842"/><span class="koboSpan" id="kobo.78.1">concerns Debian. </span><span class="koboSpan" id="kobo.78.2">As you may already know, Debian tends to march to the beat of a different drummer, and is quite slow about getting up-to-date packages in its repositories. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.79.1">So, if you’re installing ImageMagick on Debian 12 or older, you’ll get the older ImageMagick 6, rather than the current ImageMagick 7. </span><span class="koboSpan" id="kobo.79.2">(You might get version 7 if you switch to either Debian Testing or Debian Unstable, but I haven’t confirmed that since I prefer to stick with the stable branch.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.80.1">The other caveat is that there’s no consistency in how the various distros name the ImageMagick package. </span><span class="koboSpan" id="kobo.80.2">For example, the package name is </span><code class="inlineCode"><span class="koboSpan" id="kobo.81.1">ImageMagick</span></code><span class="koboSpan" id="kobo.82.1"> on Fedora, </span><code class="inlineCode"><span class="koboSpan" id="kobo.83.1">imagemagick</span></code><span class="koboSpan" id="kobo.84.1"> on Debian, OpenIndiana, and Alpine Linux, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.85.1">ImageMagick7</span></code><span class="koboSpan" id="kobo.86.1"> on FreeBSD and its desktop derivatives. </span><span class="koboSpan" id="kobo.86.2">In all cases though, just install it using your distro’s normal package management tool.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.87.1">If you’re running either macOS or Windows, you’ll find directions on how to install ImageMagick on them at the official ImageMagick website. </span><span class="koboSpan" id="kobo.87.2">(You’ll find the link to the ImageMagick website in the </span><em class="chapterRef"><span class="koboSpan" id="kobo.88.1">Further Reading</span></em><span class="koboSpan" id="kobo.89.1"> section.)</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.90.1">Now that you have ImageMagick installed, let’s look at what we can do with it.</span></p>
    <h2 id="_idParaDest-294" class="heading 2"><span class="koboSpan" id="kobo.91.1">Displaying Images</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.92.1">To display an image, use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.93.1">display</span></code><span class="koboSpan" id="kobo.94.1"> command, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.95.1">donnie@fedora script_test]$ display S1180001.jpg
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.96.1">I know, you’re</span><a id="_idIndexMarker843"/><span class="koboSpan" id="kobo.97.1"> wondering why I’m devoting a whole section of this chapter to just tell you that. </span><span class="koboSpan" id="kobo.97.2">Hang on, though, because there’s more.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.98.1">Once you’ve opened the image, you can click either the right or the left mouse button to bring up a menu. </span><span class="koboSpan" id="kobo.98.2">The left mouse button brings up a menu that performs many of the image</span><a id="_idIndexMarker844"/><span class="koboSpan" id="kobo.99.1"> manipulation functions that you can do from the command-line. </span><span class="koboSpan" id="kobo.99.2">Here’s how it looks:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.100.1"><img src="../Images/B21693_13_01.png" alt=""/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.101.1">Figure 13.1: The ImageMagick left-click menu</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.102.1">The right-click menu is much simpler, as you see here:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.103.1"><img src="../Images/B21693_13_02.png" alt=""/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.104.1">Figure 13.2: The ImageMagick right-click menu</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.105.1">One thing you can </span><a id="_idIndexMarker845"/><span class="koboSpan" id="kobo.106.1">do with the right-click menu is to display information about the image, which will look something like this:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.107.1"><img src="../Images/B21693_13_03.png" alt=""/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.108.1">Figure 13.3: Displaying image information from the right-click menu</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.109.1">You can learn how to </span><a id="_idIndexMarker846"/><span class="koboSpan" id="kobo.110.1">use these menus by just playing around with them to see what everything does. </span><span class="koboSpan" id="kobo.110.2">But, as cool as all this is, it still doesn’t help us with shell scripting. </span><span class="koboSpan" id="kobo.110.3">So, we still need to see what we can do with ImageMagick from the command-line.</span></p>
    <h2 id="_idParaDest-295" class="heading 2"><span class="koboSpan" id="kobo.111.1">Viewing Image Properties</span></h2>
    <p class="normal"><span class="koboSpan" id="kobo.112.1">Use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.113.1">identify</span></code><span class="koboSpan" id="kobo.114.1"> command</span><a id="_idIndexMarker847"/><span class="koboSpan" id="kobo.115.1"> to view the properties of an image, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.116.1">[donnie@fedora script_test]$ identify S1180001.jpg
S1180001.jpg JPEG 3968x2232 3968x2232+0+0 8-bit sRGB 1.90756MiB 0.000u 0:00.000
[donnie@fedora script_test]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.117.1">To see more information, use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.118.1">-verbose</span></code><span class="koboSpan" id="kobo.119.1"> option, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.120.1">[donnie@fedora script_test]$ identify -verbose S1180001.jpg
Image:
  Filename: S1180001.jpg
  Permissions: rw-r--r--
  Format: JPEG (Joint Photographic Experts Group JFIF format)
  Mime type: image/jpeg
. </span><span class="koboSpan" id="kobo.120.2">. </span><span class="koboSpan" id="kobo.120.3">.
</span><span class="koboSpan" id="kobo.120.4">. </span><span class="koboSpan" id="kobo.120.5">. </span><span class="koboSpan" id="kobo.120.6">.
  </span><span class="koboSpan" id="kobo.120.7">Number pixels: 8.85658M
  Pixel cache type: Memory
  Pixels per second: 55.2201MP
  User time: 0.160u
  Elapsed time: 0:01.160
  Version: ImageMagick 7.1.1-15 Q16-HDRI x86_64 21298 https://imagemagick.org
[donnie@fedora script_test]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.121.1">One thing that we see</span><a id="_idIndexMarker848"/><span class="koboSpan" id="kobo.122.1"> about the above example is that it’s quite large, at 3968x2232 pixels and 1.90756MiB in size. </span><span class="koboSpan" id="kobo.122.2">I don’t need it to be that large, so let’s see about making it smaller.</span></p>
    <h1 id="_idParaDest-296" class="heading 1"><span class="koboSpan" id="kobo.123.1">Resizing and Customizing Images</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.124.1">Let’s say that I want to</span><a id="_idIndexMarker849"/><span class="koboSpan" id="kobo.125.1"> downsize my image to 1000x1000 pixels. </span><span class="koboSpan" id="kobo.125.2">I would </span><a id="_idIndexMarker850"/><span class="koboSpan" id="kobo.126.1">do it like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.127.1">[donnie@fedora script_test]$ convert -resize 1000x1000 S1180001.jpg S1180001_small.jpg
[donnie@fedora script_test]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.128.1">By default, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.129.1">convert</span></code><span class="koboSpan" id="kobo.130.1"> command maintains the original aspect ratio of the image. </span><span class="koboSpan" id="kobo.130.2">So, the size of my downsized image is actually 1000x563 pixels, as you see here:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.131.1">[donnie@fedora script_test]$ identify S1180001_small.jpg
S1180001_small.jpg JPEG 1000x563 1000x563+0+0 8-bit sRGB 328914B 0.000u 0:00.000
[donnie@fedora script_test]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.132.1">Instead of specifying the size by </span><a id="_idIndexMarker851"/><span class="koboSpan" id="kobo.133.1">pixels, you can specify the desired size in terms of a percentage of the </span><a id="_idIndexMarker852"/><span class="koboSpan" id="kobo.134.1">original size, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.135.1">[donnie@fedora script_test]$ convert -resize 20% S1180001.jpg S1180001_small2.jpg
[donnie@fedora script_test]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.136.1">Now when I display the image, it will actually fit on my computer screen. </span><span class="koboSpan" id="kobo.136.2">Here’s how it looks:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.137.1"><img src="../Images/B21693_13_04.png" alt="B21693_13_4"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.138.1">Figure 13.4: Goldie, sleeping in my bedroom window sill</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.139.1">You can apply a special effect to an image at the same time that you resize it. </span><span class="koboSpan" id="kobo.139.2">For example, let’s turn this picture of Goldie into a charcoal drawing, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.140.1">[donnie@fedora script_test]$ convert -resize 15% -charcoal 2 S1180001.jpg S1180001_charcoal.jpg
[donnie@fedora script_test]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.141.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.142.1">-charcoal</span></code><span class="koboSpan" id="kobo.143.1"> option requires you to specify a number to determine the strength of the effect. </span><span class="koboSpan" id="kobo.143.2">In this</span><a id="_idIndexMarker853"/><span class="koboSpan" id="kobo.144.1"> case I just used </span><code class="inlineCode"><span class="koboSpan" id="kobo.145.1">-charcoal 2</span></code><span class="koboSpan" id="kobo.146.1">, which gives</span><a id="_idIndexMarker854"/><span class="koboSpan" id="kobo.147.1"> me just the effect that I want. </span><span class="koboSpan" id="kobo.147.2">(I started with </span><code class="inlineCode"><span class="koboSpan" id="kobo.148.1">-charcoal 15</span></code><span class="koboSpan" id="kobo.149.1">, but that didn’t look good at all.) Here’s how it turned out:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.150.1"><img src="../Images/B21693_13_05.png" alt="B21693_13_5"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.151.1">Figure 13.5: Goldie with the charcoal effect</span></p>
    <div class="note">
      <p class="normal"><span class="koboSpan" id="kobo.152.1">There’s such a wide array of effects that you can apply to your images, that it’s impossible for me to list them all here. </span><span class="koboSpan" id="kobo.152.2">To see the complete list, just view the </span><code class="inlineCode"><span class="koboSpan" id="kobo.153.1">convert</span></code><span class="koboSpan" id="kobo.154.1"> man page.</span></p>
    </div>
    <p class="normal"><span class="koboSpan" id="kobo.155.1">One of the pleasant surprises about ImageMagick is that you can learn to do these sorts of things quite quickly, by consulting the </span><code class="inlineCode"><span class="koboSpan" id="kobo.156.1">magick</span></code><span class="koboSpan" id="kobo.157.1"> and ImageMagick man pages, the ImageMagick website or the various tutorials that you’ll find on the either the web or on YouTube. </span><span class="koboSpan" id="kobo.157.2">In fact, every time I’ve ever tried to do anything like this with a GUI-type program, such as GIMP or PhotoShop, it always took me forever to figure it </span><a id="_idIndexMarker855"/><span class="koboSpan" id="kobo.158.1">out.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.159.1">Something that’s always bugged me about tablets and smart phones is that when you put them into selfie mode to take a picture of yourself, the picture is always reversed. </span><span class="koboSpan" id="kobo.159.2">So, let’s </span><a id="_idIndexMarker856"/><span class="koboSpan" id="kobo.160.1">say that I were to take a selfie of me playing guitar. </span><span class="koboSpan" id="kobo.160.2">I’m a right-handed guitarist, but a selfie taken with my smartphone would make me look like a left-handed guitarist. </span><span class="koboSpan" id="kobo.160.3">(Paul McCartney, the world’s most famous living left-handed guitarist, would appear to be right-handed.) ImageMagick makes it easy to correct that, just by using </span><code class="inlineCode"><span class="koboSpan" id="kobo.161.1">convert</span></code><span class="koboSpan" id="kobo.162.1"> with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.163.1">-flop</span></code><span class="koboSpan" id="kobo.164.1"> option, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.165.1">[donnie@fedora script_test]$ convert -flop S1180001_charcoal.jpg S1180001_charcoal_flop.jpg
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.166.1">I don’t have any selfies handy at the moment, so I instead flopped Goldie’s picture. </span><span class="koboSpan" id="kobo.166.2">Here’s how it turned out:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.167.1"><img src="../Images/B21693_13_06.png" alt="B21693_13_6"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.168.1">Figure 13.6: Goldie’s picture, reversed</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.169.1">If you’ve ever made the</span><a id="_idIndexMarker857"/><span class="koboSpan" id="kobo.170.1"> mistake of holding your camera upside </span><a id="_idIndexMarker858"/><span class="koboSpan" id="kobo.171.1">down while taking a picture, you can also reverse your pictures vertically by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.172.1">-flip</span></code><span class="koboSpan" id="kobo.173.1"> option, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.174.1">donnie@fedora:~/Pictures/script_test$ convert -resize 15% -flip S1180001.jpg S1180001_flip.jpg
donnie@fedora:~/Pictures/script_test$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.175.1">Here’s how it turned out:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.176.1"><img src="../Images/B21693_13_07.png" alt="B21693_13_7"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.177.1">Figure 13.7: Goldie has been flipped upside-down</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.178.1">The last trick I’ll show you</span><a id="_idIndexMarker859"/><span class="koboSpan" id="kobo.179.1"> is how to convert from one image</span><a id="_idIndexMarker860"/><span class="koboSpan" id="kobo.180.1"> format to another. </span><span class="koboSpan" id="kobo.180.2">Just use </span><code class="inlineCode"><span class="koboSpan" id="kobo.181.1">convert</span></code><span class="koboSpan" id="kobo.182.1"> without any option switches, like so:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.183.1">[donnie@fedora script_test]$ convert S1180001_small2.jpg S1180001_small2.png
[donnie@fedora script_test]$ ls -l *.png
-rw-r--r--. </span><span class="koboSpan" id="kobo.183.2">1 donnie donnie 494190 Dec  4 17:19 S1180001_small2.png
[donnie@fedora script_test]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.184.1">So, I now have a </span><code class="inlineCode"><span class="koboSpan" id="kobo.185.1">.png</span></code><span class="koboSpan" id="kobo.186.1"> file to go along with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.187.1">.jpg</span></code><span class="koboSpan" id="kobo.188.1"> file. </span><span class="koboSpan" id="kobo.188.2">To see all of the image formats that ImageMagick can work with, just do:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.189.1">[donnie@fedora ~]$ identify -list format
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.190.1">You’re not always limited to just working with existing image files. </span><span class="koboSpan" id="kobo.190.2">You can also create original text image files with a variety of special effects. </span><span class="koboSpan" id="kobo.190.3">For example, let’s create a fancy image file of my name, like this:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.191.1">[donnie@fedora Pictures]$ convert -size 320x115 xc:lightblue  -font Comic-Sans-MS -pointsize 72 -fill Navy -annotate 0x0+12+55 'Donnie' -fill RoyalBlue -annotate 0x130+25+80 'Donnie' font_slewed.jpg
[donnie@fedora Pictures]$
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.192.1">Of course, the font that you specify must be installed on your system. </span><span class="koboSpan" id="kobo.192.2">In this case, I’m using the </span><a id="_idIndexMarker861"/><span class="koboSpan" id="kobo.193.1">infamous Comic Sans font that everybody loves to hate. </span><span class="koboSpan" id="kobo.193.2">(It’s a Microsoft font, which I do have installed on this Fedora </span><a id="_idIndexMarker862"/><span class="koboSpan" id="kobo.194.1">machine. </span><span class="koboSpan" id="kobo.194.2">I always install the full suite of Microsoft fonts on my Linux machines so that I can work with my publisher and my clients.) Also, note that you can’t have blank spaces in the font names. </span><span class="koboSpan" id="kobo.194.3">Replace each blank space with a dash, and you should be good. </span><span class="koboSpan" id="kobo.194.4">To understand the rest of the command, look in the ImageMagick man pages for explanations of all of the options. </span><span class="koboSpan" id="kobo.194.5">Anyway, here’s what my new image looks like:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.195.1"><img src="../Images/B21693_13_08.png" alt="B21693_13_8"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.196.1">Figure 13.8: The text image file that I created with ImageMagick</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.197.1">Pretty cool, right? </span><span class="koboSpan" id="kobo.197.2">It gets even more cool, when you look at the plethora of examples on the Font Effects page of the official ImageMagick documentation, which you can find here: </span><a href="https://imagemagick.org/Usage/fonts/"><span class="url"><span class="koboSpan" id="kobo.198.1">https://imagemagick.org/Usage/fonts/</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.199.1">There’s a whole lot more that you can do with ImageMagick, but this is enough for now. </span><span class="koboSpan" id="kobo.199.2">Let’s now talk about using ImageMagick in shell scripts.</span></p>
    <h1 id="_idParaDest-297" class="heading 1"><span class="koboSpan" id="kobo.200.1">Batch-processing Image Files</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.201.1">Now, let’s say that you have a whole directory full of image files that you need to manipulate all in the </span><a id="_idIndexMarker863"/><span class="koboSpan" id="kobo.202.1">same way. </span><span class="koboSpan" id="kobo.202.2">Using a GUI-type graphics program will be quite tedious, because you’ll only be able to work with </span><a id="_idIndexMarker864"/><span class="koboSpan" id="kobo.203.1">one file at a time. </span><span class="koboSpan" id="kobo.203.2">With ImageMagick, just write a simple script to do the work for you. </span><span class="koboSpan" id="kobo.203.3">For example, let’s look at the </span><code class="inlineCode"><span class="koboSpan" id="kobo.204.1">resize.sh</span></code><span class="koboSpan" id="kobo.205.1"> script:</span></p>
    <pre class="programlisting gen"><code class="hljs-con"><span class="koboSpan" id="kobo.206.1">#!/bin/bash
for picture in *.jpg; do
        convert -resize 15% "$picture" "${picture%.jpg}_small.jpg"
done
</span></code></pre>
    <p class="normal"><span class="koboSpan" id="kobo.207.1">As you see, it’s really not that much different from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.208.1">rename_extension.sh</span></code><span class="koboSpan" id="kobo.209.1"> script that I’ve already shown you. </span><span class="koboSpan" id="kobo.209.2">Just a simple </span><code class="inlineCode"><span class="koboSpan" id="kobo.210.1">for</span></code><span class="koboSpan" id="kobo.211.1"> loop and a bit of variable expansion is all you need. </span><span class="koboSpan" id="kobo.211.2">And of course, you can replace this </span><code class="inlineCode"><span class="koboSpan" id="kobo.212.1">-resize</span></code><span class="koboSpan" id="kobo.213.1"> command with any other ImageMagick command you want.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.214.1">Okay, this pretty much does it for the simple stuff. </span><span class="koboSpan" id="kobo.214.2">Let’s move on to the more complex stuff.</span></p>
    <h1 id="_idParaDest-298" class="heading 1"><span class="koboSpan" id="kobo.215.1">Using Fred’s ImageMagick Scripts</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.216.1">There’s a lot you can do with the simple types of ImageMagick commands that I’ve just shown you. </span><span class="koboSpan" id="kobo.216.2">For simple projects, you might not need anything more complex. </span><span class="koboSpan" id="kobo.216.3">But, if you’re a professional graphics artist, you might need more. </span><span class="koboSpan" id="kobo.216.4">You can create some awesome-looking images with awesome effects, but that might require using a very complex set of ImageMagick commands. </span><span class="koboSpan" id="kobo.216.5">Fortunately, there’s a way to cheat, because someone else has already done this work for you.</span></p>
    <p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.217.1">Fred’s ImageMagick Scripts</span></strong><span class="koboSpan" id="kobo.218.1"> are </span><code class="inlineCode"><span class="koboSpan" id="kobo.219.1">bash</span></code><span class="koboSpan" id="kobo.220.1"> scripts</span><a id="_idIndexMarker865"/><span class="koboSpan" id="kobo.221.1"> that incorporate very complex sets of ImageMagick commands. </span><span class="koboSpan" id="kobo.221.2">As I’m writing this in December 2023, Mr. </span><span class="koboSpan" id="kobo.221.3">Fred Weinhaus has a total of 375 scripts that you can download from his site. </span><span class="koboSpan" id="kobo.221.4">They’re free of charge for personal use, but Fred does request that you contact him to arrange for payment if you need to use them for your business. </span><span class="koboSpan" id="kobo.221.5">I can’t even begin to describe all of the scripts and the effects that they can all create. </span><span class="koboSpan" id="kobo.221.6">So instead, I’ll just encourage you to go to Fred’s site and download some of the scripts for your own study. </span><span class="koboSpan" id="kobo.221.7">You can find Fred’s site here:</span></p>
    <p class="normal"><a href="http://www.fmwconcepts.com/imagemagick/"><span class="url"><span class="koboSpan" id="kobo.222.1">http://www.fmwconcepts.com/imagemagick/</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.223.1">And, here’s what the </span><a id="_idIndexMarker866"/><span class="koboSpan" id="kobo.224.1">site looks like:</span></p>
    <figure class="mediaobject"><span class="koboSpan" id="kobo.225.1"><img src="../Images/B21693_13_09.png" alt="B21693_13_9"/></span></figure>
    <p class="packt_figref"><span class="koboSpan" id="kobo.226.1">Figure 13.9: Fred’s ImageMagick Scripts site</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.227.1">As you see in this graphic, you can get a description of what each script does by moving your cursor over the script name.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.228.1">I believe that this about does it for an introduction to ImageMagick scripting. </span><span class="koboSpan" id="kobo.228.2">So, let’s summarize and move on.</span></p>
    <h1 id="_idParaDest-299" class="heading 1"><span class="koboSpan" id="kobo.229.1">Summary</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.230.1">ImageMagick is a great tool for both casual and professional graphics artists. </span><span class="koboSpan" id="kobo.230.2">You can perform some simple image manipulations with some very simple commands, or you can create awesome effects with more complex commands.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.231.1">In this chapter, I started by explaining how to automate the process of changing non-standard filename extensions to the standard Linux/Unix format. </span><span class="koboSpan" id="kobo.231.2">I then explained how to install ImageMagick on a variety of operating systems. </span><span class="koboSpan" id="kobo.231.3">Next, I showed you how to display images, view image properties, and how to resize and customize images, all from the command-line. </span><span class="koboSpan" id="kobo.231.4">Finally, I showed you how to cheat a bit, by studying and trying out Fred’s ImageMagick scripts.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.232.1">Of course, there’s still much more that you can do with ImageMagick than I can show you here. </span><span class="koboSpan" id="kobo.232.2">There are ImageMagick tutorials all over the place on the web, and you can easily find them with your favorite search engine. </span><span class="koboSpan" id="kobo.232.3">Better yet, go to YouTube, and search for ImageMagick tutorials there.</span></p>
    <p class="normal"><span class="koboSpan" id="kobo.233.1">In the next chapter, I’ll show you how to squawk with </span><code class="inlineCode"><span class="koboSpan" id="kobo.234.1">awk</span></code><span class="koboSpan" id="kobo.235.1">. </span><span class="koboSpan" id="kobo.235.2">I’ll see you there.</span></p>
    <h1 id="_idParaDest-300" class="heading 1"><span class="koboSpan" id="kobo.236.1">Questions</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.237.1">Which of the following statements is false?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.238.1">There’s not much you can do with ImageMagick, because it lacks a graphical user interface.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.239.1">It’s sometimes easier to apply an effect with ImageMagick than it is with a GUI-type program.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.240.1">You can batch process a directory full of graphics files by placing ImageMagick commands into a shell script.</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.241.1">ImageMagick is simple to use for simple tasks, but you can also perform more complex image manipulations with more complex scripts.</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.242.1">What are two methods that you can use to automate the process of changing filename extensions on a whole directory of graphics files?</span><ol>
          <li class="alphabeticList level 2" value="1"><span class="koboSpan" id="kobo.243.1">Use command substitution</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.244.1">Use variable expansion</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.245.1">Use command expansion</span></li>
          <li class="alphabeticList level 2"><span class="koboSpan" id="kobo.246.1">Use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.247.1">basename</span></code><span class="koboSpan" id="kobo.248.1"> utility</span></li>
        </ol>
      </li>
      <li class="numberedList"><span class="koboSpan" id="kobo.249.1">Which ImageMagick command would you use to display image properties?</span><ol>
          <li class="alphabeticList level 2" value="1"><code class="inlineCode"><span class="koboSpan" id="kobo.250.1">show</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.251.1">identify</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.252.1">show_properties</span></code></li>
          <li class="alphabeticList level 2"><code class="inlineCode"><span class="koboSpan" id="kobo.253.1">properties</span></code></li>
        </ol>
      </li>
    </ol>
    <h1 id="_idParaDest-301" class="heading 1"><span class="koboSpan" id="kobo.254.1">Further Reading</span></h1>
    <ul>
      <li class="bulletList"><span class="koboSpan" id="kobo.255.1">bash--How do I change the extension of multiple files?: </span><a href="https://unix.stackexchange.com/questions/19654/how-do-i-change-the-extension-of-multiple-files"><span class="url"><span class="koboSpan" id="kobo.256.1">https://unix.stackexchange.com/questions/19654/how-do-i-change-the-extension-of-multiple-files</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.257.1">ImageMagick.org: </span><a href="https://imagemagick.org/"><span class="url"><span class="koboSpan" id="kobo.258.1">https://imagemagick.org/</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.259.1">Getting started with ImageMagick: </span><a href="https://opensource.com/article/17/8/imagemagick"><span class="url"><span class="koboSpan" id="kobo.260.1">https://opensource.com/article/17/8/imagemagick</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.261.1">Getting Started with ImageMagick: </span><a href="https://riptutorial.com/imagemagick"><span class="url"><span class="koboSpan" id="kobo.262.1">https://riptutorial.com/imagemagick</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.263.1">Manipulating Images with ImageMagick Command-line Tools: </span><a href="https://www.baeldung.com/linux/imagemagick-edit-images"><span class="url"><span class="koboSpan" id="kobo.264.1">https://www.baeldung.com/linux/imagemagick-edit-images</span></span></a></li>
      <li class="bulletList"><span class="koboSpan" id="kobo.265.1">Fred’s ImageMagick Scripts: </span><a href="http://www.fmwconcepts.com/imagemagick/"><span class="url"><span class="koboSpan" id="kobo.266.1">http://www.fmwconcepts.com/imagemagick/</span></span></a></li>
    </ul>
    <h1 id="_idParaDest-302" class="heading 1"><span class="koboSpan" id="kobo.267.1">Answers</span></h1>
    <ol>
      <li class="numberedList" value="1"><span class="koboSpan" id="kobo.268.1">a</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.269.1">b and d</span></li>
      <li class="numberedList"><span class="koboSpan" id="kobo.270.1">b</span></li>
    </ol>
    <h1 id="_idParaDest-303" class="heading 1"><span class="koboSpan" id="kobo.271.1">Join our community on Discord!</span></h1>
    <p class="normal"><span class="koboSpan" id="kobo.272.1">Read this book alongside other users, Linux experts, and the author himself. </span></p>
    <p class="normal"><span class="koboSpan" id="kobo.273.1">Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. </span><span class="koboSpan" id="kobo.273.2">Scan the QR code or visit the link to join the community.</span></p>
    <p class="normal"><a href="https://packt.link/SecNet"><span class="url"><span class="koboSpan" id="kobo.274.1">https://packt.link/SecNet</span></span></a></p>
    <p class="normal"><span class="koboSpan" id="kobo.275.1"><img src="../Images/QR_Code10596186092701843.png" alt=""/></span></p>
  </div>
</body></html>