<html><head></head><body>
<div id="_idContainer165" class="calibre2">
<h1 class="chapter-number" id="_idParaDest-71"><a id="_idTextAnchor135" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1.1">5</span></h1>
<h1 id="_idParaDest-72" class="calibre5"><a id="_idTextAnchor136" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.2.1">Network and Connectivity</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.3.1">Now, it’s time to review the basics of network configuration and management on our workstation. </span><span class="kobospan" id="kobo.3.2">This will lead to us knowing about the fundamental points that can be adjusted and fine-tuned in the network configuration. </span><span class="kobospan" id="kobo.3.3">We will get to know in depth about the </span><strong class="bold"><span class="kobospan" id="kobo.4.1">NetworkManager</span></strong><span class="kobospan" id="kobo.5.1"> administration tool, as well as the most common tips and examples regarding </span><span><span class="kobospan" id="kobo.6.1">its use.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.7.1">We will also walk through the wired and wireless network configuration. </span><span class="kobospan" id="kobo.7.2">In the next section, we will review how to access a </span><strong class="bold"><span class="kobospan" id="kobo.8.1">virtual private network</span></strong><span class="kobospan" id="kobo.9.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.10.1">VPN</span></strong><span class="kobospan" id="kobo.11.1">). </span><span class="kobospan" id="kobo.11.2">Finally, we will learn about the tools for monitoring network performance </span><span><span class="kobospan" id="kobo.12.1">and connectivity.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.13.1">In this chapter, we’re going to cover the following </span><span><span class="kobospan" id="kobo.14.1">main topics:</span></span></p>
<ul class="calibre15">
<li class="calibre14"><span class="kobospan" id="kobo.15.1">Walking through </span><span><span class="kobospan" id="kobo.16.1">the basics</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.17.1">Tuning </span><span><span class="kobospan" id="kobo.18.1">wireless connectivity</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.19.1">Improving network connectivity using </span><span><span class="kobospan" id="kobo.20.1">a VPN</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.21.1">Network </span><span><span class="kobospan" id="kobo.22.1">performance monitoring</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.23.1">Let’s get </span><span><span class="kobospan" id="kobo.24.1">to it!</span></span></p>
<h1 id="_idParaDest-73" class="calibre5"><a id="_idTextAnchor137" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.25.1">Technical requirements</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.26.1">The configurations mentioned in this chapter require access to the local network, either wired or wireless. </span><span class="kobospan" id="kobo.26.2">It is not necessary to have a dedicated network interface for </span><span><span class="kobospan" id="kobo.27.1">these tests.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.28.1">You can find the templates and example files used in this chapter in this book’s GitHub repository: </span><a href="https://github.com/PacktPublishing/Fedora-Linux-System-Administration/tree/main/chapter5" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.29.1">https://github.com/PacktPublishing/Fedora-Linux-System-Administration/tree/main/chapter5</span></span></a></p>
<h1 id="_idParaDest-74" class="calibre5"><a id="_idTextAnchor138" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.30.1">Walking through the basics</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.31.1">NetworkManager uses</span><a id="_idIndexMarker306" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.32.1"> the concept of </span><em class="italic"><span class="kobospan" id="kobo.33.1">connection profiles</span></em><span class="kobospan" id="kobo.34.1">, which contain the network</span><a id="_idIndexMarker307" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.35.1"> configuration. </span><span class="kobospan" id="kobo.35.2">These profiles support a variety of formats for storing properties, such as </span><strong class="source-inline"><span class="kobospan" id="kobo.36.1">int32</span></strong><span class="kobospan" id="kobo.37.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.38.1">boolean</span></strong><span class="kobospan" id="kobo.39.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.40.1">uint32</span></strong><span class="kobospan" id="kobo.41.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.42.1">string</span></strong><span class="kobospan" id="kobo.43.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.44.1">array of string</span></strong><span class="kobospan" id="kobo.45.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.46.1">uint64</span></strong><span class="kobospan" id="kobo.47.1">, and many more. </span><span class="kobospan" id="kobo.47.2">As NetworkManager’s usage and features grow, </span><strong class="source-inline"><span class="kobospan" id="kobo.48.1">ifcfg</span></strong><span class="kobospan" id="kobo.49.1"> files may no longer </span><span><span class="kobospan" id="kobo.50.1">be supported.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.51.1">NetworkManager uses plugins to read and write this data. </span><span class="kobospan" id="kobo.51.2">NetworkManager added support for new connection types and finally settled on using a more streamlined configuration</span><a id="_idIndexMarker308" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.52.1"> file format for it, known as the </span><span><strong class="source-inline"><span class="kobospan" id="kobo.53.1">keyfile</span></strong></span><span><span class="kobospan" id="kobo.54.1"> plugin.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.55.1">The </span><strong class="source-inline"><span class="kobospan" id="kobo.56.1">keyfile</span></strong><span class="kobospan" id="kobo.57.1"> plugin supports all connection types and capabilities that NetworkManager has. </span><span class="kobospan" id="kobo.57.2">NetworkManager uses the </span><em class="italic"><span class="kobospan" id="kobo.58.1">INI-key</span></em><span class="kobospan" id="kobo.59.1"> file format to store connection </span><span><span class="kobospan" id="kobo.60.1">profile data.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.61.1">This plugin always remains active and stores any connection that no other active plugin supports. </span><span class="kobospan" id="kobo.61.2">For security, it ignores files that could be read or written by any </span><em class="italic"><span class="kobospan" id="kobo.62.1">non-root</span></em><span class="kobospan" id="kobo.63.1"> user since private keys and passwords might be stored in plain text inside </span><span><span class="kobospan" id="kobo.64.1">the file.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.65.1">Let’s take an example of an Ethernet connection profile to understand </span><span><span class="kobospan" id="kobo.66.1">plugins better:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.67.1">
[connection]
id=net_connection
uuid= 9cd8a444-f501-4179-900e-f3754dbbe7c0
type=ethernet
autoconnect=true
[ipv4]
method=auto
[ipv6]
method=auto
[ethernet]
mac-address=48:2a:e3:8f:4b:aa</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.68.1">It consists of sections (groups) of key-value pairs that correspond to a configuration name, which is described as a property. </span><span class="kobospan" id="kobo.68.2">Most of the properties in the specification are also written in the same format in the key file. </span><span class="kobospan" id="kobo.68.3">However, some values are unfriendly to use. </span><span class="kobospan" id="kobo.68.4">These are stored in the files listed at </span><strong class="source-inline"><span class="kobospan" id="kobo.69.1">/etc/NetworkManager/system-connections/</span></strong><span class="kobospan" id="kobo.70.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.71.1">/usr/lib/NetworkManager/system-connections/</span></strong><span class="kobospan" id="kobo.72.1"> and </span><strong class="source-inline"><span class="kobospan" id="kobo.73.1">/run/NetworkManager/system-connections/</span></strong><span class="kobospan" id="kobo.74.1">, in a more </span><span><span class="kobospan" id="kobo.75.1">readable form.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.76.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.77.1">For more information</span><a id="_idIndexMarker309" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.78.1"> about the </span><strong class="bold"><span class="kobospan" id="kobo.79.1">Description of keyfile settings</span></strong><span class="kobospan" id="kobo.80.1"> plugin, refer to the </span><em class="italic"><span class="kobospan" id="kobo.81.1">GNOME Developer Documentation</span></em> <span><span class="kobospan" id="kobo.82.1">at </span></span><a href="https://developer-old.gnome.org/NetworkManager/stable/nm-settings-keyfile.html" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.83.1">https://developer-old.gnome.org/NetworkManager/stable/nm-settings-keyfile.html</span></span></a><span><span class="kobospan" id="kobo.84.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.85.1">Like any file in Linux, keyfiles can be modified, but NetworkManager must know about these changes so</span><a id="_idIndexMarker310" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.86.1"> that they can </span><span><span class="kobospan" id="kobo.87.1">be considered.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.88.1">Now, let’s review the utility that helps us handle NetworkManager and </span><span><span class="kobospan" id="kobo.89.1">network configuration.</span></span></p>
<h2 id="_idParaDest-75" class="calibre7"><a id="_idTextAnchor139" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.90.1">NetworkManager command-line interface (nmcli)</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.91.1">NetworkManager</span><a id="_idIndexMarker311" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.92.1"> can be managed by the </span><strong class="source-inline"><span class="kobospan" id="kobo.93.1">nmcli</span></strong><span class="kobospan" id="kobo.94.1"> command-line utility (</span><strong class="bold"><span class="kobospan" id="kobo.95.1">NetworkManager Command Line Interface</span></strong><span class="kobospan" id="kobo.96.1">). </span><strong class="source-inline"><span class="kobospan" id="kobo.97.1">nmcli</span></strong><span class="kobospan" id="kobo.98.1"> allows us to create, display, edit, delete, activate, and deactivate network connections. </span><span class="kobospan" id="kobo.98.2">Besides controlling and displaying the status of network devices, it can run as a command from the terminal or be invoked from </span><span><span class="kobospan" id="kobo.99.1">a script.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.100.1">As a command running from the terminal, </span><strong class="source-inline"><span class="kobospan" id="kobo.101.1">nmcli</span></strong><span class="kobospan" id="kobo.102.1"> can create, edit, start, and stop network connections or display a network device’s status, without the need for the GUI or </span><span><span class="kobospan" id="kobo.103.1">desktop applet.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.104.1">For scripts, </span><strong class="source-inline"><span class="kobospan" id="kobo.105.1">nmcli</span></strong><span class="kobospan" id="kobo.106.1"> provides a simple output format that can be adapted to data processing, which integrates network configurations into a process rather than managing network </span><span><span class="kobospan" id="kobo.107.1">connections manually.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.108.1">The basic </span><strong class="source-inline"><span class="kobospan" id="kobo.109.1">nmcli</span></strong><span class="kobospan" id="kobo.110.1"> command run format is </span><span><span class="kobospan" id="kobo.111.1">as follows:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.112.1">
nmcli [OPTIONS] OBJECT { COMMAND | help }</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.113.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.114.1">For a complete list of options, from the terminal, run the </span><strong class="source-inline1"><span class="kobospan" id="kobo.115.1">man </span></strong><span><strong class="source-inline1"><span class="kobospan" id="kobo.116.1">nmcli</span></strong></span><span><span class="kobospan" id="kobo.117.1"> command.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.118.1">Then, to get the connection overview, run the </span><strong class="source-inline"><span class="kobospan" id="kobo.119.1">nmcli -o </span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.120.1">conn</span></strong></span><span><span class="kobospan" id="kobo.121.1"> command:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer119">
<span class="kobospan" id="kobo.122.1"><img alt="Figure 5.1 – Overview of network connections" src="image/B19121_05_01.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.123.1">Figure 5.1 – Overview of network connections</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.124.1">To get an overview of the </span><strong class="source-inline"><span class="kobospan" id="kobo.125.1">enp1s0</span></strong><span class="kobospan" id="kobo.126.1"> network</span><a id="_idIndexMarker312" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.127.1"> device, run the </span><strong class="source-inline"><span class="kobospan" id="kobo.128.1">nmcli -o dev show </span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.129.1">enp1s0</span></strong></span><span><span class="kobospan" id="kobo.130.1"> command:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer120">
<span class="kobospan" id="kobo.131.1"><img alt="Figure 5.2 – Overview of the network device" src="image/B19121_05_02.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.132.1">Figure 5.2 – Overview of the network device</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.133.1">You can list the </span><strong class="bold"><span class="kobospan" id="kobo.134.1">keyfiles</span></strong><span class="kobospan" id="kobo.135.1"> of network connections</span><a id="_idIndexMarker313" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.136.1"> by running the </span><strong class="source-inline"><span class="kobospan" id="kobo.137.1">nmcli -f TYPE,FILENAME,NAME </span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.138.1">conn</span></strong></span><span><span class="kobospan" id="kobo.139.1"> command:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer121">
<span class="kobospan" id="kobo.140.1"><img alt="Figure 5.3 – Checking the network connection keyfiles" src="image/B19121_05_03.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.141.1">Figure 5.3 – Checking the network connection keyfiles</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.142.1">In this case, observe</span><a id="_idIndexMarker314" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.143.1"> that the </span><em class="italic"><span class="kobospan" id="kobo.144.1">IP address</span></em><span class="kobospan" id="kobo.145.1"> of the workstation is set to </span><strong class="source-inline"><span class="kobospan" id="kobo.146.1">auto</span></strong><span class="kobospan" id="kobo.147.1">, meaning that it uses DHCP as the </span><span><span class="kobospan" id="kobo.148.1">boot-time protocol:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.149.1">
[ipv4]
method=</span><strong class="bold1"><span class="kobospan1" id="kobo.150.1">auto</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.151.1">To assign a static IP address such as </span><strong class="source-inline"><span class="kobospan" id="kobo.152.1">192.168.122.100</span></strong><span class="kobospan" id="kobo.153.1"> instead of the one assigned by DHCP, follow </span><span><span class="kobospan" id="kobo.154.1">these steps:</span></span></p>
<ol class="calibre13">
<li class="calibre14"><span class="kobospan" id="kobo.155.1">Back up the original configuration of </span><span><span class="kobospan" id="kobo.156.1">the connection:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.157.1">
# </span><strong class="bold1"><span class="kobospan1" id="kobo.158.1">cat /run/NetworkManager/system-connections/Wired\ connection\ 1.nmconnection &gt;&gt; </span></strong><span class="kobospan1" id="kobo.159.1"> </span><strong class="bold1"><span class="kobospan1" id="kobo.160.1">wired_connection_1.bkp.txt</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer122">
<span class="kobospan" id="kobo.161.1"><img alt="Figure 5.4 – Backing up network connection settings" src="image/B19121_05_04.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.162.1">Figure 5.4 – Backing up network connection settings</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.163.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.164.1">Running the </span><strong class="source-inline1"><span class="kobospan" id="kobo.165.1">cat</span></strong><span class="kobospan" id="kobo.166.1"> command to redirect the output to a file lets us know about and identify the contents of </span><span><span class="kobospan" id="kobo.167.1">the file.</span></span></p>
<ol class="calibre13">
<li value="2" class="calibre14"><span class="kobospan" id="kobo.168.1">Add the </span><strong class="source-inline1"><span class="kobospan" id="kobo.169.1">enp1s0</span></strong><span class="kobospan" id="kobo.170.1"> connection</span><a id="_idIndexMarker315" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.171.1"> as a new NetworkManager </span><span><span class="kobospan" id="kobo.172.1">connection profile:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.173.1">
# </span><strong class="bold1"><span class="kobospan1" id="kobo.174.1">nmcli connection add con-name wired-conn1</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.175.1">ifname enp1s0 type ethernet</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer123">
<span class="kobospan" id="kobo.176.1"><img alt="Figure 5.5 – Adding the new NetworkManager connection profile" src="image/B19121_05_05.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.177.1">Figure 5.5 – Adding the new NetworkManager connection profile</span></p>
<ol class="calibre13">
<li value="3" class="calibre14"><span class="kobospan" id="kobo.178.1">Set the IP address of </span><span><span class="kobospan" id="kobo.179.1">this profile:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.180.1">
# </span><strong class="bold1"><span class="kobospan1" id="kobo.181.1">nmcli connection modify wired-conn1</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.182.1">ipv4.addresses 192.168.122.100/24</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer124">
<span class="kobospan" id="kobo.183.1"><img alt="Figure 5.6 –  Setting the IP address" src="image/B19121_05_06.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.184.1">Figure 5.6 –  Setting the IP address</span></p>
<ol class="calibre13">
<li value="4" class="calibre14"><span class="kobospan" id="kobo.185.1">Set the connection</span><a id="_idIndexMarker316" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.186.1"> method </span><span><span class="kobospan" id="kobo.187.1">to </span></span><span><strong class="source-inline1"><span class="kobospan" id="kobo.188.1">manual</span></strong></span><span><span class="kobospan" id="kobo.189.1">:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.190.1">
# </span><strong class="bold1"><span class="kobospan1" id="kobo.191.1">nmcli connection modify wired-conn1</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.192.1">ipv4.method manual</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer125">
<span class="kobospan" id="kobo.193.1"><img alt="Figure 5.7 – Setting the connection method" src="image/B19121_05_07.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.194.1">Figure 5.7 – Setting the connection method</span></p>
<ol class="calibre13">
<li value="5" class="calibre14"><span class="kobospan" id="kobo.195.1">Set the gateway </span><span><span class="kobospan" id="kobo.196.1">to </span></span><span><strong class="source-inline1"><span class="kobospan" id="kobo.197.1">192.168.122.1</span></strong></span><span><span class="kobospan" id="kobo.198.1">:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.199.1">
# </span><strong class="bold1"><span class="kobospan1" id="kobo.200.1">nmcli connection modify wired-conn1 </span></strong><span class="kobospan1" id="kobo.201.1"> </span><strong class="bold1"><span class="kobospan1" id="kobo.202.1">ipv4.gateway 192.168.122.1</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer126">
<span class="kobospan" id="kobo.203.1"><img alt="Figure 5.8 – Setting the gateway" src="image/B19121_05_08.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.204.1">Figure 5.8 – Setting the gateway</span></p>
<ol class="calibre13">
<li value="6" class="calibre14"><span class="kobospan" id="kobo.205.1">Set </span><strong class="source-inline1"><span class="kobospan" id="kobo.206.1">dns</span></strong> <span><span class="kobospan" id="kobo.207.1">to </span></span><span><strong class="source-inline1"><span class="kobospan" id="kobo.208.1">192.168.122.1</span></strong></span><span><span class="kobospan" id="kobo.209.1">:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.210.1">
# </span><strong class="bold1"><span class="kobospan1" id="kobo.211.1">nmcli connection modify wired-conn1 </span></strong><span class="kobospan1" id="kobo.212.1"> </span><strong class="bold1"><span class="kobospan1" id="kobo.213.1">ipv4.dns 192.168.122.1</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer127">
<span class="kobospan" id="kobo.214.1"><img alt="Figure 5.9 – Setting dns" src="image/B19121_05_09.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.215.1">Figure 5.9 – Setting dns</span></p>
<ol class="calibre13">
<li value="7" class="calibre14"><span class="kobospan" id="kobo.216.1">Activate the new NetworkManager </span><span><span class="kobospan" id="kobo.217.1">connection</span></span><span><a id="_idIndexMarker317" class="pcalibre1 calibre6 pcalibre"/></span><span><span class="kobospan" id="kobo.218.1"> profile:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.219.1">[root@workstation ~]# nmcli connection up wired-conn1</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer128">
<span class="kobospan" id="kobo.220.1"><img alt="Figure 5.10 – Activating the NetworkManager profile" src="image/B19121_05_10.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.221.1">Figure 5.10 – Activating the NetworkManager profile</span></p>
<ol class="calibre13">
<li value="8" class="calibre14"><span class="kobospan" id="kobo.222.1">Check the </span><span><span class="kobospan" id="kobo.223.1">device’s status:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.224.1">[root@workstation ~]# </span></strong><strong class="bold1"><span class="kobospan1" id="kobo.225.1">nmcli device status</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer129">
<span class="kobospan" id="kobo.226.1"><img alt="Figure 5.11 – Reviewing the device’s status" src="image/B19121_05_11.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.227.1">Figure 5.11 – Reviewing the device’s status</span></p>
<ol class="calibre13">
<li value="9" class="calibre14"><span class="kobospan" id="kobo.228.1">Check the network configuration of the workstation. </span><span class="kobospan" id="kobo.228.2">Confirm the changes in the IP address of the </span><strong class="source-inline1"><span class="kobospan" id="kobo.229.1">enp1s0</span></strong><span class="kobospan" id="kobo.230.1"> device. </span><span class="kobospan" id="kobo.230.2">Then, use the </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.231.1">ip</span></strong></span><span><span class="kobospan" id="kobo.232.1"> command:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.233.1">[root@workstation ~]# ip a</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer130">
<span class="kobospan" id="kobo.234.1"><img alt="Figure 5.12 – Verifying the network configuration" src="image/B19121_05_12.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.235.1">Figure 5.12 – Verifying the network configuration</span></p>
<ol class="calibre13">
<li value="10" class="calibre14"><span class="kobospan" id="kobo.236.1">Review the workstation</span><a id="_idIndexMarker318" class="pcalibre1 calibre6 pcalibre"/> <span><span class="kobospan" id="kobo.237.1">connection’s keyfiles:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.238.1">
# </span><strong class="bold1"><span class="kobospan1" id="kobo.239.1">nmcli -f TYPE,FILENAME,NAME conn</span></strong></pre></li> </ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer131">
<span class="kobospan" id="kobo.240.1"><img alt="Figure 5.13 – Checking the keyfiles" src="image/B19121_05_13.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.241.1">Figure 5.13 – Checking the keyfiles</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.242.1">Note that the </span><em class="italic"><span class="kobospan" id="kobo.243.1">active configuration</span></em><span class="kobospan" id="kobo.244.1"> is now highlighted </span><span><span class="kobospan" id="kobo.245.1">in green.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.246.1">Let’s compare the original backup</span><a id="_idIndexMarker319" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.247.1"> file with the created one. </span><span class="kobospan" id="kobo.247.2">Use the </span><strong class="source-inline"><span class="kobospan" id="kobo.248.1">diff</span></strong><span class="kobospan" id="kobo.249.1"> command to highlight </span><span><span class="kobospan" id="kobo.250.1">the differences:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer132">
<span class="kobospan" id="kobo.251.1"><img alt="Figure 5.14 – Keyfile differences" src="image/B19121_05_14.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.252.1">Figure 5.14 – Keyfile differences</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.253.1">The first difference is in the </span><strong class="source-inline"><span class="kobospan" id="kobo.254.1">id</span></strong><span class="kobospan" id="kobo.255.1"> value of the </span><em class="italic"><span class="kobospan" id="kobo.256.1">connection name</span></em><span class="kobospan" id="kobo.257.1">. </span><span class="kobospan" id="kobo.257.2">But also, notice that there is a change in the </span><span><strong class="source-inline"><span class="kobospan" id="kobo.258.1">uuid</span></strong></span><span><span class="kobospan" id="kobo.259.1"> value:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.260.1">
&lt; id=</span><strong class="bold1"><span class="kobospan1" id="kobo.261.1">Wired connection 1</span></strong><span class="kobospan1" id="kobo.262.1">
&lt; uuid=</span><strong class="bold1"><span class="kobospan1" id="kobo.263.1">0938b01a-f879-3f76-a796-b3f856dc27ac</span></strong><span class="kobospan1" id="kobo.264.1">
---
&gt; id=</span><strong class="bold1"><span class="kobospan1" id="kobo.265.1">wired-conn1</span></strong><span class="kobospan1" id="kobo.266.1">
&gt; uuid=</span><strong class="bold1"><span class="kobospan1" id="kobo.267.1">c841a92b-3aab-45ac-9ef1-25cd4dc2034f</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.268.1">NetworkManager creates a new </span><em class="italic"><span class="kobospan" id="kobo.269.1">Universally Unique Identifier</span></em><span class="kobospan" id="kobo.270.1"> (</span><strong class="source-inline"><span class="kobospan" id="kobo.271.1">uuid</span></strong><span class="kobospan" id="kobo.272.1">) for this connection profile. </span><span class="kobospan" id="kobo.272.2">This allows multiple connections to be applied to the same device, but only one of these can be activated at a time. </span><span class="kobospan" id="kobo.272.3">Extra connections allow you to quickly switch between different networks </span><span><span class="kobospan" id="kobo.273.1">or configurations.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.274.1">The connection was </span><em class="italic"><span class="kobospan" id="kobo.275.1">auto-configured</span></em><span class="kobospan" id="kobo.276.1"> during installation as DHCP. </span><span class="kobospan" id="kobo.276.2">Since this parameter remained unchanged during installation, one of the properties that were assigned by the boot-time protocol was </span><span><em class="italic"><span class="kobospan" id="kobo.277.1">auto-connection priority</span></em></span><span><span class="kobospan" id="kobo.278.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.279.1">
&lt; </span><strong class="bold1"><span class="kobospan1" id="kobo.280.1">autoconnect-priority=-999</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.281.1">When the connection is set to </span><strong class="source-inline"><span class="kobospan" id="kobo.282.1">auto-connect</span></strong><span class="kobospan" id="kobo.283.1">, higher-priority connections are preferred. </span><span class="kobospan" id="kobo.283.2">The default is </span><strong class="source-inline"><span class="kobospan" id="kobo.284.1">0</span></strong><span class="kobospan" id="kobo.285.1">. </span><em class="italic"><span class="kobospan" id="kobo.286.1">A higher number means a </span></em><span><em class="italic"><span class="kobospan" id="kobo.287.1">higher priority</span></em></span><span><span class="kobospan" id="kobo.288.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.289.1">An interesting piece</span><a id="_idIndexMarker320" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.290.1"> of data that can be found in the original keyfile is </span><strong class="source-inline"><span class="kobospan" id="kobo.291.1">timestamp</span></strong><span class="kobospan" id="kobo.292.1">, in seconds since the </span><strong class="bold"><span class="kobospan" id="kobo.293.1">Unix Epoch</span></strong><span class="kobospan" id="kobo.294.1">, when the connection was last </span><span><span class="kobospan" id="kobo.295.1">successfully activated:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.296.1">
&lt; </span><strong class="bold1"><span class="kobospan1" id="kobo.297.1">timestamp=1687113052</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.298.1">The biggest change is in the </span><strong class="source-inline"><span class="kobospan" id="kobo.299.1">ipv4</span></strong> <span><span class="kobospan" id="kobo.300.1">configuration section:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.301.1">
&lt; </span><strong class="bold1"><span class="kobospan1" id="kobo.302.1">method=auto</span></strong><span class="kobospan1" id="kobo.303.1">
---
&gt; </span><strong class="bold1"><span class="kobospan1" id="kobo.304.1">address1=192.168.122.100/24,192.168.122.1</span></strong><span class="kobospan1" id="kobo.305.1">
&gt; </span><strong class="bold1"><span class="kobospan1" id="kobo.306.1">dns=192.168.122.1;</span></strong><span class="kobospan1" id="kobo.307.1">
&gt; </span><strong class="bold1"><span class="kobospan1" id="kobo.308.1">method=manual</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.309.1">In the original keyfile, the method is set as </span><strong class="source-inline"><span class="kobospan" id="kobo.310.1">auto</span></strong><span class="kobospan" id="kobo.311.1">. </span><span class="kobospan" id="kobo.311.2">The current keyfile is set to </span><strong class="source-inline"><span class="kobospan" id="kobo.312.1">manual</span></strong><span class="kobospan" id="kobo.313.1">, plus the configuration of the </span><em class="italic"><span class="kobospan" id="kobo.314.1">IP address</span></em><span class="kobospan" id="kobo.315.1">, </span><em class="italic"><span class="kobospan" id="kobo.316.1">gateway</span></em><span class="kobospan" id="kobo.317.1">, </span><span><span class="kobospan" id="kobo.318.1">and </span></span><span><em class="italic"><span class="kobospan" id="kobo.319.1">DNS</span></em></span><span><span class="kobospan" id="kobo.320.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.321.1">A </span><em class="italic"><span class="kobospan" id="kobo.322.1">wired connection</span></em><span class="kobospan" id="kobo.323.1"> is the simplest example of network configuration, although several extra properties could </span><span><span class="kobospan" id="kobo.324.1">be added.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.325.1">A </span><em class="italic"><span class="kobospan" id="kobo.326.1">wireless connection</span></em><span class="kobospan" id="kobo.327.1">, which is used for the kind of work involved in managing Linux servers, is the type of connection</span><a id="_idIndexMarker321" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.328.1"> we will use the most, given its inherent </span><span><span class="kobospan" id="kobo.329.1">mobility advantages.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.330.1">Now, let’s see how, besides configuring our </span><em class="italic"><span class="kobospan" id="kobo.331.1">wireless connection</span></em><span class="kobospan" id="kobo.332.1">, to optimize it with some </span><span><span class="kobospan" id="kobo.333.1">fine-tuning settings.</span></span></p>
<h1 id="_idParaDest-76" class="calibre5"><a id="_idTextAnchor140" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.334.1">Tuning wireless connectivity</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.335.1">Sometimes, the network’s devices</span><a id="_idIndexMarker322" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.336.1"> are not recognized by the operating system. </span><span class="kobospan" id="kobo.336.2">This is one of the common issues of using </span><span><span class="kobospan" id="kobo.337.1">wireless networks.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.338.1">Let’s start this section by ensuring that the wireless network device has support from the operating system by identifying which chipset it uses and which drivers work best for </span><span><span class="kobospan" id="kobo.339.1">its operation.</span></span></p>
<h2 id="_idParaDest-77" class="calibre7"><a id="_idTextAnchor141" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.340.1">Identifying the device</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.341.1">In a network device, the main</span><a id="_idIndexMarker323" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.342.1"> thing is to identify the </span><em class="italic"><span class="kobospan" id="kobo.343.1">Vendor ID</span></em><span class="kobospan" id="kobo.344.1"> (the 16-bit number of the vendor – that is, the </span><strong class="bold"><span class="kobospan" id="kobo.345.1">VID</span></strong><span class="kobospan" id="kobo.346.1">) and the </span><em class="italic"><span class="kobospan" id="kobo.347.1">Product ID</span></em><span class="kobospan" id="kobo.348.1"> (the 16-bit number of the product number – that is, the </span><strong class="bold"><span class="kobospan" id="kobo.349.1">PID</span></strong><span class="kobospan" id="kobo.350.1">). </span><span class="kobospan" id="kobo.350.2">Use the following commands for each case, depending on the bus used by </span><span><span class="kobospan" id="kobo.351.1">the device:</span></span></p>
<ul class="calibre15">
<li class="calibre14"><span class="kobospan" id="kobo.352.1">PCI: </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.353.1">lspci -nn</span></strong></span></li>
<li class="calibre14"><span><span class="kobospan" id="kobo.354.1">USB: </span></span><span><strong class="source-inline1"><span class="kobospan" id="kobo.355.1">lsusb</span></strong></span><span><span class="kobospan" id="kobo.356.1">:</span></span></li>
</ul>
<div class="calibre2">
<div class="img---figure" id="_idContainer133">
<span class="kobospan" id="kobo.357.1"><img alt="Figure 5.15 – Identifying the network device" src="image/B19121_05_15.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.358.1">Figure 5.15 – Identifying the network device</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.359.1">As shown in the preceding figure, the output of the </span><strong class="source-inline"><span class="kobospan" id="kobo.360.1">lspci</span></strong><span class="kobospan" id="kobo.361.1"> command provides the required </span><span><span class="kobospan" id="kobo.362.1">chipset information:</span></span></p>
<pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.363.1">00:00.0</span></strong><span class="kobospan1" id="kobo.364.1"> PCI bridge [0604]: Broadcom Inc. </span><span class="kobospan1" id="kobo.364.2">and subsidiaries </span><strong class="bold1"><span class="kobospan1" id="kobo.365.1">BCM2711</span></strong><span class="kobospan1" id="kobo.366.1"> PCIe Bridge [</span><strong class="bold1"><span class="kobospan1" id="kobo.367.1">14e4:2711</span></strong><span class="kobospan1" id="kobo.368.1">] (rev 10)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.369.1">Now, go to Google and type the chipset information in </span><span><span class="kobospan" id="kobo.370.1">the form:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.371.1">
"</span><strong class="bold1"><span class="kobospan1" id="kobo.372.1">14e4 2711</span></strong><span class="kobospan1" id="kobo.373.1">" site:cateee.net/lkddb/</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.374.1">This search leads</span><a id="_idIndexMarker324" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.375.1"> to a chipset match in </span><strong class="bold"><span class="kobospan" id="kobo.376.1">Linux Kernel Driver DataBase</span></strong><span class="kobospan" id="kobo.377.1"> (</span><a href="https://cateee.net/lkddb/" class="pcalibre1 calibre6 pcalibre"><span class="kobospan" id="kobo.378.1">https://cateee.net/lkddb/</span></a><span class="kobospan" id="kobo.379.1">), which allows us to identify whether the wireless network device has support and which driver is the correct one </span><span><span class="kobospan" id="kobo.380.1">to use:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer134">
<span class="kobospan" id="kobo.381.1"><img alt="Figure 5.16 – LKDDb search" src="image/B19121_05_16.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.382.1">Figure 5.16 – LKDDb search</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.383.1">If you search for chipset</span><a id="_idIndexMarker325" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.384.1"> information in the form – that is, </span><strong class="source-inline"><span class="kobospan" id="kobo.385.1">"14e4:2711"</span></strong><span class="kobospan" id="kobo.386.1"> – it leads to several useful sites that provide</span><a id="_idIndexMarker326" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.387.1"> more detailed information. </span><span class="kobospan" id="kobo.387.2">Click on the </span><strong class="bold"><span class="kobospan" id="kobo.388.1">Hardware for Linux</span></strong><span class="kobospan" id="kobo.389.1"> page link (</span><a href="https://linux-hardware.org/" class="pcalibre1 calibre6 pcalibre"><span class="kobospan" id="kobo.390.1">https://linux-hardware.org/</span></a><span class="kobospan" id="kobo.391.1">) and find the </span><span><span class="kobospan" id="kobo.392.1">chipset’s details:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer135">
<span class="kobospan" id="kobo.393.1"><img alt="Figure 5.17 – The Hardware for Linux site" src="image/B19121_05_17.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.394.1">Figure 5.17 – The Hardware for Linux site</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.395.1">With the preceding tools, we can identify</span><a id="_idIndexMarker327" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.396.1"> the wireless device in our computer. </span><span class="kobospan" id="kobo.396.2">Follow these steps to identify the vendor and its </span><span><span class="kobospan" id="kobo.397.1">product ID:</span></span></p>
<ol class="calibre13">
<li class="calibre14"><span class="kobospan" id="kobo.398.1">Run the </span><strong class="source-inline1"><span class="kobospan" id="kobo.399.1">lspci</span></strong><span class="kobospan" id="kobo.400.1"> command to identify </span><span><span class="kobospan" id="kobo.401.1">the card:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.402.1">[root@workstation ~]# lspci | grep -i broadcom</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.403.1">00:00.0 PCI bridge: Broadcom Inc. </span><span class="kobospan1" id="kobo.403.2">and subsidiaries BCM2711</span></strong><strong class="bold1"><span class="kobospan1" id="kobo.404.1"> PCIe Bridge (rev 10)</span></strong></pre></li> </ol>
<p class="calibre3"><span class="kobospan" id="kobo.405.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.406.1">If the card is not integrated into the motherboard of the computer, use the </span><strong class="source-inline1"><span class="kobospan" id="kobo.407.1">lsusb</span></strong><span class="kobospan" id="kobo.408.1"> command to identify </span><span><span class="kobospan" id="kobo.409.1">this device.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.410.1">A bus number, a device number, and a function number can be identified at the beginning of </span><span><span class="kobospan" id="kobo.411.1">the output:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.412.1">
00:00.0</span></pre> <ol class="calibre13">
<li value="2" class="calibre14"><span class="kobospan" id="kobo.413.1">Use this information to get detailed </span><a id="_idIndexMarker328" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.414.1">device information. </span><span class="kobospan" id="kobo.414.2">To do so, run the </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.415.1">lspci</span></strong></span><span><span class="kobospan" id="kobo.416.1"> command:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.417.1">[root@workstation ~]# lspci -vv -s 00:00.0</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.418.1">00:00.0 PCI bridge: Broadcom Inc. </span><span class="kobospan1" id="kobo.418.2">and subsidiaries BCM2711 PCIe Bridge (rev 10) (prog-if 00 [Normal decode])</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.419.1">Device tree node: /sys/firmware/devicetree/base/scb/pcie@7d500000/pci@0,0</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.420.1">Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.421.1">Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.422.1">Latency: 0</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.423.1">Interrupt: pin A routed to IRQ 38</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.424.1">...output omitted...</span></strong></pre></li> <li class="calibre14"><span class="kobospan" id="kobo.425.1">List the modules that were loaded in the kernel and search the identified chipset of the wireless card. </span><span class="kobospan" id="kobo.425.2">Use the </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.426.1">lsmod</span></strong></span><span><span class="kobospan" id="kobo.427.1"> command:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.428.1">root@workstation ~]# lsmod | grep -i broadcom</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.429.1">broadcom               28672  1</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.430.1">bcm_phy_ptp            24576  1 broadcom</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.431.1">bcm_phy_lib            28672  2 bcm_phy_ptp,broadcom</span></strong></pre></li> <li class="calibre14"><span class="kobospan" id="kobo.432.1">Use the </span><strong class="source-inline1"><span class="kobospan" id="kobo.433.1">modinfo</span></strong><span class="kobospan" id="kobo.434.1"> command to display the </span><span><span class="kobospan" id="kobo.435.1">module information:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.436.1">[root@workstation ~]# modinfo broadcom</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.437.1">filename:       /lib/modules/6.1.12-200.fc37.aarch64/kernel/drivers/net/phy/broadcom.ko.xz</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.438.1">license:        GPL</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.439.1">author:         Maciej W. </span><span class="kobospan1" id="kobo.439.2">Rozycki</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.440.1">description:    Broadcom PHY driver</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.441.1">...output omitted...</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.442.1">depends:        bcm-phy-lib,bcm-phy-ptp</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.443.1">intree:         Y</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.444.1">name:           broadcom</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.445.1">vermagic:       6.1.12-200.fc37.aarch64 SMP preempt</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.446.1">    mod_unload aarch64</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.447.1">sig_id:         PKCS#7</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.448.1">signer:         Fedora kernel signing key</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.449.1">sig_key:        4C:FF:C2:28:93:D4:32:A9:E6:E0:32:6A:D9:B0</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.450.1">...output omitted...</span></strong></pre></li> </ol>
<p class="calibre3"><span class="kobospan" id="kobo.451.1">With these simple steps, we can determine whether the wireless card is using the right, updated driver. </span><span class="kobospan" id="kobo.451.2">This prevents any initial issues when connecting to </span><span><span class="kobospan" id="kobo.452.1">a network.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.453.1">Now, let’s learn how to identify</span><a id="_idIndexMarker329" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.454.1"> the available wireless networks and configure our wireless card to get the best </span><span><span class="kobospan" id="kobo.455.1">connectivity performance.</span></span></p>
<h2 id="_idParaDest-78" class="calibre7"><a id="_idTextAnchor142" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.456.1">Finding the best quality network connection</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.457.1">By default, the </span><strong class="source-inline"><span class="kobospan" id="kobo.458.1">nmcli</span></strong><span class="kobospan" id="kobo.459.1"> command</span><a id="_idIndexMarker330" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.460.1"> lists the available </span><strong class="bold"><span class="kobospan" id="kobo.461.1">Wi-Fi access points</span></strong><span class="kobospan" id="kobo.462.1"> that are no more than </span><em class="italic"><span class="kobospan" id="kobo.463.1">30 seconds old</span></em><span class="kobospan" id="kobo.464.1"> by enabling</span><a id="_idIndexMarker331" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.465.1"> a network scan </span><span><span class="kobospan" id="kobo.466.1">if necessary.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.467.1">To list the available Wi-Fi access points, run the </span><strong class="source-inline"><span class="kobospan" id="kobo.468.1">nmcli dev wifi </span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.469.1">list</span></strong></span><span><span class="kobospan" id="kobo.470.1"> command:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer136">
<span class="kobospan" id="kobo.471.1"><img alt="Figure 5.18 – Listing the Wi-Fi access points" src="image/B19121_05_18.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.472.1">Figure 5.18 – Listing the Wi-Fi access points</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.473.1">The </span><strong class="source-inline"><span class="kobospan" id="kobo.474.1">nmcli</span></strong><span class="kobospan" id="kobo.475.1"> command shows</span><a id="_idIndexMarker332" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.476.1"> the Wi-Fi access points in different colors. </span><span class="kobospan" id="kobo.476.2">Each one represents different </span><span><span class="kobospan" id="kobo.477.1">signal strengths.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.478.1">Soft colors, such as cyan, represent a weak signal (less than 30% intensity). </span><span class="kobospan" id="kobo.478.2">A stronger signal (30-50%) is represented by a magenta color. </span><span class="kobospan" id="kobo.478.3">Orange indicates a better signal (60-80%), whereas green represents an excellent </span><span><span class="kobospan" id="kobo.479.1">signal (80-100%).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.480.1">With the </span><strong class="source-inline"><span class="kobospan" id="kobo.481.1">--rescan</span></strong><span class="kobospan" id="kobo.482.1"> option, the scan could be forced to be disabled, regardless of the age of the access </span><span><span class="kobospan" id="kobo.483.1">point list.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.484.1">Use the </span><strong class="source-inline"><span class="kobospan" id="kobo.485.1">nmcli device</span></strong><span class="kobospan" id="kobo.486.1"> command to identify the wireless </span><span><span class="kobospan" id="kobo.487.1">network device:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer137">
<span class="kobospan" id="kobo.488.1"><img alt="Figure 5.19 – Identifying the wireless network device" src="image/B19121_05_19.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.489.1">Figure 5.19 – Identifying the wireless network device</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.490.1">From the list of access points, select those</span><a id="_idIndexMarker333" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.491.1"> that belong to the location of the workstation. </span><span class="kobospan" id="kobo.491.2">Both have good </span><span><span class="kobospan" id="kobo.492.1">signal quality:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer138">
<span class="kobospan" id="kobo.493.1"><img alt="Figure 5.20 – Selecting Wi-Fi access points" src="image/B19121_05_20.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.494.1">Figure 5.20 – Selecting Wi-Fi access points</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.495.1">Select the access point with the best signal quality and connect to it. </span><span class="kobospan" id="kobo.495.2">Use the </span><strong class="source-inline"><span class="kobospan" id="kobo.496.1">nmcli</span></strong><span class="kobospan" id="kobo.497.1"> command with the </span><span><span class="kobospan" id="kobo.498.1">following format:</span></span></p>
<pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.499.1"># nmcli device wifi connect [SSID] password [SSID-password]</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.500.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.501.1">This command preserves the </span><strong class="bold"><span class="kobospan" id="kobo.502.1">password</span></strong><span class="kobospan" id="kobo.503.1"> in the shell history. </span><span class="kobospan" id="kobo.503.2">To remove it from the history, delete the corresponding line in the </span><strong class="source-inline1"><span class="kobospan" id="kobo.504.1">~/.bash_history</span></strong><span class="kobospan" id="kobo.505.1"> file or run the </span><strong class="source-inline1"><span class="kobospan" id="kobo.506.1">history -c</span></strong><span class="kobospan" id="kobo.507.1"> command to delete </span><span><span class="kobospan" id="kobo.508.1">all entries.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.509.1">Then, use the </span><strong class="source-inline"><span class="kobospan" id="kobo.510.1">nmcli device</span></strong><span class="kobospan" id="kobo.511.1"> command</span><a id="_idIndexMarker334" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.512.1"> to confirm the device </span><span><span class="kobospan" id="kobo.513.1">status change:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer139">
<span class="kobospan" id="kobo.514.1"><img alt="Figure 5.21 – Connecting to the access point" src="image/B19121_05_21.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.515.1">Figure 5.21 – Connecting to the access point</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.516.1">Repeat the same command and add the </span><strong class="source-inline"><span class="kobospan" id="kobo.517.1">show</span></strong><span class="kobospan" id="kobo.518.1"> and </span><strong class="source-inline"><span class="kobospan" id="kobo.519.1">device</span></strong><span class="kobospan" id="kobo.520.1"> options to display the </span><span><span class="kobospan" id="kobo.521.1">connection details:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer140">
<span class="kobospan" id="kobo.522.1"><img alt="Figure 5.22 – Connection details" src="image/B19121_05_22.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.523.1">Figure 5.22 – Connection details</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.524.1">The </span><strong class="bold"><span class="kobospan" id="kobo.525.1">received signal strength indicator </span></strong><span class="kobospan" id="kobo.526.1">(</span><strong class="bold"><span class="kobospan" id="kobo.527.1">RSSI</span></strong><span class="kobospan" id="kobo.528.1">), which specifies how strong</span><a id="_idIndexMarker335" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.529.1"> the received signal is, is measured in </span><em class="italic"><span class="kobospan" id="kobo.530.1">decibels relative to one milliwatt</span></em><span class="kobospan" id="kobo.531.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.532.1">dBm</span></strong><span class="kobospan" id="kobo.533.1">) or </span><span><strong class="bold"><span class="kobospan" id="kobo.534.1">10-3 W</span></strong></span><span><span class="kobospan" id="kobo.535.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.536.1">To find the RSSI, it’s necessary</span><a id="_idIndexMarker336" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.537.1"> to interpret the </span><em class="italic"><span class="kobospan" id="kobo.538.1">raw value</span></em><span class="kobospan" id="kobo.539.1"> given by </span><strong class="source-inline"><span class="kobospan" id="kobo.540.1">/proc/net/wireless</span></strong><span class="kobospan" id="kobo.541.1"> and then display it in the appropriate unit or greatest value (using </span><span><span class="kobospan" id="kobo.542.1">8-bit arithmetic).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.543.1">Use the </span><strong class="source-inline"><span class="kobospan" id="kobo.544.1">iw</span></strong><span class="kobospan" id="kobo.545.1"> command to get the device </span><span><span class="kobospan" id="kobo.546.1">link information:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.547.1">
[root@workstation ~]# </span><strong class="bold1"><span class="kobospan1" id="kobo.548.1">iw wlan0 link</span></strong><span class="kobospan1" id="kobo.549.1">
Connected to 2c:58:4f:7c:4a:1b (on wlan0)
SSID: innsmouth
freq: 2462
RX: 1817351 bytes (8922 packets)
TX: 806585 bytes (3517 packets)
</span><strong class="bold1"><span class="kobospan1" id="kobo.550.1">signal: -38 dBm</span></strong><span class="kobospan1" id="kobo.551.1">
rx bitrate: 58.5 MBit/s
tx bitrate: 72.2 MBit/s
     bss flags:     short-preamble
dtim period:     1
beacon int:     100</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.552.1">The </span><strong class="source-inline"><span class="kobospan" id="kobo.553.1">iw</span></strong><span class="kobospan" id="kobo.554.1"> command grabs</span><a id="_idIndexMarker337" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.555.1"> the information from the </span><strong class="source-inline"><span class="kobospan" id="kobo.556.1">/proc/net/wireless</span></strong><span class="kobospan" id="kobo.557.1"> file and interprets it. </span><span class="kobospan" id="kobo.557.2">By combining this with the </span><strong class="source-inline"><span class="kobospan" id="kobo.558.1">watch</span></strong><span class="kobospan" id="kobo.559.1"> command, it is possible to directly monitor changes in the file. </span><span class="kobospan" id="kobo.559.2">Here’s </span><span><span class="kobospan" id="kobo.560.1">an example:</span></span></p>
<pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.561.1"># watch -n 1 cat /proc/net/wireless</span></strong></pre> <div class="calibre2">
<div class="img---figure" id="_idContainer141">
<span class="kobospan" id="kobo.562.1"><img alt="Figure 5.23 – Monitoring the quality of the connection" src="image/B19121_05_23.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.563.1">Figure 5.23 – Monitoring the quality of the connection</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.564.1">Monitoring the frequency of changes in quality values and comparing them on different networks could establish the optimal network to use for our system administration tasks. </span><span class="kobospan" id="kobo.564.2">This will help us reduce connectivity interruptions in </span><span><span class="kobospan" id="kobo.565.1">such tasks.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.566.1">In the last section of this chapter, we will take a more in-depth look at monitoring connections for better performance and </span><span><span class="kobospan" id="kobo.567.1">minimizing outages.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.568.1">The </span><strong class="bold"><span class="kobospan" id="kobo.569.1">GNOME</span></strong><span class="kobospan" id="kobo.570.1"> desktop also includes an </span><em class="italic"><span class="kobospan" id="kobo.571.1">applet</span></em><span class="kobospan" id="kobo.572.1"> to configure </span><a id="_idIndexMarker338" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.573.1">the wireless network graphically. </span><strong class="source-inline"><span class="kobospan" id="kobo.574.1">nm-connection-editor</span></strong><span class="kobospan" id="kobo.575.1"> is a </span><em class="italic"><span class="kobospan" id="kobo.576.1">GTK-based</span></em><span class="kobospan" id="kobo.577.1"> application for adding, deleting, and modifying</span><a id="_idIndexMarker339" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.578.1"> network connections that NetworkManager stores. </span><span class="kobospan" id="kobo.578.2">Let’s see how to </span><span><span class="kobospan" id="kobo.579.1">do it.</span></span></p>
<h2 id="_idParaDest-79" class="calibre7"><a id="_idTextAnchor143" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.580.1">nm-connection-editor</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.581.1">In the top-right corner</span><a id="_idIndexMarker340" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.582.1"> of the taskbar, there is the control panel for settings, including</span><a id="_idIndexMarker341" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.583.1"> the network connection. </span><span class="kobospan" id="kobo.583.2">If the workstation is not connected to any network, only the icons for keyboard language, volume, and system power </span><span><span class="kobospan" id="kobo.584.1">will appear:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer142">
<span class="kobospan" id="kobo.585.1"><img alt="Figure 5.24 – The top-right corner of the taskbar" src="image/B19121_05_24.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.586.1">Figure 5.24 – The top-right corner of the taskbar</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.587.1">Click on that area to display the </span><span><span class="kobospan" id="kobo.588.1">control panel:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer143">
<span class="kobospan" id="kobo.589.1"><img alt="Figure 5.25 – Taskbar control panel" src="image/B19121_05_25.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.590.1">Figure 5.25 – Taskbar control panel</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.591.1">Follow these steps to connect the workstation to the </span><span><span class="kobospan" id="kobo.592.1">wireless network:</span></span></p>
<ol class="calibre13">
<li class="calibre14"><span class="kobospan" id="kobo.593.1">Click on the gear icon and select </span><strong class="bold"><span class="kobospan" id="kobo.594.1">Wi-Fi</span></strong><span class="kobospan" id="kobo.595.1"> to discover the available </span><span><span class="kobospan" id="kobo.596.1">wireless networks:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer144">
<span class="kobospan" id="kobo.597.1"><img alt="Figure 5.26 – Wi-Fi – Visible Networks" src="image/B19121_05_26.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.598.1">Figure 5.26 – Wi-Fi – Visible Networks</span></p>
<ol class="calibre13">
<li value="2" class="calibre14"><span class="kobospan" id="kobo.599.1">Locate the desired </span><a id="_idIndexMarker342" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.600.1">wireless network and click on it. </span><span class="kobospan" id="kobo.600.2">If required, you</span><a id="_idIndexMarker343" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.601.1"> will be prompted to enter the </span><span><span class="kobospan" id="kobo.602.1">access password:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer145">
<span class="kobospan" id="kobo.603.1"><img alt="Figure 5.27 – Requesting access to the wireless network" src="image/B19121_05_27.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.604.1">Figure 5.27 – Requesting access to the wireless network</span></p>
<ol class="calibre13">
<li value="3" class="calibre14"><span class="kobospan" id="kobo.605.1">If the password you’ve entered</span><a id="_idIndexMarker344" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.606.1"> is correct, you will be able to access the wireless network</span><a id="_idIndexMarker345" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.607.1"> and the connection details will </span><span><span class="kobospan" id="kobo.608.1">be shown:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer146">
<span class="kobospan" id="kobo.609.1"><img alt="Figure 5.28 – Connection details" src="image/B19121_05_28.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.610.1">Figure 5.28 – Connection details</span></p>
<ol class="calibre13">
<li value="4" class="calibre14"><span class="kobospan" id="kobo.611.1">Now, the wireless connection</span><a id="_idIndexMarker346" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.612.1"> icon will appear in the top-right corner</span><a id="_idIndexMarker347" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.613.1"> of </span><span><span class="kobospan" id="kobo.614.1">the taskbar:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer147">
<span class="kobospan" id="kobo.615.1"><img alt="Figure 5.29 – Wireless icon on the taskbar" src="image/B19121_05_29.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.616.1">Figure 5.29 – Wireless icon on the taskbar</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.617.1">When we click on it, the control panel will show us an icon that we can use to disable the connection or view the </span><span><span class="kobospan" id="kobo.618.1">available networks:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer148">
<span class="kobospan" id="kobo.619.1"><img alt="Figure 5.30 – Wireless direct access icon" src="image/B19121_05_30.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.620.1">Figure 5.30 – Wireless direct access icon</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.621.1">Now, we can configure the network access to our workstation, either cable or wireless, depending on </span><span><span class="kobospan" id="kobo.622.1">our needs.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.623.1">In the examples shown in this chapter, we have focused on setting access and ensuring a healthy connection to </span><span><span class="kobospan" id="kobo.624.1">the network.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.625.1">However, we cannot omit the security</span><a id="_idIndexMarker348" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.626.1"> risks involved in connecting to a network, especially those with</span><a id="_idIndexMarker349" class="pcalibre1 calibre6 pcalibre"/> <span><span class="kobospan" id="kobo.627.1">public access.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.628.1">Let’s talk about this and how we can mitigate </span><span><span class="kobospan" id="kobo.629.1">these risks.</span></span></p>
<h2 id="_idParaDest-80" class="calibre7"><a id="_idTextAnchor144" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.630.1">What about security?</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.631.1">The use of wireless networks</span><a id="_idIndexMarker350" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.632.1"> has boosted the mobility of jobs that rely on the use </span><span><span class="kobospan" id="kobo.633.1">of computers.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.634.1">Open wireless networks provide many facilities for remote work from anywhere in the world. </span><span class="kobospan" id="kobo.634.2">However, they also include the risk of exposing confidential information about ourselves, our employers, or the clients we </span><span><span class="kobospan" id="kobo.635.1">work with.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.636.1">The most basic principle of security is to be aware of what we have open, such as ports, sockets, files, and/or processes. </span><span class="kobospan" id="kobo.636.2">Some processes use the network’s open ports to maintain connectivity between the client and server machine. </span><span class="kobospan" id="kobo.636.3">Applying security’s basic principle, we must be aware of the ports that have been opened and only allow those that we know must remain </span><span><span class="kobospan" id="kobo.637.1">that way.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.638.1">The tool</span><a id="_idIndexMarker351" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.639.1"> that helps us in these cases is the </span><span><strong class="bold"><span class="kobospan" id="kobo.640.1">network firewall</span></strong></span><span><span class="kobospan" id="kobo.641.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.642.1">As its name suggests, a network firewall is </span><em class="italic"><span class="kobospan" id="kobo.643.1">a protective barrier that prevents unauthorized network communications</span></em><span class="kobospan" id="kobo.644.1">. </span><span class="kobospan" id="kobo.644.2">Its main purpose is to prevent unauthorized access or use of the network services of </span><span><span class="kobospan" id="kobo.645.1">our system.</span></span></p>
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.646.1">Fedora Linux</span></strong><span class="kobospan" id="kobo.647.1"> has a </span><em class="italic"><span class="kobospan" id="kobo.648.1">built-in</span></em><span class="kobospan" id="kobo.649.1"> firewall as part of the networking</span><a id="_idIndexMarker352" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.650.1"> functions inside the kernel. </span><span class="kobospan" id="kobo.650.2">The firewall management service in Fedora </span><span><span class="kobospan" id="kobo.651.1">uses </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.652.1">firewalld</span></strong></span><span><span class="kobospan" id="kobo.653.1">.</span></span></p>
<p class="calibre3"><strong class="source-inline"><span class="kobospan" id="kobo.654.1">firewalld</span></strong><span class="kobospan" id="kobo.655.1"> provides dynamic firewall management</span><a id="_idIndexMarker353" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.656.1"> with support for network/firewall zones. </span><span class="kobospan" id="kobo.656.2">That support defines the </span><em class="italic"><span class="kobospan" id="kobo.657.1">trust level</span></em><span class="kobospan" id="kobo.658.1"> of network connections or interfaces. </span><span class="kobospan" id="kobo.658.2">The </span><strong class="source-inline"><span class="kobospan" id="kobo.659.1">firewalld</span></strong><span class="kobospan" id="kobo.660.1"> D-Bus interface uses the </span><strong class="source-inline"><span class="kobospan" id="kobo.661.1">firewall-cmd</span></strong><span class="kobospan" id="kobo.662.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.663.1">firewall-config</span></strong><span class="kobospan" id="kobo.664.1">, and </span><strong class="source-inline"><span class="kobospan" id="kobo.665.1">firewall-applet</span></strong><span class="kobospan" id="kobo.666.1"> firewall </span><span><span class="kobospan" id="kobo.667.1">configuration tools.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.668.1">The following diagram shows the firewall management flow </span><span><span class="kobospan" id="kobo.669.1">with </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.670.1">firewalld</span></strong></span><span><span class="kobospan" id="kobo.671.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer149">
<span class="kobospan" id="kobo.672.1"><img alt="Figure 5.31 – The firewall management flow with firewalld" src="image/B19121_05_31.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.673.1">Figure 5.31 – The firewall management flow with firewalld</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.674.1">By default, the </span><strong class="source-inline"><span class="kobospan" id="kobo.675.1">firewalld</span></strong><span class="kobospan" id="kobo.676.1"> service comes</span><a id="_idIndexMarker354" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.677.1"> installed with Fedora. </span><span class="kobospan" id="kobo.677.2">You can use the </span><strong class="bold"><span class="kobospan" id="kobo.678.1">firewall-cmd cli</span></strong><span class="kobospan" id="kobo.679.1"> interface to investigate its status. </span><span class="kobospan" id="kobo.679.2">Run the </span><strong class="source-inline"><span class="kobospan" id="kobo.680.1">firewall-cmd --</span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.681.1">state</span></strong></span><span><span class="kobospan" id="kobo.682.1"> command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.683.1">
[root@workstation ~]# </span><strong class="bold1"><span class="kobospan1" id="kobo.684.1">firewall-cmd --state</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.685.1">running</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.686.1">To load the configuration into the firewall, use the </span><strong class="source-inline"><span class="kobospan" id="kobo.687.1">firewall-cmd --</span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.688.1">list-all</span></strong></span><span><span class="kobospan" id="kobo.689.1"> command:</span></span></p>
<pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.690.1">[root@workstation ~]# firewall-cmd --list-all</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.691.1">FedoraWorkstation (active)</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.692.1">  target: default</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.693.1">  icmp-block-inversion: no</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.694.1">  interfaces: wlan0</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.695.1">  sources:</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.696.1">  services: dhcpv6-client mdns samba-client ssh</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.697.1">  ports: 1025-65535/udp 1025-65535/tcp</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.698.1">  protocols:</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.699.1">  forward: yes</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.700.1">  masquerade: no</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.701.1">  forward-ports:</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.702.1">  source-ports:</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.703.1">  icmp-blocks:</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.704.1">  rich rules:</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.705.1">The output of the preceding command shows that the configuration allows the </span><strong class="source-inline"><span class="kobospan" id="kobo.706.1">dhcpv6-client</span></strong><span class="kobospan" id="kobo.707.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.708.1">mdns</span></strong><span class="kobospan" id="kobo.709.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.710.1">samba-client</span></strong><span class="kobospan" id="kobo.711.1">, and </span><strong class="source-inline"><span class="kobospan" id="kobo.712.1">ssh</span></strong><span class="kobospan" id="kobo.713.1"> services, as well as the </span><strong class="source-inline"><span class="kobospan" id="kobo.714.1">1025-65535/udp</span></strong><span class="kobospan" id="kobo.715.1"> and </span><strong class="source-inline"><span class="kobospan" id="kobo.716.1">1025-65535/tcp</span></strong> <span><span class="kobospan" id="kobo.717.1">dynamic ports.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.718.1">In our workstation</span><a id="_idIndexMarker355" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.719.1"> use case, it is likely that we do not need to have services or ports exposed to the network. </span><span class="kobospan" id="kobo.719.2">So, the best practice is to close </span><span><span class="kobospan" id="kobo.720.1">them all.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.721.1">Before closing them, use the </span><strong class="source-inline"><span class="kobospan" id="kobo.722.1">ss</span></strong><span class="kobospan" id="kobo.723.1"> command to investigate the ports that have been opened by the processes to determine whether they refer to the services and ports allowed in </span><span><span class="kobospan" id="kobo.724.1">the firewall:</span></span></p>
<pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.725.1"># ss -tulpn</span></strong></pre> <div class="calibre2">
<div class="img---figure" id="_idContainer150">
<span class="kobospan" id="kobo.726.1"><img alt="Figure 5.32 – Ports and services connections" src="image/B19121_05_32.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.727.1">Figure 5.32 – Ports and services connections</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.728.1">As a result of this analysis, it is clear</span><a id="_idIndexMarker356" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.729.1"> that our network is not using the open services allowed in the firewall, so we should close them. </span><span class="kobospan" id="kobo.729.2">Let’s look at the main reasons why we should </span><span><span class="kobospan" id="kobo.730.1">do this:</span></span></p>
<ul class="calibre15">
<li class="calibre14"><span class="kobospan" id="kobo.731.1">The network does not have </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.732.1">ipv6</span></strong></span><span><span class="kobospan" id="kobo.733.1"> (</span></span><span><strong class="source-inline1"><span class="kobospan" id="kobo.734.1">dhcpv6-client</span></strong></span><span><span class="kobospan" id="kobo.735.1">)</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.736.1">DNS resolution does not use </span><em class="italic"><span class="kobospan" id="kobo.737.1">multicast</span></em><span class="kobospan" id="kobo.738.1"> on the </span><span><span class="kobospan" id="kobo.739.1">network. </span><span class="kobospan" id="kobo.739.2">(</span></span><span><strong class="source-inline1"><span class="kobospan" id="kobo.740.1">mdns</span></strong></span><span><span class="kobospan" id="kobo.741.1">)</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.742.1">We do not use shared directories by </span><strong class="source-inline1"><span class="kobospan" id="kobo.743.1">CIFS</span></strong><span class="kobospan" id="kobo.744.1"> or </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.745.1">samba</span></strong></span><span><span class="kobospan" id="kobo.746.1"> (</span></span><span><strong class="source-inline1"><span class="kobospan" id="kobo.747.1">samba-client</span></strong></span><span><span class="kobospan" id="kobo.748.1">)</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.749.1">The workstation will be used to connect to other computers via </span><strong class="source-inline1"><span class="kobospan" id="kobo.750.1">ssh</span></strong><span class="kobospan" id="kobo.751.1">, but not in the </span><span><span class="kobospan" id="kobo.752.1">opposite direction</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.753.1">To permanently remove the services from the configuration, use the </span><span><strong class="source-inline"><span class="kobospan" id="kobo.754.1">firewall-cmd</span></strong></span><span><span class="kobospan" id="kobo.755.1"> command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.756.1">
[root@workstation ~]# </span><strong class="bold1"><span class="kobospan1" id="kobo.757.1">firewall-cmd --permanent</span></strong><span class="kobospan1" id="kobo.758.1">  </span><strong class="bold1"><span class="kobospan1" id="kobo.759.1">--delete-service={dhcpv6-client,mdns,samba-client}</span></strong><span class="kobospan1" id="kobo.760.1">
Error: BUILTIN_SERVICE: 'dhcpv6-client' is built-in service
Error: BUILTIN_SERVICE: 'mdns' is built-in service
Error: BUILTIN_SERVICE: 'samba-client' is built-in service</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.761.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.762.1">These services come as part of the system and they cannot be removed from </span><span><span class="kobospan" id="kobo.763.1">the configuration.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.764.1">The fourth point (from the preceding list) is also optional. </span><span class="kobospan" id="kobo.764.2">We can do this if we need to connect to the workstation and connect to the managed servers from there, either as a </span><em class="italic"><span class="kobospan" id="kobo.765.1">pivot server</span></em><span class="kobospan" id="kobo.766.1"> or a </span><span><em class="italic"><span class="kobospan" id="kobo.767.1">jump box</span></em></span><span><span class="kobospan" id="kobo.768.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.769.1">With the same command, remove the </span><span><span class="kobospan" id="kobo.770.1">dynamic ports:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.771.1">
[root@workstation ~]# </span><strong class="bold1"><span class="kobospan1" id="kobo.772.1">firewall-cmd --permanent </span></strong><span class="kobospan1" id="kobo.773.1"> </span><strong class="bold1"><span class="kobospan1" id="kobo.774.1">--remove-port={1025-65535/udp,1025-65535/tcp}</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.775.1">Success</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.776.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.777.1">The </span><strong class="source-inline1"><span class="kobospan" id="kobo.778.1">firewall-cmd --permanent</span></strong><span class="kobospan" id="kobo.779.1"> command only affects the configuration files, not the firewall running </span><span><span class="kobospan" id="kobo.780.1">in memory.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.781.1">The service must reload its configuration</span><a id="_idIndexMarker357" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.782.1"> to consider </span><span><span class="kobospan" id="kobo.783.1">the changes.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.784.1">Use the </span><strong class="source-inline"><span class="kobospan" id="kobo.785.1">firewall-cmd --reload</span></strong><span class="kobospan" id="kobo.786.1"> command and verify the </span><span><span class="kobospan" id="kobo.787.1">configuration change:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.788.1">
[root@workstation ~]# </span><strong class="bold1"><span class="kobospan1" id="kobo.789.1">firewall-cmd --reload</span></strong>
<strong class="bold1"><span class="kobospan1" id="kobo.790.1">success</span></strong><span class="kobospan1" id="kobo.791.1">
[root@workstation ~]# </span><strong class="bold1"><span class="kobospan1" id="kobo.792.1">firewall-cmd --list-all</span></strong><span class="kobospan1" id="kobo.793.1">
FedoraWorkstation (active)
  target: default
  icmp-block-inversion: no
  interfaces: wlan0
  sources:
  services: dhcpv6-client mdns samba-client ssh
  </span><strong class="bold1"><span class="kobospan1" id="kobo.794.1">ports:</span></strong><span class="kobospan1" id="kobo.795.1">
  protocols:
  forward: yes
  masquerade: no
  forward-ports:
  source-ports:
  icmp-blocks:
  rich rules:</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.796.1">Thus, by adding services and/or ports, we will have better control of the connections to </span><span><span class="kobospan" id="kobo.797.1">our workstation.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.798.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.799.1">For more information on the use of </span><strong class="source-inline1"><span class="kobospan" id="kobo.800.1">firewalld</span></strong><span class="kobospan" id="kobo.801.1">, refer to the service manual included in the operating system. </span><span class="kobospan" id="kobo.801.2">Run the </span><strong class="source-inline1"><span class="kobospan" id="kobo.802.1">man firewalld</span></strong><span class="kobospan" id="kobo.803.1"> command to </span><span><span class="kobospan" id="kobo.804.1">access it.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.805.1">From our side, the workstation has a secure environment that knows and authorizes the services and ports exposed to the network. </span><span class="kobospan" id="kobo.805.2">But, especially in a public network, this communication must have</span><a id="_idIndexMarker358" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.806.1"> an extra level of security. </span><span class="kobospan" id="kobo.806.2">This could come from using </span><span><span class="kobospan" id="kobo.807.1">a VPN.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.808.1">Let’s learn how to use a VPN to secure the connection from our workstation to the </span><span><span class="kobospan" id="kobo.809.1">managed computers.</span></span></p>
<h1 id="_idParaDest-81" class="calibre5"><a id="_idTextAnchor145" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.810.1">Improving network connectivity using a VPN</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.811.1">A VPN is a way of connecting</span><a id="_idIndexMarker359" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.812.1"> to a local network</span><a id="_idIndexMarker360" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.813.1"> over </span><span><span class="kobospan" id="kobo.814.1">the internet.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.815.1">A VPN connection creates a </span><em class="italic"><span class="kobospan" id="kobo.816.1">single virtual private network between two points</span></em><span class="kobospan" id="kobo.817.1">. </span><span class="kobospan" id="kobo.817.2">Each bit of data gets</span><a id="_idIndexMarker361" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.818.1"> encrypted from point to point via </span><strong class="bold"><span class="kobospan" id="kobo.819.1">tunneling</span></strong><span class="kobospan" id="kobo.820.1">. </span><span class="kobospan" id="kobo.820.2">Tunneling refers to the process by which VPN packets reach their destination. </span><span class="kobospan" id="kobo.820.3">VPNs operate at the operating system level, redirecting all their traffic through other servers. </span><span class="kobospan" id="kobo.820.4">All traffic, including its physical location, remains hidden</span><a id="_idIndexMarker362" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.821.1"> during network browsing. </span><span class="kobospan" id="kobo.821.2">When using a VPN, the VPN router, called the </span><em class="italic"><span class="kobospan" id="kobo.822.1">proxy server</span></em><span class="kobospan" id="kobo.823.1">, appears as the origin of the connection, not the real one. </span><span class="kobospan" id="kobo.823.2">So, neither the site offering public access nor anyone else will be able to deduce who you are or what you </span><span><span class="kobospan" id="kobo.824.1">are doing.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.825.1">The following diagram shows, with a red line, the tunneling created by the VPN by connecting the workstation to the managed server through the </span><span><span class="kobospan" id="kobo.826.1">public network:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer151">
<span class="kobospan" id="kobo.827.1"><img alt="Figure 5.33 – Virtual private network" src="image/B19121_05_33.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.828.1">Figure 5.33 – Virtual private network</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.829.1">A VPN could be</span><a id="_idIndexMarker363" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.830.1"> created with different types</span><a id="_idIndexMarker364" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.831.1"> of tunneling using a variety of protocols, such as </span><strong class="bold"><span class="kobospan" id="kobo.832.1">Secure Shell</span></strong><span class="kobospan" id="kobo.833.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.834.1">SSH</span></strong><span class="kobospan" id="kobo.835.1">) or </span><strong class="bold"><span class="kobospan" id="kobo.836.1">Point-to-Point Protocol</span></strong><span class="kobospan" id="kobo.837.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.838.1">PPP</span></strong><span class="kobospan" id="kobo.839.1">). </span><span class="kobospan" id="kobo.839.2">They also support different service</span><a id="_idIndexMarker365" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.840.1"> providers, such as </span><strong class="bold"><span class="kobospan" id="kobo.841.1">Cisco</span></strong><span class="kobospan" id="kobo.842.1">, </span><strong class="bold"><span class="kobospan" id="kobo.843.1">Juniper</span></strong><span class="kobospan" id="kobo.844.1">, </span><strong class="bold"><span class="kobospan" id="kobo.845.1">NetScreen</span></strong><span class="kobospan" id="kobo.846.1">, and </span><strong class="bold"><span class="kobospan" id="kobo.847.1">SonicWall</span></strong><span class="kobospan" id="kobo.848.1">, and they </span><span><span class="kobospan" id="kobo.849.1">are</span></span><span><a id="_idIndexMarker366" class="pcalibre1 calibre6 pcalibre"/></span><span><span class="kobospan" id="kobo.850.1"> multi-compatible.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.851.1">Now, let’s provide an overview of their two most common services: an </span><strong class="bold"><span class="kobospan" id="kobo.852.1">IPSec-based VPN</span></strong> <span><span class="kobospan" id="kobo.853.1">and </span></span><span><strong class="bold"><span class="kobospan" id="kobo.854.1">OpenVPN</span></strong></span><span><span class="kobospan" id="kobo.855.1">.</span></span></p>
<h2 id="_idParaDest-82" class="calibre7"><a id="_idTextAnchor146" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.856.1">IPSec-based VPN</span></h2>
<p class="calibre3"><strong class="source-inline"><span class="kobospan" id="kobo.857.1">Libreswan</span></strong><span class="kobospan" id="kobo.858.1"> is an </span><strong class="bold"><span class="kobospan" id="kobo.859.1">IPsec</span></strong><span class="kobospan" id="kobo.860.1"> implementation of userspace</span><a id="_idIndexMarker367" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.861.1"> for a VPN, which is the preferred method for creating a VPN. </span><span class="kobospan" id="kobo.861.2">A VPN tunnel always uses </span><em class="italic"><span class="kobospan" id="kobo.862.1">authentication</span></em><span class="kobospan" id="kobo.863.1"> and </span><em class="italic"><span class="kobospan" id="kobo.864.1">encryption</span></em><span class="kobospan" id="kobo.865.1">. </span><span class="kobospan" id="kobo.865.2">For cryptographic operations, </span><strong class="source-inline"><span class="kobospan" id="kobo.866.1">Libreswan</span></strong><span class="kobospan" id="kobo.867.1"> uses the </span><span><strong class="source-inline"><span class="kobospan" id="kobo.868.1">NSS</span></strong></span><span><span class="kobospan" id="kobo.869.1"> library.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.870.1">In Fedora, by default, </span><strong class="source-inline"><span class="kobospan" id="kobo.871.1">Libreswan</span></strong><span class="kobospan" id="kobo.872.1"> is not installed. </span><span class="kobospan" id="kobo.872.2">So, install the </span><strong class="source-inline"><span class="kobospan" id="kobo.873.1">NetworkManager-libreswan-gnome</span></strong><span class="kobospan" id="kobo.874.1"> package with the </span><span><strong class="source-inline"><span class="kobospan" id="kobo.875.1">dnf</span></strong></span><span><span class="kobospan" id="kobo.876.1"> command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.877.1">
[root@workstation ~]# </span><strong class="bold1"><span class="kobospan1" id="kobo.878.1">dnf install NetworkManager-libreswan-gnome</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.879.1">Later, we will describe how to configure the VPN client with </span><span><span class="kobospan" id="kobo.880.1">this protocol.</span></span></p>
<h2 id="_idParaDest-83" class="calibre7"><a id="_idTextAnchor147" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.881.1">OpenVPN</span></h2>
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.882.1">OpenVPN</span></strong><span class="kobospan" id="kobo.883.1"> supports client authentication methods</span><a id="_idIndexMarker368" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.884.1"> based on certificates, smart cards, and/or two-factor authentication. </span><span class="kobospan" id="kobo.884.2">It allows access control policies through firewall rules. </span><span class="kobospan" id="kobo.884.3">OpenVPN </span><em class="italic"><span class="kobospan" id="kobo.885.1">is not</span></em><span class="kobospan" id="kobo.886.1"> a web application proxy and </span><em class="italic"><span class="kobospan" id="kobo.887.1">does not work</span></em><span class="kobospan" id="kobo.888.1"> through a web browser. </span><span class="kobospan" id="kobo.888.2">It needs to be set up in the properties of the </span><span><span class="kobospan" id="kobo.889.1">network connection.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.890.1">The OpenVPN client integrates into </span><strong class="source-inline"><span class="kobospan" id="kobo.891.1">NetworkManager</span></strong><span class="kobospan" id="kobo.892.1"> as </span><span><span class="kobospan" id="kobo.893.1">an </span></span><span><em class="italic"><span class="kobospan" id="kobo.894.1">applet</span></em></span><span><span class="kobospan" id="kobo.895.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.896.1">Now, let’s learn how to connect the workstation as a </span><span><span class="kobospan" id="kobo.897.1">VPN client.</span></span></p>
<h2 id="_idParaDest-84" class="calibre7"><a id="_idTextAnchor148" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.898.1">Configuring a VPN client with the Control Center</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.899.1">Follow these steps</span><a id="_idIndexMarker369" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.900.1"> to connect the workstation</span><a id="_idIndexMarker370" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.901.1"> as a </span><span><span class="kobospan" id="kobo.902.1">VPN client:</span></span></p>
<ol class="calibre13">
<li class="calibre14"><span class="kobospan" id="kobo.903.1">Go to the top-right corner, click on it, and click on the </span><strong class="source-inline1"><span class="kobospan" id="kobo.904.1">gear</span></strong><span class="kobospan" id="kobo.905.1"> icon to open the </span><strong class="bold"><span class="kobospan" id="kobo.906.1">Control </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.907.1">Center</span></strong></span><span><span class="kobospan" id="kobo.908.1"> area:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer152">
<span class="kobospan" id="kobo.909.1"><img alt="Figure 5.34 – Control Center" src="image/B19121_05_34.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.910.1">Figure 5.34 – Control Center</span></p>
<ol class="calibre13">
<li value="2" class="calibre14"><span class="kobospan" id="kobo.911.1">In </span><strong class="bold"><span class="kobospan" id="kobo.912.1">Settings</span></strong><span class="kobospan" id="kobo.913.1">, in</span><a id="_idIndexMarker371" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.914.1"> the left</span><a id="_idIndexMarker372" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.915.1"> column, </span><span><span class="kobospan" id="kobo.916.1">click </span></span><span><strong class="bold"><span class="kobospan" id="kobo.917.1">Network</span></strong></span><span><span class="kobospan" id="kobo.918.1">:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer153">
<span class="kobospan" id="kobo.919.1"><img alt="Figure 5.35 – Network settings" src="image/B19121_05_35.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.920.1">Figure 5.35 – Network settings</span></p>
<ol class="calibre13">
<li value="3" class="calibre14"><span class="kobospan" id="kobo.921.1">In the </span><strong class="bold"><span class="kobospan" id="kobo.922.1">VPN</span></strong><span class="kobospan" id="kobo.923.1"> section, click on the </span><em class="italic"><span class="kobospan" id="kobo.924.1">plus</span></em><span class="kobospan" id="kobo.925.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.926.1">+</span></strong><span class="kobospan" id="kobo.927.1">) symbol to add a </span><span><span class="kobospan" id="kobo.928.1">new connection.</span></span></li>
</ol>
<p class="calibre3"><span class="kobospan" id="kobo.929.1">If the workstation has the </span><strong class="source-inline"><span class="kobospan" id="kobo.930.1">NetworkManager-libreswan-gnome</span></strong><span class="kobospan" id="kobo.931.1"> package installed, the option to add an IPsec-based VPN </span><span><span class="kobospan" id="kobo.932.1">will appear.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.933.1">The following figure shows</span><a id="_idIndexMarker373" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.934.1"> the difference. </span><span class="kobospan" id="kobo.934.2">The </span><strong class="bold"><span class="kobospan" id="kobo.935.1">Add VPN</span></strong><span class="kobospan" id="kobo.936.1"> window</span><a id="_idIndexMarker374" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.937.1"> on the left does have the </span><strong class="source-inline"><span class="kobospan" id="kobo.938.1">NetworkManager-libreswan-gnome</span></strong><span class="kobospan" id="kobo.939.1"> package installed, while the window on the right side does not have the </span><span><span class="kobospan" id="kobo.940.1">package installed:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer154">
<span class="kobospan" id="kobo.941.1"><img alt="Figure 5.36 – Different VPN connection types available" src="image/B19121_05_36.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.942.1">Figure 5.36 – Different VPN connection types available</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.943.1">Let’s look at </span><span><span class="kobospan" id="kobo.944.1">each case.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.945.1">IPsec-based VPN</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.946.1">The following figure shows</span><a id="_idIndexMarker375" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.947.1"> the window for adding the </span><strong class="bold"><span class="kobospan" id="kobo.948.1">IPsec-based </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.949.1">VPN</span></strong></span><span><span class="kobospan" id="kobo.950.1"> connection:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer155">
<span class="kobospan" id="kobo.951.1"><img alt="Figure 5.37 – IPsec-based VPN" src="image/B19121_05_37.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.952.1">Figure 5.37 – IPsec-based VPN</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.953.1">In the </span><strong class="bold"><span class="kobospan" id="kobo.954.1">Identity</span></strong><span class="kobospan" id="kobo.955.1"> tab, add some general</span><a id="_idIndexMarker376" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.956.1"> configuration properties for </span><span><span class="kobospan" id="kobo.957.1">the connection:</span></span></p>
<ul class="calibre15">
<li class="calibre14"><strong class="bold"><span class="kobospan" id="kobo.958.1">Name</span></strong><span class="kobospan" id="kobo.959.1">: This will identify the </span><span><strong class="bold"><span class="kobospan" id="kobo.960.1">VPN</span></strong></span><span><span class="kobospan" id="kobo.961.1"> connection.</span></span></li>
<li class="calibre14"><span><strong class="bold"><span class="kobospan" id="kobo.962.1">General</span></strong></span><span><span class="kobospan" id="kobo.963.1">:</span></span><ul class="calibre17"><li class="calibre14"><strong class="bold"><span class="kobospan" id="kobo.964.1">Gateway</span></strong><span class="kobospan" id="kobo.965.1">: The </span><em class="italic"><span class="kobospan" id="kobo.966.1">name</span></em><span class="kobospan" id="kobo.967.1"> or IP address of the </span><span><strong class="bold"><span class="kobospan" id="kobo.968.1">VPN</span></strong></span><span><span class="kobospan" id="kobo.969.1"> gateway</span></span></li></ul></li>
<li class="calibre14"><span><strong class="bold"><span class="kobospan" id="kobo.970.1">Authentication</span></strong></span><span><span class="kobospan" id="kobo.971.1">:</span></span><ul class="calibre17"><li class="calibre14"><strong class="bold"><span class="kobospan" id="kobo.972.1">Type</span></strong><span class="kobospan" id="kobo.973.1">: IPsec supports two different types </span><span><span class="kobospan" id="kobo.974.1">of authentication:</span></span><ul class="calibre17"><li class="calibre14"><strong class="source-inline1"><span class="kobospan" id="kobo.975.1">IKEv2 (Certificate)</span></strong><span class="kobospan" id="kobo.976.1">: This authentication uses a </span><em class="italic"><span class="kobospan" id="kobo.977.1">certificate</span></em><span class="kobospan" id="kobo.978.1">, so it is the most secure option. </span><span class="kobospan" id="kobo.978.2">This is the </span><strong class="bold"><span class="kobospan" id="kobo.979.1">default option</span></strong><span class="kobospan" id="kobo.980.1"> in </span><span><span class="kobospan" id="kobo.981.1">the connection.</span></span></li><li class="calibre14"><strong class="source-inline1"><span class="kobospan" id="kobo.982.1">IKEv1 (XAUTH)</span></strong><span class="kobospan" id="kobo.983.1">: The authentication uses a </span><em class="italic"><span class="kobospan" id="kobo.984.1">username and password</span></em><span class="kobospan" id="kobo.985.1"> or a </span><span><em class="italic"><span class="kobospan" id="kobo.986.1">pre-shared key</span></em></span><span><span class="kobospan" id="kobo.987.1">.</span></span></li></ul></li></ul></li>
<li class="calibre14"><strong class="bold"><span class="kobospan" id="kobo.988.1">Certificate name</span></strong><span class="kobospan" id="kobo.989.1">: The </span><span><span class="kobospan" id="kobo.990.1">certificate’s filename</span></span></li>
<li class="calibre14"><strong class="bold"><span class="kobospan" id="kobo.991.1">Remote ID</span></strong><span class="kobospan" id="kobo.992.1">: This is used if the remote </span><a id="_idIndexMarker377" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.993.1">server requires a local identifier for the </span><span><span class="kobospan" id="kobo.994.1">IKE exchange</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.995.1">By clicking on the </span><strong class="bold"><span class="kobospan" id="kobo.996.1">Advanced</span></strong><span class="kobospan" id="kobo.997.1"> button, you can access more specific configuration details. </span><span class="kobospan" id="kobo.997.2">If more details for the connection are needed, they can be set up in </span><span><span class="kobospan" id="kobo.998.1">this window:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer156">
<span class="kobospan" id="kobo.999.1"><img alt="Figure 5.38 – IPsec-based VPN – Advanced Properties" src="image/B19121_05_38.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1000.1">Figure 5.38 – IPsec-based VPN – Advanced Properties</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1001.1">After filling in the required fields, click the </span><strong class="bold"><span class="kobospan" id="kobo.1002.1">Apply</span></strong><span class="kobospan" id="kobo.1003.1"> button. </span><span class="kobospan" id="kobo.1003.2">Returning to the previous </span><strong class="bold"><span class="kobospan" id="kobo.1004.1">Add VPN</span></strong><span class="kobospan" id="kobo.1005.1"> screen, click the </span><strong class="bold"><span class="kobospan" id="kobo.1006.1">Add</span></strong><span class="kobospan" id="kobo.1007.1"> button to add</span><a id="_idIndexMarker378" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1008.1"> the </span><span><span class="kobospan" id="kobo.1009.1">VPN connection.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.1010.1">OpenVPN</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.1011.1">Clicking on </span><strong class="bold"><span class="kobospan" id="kobo.1012.1">OpenVPN</span></strong><span class="kobospan" id="kobo.1013.1"> displays a window </span><a id="_idIndexMarker379" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1014.1">similar to the </span><span><span class="kobospan" id="kobo.1015.1">IPsec-based screen:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer157">
<span class="kobospan" id="kobo.1016.1"><img alt="Figure 5.39 – OpenVPN connection" src="image/B19121_05_39.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1017.1">Figure 5.39 – OpenVPN connection</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1018.1">Filling in all the fields, as you did for the previous connection type, allows you to add the </span><span><span class="kobospan" id="kobo.1019.1">OpenVPN connection.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1020.1">However, adding an OpenVPN connection</span><a id="_idIndexMarker380" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1021.1"> is typically done by </span><em class="italic"><span class="kobospan" id="kobo.1022.1">importing a certificate</span></em><span class="kobospan" id="kobo.1023.1">. </span><span class="kobospan" id="kobo.1023.2">Let’s take a look at </span><span><span class="kobospan" id="kobo.1024.1">this process.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1025.1">In the </span><strong class="bold"><span class="kobospan" id="kobo.1026.1">Add VPN</span></strong><span class="kobospan" id="kobo.1027.1"> connection window, click on the last option, </span><strong class="bold"><span class="kobospan" id="kobo.1028.1">Import </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.1029.1">from file…</span></strong></span><span><span class="kobospan" id="kobo.1030.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer158">
<span class="kobospan" id="kobo.1031.1"><img alt="Figure 5.40 – Importing the .ovpn file certificate" src="image/B19121_05_40.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1032.1">Figure 5.40 – Importing the .ovpn file certificate</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1033.1">Browse to the </span><strong class="source-inline"><span class="kobospan" id="kobo.1034.1">.ovpn</span></strong><span class="kobospan" id="kobo.1035.1"> file and click the </span><strong class="bold"><span class="kobospan" id="kobo.1036.1">Open</span></strong><span class="kobospan" id="kobo.1037.1"> button. </span><span class="kobospan" id="kobo.1037.2">The configuration window will display the </span><span><span class="kobospan" id="kobo.1038.1">connection</span></span><span><a id="_idIndexMarker381" class="pcalibre1 calibre6 pcalibre"/></span><span><span class="kobospan" id="kobo.1039.1"> information.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1040.1">For example, in this case, we will import the </span><strong class="source-inline"><span class="kobospan" id="kobo.1041.1">/</span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.1042.1">home/acallejas/sample.ovpn</span></strong></span><span><span class="kobospan" id="kobo.1043.1"> file.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1044.1">The following figure shows the </span><strong class="bold"><span class="kobospan" id="kobo.1045.1">sample vpn</span></strong> <span><span class="kobospan" id="kobo.1046.1">connection information:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer159">
<span class="kobospan" id="kobo.1047.1"><img alt="Figure 5.41 – Sample VPN connection" src="image/B19121_05_41.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1048.1">Figure 5.41 – Sample VPN connection</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1049.1">Regarding the connection, note</span><a id="_idIndexMarker382" class="pcalibre1 calibre6 pcalibre"/> <span><span class="kobospan" id="kobo.1050.1">the following:</span></span></p>
<ul class="calibre15">
<li class="calibre14"><span class="kobospan" id="kobo.1051.1">The file contains the connection’s </span><strong class="bold"><span class="kobospan" id="kobo.1052.1">Name</span></strong><span class="kobospan" id="kobo.1053.1"> and the remote access </span><span><strong class="bold"><span class="kobospan" id="kobo.1054.1">Gateway</span></strong></span><span><span class="kobospan" id="kobo.1055.1"> details.</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.1056.1">Authentication requires </span><strong class="bold"><span class="kobospan" id="kobo.1057.1">User name</span></strong> <span><span class="kobospan" id="kobo.1058.1">and </span></span><span><strong class="bold"><span class="kobospan" id="kobo.1059.1">Password.</span></strong></span></li>
<li class="calibre14"><strong class="bold"><span class="kobospan" id="kobo.1060.1">CA certificate</span></strong><span class="kobospan" id="kobo.1061.1"> is a </span><strong class="source-inline1"><span class="kobospan" id="kobo.1062.1">.pem</span></strong><span class="kobospan" id="kobo.1063.1"> file. </span><span class="kobospan" id="kobo.1063.2">This file</span><a id="_idIndexMarker383" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1064.1"> could request a </span><em class="italic"><span class="kobospan" id="kobo.1065.1">dynamic passphrase</span></em><span class="kobospan" id="kobo.1066.1"> or </span><strong class="bold"><span class="kobospan" id="kobo.1067.1">one-time password</span></strong><span class="kobospan" id="kobo.1068.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.1069.1">OTP</span></strong><span class="kobospan" id="kobo.1070.1">). </span><span class="kobospan" id="kobo.1070.2">This is generated by a physical, virtual, or hybrid device to </span><span><span class="kobospan" id="kobo.1071.1">allow access.</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.1072.1">Click on the </span><strong class="bold"><span class="kobospan" id="kobo.1073.1">Apply</span></strong><span class="kobospan" id="kobo.1074.1"> button, if necessary. </span><span class="kobospan" id="kobo.1074.2">The OpenVPN connection will </span><span><span class="kobospan" id="kobo.1075.1">be added.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1076.1">At the end of the VPN connection configuration, go to </span><strong class="bold"><span class="kobospan" id="kobo.1077.1">Control Center</span></strong><span class="kobospan" id="kobo.1078.1"> and select the VPN you want </span><span><span class="kobospan" id="kobo.1079.1">to access:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer160">
<span class="kobospan" id="kobo.1080.1"><img alt="Figure 5.42 – Choosing a VPN connection" src="image/B19121_05_42.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1081.1">Figure 5.42 – Choosing a VPN connection</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1082.1">After successfully</span><a id="_idIndexMarker384" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1083.1"> authenticating, the login icon will appear in the </span><span><span class="kobospan" id="kobo.1084.1">top-right corner:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer161">
<span class="kobospan" id="kobo.1085.1"><img alt="Figure 5.43 – Workstation connected to the VPN" src="image/B19121_05_43.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1086.1">Figure 5.43 – Workstation connected to the VPN</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1087.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.1088.1">One of the best practices for secure communications is to have your own VPN. </span><span class="kobospan" id="kobo.1088.2">For more information on how to do this, visit the articles published in </span><strong class="bold"><span class="kobospan" id="kobo.1089.1">Fedora Magazine</span></strong> <span><span class="kobospan" id="kobo.1090.1">at </span></span><a href="https://fedoramagazine.org/tag/vpn/" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1091.1">https://fedoramagazine.org/tag/vpn/</span></span></a><span><span class="kobospan" id="kobo.1092.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1093.1">Now that we have improved our network connection, be it wired or wireless, using tuning or a VPN, let’s learn about some tools that will help us track the </span><span><span class="kobospan" id="kobo.1094.1">connection’s behavior.</span></span></p>
<h1 id="_idParaDest-85" class="calibre5"><a id="_idTextAnchor149" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1095.1">Network performance monitoring</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.1096.1">There are different and varied</span><a id="_idIndexMarker385" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1097.1"> network connection monitoring tools, but I prefer those that can be managed via the console. </span><span class="kobospan" id="kobo.1097.2">This allows for flexibility and, at the same time, can be used to run test batteries to verify the information that’s </span><span><span class="kobospan" id="kobo.1098.1">been received.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1099.1">The first tool we’ll look at is basic but also has enough power to generate a quick analysis of the </span><span><span class="kobospan" id="kobo.1100.1">connection’s behavior.</span></span></p>
<h2 id="_idParaDest-86" class="calibre7"><a id="_idTextAnchor150" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1101.1">nmon</span></h2>
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.1102.1">Nigel’s Monitor</span></strong><span class="kobospan" id="kobo.1103.1"> (</span><strong class="source-inline"><span class="kobospan" id="kobo.1104.1">nmon</span></strong><span class="kobospan" id="kobo.1105.1">) was created for the </span><strong class="bold"><span class="kobospan" id="kobo.1106.1">IBM AIX</span></strong><span class="kobospan" id="kobo.1107.1"> operating system with</span><a id="_idIndexMarker386" class="pcalibre1 calibre6 pcalibre"/> <em class="italic"><span class="kobospan" id="kobo.1108.1">release 4.3</span></em><span class="kobospan" id="kobo.1109.1"> in 2006 and</span><a id="_idIndexMarker387" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1110.1"> was ported</span><a id="_idIndexMarker388" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1111.1"> to Linux in 2015 under the </span><strong class="bold"><span class="kobospan" id="kobo.1112.1">GNU General Public License</span></strong> <span><span class="kobospan" id="kobo.1113.1">for use.</span></span></p>
<p class="calibre3"><strong class="source-inline"><span class="kobospan" id="kobo.1114.1">nmon</span></strong><span class="kobospan" id="kobo.1115.1"> is a benchmark</span><a id="_idIndexMarker389" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1116.1"> tool. </span><span class="kobospan" id="kobo.1116.2">It collects operating system statistics, including </span><span><span class="kobospan" id="kobo.1117.1">the following:</span></span></p>
<ul class="calibre15">
<li class="calibre14"><span class="kobospan" id="kobo.1118.1">CPU (and CPU thread utilization or </span><span><span class="kobospan" id="kobo.1119.1">CPU frequency)</span></span></li>
<li class="calibre14"><span><span class="kobospan" id="kobo.1120.1">GPU stats</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.1121.1">Memory use (physical and virtual, swap </span><span><span class="kobospan" id="kobo.1122.1">and paging)</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.1123.1">Disk (read and write, transfers plus service time and wait </span><span><span class="kobospan" id="kobo.1124.1">times, groups)</span></span></li>
<li class="calibre14"><span class="kobospan" id="kobo.1125.1">Network (read and write and transfers), </span><span><span class="kobospan" id="kobo.1126.1">and more</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.1127.1">This information can be displayed on the screen or saved in a </span><em class="italic"><span class="kobospan" id="kobo.1128.1">comma-separated file</span></em><span class="kobospan" id="kobo.1129.1">. </span><span class="kobospan" id="kobo.1129.2">This allows for file backup and analysis to be performed with data </span><span><span class="kobospan" id="kobo.1130.1">extraction tools.</span></span></p>
<p class="calibre3"><strong class="source-inline"><span class="kobospan" id="kobo.1131.1">nmon</span></strong><span class="kobospan" id="kobo.1132.1"> is available in Fedora’s repositories. </span><span class="kobospan" id="kobo.1132.2">Install </span><strong class="source-inline"><span class="kobospan" id="kobo.1133.1">nmon</span></strong><span class="kobospan" id="kobo.1134.1"> using the </span><span><strong class="source-inline"><span class="kobospan" id="kobo.1135.1">dnf</span></strong></span><span><span class="kobospan" id="kobo.1136.1"> command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.1137.1">
[root@workstation ~]# </span><strong class="bold1"><span class="kobospan1" id="kobo.1138.1">dnf install nmon</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.1139.1">Run the tool with the </span><span><strong class="source-inline"><span class="kobospan" id="kobo.1140.1">nmon</span></strong></span><span><span class="kobospan" id="kobo.1141.1"> command:</span></span></p>
<pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.1142.1">[root@workstation ~]# nmon</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.1143.1">The terminal will display the main </span><span><strong class="source-inline"><span class="kobospan" id="kobo.1144.1">nmon</span></strong></span><span><span class="kobospan" id="kobo.1145.1"> window:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer162">
<span class="kobospan" id="kobo.1146.1"><img alt="Figure 5.44 – nmon" src="image/B19121_05_44.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1147.1">Figure 5.44 – nmon</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1148.1">In the case of network</span><a id="_idIndexMarker390" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1149.1"> connection</span><a id="_idIndexMarker391" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1150.1"> analysis, press </span><strong class="source-inline"><span class="kobospan" id="kobo.1151.1">n</span></strong><span class="kobospan" id="kobo.1152.1"> to display the </span><span><span class="kobospan" id="kobo.1153.1">connection statistics:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer163">
<span class="kobospan" id="kobo.1154.1"><img alt="Figure 5.45 – Network stats" src="image/B19121_05_45.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1155.1">Figure 5.45 – Network stats</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1156.1">Note</span></p>
<p class="callout"><strong class="source-inline1"><span class="kobospan" id="kobo.1157.1">nmon</span></strong><span class="kobospan" id="kobo.1158.1"> can collect a lot of useful information for workstation </span><em class="italic"><span class="kobospan" id="kobo.1159.1">performance benchmarking</span></em><span class="kobospan" id="kobo.1160.1">. </span><span class="kobospan" id="kobo.1160.2">To learn</span><a id="_idIndexMarker392" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1161.1"> more about its uses, refer to the </span><strong class="bold"><span class="kobospan" id="kobo.1162.1">nmon for Linux</span></strong><span class="kobospan" id="kobo.1163.1"> page </span><span><span class="kobospan" id="kobo.1164.1">at </span></span><a href="https://nmon.sourceforge.net/" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1165.1">https://nmon.sourceforge.net/</span></span></a><span><span class="kobospan" id="kobo.1166.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1167.1">Another of my favorite tools is </span><strong class="source-inline"><span class="kobospan" id="kobo.1168.1">bashtop</span></strong><span class="kobospan" id="kobo.1169.1">, but it is not included in the Fedora repositories at the time</span><a id="_idIndexMarker393" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1170.1"> of writing. </span><span class="kobospan" id="kobo.1170.2">It must be installed by following the instructions on the project’s page on </span><span><span class="kobospan" id="kobo.1171.1">GitHub (</span></span><a href="https://github.com/aristocratos/bashtop#installation" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1172.1">https://github.com/aristocratos/bashtop#installation</span></span></a><span><span class="kobospan" id="kobo.1173.1">).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1174.1">A </span><strong class="bold"><span class="kobospan" id="kobo.1175.1">Python</span></strong><span class="kobospan" id="kobo.1176.1"> implementation of </span><strong class="source-inline"><span class="kobospan" id="kobo.1177.1">bashtop</span></strong><span class="kobospan" id="kobo.1178.1"> that’s</span><a id="_idIndexMarker394" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1179.1"> included</span><a id="_idIndexMarker395" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1180.1"> in</span><a id="_idIndexMarker396" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1181.1"> the official </span><strong class="bold"><span class="kobospan" id="kobo.1182.1">Fedora Linux</span></strong><span class="kobospan" id="kobo.1183.1"> repositories </span><span><span class="kobospan" id="kobo.1184.1">is </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.1185.1">bpytop</span></strong></span><span><span class="kobospan" id="kobo.1186.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1187.1">Let’s learn how to install and </span><span><span class="kobospan" id="kobo.1188.1">use it.</span></span></p>
<h2 id="_idParaDest-87" class="calibre7"><a id="_idTextAnchor151" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1189.1">bpytop</span></h2>
<p class="calibre3"><strong class="source-inline"><span class="kobospan" id="kobo.1190.1">bpytop</span></strong><span class="kobospan" id="kobo.1191.1"> is a </span><em class="italic"><span class="kobospan" id="kobo.1192.1">resource monitor</span></em><span class="kobospan" id="kobo.1193.1"> that displays usage</span><a id="_idIndexMarker397" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1194.1"> and statistics for the</span><a id="_idIndexMarker398" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1195.1"> processor, memory, disks, network, </span><span><span class="kobospan" id="kobo.1196.1">and processes.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1197.1">It includes the most common features of resource monitors, such as ease of use and process manipulation at the touch of a key. </span><span class="kobospan" id="kobo.1197.2">However, it also has flexible features that allow data and processes to be manipulated simplistically. </span><span class="kobospan" id="kobo.1197.3">It can also be used to integrate themes that make it </span><span><span class="kobospan" id="kobo.1198.1">more attractive.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1199.1">To install </span><strong class="source-inline"><span class="kobospan" id="kobo.1200.1">bpytop</span></strong><span class="kobospan" id="kobo.1201.1">, follow </span><span><span class="kobospan" id="kobo.1202.1">these steps:</span></span></p>
<ol class="calibre13">
<li class="calibre14"><span class="kobospan" id="kobo.1203.1">As the </span><strong class="source-inline1"><span class="kobospan" id="kobo.1204.1">root</span></strong><span class="kobospan" id="kobo.1205.1"> user, use the </span><strong class="source-inline1"><span class="kobospan" id="kobo.1206.1">dnf</span></strong><span class="kobospan" id="kobo.1207.1"> command to </span><span><span class="kobospan" id="kobo.1208.1">install </span></span><span><strong class="source-inline1"><span class="kobospan" id="kobo.1209.1">bpytop</span></strong></span><span><span class="kobospan" id="kobo.1210.1">:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.1211.1">[root@workstation ~]# dnf -y install bpytop</span></strong></pre></li> <li class="calibre14"><span class="kobospan" id="kobo.1212.1">On the terminal, run </span><strong class="source-inline1"><span class="kobospan" id="kobo.1213.1">bpytop</span></strong> <span><span class="kobospan" id="kobo.1214.1">as </span></span><span><strong class="bold"><span class="kobospan" id="kobo.1215.1">root</span></strong></span><span><span class="kobospan" id="kobo.1216.1">:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.1217.1">[root@workstation ~]# bpytop</span></strong></pre></li> </ol>
<p class="calibre3"><span class="kobospan" id="kobo.1218.1">The main monitor window </span><span><span class="kobospan" id="kobo.1219.1">will appear:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer164">
<span class="kobospan" id="kobo.1220.1"><img alt="Figure 5.46 – bpytop monitor" src="image/B19121_05_46.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1221.1">Figure 5.46 – bpytop monitor</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1222.1">Note</span></p>
<p class="callout"><span class="kobospan" id="kobo.1223.1">To learn more about </span><strong class="source-inline1"><span class="kobospan" id="kobo.1224.1">bpytop</span></strong><span class="kobospan" id="kobo.1225.1"> monitor usage, refer to the </span><strong class="bold"><span class="kobospan" id="kobo.1226.1">bpytop GitHub page</span></strong> <span><span class="kobospan" id="kobo.1227.1">at </span></span><a href="https://github.com/aristocratos/bpytop" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1228.1">https://github.com/aristocratos/bpytop</span></span></a><span><span class="kobospan" id="kobo.1229.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1230.1">These excellent monitoring</span><a id="_idIndexMarker399" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1231.1"> tools allow us to track the performance</span><a id="_idIndexMarker400" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1232.1"> of </span><span><span class="kobospan" id="kobo.1233.1">network connections.</span></span></p>
<h1 id="_idParaDest-88" class="calibre5"><a id="_idTextAnchor152" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1234.1">Summary</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.1235.1">In this chapter, we reviewed how to connect our workstation to a network, by cable or wirelessly. </span><span class="kobospan" id="kobo.1235.2">Besides learning how to fine-tune this connection through best practices, we reviewed how to use VPNs in detail, as well as how to connect our workstation with an IPsec-based VPN and OpenVPN. </span><span class="kobospan" id="kobo.1235.3">Finally, we reviewed two monitoring tools that can help us track the performance of the </span><span><span class="kobospan" id="kobo.1236.1">network’s connection.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1237.1">In the next chapter, we will start learning about applications. </span><span class="kobospan" id="kobo.1237.2">We will begin by looking at some modern ways of using them, such as using </span><span><em class="italic"><span class="kobospan" id="kobo.1238.1">sandbox containers</span></em></span><span><span class="kobospan" id="kobo.1239.1">.</span></span></p>
<h1 id="_idParaDest-89" class="calibre5"><a id="_idTextAnchor153" class="pcalibre1 calibre6 pcalibre"/><span class="kobospan" id="kobo.1240.1">Further reading</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.1241.1">To learn more about the topics that were covered in this chapter, take a look at the </span><span><span class="kobospan" id="kobo.1242.1">following resources:</span></span></p>
<ul class="calibre15">
<li class="calibre14"><em class="italic"><span class="kobospan" id="kobo.1243.1">Fedora Linux 36 no longer supports the ifcfg files to </span></em><span><em class="italic"><span class="kobospan" id="kobo.1244.1">configure networking</span></em></span><span><span class="kobospan" id="kobo.1245.1">:</span></span></li>
</ul>
<p class="calibre3"><a href="https://fedoraproject.org/wiki/Releases/36/ChangeSet#No_ifcfg_by_default" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1246.1">https://fedoraproject.org/wiki/Releases/36/ChangeSet#No_ifcfg_by_default</span></span></a></p>
<ul class="calibre15">
<li class="calibre14"><span><em class="italic"><span class="kobospan" id="kobo.1247.1">nm-settings-nmcli</span></em></span><span><span class="kobospan" id="kobo.1248.1">:</span></span></li>
</ul>
<p class="calibre3"><a href="https://developer-old.gnome.org/NetworkManager/stable/nm-settings-nmcli.html" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1249.1">https://developer-old.gnome.org/NetworkManager/stable/nm-settings-nmcli.html</span></span></a></p>
<ul class="calibre15">
<li class="calibre14"><em class="italic"><span class="kobospan" id="kobo.1250.1">Ask Fedora – </span></em><span><em class="italic"><span class="kobospan" id="kobo.1251.1">Wi-Fi</span></em></span><span><span class="kobospan" id="kobo.1252.1">:</span></span></li>
</ul>
<p class="calibre3"><a href="https://ask.fedoraproject.org/search?q=wifi%20tags%3Af37%2Cwifi%20order%3Aviews" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1253.1">https://ask.fedoraproject.org/search?q=wifi%20tags%3Af37%2Cwifi%20order%3Aviews</span></span></a></p>
<ul class="calibre15">
<li class="calibre14"><em class="italic"><span class="kobospan" id="kobo.1254.1">Fedora Docs: </span></em><span><em class="italic"><span class="kobospan" id="kobo.1255.1">Using firewalld</span></em></span><span><span class="kobospan" id="kobo.1256.1">:</span></span></li>
</ul>
<p class="calibre3"><a href="https://docs.fedoraproject.org/en-US/quick-docs/firewalld/" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1257.1">https://docs.fedoraproject.org/en-US/quick-docs/firewalld/</span></span></a></p>
<ul class="calibre15">
<li class="calibre14"><em class="italic"><span class="kobospan" id="kobo.1258.1">Fedora </span></em><span><em class="italic"><span class="kobospan" id="kobo.1259.1">Wiki: OpenVPN</span></em></span><span><span class="kobospan" id="kobo.1260.1">:</span></span></li>
</ul>
<p class="calibre3"><a href="https://fedoraproject.org/wiki/OpenVPN" class="pcalibre1 calibre6 pcalibre"><span><span class="kobospan" id="kobo.1261.1">https://fedoraproject.org/wiki/OpenVPN</span></span></a></p>
</div>
</body></html>