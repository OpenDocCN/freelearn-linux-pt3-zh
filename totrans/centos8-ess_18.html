<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer180" class="_idGenObjectStyleOverride-1">&#13;
			<p id="_idParaDest-193" class="Chapter-Title"><span class="ChapterMarker">20. </span><a id="_idTextAnchor257"/>Installing <a id="_idIndexMarker460"/>KVM <a id="_idIndexMarker461"/>Virtualization on CentOS 8</p>&#13;
			<p class="My-Basic-Paragraph">Prior to CentOS 6 two virtualization platforms were provided with CentOS in the form of Kernel-based Virtual Machine (KVM) and Xen. With the release of CentOS 6, support for Xen was removed leaving KVM as the only bundled virtualization option supplied with CentOS 8. In addition to KVM, third party solutions are available in the form of products such as VMware and Oracle VirtualBox. Since KVM is supplied with CentOS 8, however, this is the virtualization solution that will be covered in this and subsequent chapters.</p>&#13;
			<p class="My-Basic-Paragraph">Before plunging into installing and running KVM it is worth taking a little time to talk about how it fits into the various types of virtualization outlined in the previous chapter.</p>&#13;
			<p id="_idParaDest-194" class="Heading-1-1"><span class="Heading11Marker">20.1 </span><a id="_idTextAnchor258"/>An Overview of <a id="_idIndexMarker462"/>KVM </p>&#13;
			<p class="My-Basic-Paragraph">KVM is categorized as a Type-1 hypervisor virtualization solution that implements full virtualization with support for unmodified guest operating systems using Intel VT and AMD-V hardware virtualization support.</p>&#13;
			<p class="My-Basic-Paragraph">KVM differs from many other Type-1 solutions in that it turns the host Linux operating system itself into the hypervisor, allowing bare metal virtualization to be implemented while still running a full, enterprise level host operating system.</p>&#13;
			<p id="_idParaDest-195" class="Heading-1-1"><span class="Heading11Marker">20.2 </span><a id="_idTextAnchor259"/>KVM <a id="_idIndexMarker463"/>Hardware Requirements</p>&#13;
			<p class="My-Basic-Paragraph">Before proceeding with this chapter we need to take a moment to discuss the hardware requirements for running virtual machines within a KVM environment. First and foremost, KVM virtualization is only available on certain processor types. As previously discussed, these processors must include either Intel VT or AMD-V technology. </p>&#13;
			<p class="My-Basic-Paragraph">To check for virtualization support, run the following command in a terminal window:</p>&#13;
			<p class="Code"># lscpu | grep Virtualization:</p>&#13;
			<p class="My-Basic-Paragraph">If the system contains a CPU with <a id="_idIndexMarker464"/><a id="_idIndexMarker465"/>Intel VT support, the above command will provide the following output:</p>&#13;
			<p class="Code">Virtualization:      VT-x</p>&#13;
			<p class="My-Basic-Paragraph">Alternatively, the following output will be displayed when a CPU with AMD-V support is detected:</p>&#13;
			<p class="Code">Virtualization:      AMD-V</p>&#13;
			<p class="My-Basic-Paragraph">If the CPU does not support virtualization, no output will displayed by the <span class="My-Italic _idGenCharOverride-1">lscpu</span> command.</p>&#13;
			<p class="My-Basic-Paragraph">Note that while the above commands only report whether the processor supports the respective feature, it does not indicate whether the feature is currently enabled in the BIOS. In practice virtualization support is typically disabled by default in the BIOS of most systems. It is recommended, therefore, that you check your BIOS settings to ensure the appropriate virtualization technology is enabled before proceeding with this tutorial. </p>&#13;
			<p class="My-Basic-Paragraph">Unlike a dual booting environment, a virtualized environment involves the running of two or more complete operating systems concurrently on a single computer system. This means that the system must have enough physical memory, disk space and CPU processing power to comfortably accommodate all these systems in parallel. Before beginning the configuration and installation process check on the minimum system requirements for both CentOS 8 and your chosen guest operating systems and verify that your system has sufficient resources to handle the requirements of both systems.</p>&#13;
			<p id="_idParaDest-196" class="Heading-1-1"><span class="Heading11Marker">20.3 </span><a id="_idTextAnchor260"/>Preparing CentOS 8 for <a id="_idIndexMarker466"/>KVM Virtualization </p>&#13;
			<p class="My-Basic-Paragraph">Unlike Xen, it is not necessary to run a special version of the kernel in order to support KVM. As a result KVM support is already available for use with the standard kernel via the installation of a KVM kernel module, thereby negating the need to install and boot from a special kernel. </p>&#13;
			<p class="My-Basic-Paragraph">To avoid conflicts, however, if a Xen enabled kernel is currently running on the system, reboot the system and select a non-Xen kernel from the boot menu before proceeding with the remainder of this chapter.</p>&#13;
			<p class="My-Basic-Paragraph">The tools required to setup and maintain a KVM-based virtualized system are not installed by default unless specifically selected during the CentOS 8 operating system installation process. To install KVM from the command prompt, execute the following command in a terminal window:</p>&#13;
			<p class="Code"># dnf install qemu-kvm qemu-img libvirt virt-install libvirt-client</p>&#13;
			<p class="My-Basic-Paragraph">If you have access to a graphical desktop environment the <a id="_idIndexMarker467"/><a id="_idIndexMarker468"/><span class="My-Italic _idGenCharOverride-1">virt-manager</span> package is also recommended:</p>&#13;
			<p class="Code"># dnf install virt-manager</p>&#13;
			<p id="_idParaDest-197" class="Heading-1-1"><span class="Heading11Marker">20.4 </span><a id="_idTextAnchor261"/>Verifying the <a id="_idIndexMarker469"/>KVM Installation</p>&#13;
			<p class="My-Basic-Paragraph">It is worthwhile checking that the KVM installation worked correctly before moving forward. When KVM is installed and running, two modules will have been loaded into the kernel. The presence or otherwise of these modules can be verified in a terminal window by running the following command:</p>&#13;
			<p class="Code"># lsmod | grep kvm </p>&#13;
			<p class="My-Basic-Paragraph">Assuming that the installation was successful the above command should generate output similar to the following:</p>&#13;
			<p class="Code"># lsmod | grep kvm</p>&#13;
			<p class="Code">kvm_intel             237568  0</p>&#13;
			<p class="Code">kvm                   737280  1 kvm_intel</p>&#13;
			<p class="Code">irqbypass              16384  1 kvm</p>&#13;
			<p class="My-Basic-Paragraph">Note that if the system contains an AMD processor the kvm module will likely read <a id="_idIndexMarker470"/><a id="_idIndexMarker471"/><a id="_idIndexMarker472"/><a id="_idIndexMarker473"/><a id="_idIndexMarker474"/><span class="My-Italic _idGenCharOverride-1">kvm_amd </span>rather than <span class="My-Italic _idGenCharOverride-1">kvm_intel</span>.</p>&#13;
			<p class="My-Basic-Paragraph">The installation process should also have configured the libvirtd daemon to run in the background. Once again using a terminal window, run the following command to ensure <a id="_idIndexMarker475"/><a id="_idIndexMarker476"/>libvirtd is running:</p>&#13;
			<p class="Code"># systemctl status libvirtd</p>&#13;
			<p class="Code"> libvirtd.service - Virtualization daemon</p>&#13;
			<p class="Code">   Loaded: loaded (/usr/lib/systemd/system/libvirtd.service; enabled; vendor preset: enabled)</p>&#13;
			<p class="Code">   Active: active (running) since Wed 2019-03-06 14:41:22 EST; 3min 54s ago</p>&#13;
			<p class="My-Basic-Paragraph">If the process is not running, it may be started as follows:</p>&#13;
			<p class="Code"># systemctl enable --now libvirtd</p>&#13;
			<p class="Code"># systemctl start libvirtd</p>&#13;
			<p class="My-Basic-Paragraph">If the desktop environment is available, run the <a id="_idIndexMarker477"/><a id="_idIndexMarker478"/><span class="My-Italic _idGenCharOverride-1">virt-manager</span> tool by selecting Activities and entering “virt” into the search box. When the Virtual Machine Manager icon appears, click on it to launch it. When loaded, the manager should appear as illustrated in the following figure:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1"><img class="_idGenObjectAttribute-1" src="Images/rhel_8_virt-manager.png" alt="" width="1100" height="444"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 20-1</span></p>&#13;
			<p class="My-Basic-Paragraph">If the <a id="_idIndexMarker479"/>QEMU/KVM entry is not listed, select the <span class="My-Italic _idGenCharOverride-1">File -&gt; Add Connection</span> menu option and, in the resulting dialog, select the QEMU/KVM Hypervisor before clicking on the Connect button:</p>&#13;
			<p class="My-Basic-Paragraph ParaOverride-1"><img class="_idGenObjectAttribute-2" src="Images/rhel_8_virt-manager_add_connection.png" alt="" width="665" height="586"/></p>&#13;
			<p class="Figure-Caption"><span class="FigureCaptionMarker">Figure 20-2</span></p>&#13;
			<p class="My-Basic-Paragraph">If the manager is not currently connected to the virtualization processes, right-click on the entry listed and select Connect from the popup menu.</p>&#13;
			<p id="_idParaDest-198" class="Heading-1-1"><span class="Heading11Marker">20.5 </span><a id="_idTextAnchor262"/>Summary</p>&#13;
			<p class="My-Basic-Paragraph">KVM is a Type-1 hypervisor virtualization solution that implements full virtualization with support for unmodified guest operating systems using Intel VT and AMD-V hardware virtualization support. It is the default virtualization solution bundled with CentOS 8 and can be installed quickly and easily on any CentOS 8 system with appropriate processor support. With KVM support installed and enabled, the next few chapters will outline some of the options for installing and managing virtual machines on a CentOS 8 host.</p>&#13;
		</div>&#13;
</div>



  </body></html>